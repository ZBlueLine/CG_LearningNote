<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><style type="text/css" title="ibis-book"></style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Script; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_SansSerif-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav  scalefonts subscribe-panel library nav-collapsed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C015.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 15 Curves</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C017.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 17 Using Graphics Hardware</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 16</p>
<h1>Computer Animation</h1>
<p class="h1Author">Michael Ashikhmin</p>
<p><a id="page_405"></a><span class="cItalic">Animation</span> is derived from the Latin <span class="cItalic">anima</span> and means the act, process, or result of imparting life, interest, spirit, motion, or activity. Motion is a defining property of life and much of the true art of animation is about how to tell a story, show emotion, or even express subtle details of human character through motion. A computer is a secondary tool for achieving these goals—it is a tool which a skillful animator can use to help get the result he wants faster and without concentrating on technicalities in which he is not interested. Animation without computers, which is now often called “traditional” animation, has a long and rich history of its own which is continuously being written by hundreds of people still active in this art. As in any established field, some time-tested rules have been crystallized which give general high-level guidance to how certain things should be done and what should be avoided. These principles of traditional animation apply equally to computer animation, and we will discuss some of them in this chapter.</p>
<p>The computer, however, is more than just a tool. In addition to making the animator’s main task less tedious, computers also add some truly unique abilities that were simply not available or were extremely difficult to obtain before. Modern modeling tools allow the relatively easy creation of detailed three-dimensional models, rendering algorithms can produce an impressive range of appearances, from fully photorealistic to highly stylized, powerful numerical simulation algorithms can help to produce desired physics-based motion for particularly hard to animate objects, and motion capture systems give the ability to <a id="page_406"></a>record and use real-life motion. These developments led to an exploding use of computer animation techniques in motion pictures and commercials, automotive design and architecture, medicine and scientific research, among many other areas. Completely new domains and applications have also appeared including fully computer-animated feature films, virtual/augmented reality systems, and, of course, computer games.</p>
<p>Other chapters of this book cover many of the developments mentioned above (for example, geometric modeling and rendering) more directly. Here, we will provide an overview only of techniques and algorithms directly used to create and manipulate motion. In particular, we will loosely distinguish and briefly describe four main computer animation approaches:</p>
<ul>
<li class="LX"><span class="cBold">Keyframing</span> gives the most direct control to the animator who provides necessary data at some moments in time and the computer fills in the rest.</li>
<li class="LX"><span class="cBold">Procedural</span> animation involves specially designed, often empirical, mathematical functions and procedures whose output resembles some particular motion.</li>
<li class="LX"><span class="cBold">Physics-based</span> techniques solve differential equation of motion.</li>
<li class="LX"><span class="cBold">Motion capture</span> uses special equipment or techniques to record real-world motion and then transfers this motion into that of computer models.</li>
</ul>
<p>We do not touch upon the artistic side of the field at all here. In general, we cannot possibly do more here than just scratch the surface of the fascinating subject of creating motion with a computer. We hope that readers truly interested in the subject will continue their journey well beyond the material of this chapter.</p>
<h2><a id="sec16-1"></a>16.1 Principles of Animation</h2>
<p>In his seminal 1987 SIGGRAPH paper (Lasseter, 1987), John Lasseter brought key principles developed as early as the 1930’s by traditional animators of Walt Disney studios to the attention of the then-fledgling computer animation community. Twelve principles were mentioned: <span class="cItalic">squash and stretch, timing, anticipation, follow through and overlapping action, slow-in and slow-out, staging, arcs, secondary action, straight-ahead and pose-to-pose action, exaggeration, solid drawing skill,</span> and <span class="cItalic">appeal.</span> Almost two decades later, these time-tested rules, which can make a difference between a natural and entertaining animation and a mechanistic-looking and boring one, are as important as ever. For computer animation, in addition, it is very important to <span class="cItalic">balance</span> control and flexibility given to <a id="page_407"></a>the animator with the full advantage of the computer’s abilities. Although these principles are widely known, many factors affect how much attention is being paid to these rules in practice. While a character animator working on a feature film might spend many hours trying to follow some of these suggestions (for example, tweaking his timing to be just right), many game designers tend to believe that their time is better spent elsewhere.</p>
<h3><a id="sec16-1-1"></a>16.1.1 Timing</h3>
<p><span class="cItalic">Timing</span>, or the speed of action, is at the heart of any animation. How fast things happen affects the meaning of action, emotional state, and even perceived weight of objects involved. Depending on its speed, the same action, a turn of a character’s head from left to right, can mean anything from a reaction to being hit by a heavy object to slowly seeking a book on a bookshelf or stretching a neck muscle. It is very important to set timing appropriate for the specific action at hand. Action should occupy enough time to be noticed while avoiding too slow and potentially boring motions. For computer animation projects involving recorded sound, the sound provides a natural timing anchor to be followed. In fact, in most productions, the actor’s voice is recorded first and the complete animation is then synchronized to this recording. Since large and heavy objects tend to move slower than small and light ones (with less acceleration, to be more precise), timing can be used to provide significant information about the weight of an object.</p>
<h3><a id="sec16-1-2"></a>16.1.2 Action Layout</h3>
<p>At any moment during an animation, it should be clear to the viewer what idea (action, mood, expression) is being presented. Good <span class="cItalic">staging</span>, or high-level planning of the action, should lead a viewer’s eye to where the important action is currently concentrated, effectively telling him “look at this, and now, look at this” without using any words. Some familiarity with human perception can help us with this difficult task. Since human visual systems react mostly to relative changes rather than absolute values of stimuli, a sudden motion in a still environment or lack of motion in some part of a busy scene naturally draws attention. The same action presented so that the silhouette of the object is changing can often be much more noticeable compared with a frontal arrangement (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-1">Figure 16.1</a> (bottom left)).</p>
<div id="art_Dest_fig_16-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-1"></a><span class="cBold">Figure 16.1</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-1.png" alt="Figure showing action layout. Left: Staging action properly is crucial for bringing attention to currently important motion. The act of raising a hand would be prominent on the top but harder to notice on the bottom. A change in nose length, on the contrary, might be completely invisible in the first case. Note that this might be intentionally hidden, for example, to be suddenly revealed later. Neither arrangement is particularly good if both motions should be attended to. Middle: The amount of anticipation can tell much about the following action. The action which is about to follow (throwing a ball) is very short, but it is clear what is about to happen. The more wound up the character is, the faster the following action is perceived to be. Right: The follow-through phase is especially important for secondary appendages (hair) whose motion follows the leading part (head). The motion of the head is very simple, but leads to nontrivial follow-through behavior of the hair itself. It is impossible to create a natural animation without a follow-through phase and overlapping action in this case." width="600" height="569" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-1.png"></p>
<p class="Text figcaption">Action layout. Left: Staging action properly is crucial for bringing attention to currently important motion. The act of raising a hand would be prominent on the top but harder to notice on the bottom. A change in nose length, on the contrary, might be completely invisible in the first case. Note that this might be intentionally hidden, for example, to be suddenly revealed later. Neither arrangement is particularly good if both motions should be attended to. Middle: The amount of anticipation can tell much about the following action. The action which is about to follow (throwing a ball) is very short, but it is clear what is about to happen. The more wound up the character is, the faster the following action is perceived to be. Right: The follow-through phase is especially important for secondary appendages (hair) whose motion follows the leading part (head). The motion of the head is very simple, but leads to nontrivial follow-through behavior of the hair itself. It is impossible to create a natural animation without a follow-through phase and overlapping action in this case.</p>
<p class="Text figsource"><span class="cItalic">Figure courtesy Peter Shirley and Christina Villarruel.</span></p>
</div>
<p>On a slightly lower level, each action can be split into three parts: <span class="cItalic">anticipation</span> (preparation for the action), the action itself, and <span class="cItalic">follow-through</span> (termination of the action). In many cases, the action itself is the shortest part and, in some sense, <a id="page_408"></a>the least interesting. For example, kicking a football might involve extensive preparation on the part of the kicker and long “visual tracking” of the departing ball with ample opportunities to show the stress of the moment, emotional state of the kicker, and even the reaction to the expected result of the action. The action itself (motion of the leg to kick the ball) is rather plain and takes just a fraction of a second in this case.</p>
<p>The goal of anticipation is to prepare the viewer for what is about to happen. This becomes especially important if the action itself is very fast, greatly <a id="page_409"></a>important, or extremely difficult. Creating a more extensive anticipation for such actions serves to underscore these properties and, in case of fast events, makes sure the action will not be missed (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-1">Figure 16.1</a> (bottom center)).</p>
<p>In real life, the main action often causes one or more other <span class="cItalic">overlapping actions</span>. Different appendages or loose parts of the object typically drag behind the main leading section and keep moving for a while in the follow-through part of the main action as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-1">Figure 16.1</a> (bottom right). Moreover, the next action often starts before the previous one is completely over. A player might start running while he is still tracking the ball he just kicked. Ignoring such natural flow is generally perceived as if there are pauses between actions and can result in robot-like mechanical motion. While overlapping is necessary to keep the motion natural, <span class="cItalic">secondary action</span> is often added by the animator to make motion more interesting and achieve realistic complexity of the animation. It is important not to allow secondary action to dominate the main action.</p>
<h3><a id="sec16-1-3"></a>16.1.3 Animation Techniques</h3>
<p>Several specific techniques can be used to make motion look more natural. The most important one is probably <span class="cItalic">squash and stretch</span> which suggests to change the shape of a moving object in a particular way as it moves. One would generally stretch an object in the direction of motion and squash it when a force is applied to it, as demonstrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-2">Figure 16.2</a> for a classic animation of a bouncing ball. It is important to preserve the total volume as this happens to avoid the illusion of growing or shrinking of the object. The greater the speed of motion (or the force), the more stretching (or squashing) is applied. Such deformations are used for several reasons. For very fast motion, an object can move between two sequential frames so quickly that there is no overlap between the object at the time of the current frame and at the time of the previous frame which can lead to strobing (a variant of aliasing). Having the object elongated in the direction of motion can ensure better overlap and helps the eye to fight this unpleasant effect. Stretching/squashing can also be used to show flexibility of the object with more deformation applied for more pliable materials. If the object is intended to appear as rigid, its shape is purposefully left the same when it moves.</p>
<div id="art_Dest_fig_16-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-2"></a><span class="cBold">Figure 16.2</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-2.png" alt="Figure showing classic example of applying the squash and stretch principle. Note that the volume of the bouncing ball should remain roughly the same throughout the animation." width="410" height="304" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-2.png"></p>
<p class="Text figcaption">Classic example of applying the squash and stretch principle. Note that the volume of the bouncing ball should remain roughly the same throughout the animation.</p>
</div>
<p>Natural motion rarely happens along straight lines, so this should generally be avoided in animation and <span class="cItalic">arcs</span> should be used instead. Similarly, no real-world motion can instantly change its speed—this would require an infinite amount of force to be applied to an object. It is desirable to avoid such situations in animation as well. In particular, the motion should start and end gradually (<span class="cItalic">slow in and out</span>). While hand-drawn animation is sometimes done via <span class="cItalic">straight-ahead action</span> <a id="page_410"></a>with an animator starting at the first frame and drawing one frame after another in sequence until the end, <span class="cItalic">pose-to-pose action</span>, also known as <span class="cItalic">keyframing</span>, is much more suitable for computer animation. In this technique, animation is carefully planned through a series of relatively sparsely spaced key frames with the rest of the animation (in-between frames) filled in only after the keys are set (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-3">Figure 16.3</a>). This allows more precise timing and allows the computer to take over the most tedious part of the process—the creation of the in-between frames— using algorithms presented in the next section.</p>
<div id="art_Dest_fig_16-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-3"></a><span class="cBold">Figure 16.3</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-3.png" alt="Figure showing keyframing (top) encourages detailed action planning while straight-ahead action (bottom) leads to a more spontaneous result." width="409" height="624" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-3.png"></p>
<p class="Text figcaption">Keyframing (top) encourages detailed action planning while straight-ahead action (bottom) leads to a more spontaneous result.</p>
</div>
<p>Almost any of the techniques outlined above can be used with some reasonable amount of <span class="cItalic">exaggeration</span> to achieve greater artistic effect or underscore some specific property of an action or a character. The ultimate goal is to achieve something the audience will want to see, something which is <span class="cItalic">appealing</span>. Extreme complexity or too much symmetry in a character or action tends to be less appealing. To create good results, a traditional animator needs <span class="cItalic">solid drawing skills</span>. Analogously, a computer animator should certainly understand computer graphics and have a solid knowledge of the tools he uses.</p>
<h3><a id="sec16-1-4"></a>16.1.4 Animator Control vs. Automatic Methods</h3>
<p>In traditional animation, the animator has complete control over all aspects of the production process and nothing prevents the final product to be as it was planned in every detail. The price paid for this flexibility is that every frame is created by hand, leading to an extremely time- and labor-consuming enterprise. In computer animation, there is a clear tradeoff between, on the one hand, giving an animator more direct control over the result, but asking him to contribute more work and, on the other hand, relying on more automatic techniques which might require setting just a few input parameters but offer little or no control over some of the properties of the result. A good algorithm should provide sufficient flexibility while asking an animator only the information which is intuitive, easy to provide, and which he himself feels is necessary for achieving the desired effect. While perfect compliance with this requirement is unlikely in practice since it would probably take something close to a mind-reading machine, we do encourage the reader to evaluate any computer-animation technique from the point of view of providing such <span class="cItalic">balance</span>.</p>
<h2><a id="sec16-2"></a>16.2 Keyframing</h2>
<p>The term keyframing can be misleading when applied to 3D computer animation since no actual completed frames (i.e., images) are typically involved. At any <a id="page_411"></a>given moment, a 3D scene being animated is specified by a set of numbers: the positions of centers of all objects, their RGB colors, the amount of scaling applied to each object in each axis, modeling transformations between different parts of a complex object, camera position and orientation, light sources intensity, etc. To animate a scene, some subset of these values have to change with time. One can, of course, directly set these values at every frame, but this will not be particularly efficient. Short of that, some number of important moments in time (key frames <span class="cItalic">t<span class="cSubscript">k</span></span>) can be chosen along the timeline of animation for each of the parameters and values of this parameter (key values <span class="cItalic">f<span class="cSubscript">k</span></span>) are set only for these selected frames. We will call a combination (<span class="cItalic">t<span class="cSubscript">k</span>, f<span class="cSubscript">k</span></span>) of key frame and key value simply a key. Key frames do not have to be the same for different parameters, but it is often logical to set keys at least for some of them simultaneously. For example, key frames chosen for <span class="cItalic">x</span>-, <span class="cItalic">y</span>- and <span class="cItalic">z</span>-coordinates of a specific object might be set at exactly the same frames forming a single position vector key (<span class="cItalic">t<span class="cSubscript">k</span></span>, <span class="cBold">p<span class="cSubscript">k</span></span>). These key frames, however, might be completely different from those chosen for the object’s orientation or color. The closer key frames are to each other, the more control the animator has over the result; however the cost of doing more work of setting the keys has to be assessed. It is, therefore, typical to have large spacing between keys in parts of the animation which are relatively simple, concentrating them in intervals where complex action occurs, as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-4">Figure 16.4</a>.</p>
<div id="art_Dest_fig_16-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-4"></a><span class="cBold">Figure 16.4</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-4.png" alt="Figure showing different patterns of setting keys (black circles above) can be used simultaneously for the same scene. It is assumed that there are more frames before, as well as after, this portion." width="600" height="298" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-4.png"></p>
<p class="Text figcaption">Different patterns of setting keys (black circles above) can be used simultaneously for the same scene. It is assumed that there are more frames before, as well as after, this portion.</p>
</div>
<p>Once the animator sets the key (<span class="cItalic">t<span class="cSubscript">k</span>, f<span class="cSubscript">k</span></span>), the system has to compute values of <span class="cItalic">f</span> for all other frames. Although we are ultimately interested only in a discrete set of values, it is convenient to treat this as a classical interpolation problem which fits a continuous <span class="cItalic">animation curve f</span>(<span class="cItalic">t</span>) through a provided set of data points (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-5">Figure 16.5</a>). Extensive discussion of curve-fitting algorithms can be found in <a id="page_412"></a><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C015.xhtml">Chapter 15</a>, and we will not repeat it here. Since the animator initially provides only the keys and not the derivative (tangent), methods which compute all necessary information directly from keys are preferable for animation. The speed of parameter change along the curve is given by the derivative of the curve with respect to time <span class="cItalic">df/dt.</span> Therefore, to avoid sudden jumps in velocity, <span class="cItalic">C<span class="cSuperscript">1</span></span> continuity is typically necessary. A higher degree of continuity is typically not required from animation curves, since the second derivative, which corresponds to acceleration or applied force, can experience very sudden changes in real-world situations (ball hitting a solid wall), and higher derivatives do not directly correspond to any parameters of physical motion. These consideration make Catmull-Rom splines one of the best choices for initial animation curve creation.</p>
<div id="art_Dest_fig_16-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-5"></a><span class="cBold">Figure 16.5</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-5.png" alt="Figure showing a continuous curve f(t) is fit through the keys provided by the animator even though only values at frame positions are of interest. The derivative of this function gives the speed of parameter change and is at first determined automatically by the fitting procedure." width="410" height="468" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-5.png"></p>
<p class="Text figcaption">A continuous curve <span class="cItalic">f(t)</span> is fit through the keys provided by the animator even though only values at frame positions are of interest. The derivative of this function gives the speed of parameter change and is at first determined automatically by the fitting procedure.</p>
</div>
<p>Most animation systems give the animator the ability to perform interactive fine editing of this initial curve, including inserting more keys, adjusting existing keys, or modifying automatically computed tangents. Another useful technique which can help to tweak the shape of the curve is called TCB control (TCB stands for tension, continuity, and bias). The idea is to introduce three new parameters which can be used to modify the shape of the curve near a key through coordinated adjustment of incoming and outgoing tangents at this point. For keys uniformly spaced in time with distance Δ<span class="cItalic">t</span> between them, the standard Catmull-Rom expression for incoming <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-621-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_68&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;in&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_68" style="width: 1.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1001.55em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33499"><span class="mrow" id="MathJax-Span-33500"><span class="msubsup" id="MathJax-Span-33501"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33502" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mi" id="MathJax-Span-33503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i<span style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.274em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_68"><mrow><msubsup><mi>T</mi><mi>i</mi><mi mathvariant="italic">in</mi></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-621"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_68"><mrow><msubsup><mi>T</mi><mi>i</mi><mi mathvariant="italic">in</mi></msubsup></mrow></math></script> and outgoing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-622-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_69&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;out&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_69" style="width: 1.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1001.86em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33506"><span class="mrow" id="MathJax-Span-33507"><span class="msubsup" id="MathJax-Span-33508"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33509" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mi" id="MathJax-Span-33510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o<span style="font-family: MathJax_Math-italic;">u</span><span style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.274em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_69"><mrow><msubsup><mi>T</mi><mi>i</mi><mi mathvariant="italic">out</mi></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-622"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_69"><mrow><msubsup><mi>T</mi><mi>i</mi><mi mathvariant="italic">out</mi></msubsup></mrow></math></script> tangents at an internal key (<span class="cItalic">t<span class="cSubscript">k</span>, f<span class="cSubscript">k</span></span>) can be rewritten as</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-623-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_706&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_706" overflow="scroll" style="width: 21.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.928em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1020.83em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33513"><span class="msubsup" id="MathJax-Span-33514"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33515" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mrow" id="MathJax-Span-33516"><span class="mi" id="MathJax-Span-33517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-33518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33520" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msubsup" id="MathJax-Span-33521" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33522" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mrow" id="MathJax-Span-33523"><span class="mi" id="MathJax-Span-33524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-33525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-33526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33527" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33528" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-33529" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33530" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33531"><span class="mn" id="MathJax-Span-33532" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33533" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.3em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.339em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33535"><span class="mo" id="MathJax-Span-33536" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33537"><span class="msub" id="MathJax-Span-33538"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33539" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mrow" id="MathJax-Span-33540"><span class="mi" id="MathJax-Span-33541" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-33542" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-33543" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33544" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33545" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33546" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33548" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33549" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-33550" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33551" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33552"><span class="mn" id="MathJax-Span-33553" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33554" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33555" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.3em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.339em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33556"><span class="mo" id="MathJax-Span-33557" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33558"><span class="msub" id="MathJax-Span-33559"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33560" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33562" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33563" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33564" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33566" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-33567" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span></span><span class="mo" id="MathJax-Span-33568" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33569" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_706"><msubsup><mi>T</mi><mi>k</mi><mrow><mi>i</mi><mi>n</mi></mrow></msubsup><mo>=</mo><msubsup><mi>T</mi><mi>k</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-623"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_706"><msubsup><mi>T</mi><mi>k</mi><mrow><mi>i</mi><mi>n</mi></mrow></msubsup><mo>=</mo><msubsup><mi>T</mi><mi>k</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></math></script></p>
<p>Modified tangents of a TCB spline are</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-624-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_707&quot;&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_707" overflow="scroll" style="width: 27.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.532em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.049em, 1026.28em, 3.756em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33571"><span class="mtable" id="MathJax-Span-33572" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 26.224em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1026.18em, 6.121em, -1000.01em); top: -4.47em; left: 0em;"><span style="display: inline-block; position: relative; width: 26.224em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1025.82em, 4.578em, -1000.01em); top: -4.882em; left: 50%; margin-left: -12.954em;"><span class="mtd" id="MathJax-Span-33573"><span class="mrow" id="MathJax-Span-33574"><span class="mrow" id="MathJax-Span-33575"><span class="msubsup" id="MathJax-Span-33576"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33577" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mrow" id="MathJax-Span-33578"><span class="mi" id="MathJax-Span-33579" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-33580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33582" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-33583" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 5.35em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005.15em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.62em;"><span class="mrow" id="MathJax-Span-33584"><span class="mrow" id="MathJax-Span-33585"><span class="mo" id="MathJax-Span-33586" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33587"><span class="mn" id="MathJax-Span-33588" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33589" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-33591" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33592"><span class="mo" id="MathJax-Span-33593" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33594"><span class="mn" id="MathJax-Span-33595" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33596" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33597" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-33598" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33599"><span class="mo" id="MathJax-Span-33600" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33601"><span class="mn" id="MathJax-Span-33602" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33603" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-33604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-33605" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33606"><span class="mn" id="MathJax-Span-33607" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33608" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.36em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33610"><span class="mo" id="MathJax-Span-33611" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33612"><span class="msub" id="MathJax-Span-33613"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33614" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mrow" id="MathJax-Span-33615"><span class="mi" id="MathJax-Span-33616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-33617" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-33618" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33619" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33620" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33621" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33623" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33624" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-33625" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.35em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005.15em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.62em;"><span class="mrow" id="MathJax-Span-33626"><span class="mrow" id="MathJax-Span-33627"><span class="mo" id="MathJax-Span-33628" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33629"><span class="mn" id="MathJax-Span-33630" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33631" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-33633" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33634"><span class="mo" id="MathJax-Span-33635" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33636"><span class="mn" id="MathJax-Span-33637" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33638" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-33639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-33640" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33641"><span class="mo" id="MathJax-Span-33642" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33643"><span class="mn" id="MathJax-Span-33644" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33645" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-33647" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33648"><span class="mn" id="MathJax-Span-33649" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33650" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.36em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33652"><span class="mo" id="MathJax-Span-33653" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33654"><span class="msub" id="MathJax-Span-33655"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33656" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33657" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33658" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33659" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33660" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33661" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33662" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-33663" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span></span><span class="mo" id="MathJax-Span-33664" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33665" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1026.18em, 4.578em, -1000.01em); top: -2.928em; left: 50%; margin-left: -13.108em;"><span class="mtd" id="MathJax-Span-33666"><span class="mrow" id="MathJax-Span-33667"><span class="mrow" id="MathJax-Span-33668"><span class="msubsup" id="MathJax-Span-33669"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33670" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.167em, -1000.01em); top: -4.368em; left: 0.774em;"><span class="mrow" id="MathJax-Span-33671"><span class="mi" id="MathJax-Span-33672" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-33673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-33674" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -3.699em; left: 0.568em;"><span class="mi" id="MathJax-Span-33675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33676" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-33677" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 5.35em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005.15em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.62em;"><span class="mrow" id="MathJax-Span-33678"><span class="mrow" id="MathJax-Span-33679"><span class="mo" id="MathJax-Span-33680" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33681"><span class="mn" id="MathJax-Span-33682" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33683" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-33685" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33686"><span class="mo" id="MathJax-Span-33687" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33688"><span class="mn" id="MathJax-Span-33689" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33690" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-33691" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-33692" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33693"><span class="mo" id="MathJax-Span-33694" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33695"><span class="mn" id="MathJax-Span-33696" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33697" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-33698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-33699" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33700"><span class="mn" id="MathJax-Span-33701" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33702" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.36em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33704"><span class="mo" id="MathJax-Span-33705" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33706"><span class="msub" id="MathJax-Span-33707"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33708" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mrow" id="MathJax-Span-33709"><span class="mi" id="MathJax-Span-33710" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-33711" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-33712" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33713" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33714" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33715" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33717" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33718" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-33719" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.35em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005.15em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.62em;"><span class="mrow" id="MathJax-Span-33720"><span class="mrow" id="MathJax-Span-33721"><span class="mo" id="MathJax-Span-33722" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33723"><span class="mn" id="MathJax-Span-33724" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33725" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-33727" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33728"><span class="mo" id="MathJax-Span-33729" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33730"><span class="mn" id="MathJax-Span-33731" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33732" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33733" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-33734" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-33735"><span class="mo" id="MathJax-Span-33736" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33737"><span class="mn" id="MathJax-Span-33738" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-33739" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-33740" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-33741" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-33742"><span class="mn" id="MathJax-Span-33743" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33744" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-33745" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.36em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33746"><span class="mo" id="MathJax-Span-33747" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33748"><span class="msub" id="MathJax-Span-33749"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33750" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33752" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33753" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33754" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-33755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33756" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-33757" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span></span><span class="mo" id="MathJax-Span-33758" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33759" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.476em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.586em; border-left: 0px solid; width: 0px; height: 3.71em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_707"><mtable><mtr><mtd><mrow><msubsup><mi>T</mi><mi>k</mi><mrow><mi>i</mi><mi>n</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>T</mi><mi>k</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-624"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_707"><mtable><mtr><mtd><mrow><msubsup><mi>T</mi><mi>k</mi><mrow><mi>i</mi><mi>n</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mi>T</mi><mi>k</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>c</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>b</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mo>Δ</mo><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>The tension parameter <span class="cItalic">t</span> controls the sharpness of the curve near the key by scaling both incoming and outgoing tangents. Larger tangents (lower tension) lead to a flatter curve shape near the key. Bias <span class="cItalic">b</span> allows the animator to selectively increase the weight of a key’s neighbors locally pulling the curve closer to a straight line connecting the key with its left (<span class="cItalic">b</span> near 1, “overshooting” the action) or right (<span class="cItalic">b</span> near −1, “undershooting” the action) neighbors. A nonzero value of continuity <span class="cItalic">c</span> makes incoming and outgoing tangents different allowing the animator to create kinks in the curve at the key value. Practically useful values of TCB parameters are typically confined to the interval [−1; 1] with defaults <span class="cItalic">t</span> = <span class="cItalic">c</span> = <span class="cItalic">b</span> = 0 corresponding to the original Catmull-Rom spline. Examples of possible curve shape adjustments are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-6">Figure 16.6</a>.</p>
<div id="art_Dest_fig_16-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-6"></a><span class="cBold">Figure 16.6</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-6.png" alt="Figure showing editing the default interpolating spline (middle column) using TCB controls. Note that all keys remain at the same positions." width="600" height="516" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-6.png"></p>
<p class="Text figcaption">Editing the default interpolating spline (middle column) using TCB controls. Note that all keys remain at the same positions.</p>
</div>
<h3><a id="page_413"></a><a id="sec16-2-1"></a>16.2.1. Motion Controls</h3>
<p>So far, we have described how to control the shape of the animation curve through key positioning and fine tweaking of tangent values at the keys. This, however, is generally not sufficient when one would like to have control both over where the object is moving, i.e., its path, and how fast it moves along this path. Given a set of positions in space as keys, automatic curve-fitting techniques can fit a curve through them, but resulting motion is only constrained by forcing the object to arrive at a specified key position p<span class="cSubscript">k</span> at the corresponding key frame <span class="cItalic">t<span class="cSubscript">k</span></span>, and nothing is directly said about the speed of motion between the keys. This can create problems. For example, if an object moves along the <span class="cItalic">x</span>-axis with velocity 11 meters per second for 1 second and then with 1 meter per second for 9 seconds, it will arrive at position <span class="cItalic">x</span> = 20 after 10 seconds thus satisfying animator’s keys (0,0) and (10, 20). It is rather unlikely that this jerky motion was actually desired, and uniform motion with speed 2 meters/second is probably closer to what the animator wanted when setting these keys. Although typically not displaying <a id="page_414"></a>such extreme behavior, polynomial curves resulting from standard fitting procedures do exhibit nonuniform speed of motion between keys as demonstrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-7">Figure 16.7</a>. While this can be tolerable (within limits) for some parameters for which the human visual system is not very good at determining nonuniformities in the rate of change (such as color or even rate of rotation), we have to do better for position <span class="cBold">p</span> of the object where velocity directly corresponds to everyday experience.</p>
<div id="art_Dest_fig_16-7" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-7"></a><span class="cBold">Figure 16.7</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-7.png" alt="Figure showing all three motions are along the same 2D path and satisfy the set of keys at the tips of the black triangles. The tips of the white triangles show object position at Δt = 1 intervals. Uniform speed of motion between the keys (top) might be closer to what the animator wanted, but automatic fitting procedures could result in either of the other two motions." width="409" height="504" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-7.png"></p>
<p class="Text figcaption">All three motions are along the same 2D path and satisfy the set of keys at the tips of the black triangles. The tips of the white triangles show object position at Δ<span class="cItalic">t</span> = 1 intervals. Uniform speed of motion between the keys (top) might be closer to what the animator wanted, but automatic fitting procedures could result in either of the other two motions.</p>
</div>
<p>We will first distinguish curve parameterization used during the fitting procedure from that used for animation. When a curve is fit through position keys, we will write the result as a function <span class="cBold">p</span>(<span class="cItalic">u</span>) of some parameter <span class="cItalic">u</span>. This will describe the geometry of the curve in space. The arc length <span class="cItalic">s</span> is the physical length of the curve. A natural way for the animator to control the motion along the now-existing curve is to specify an extra function <span class="cItalic">s</span>(<span class="cItalic">t</span>) which corresponds to how far along the curve the object should be at any given time. To get an actual position in space, we need one more auxiliary function <span class="cItalic">u</span>(<span class="cItalic">s</span>) which computes a parameter value <span class="cItalic">u</span> for given arc length <span class="cItalic">s</span>. The complete process of computing an object position for a given time <span class="cItalic">t</span> is then given by composing these functions (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-8">Figure 16.8</a>):</p>
<div id="art_Dest_fig_16-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-8"></a><span class="cBold">Figure 16.8</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-8.png" alt="Figure showing to get position in space at a given time t, one first utilizes user-specified motion control to obtain the distance along the curve s(t) and then computes the corresponding curve parameter value u(s(t)). Previously fitted curve P(u) can now be used to find the position P(u(s(t)))." width="600" height="180" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-8.png"></p>
<p class="Text figcaption">To get position in space at a given time <span class="cItalic">t</span>, one first utilizes user-specified motion control to obtain the distance along the curve <span class="cItalic">s</span>(<span class="cItalic">t</span>) and then computes the corresponding curve parameter value <span class="cItalic">u</span>(<span class="cItalic">s</span>(<span class="cItalic">t</span>)). Previously fitted curve <span class="cBold">P</span>(<span class="cItalic">u</span>) can now be used to find the position <span class="cBold">P</span>(<span class="cItalic">u</span>(<span class="cItalic">s</span>(<span class="cItalic">t</span>))).</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-625-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_708&quot;&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_708" overflow="scroll" style="width: 8.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.486em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1008.39em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-33761"><span class="mstyle" id="MathJax-Span-33762"><span class="mrow" id="MathJax-Span-33763"><span class="mi" id="MathJax-Span-33764" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mrow" id="MathJax-Span-33765" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33766" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-33767" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-33768" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33769" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-33770" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-33771"><span class="mi" id="MathJax-Span-33772" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mrow" id="MathJax-Span-33773" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33774" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33775"><span class="mi" id="MathJax-Span-33776" style="font-family: MathJax_Math-italic;">u</span><span class="mrow" id="MathJax-Span-33777" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33778" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33779"><span class="mi" id="MathJax-Span-33780" style="font-family: MathJax_Math-italic;">s</span><span class="mrow" id="MathJax-Span-33781" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33782" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-33783" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-33784" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-33785" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-33786" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33787" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_708"><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mi>s</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-625"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_708"><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mi>s</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>.</mo></math></script></p>
<p>Several standard functions can be used as the distance-time function <span class="cItalic">s</span>(<span class="cItalic">t</span>). One of the simplest is the linear function corresponding to constant velocity: <span class="cItalic">s</span>(<span class="cItalic">t</span>) = <span class="cItalic">vt</span> with <span class="cItalic">v</span> = const. Another common example is the motion with constant acceleration <span class="cItalic">a</span> (and initial speed <span class="cItalic">v</span><span class="cSubscript">0</span>) which is described by the parabolic <span class="cItalic">s</span>(<span class="cItalic">t</span>) = <span class="cItalic">v</span><span class="cSubscript">0</span><span class="cItalic">t</span> + <span class="cItalic">at</span><span class="cSuperscript">2</span><span class="cItalic">/</span>2. Since velocity is changing gradually here, this function can help to model desirable ease-in and ease-out behavior. More generally, the slope of <span class="cItalic">s</span>(<span class="cItalic">t</span>) gives the velocity of motion with negative slope corresponding to the motion backwards along the curve. To achieve most flexibility, the ability to <a id="page_415"></a>interactively edit <span class="cItalic">s(t)</span> is typically provided to the animator by the animation system. The distance-time function is not the only way to control motion. In some cases it might be more convenient for the user to specify a velocity-time function <span class="cItalic">v(t)</span> or even an acceleration-time function <span class="cItalic">a(t).</span> Since these are correspondingly first and second derivatives of <span class="cItalic">s(t),</span> to use these type of controls, the system first recovers the distance-time function by integrating the user input (twice in the case of <span class="cItalic">a(t)).</span></p>
<p>The relationship between the curve parameter <span class="cItalic">u</span> and arc length <span class="cItalic">s</span> is established automatically by the system. In practice, the system first determines arc length dependance on parameter <span class="cItalic">u</span> (i.e., the inverse function <span class="cItalic">s(u)).</span> Using this function, for any given <span class="cItalic">S</span> it is possible to solve the equation <span class="cItalic">s(u) − S =</span> 0 with unknown <span class="cItalic">u</span> obtaining <span class="cItalic">u(S).</span> For most curves, the function <span class="cItalic">s(u)</span> cannot be expressed in closed analytic form and numerical integration is necessary (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml">Chapter 14</a>). Standard numerical root-finding procedures (such as the Newton-Raphson method, for example) can then be directly used to solve the equation <span class="cItalic">s(u) − S =</span> 0 for <span class="cItalic">u.</span></p>
<p>An alternative technique is to approximate the curve itself as a set of linear segments between points <span class="cBold">p</span><span class="cItalic">i</span> computed at some set of sufficiently densely spaced parameter values <span class="cItalic">ui</span>. One then creates a table of approximate arc lengths</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-626-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_709&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mstyle&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mstyle&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_709" overflow="scroll" style="width: 22.162em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.494em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1021.4em, 4.476em, -1000.01em); top: -2.979em; left: 0em;"><span class="mrow" id="MathJax-Span-33789"><span class="mi" id="MathJax-Span-33790" style="font-family: MathJax_Math-italic;">s</span><span class="mrow" id="MathJax-Span-33791" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33792" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33793"><span class="msub" id="MathJax-Span-33794"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33795" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-33796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33797" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33798" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mstyle" id="MathJax-Span-33799" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-33800"><span class="munderover" id="MathJax-Span-33801"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-33802" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.424em, -1000.01em); top: -2.928em; left: 0.105em;"><span class="mrow" id="MathJax-Span-33803"><span class="mi" id="MathJax-Span-33804" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-33805" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-33806" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.22em, 4.167em, -1000.01em); top: -5.139em; left: 0.62em;"><span class="mi" id="MathJax-Span-33807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33808"><span class="mo" id="MathJax-Span-33809" style="vertical-align: 0.877em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.237em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.031em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-33810"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33811"><span class="mrow" id="MathJax-Span-33812"><span class="mi" id="MathJax-Span-33813" style="font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.62em;"><span class="mstyle" id="MathJax-Span-33814"><span class="mrow" id="MathJax-Span-33815"><span class="mi" id="MathJax-Span-33816" style="font-size: 70.7%; font-family: MathJax_Main-bold;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33817" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33818" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33819"><span class="mrow" id="MathJax-Span-33820"><span class="mi" id="MathJax-Span-33821" style="font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 0.62em;"><span class="mrow" id="MathJax-Span-33822"><span class="mstyle" id="MathJax-Span-33823"><span class="mrow" id="MathJax-Span-33824"><span class="mi" id="MathJax-Span-33825" style="font-size: 70.7%; font-family: MathJax_Main-bold;">j</span></span></span><span class="mo" id="MathJax-Span-33826" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33827" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33828" style="font-family: MathJax_Main; padding-left: 0.26em;">∥</span><span class="mo" id="MathJax-Span-33829" style="font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-33830" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">s</span><span class="mrow" id="MathJax-Span-33831" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-33832" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-33833"><span class="msub" id="MathJax-Span-33834"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33835" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mrow" id="MathJax-Span-33836"><span class="mi" id="MathJax-Span-33837" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-33838" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33839" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33840" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-33841" style="font-family: MathJax_Main; padding-left: 0.157em;">+</span><span class="mo" id="MathJax-Span-33842" style="font-family: MathJax_Main; padding-left: 0.26em;">∥</span><span class="msub" id="MathJax-Span-33843" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33844"><span class="mrow" id="MathJax-Span-33845"><span class="mi" id="MathJax-Span-33846" style="font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.62em;"><span class="mstyle" id="MathJax-Span-33847"><span class="mrow" id="MathJax-Span-33848"><span class="mi" id="MathJax-Span-33849" style="font-size: 70.7%; font-family: MathJax_Main-bold;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33850" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-33851" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33852"><span class="mrow" id="MathJax-Span-33853"><span class="mi" id="MathJax-Span-33854" style="font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 0.62em;"><span class="mrow" id="MathJax-Span-33855"><span class="mstyle" id="MathJax-Span-33856"><span class="mrow" id="MathJax-Span-33857"><span class="mi" id="MathJax-Span-33858" style="font-size: 70.7%; font-family: MathJax_Main-bold;">i</span></span></span><span class="mo" id="MathJax-Span-33859" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33860" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33861" style="font-family: MathJax_Main; padding-left: 0.26em;">∥</span><span class="mo" id="MathJax-Span-33862" style="font-family: MathJax_Main;">.</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.985em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_709"><mi>s</mi><mrow><mo>(</mo><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></munderover><mrow><mo>∥</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mstyle mathvariant="bold" mathsize="normal"><mi>j</mi></mstyle></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>j</mi></mstyle><mo>−</mo><mn>1</mn></mrow></msub><mo>∥</mo><mo>=</mo><mi>s</mi><mrow><mo>(</mo><mrow><msub><mi>u</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>+</mo><mo>∥</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mstyle mathvariant="bold" mathsize="normal"><mi>i</mi></mstyle></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>i</mi></mstyle><mo>−</mo><mn>1</mn></mrow></msub><mo>∥</mo><mo>.</mo></mrow></mstyle></math></span></span><script type="math/mml" id="MathJax-Element-626"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_709"><mi>s</mi><mrow><mo>(</mo><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></munderover><mrow><mo>∥</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mstyle mathvariant="bold" mathsize="normal"><mi>j</mi></mstyle></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>j</mi></mstyle><mo>−</mo><mn>1</mn></mrow></msub><mo>∥</mo><mo>=</mo><mi>s</mi><mrow><mo>(</mo><mrow><msub><mi>u</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>+</mo><mo>∥</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mstyle mathvariant="bold" mathsize="normal"><mi>i</mi></mstyle></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>i</mi></mstyle><mo>−</mo><mn>1</mn></mrow></msub><mo>∥</mo><mo>.</mo></mrow></mstyle></math></script></p>
<p>Since <span class="cItalic">s(u)</span> is a non-decreasing function of <span class="cItalic">u,</span> one can then find the interval containing the value <span class="cItalic">S</span> by simple searching through the table (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-9">Figure 16.9</a>). Linear interpolation of the interval’s <span class="cItalic">u</span> end values is then performed to finally find u(S). If greater precision is necessary, a few steps of the Newton-Raphson algorithm with this value as the starting point can be applied.</p>
<div id="art_Dest_fig_16-9" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-9"></a><span class="cBold">Figure 16.9</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-9.png" alt="Figure showing to create a tabular version of s(u), the curve can be approximated by a number of line segments connecting points on the curve positioned at equal parameter increments. The table is searched to find the u-interval for a given S. For the curve above, for example, the value of u corresponding to the position of S = 6.5 lies between u = 0.6 and u = 0.8." width="410" height="428" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-9.png"></p>
<p class="Text figcaption">To create a tabular version of <span class="cItalic">s</span>(<span class="cItalic">u</span>), the curve can be approximated by a number of line segments connecting points on the curve positioned at equal parameter increments. The table is searched to find the <span class="cItalic">u</span>-interval for a given <span class="cItalic">S</span>. For the curve above, for example, the value of <span class="cItalic">u</span> corresponding to the position of <span class="cItalic">S</span> = 6.5 lies between <span class="cItalic">u</span> = 0.6 and <span class="cItalic">u</span> = 0.8.</p>
</div>
<h3><a id="sec16-2-2"></a>16.2.2 Interpolating Rotation</h3>
<p>The techniques presented above can be used to interpolate the keys set for most of the parameters describing the scene. Three-dimensional rotation is one important motion for which more specialized interpolation methods and representations are common. The reason for this is that applying standard techniques to 3D rotations often leads to serious practical problems. Rotation (a change in orientation of an object) is the only motion other than translation which leaves the shape of the object intact. It therefore plays a special role in animating rigid objects.</p>
<p>There are several ways to specify the orientation of an object. First, transformation matrices as described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C006.xhtml">Chapter 6</a> can be used. Unfortunately, naive <a id="page_416"></a>(element-by-element) interpolation of rotation matrices does not produce a correct result. For example, the matrix “halfway” between 2D clock- and counterclockwise 90 degree rotation is the null matrix:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-627-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_710&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_710" overflow="scroll" style="width: 15.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.273em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.751em, 1015.18em, 4.476em, -1000.01em); top: -3.339em; left: 0em;"><span class="mrow" id="MathJax-Span-33864"><span class="mfrac" id="MathJax-Span-33865"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33866" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33867" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33868"><span class="mo" id="MathJax-Span-33869" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-33870"><span class="mtable" id="MathJax-Span-33871" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.573em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1001.19em, 4.99em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33872"><span class="mrow" id="MathJax-Span-33873"><span class="mn" id="MathJax-Span-33874" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1001.19em, 4.27em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.614em;"><span class="mtd" id="MathJax-Span-33878"><span class="mrow" id="MathJax-Span-33879"><span class="mrow" id="MathJax-Span-33880"><span class="mo" id="MathJax-Span-33881" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33882" style="font-family: MathJax_Main;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1000.47em, 4.938em, -1000.01em); top: -4.008em; left: 2.059em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33875"><span class="mrow" id="MathJax-Span-33876"><span class="mn" id="MathJax-Span-33877" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33883"><span class="mrow" id="MathJax-Span-33884"><span class="mn" id="MathJax-Span-33885" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33886" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-33887" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-33888" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33889" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-33890" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-33891"><span class="mo" id="MathJax-Span-33892" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-33893"><span class="mtable" id="MathJax-Span-33894" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.573em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.47em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33895"><span class="mrow" id="MathJax-Span-33896"><span class="mn" id="MathJax-Span-33897" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33903"><span class="mrow" id="MathJax-Span-33904"><span class="mn" id="MathJax-Span-33905" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1001.19em, 4.938em, -1000.01em); top: -4.008em; left: 1.288em;"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.19em, 4.27em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.614em;"><span class="mtd" id="MathJax-Span-33898"><span class="mrow" id="MathJax-Span-33899"><span class="mrow" id="MathJax-Span-33900"><span class="mo" id="MathJax-Span-33901" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33902" style="font-family: MathJax_Main;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33906"><span class="mrow" id="MathJax-Span-33907"><span class="mn" id="MathJax-Span-33908" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33909" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-33910" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-33911" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-33912" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-33913"><span class="mtable" id="MathJax-Span-33914" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.47em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33915"><span class="mrow" id="MathJax-Span-33916"><span class="mn" id="MathJax-Span-33917" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33921"><span class="mrow" id="MathJax-Span-33922"><span class="mn" id="MathJax-Span-33923" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1000.47em, 4.938em, -1000.01em); top: -4.008em; left: 1.288em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33918"><span class="mrow" id="MathJax-Span-33919"><span class="mn" id="MathJax-Span-33920" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-33924"><span class="mrow" id="MathJax-Span-33925"><span class="mn" id="MathJax-Span-33926" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33927" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-33928" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.345em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.598em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_710"><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mn>1</mn></mrow></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mrow><mo>−</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-627"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_710"><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mn>1</mn></mrow></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mrow><mo>−</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>The correct result is, of course, the unit matrix corresponding to no rotation. Second, one can specify arbitrary orientation as a sequence of exactly three rotations around coordinate axes chosen in some specific order. These axes can be fixed in space <span class="cItalic">(fixed-angle</span> representation) or embedded into the object therefore changing after each rotation <span class="cItalic">(Euler-angle</span> representation as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-10">Figure 16.10</a>). These three angles of rotation can be animated directly through standard keyframing, but a subtle problem known as gimbal lock arises. Gimbal lock occurs if during rotation one of the three rotation axes is by accident aligned with another, thereby reducing by one the number of available degrees of freedom as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-11">Figure 16.11</a> for a physical device. This effect is more common than one might think—a single 90 degree turn to the right (or left) can potentially put an object into a gimbal lock. Finally, any orientation can be specified by choosing an appropriate axis in space and angle of rotation around this axis. While animating in this representation is relatively straightforward, combining two rotations, i.e., finding the axis and angle corresponding to a sequence of two rotations both represented by axis and angle, is nontrivial. A special mathematical apparatus, <span class="cItalic">quaternions</span> has been developed to make this representation suitable both for combining several rotations into a single one and for animation.</p>
<div id="art_Dest_fig_16-10" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-10"></a><span class="cBold">Figure 16.10</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-10.png" alt="Figure showing three Euler angles can be used to specify arbitrary object orientation through a sequence of three rotations around coordinate axes embedded into the object (axis Y always points to the tip of the cone). Note that each rotation is given in a new coordinate system. Fixed angle representation is very similar, but the coordinate axes it uses are fixed in space and do not rotate with the object." width="600" height="225" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-10.png"></p>
<p class="Text figcaption">Three Euler angles can be used to specify arbitrary object orientation through a sequence of three rotations around coordinate axes embedded into the object (axis Y always points to the tip of the cone). Note that each rotation is given in a new coordinate system. Fixed angle representation is very similar, but the coordinate axes it uses are fixed in space and do not rotate with the object.</p>
</div>
<div id="art_Dest_fig_16-11" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-11"></a><span class="cBold">Figure 16.11</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-11.png" alt="Figure showing in this example, gimbal lock occurs when a 90 degree turn around axis Z is made. Both X and Y rotations are now performed around the same axis leading to the loss of one degree of freedom." width="409" height="768" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-11.png"></p>
<p class="Text figcaption">In this example, gimbal lock occurs when a 90 degree turn around axis Z is made. Both X and Y rotations are now performed around the same axis leading to the loss of one degree of freedom.</p>
</div>
<p>Given a 3D vector <span class="cBold">v</span> = <span class="cItalic">(x, y, z)</span> and a scalar <span class="cItalic">s</span>, a quaternion <span class="cItalic">q</span> is formed by combining the two into a four-component object: <span class="cItalic">q</span> = [<span class="cItalic">s x y z</span>] = [<span class="cItalic">s</span>; v]. Several <a id="page_417"></a>new operations are then defined for quaternions. Quaternion addition simply sums scalar and vector parts separately:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-628-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_711&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_711" overflow="scroll" style="width: 12.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.828em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1011.73em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33930"><span class="msub" id="MathJax-Span-33931"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33932" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33933" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33934" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-33935" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33936" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33937" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33938" style="font-family: MathJax_Main; padding-left: 0.26em;">≡</span><span class="mrow" id="MathJax-Span-33939" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-33940" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-33941"><span class="msub" id="MathJax-Span-33942"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33943" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33944" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33945" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-33946" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33947" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33948" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33949" style="font-family: MathJax_Main;">;</span><span class="msub" id="MathJax-Span-33950" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33951"><span class="mrow" id="MathJax-Span-33952"><span class="mi" id="MathJax-Span-33953" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-33954" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33955" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-33956" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-33957"><span class="mrow" id="MathJax-Span-33958"><span class="mi" id="MathJax-Span-33959" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-33960" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-33961" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-33962" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_711"><msub><mi>q</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mo>≡</mo><mrow><mo>[</mo><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>;</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mn>1</mn></msub><mo>+</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mn>2</mn></msub></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-628"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_711"><msub><mi>q</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mo>≡</mo><mrow><mo>[</mo> <mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>;</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mn>1</mn></msub><mo>+</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mn>2</mn></msub></mrow> <mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>Multiplication by a scalar <span class="cItalic">a</span> gives a new quaternion</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-629-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_712&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_712" overflow="scroll" style="width: 6.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.812em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1005.72em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-33964"><span class="mi" id="MathJax-Span-33965" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-33966" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-33967" style="font-family: MathJax_Main; padding-left: 0.26em;">≡</span><span class="mrow" id="MathJax-Span-33968" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-33969" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-33970"><span class="mi" id="MathJax-Span-33971" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-33972" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-33973" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-33974" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">a</span><span class="mstyle" id="MathJax-Span-33975"><span class="mrow" id="MathJax-Span-33976"><span class="mi" id="MathJax-Span-33977" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span class="mo" id="MathJax-Span-33978" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-33979" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_712"><mi>a</mi><mi>q</mi><mo>≡</mo><mrow><mo>[</mo><mrow><mi>a</mi><mi>s</mi><mo>;</mo><mi>a</mi><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-629"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_712"><mi>a</mi><mi>q</mi><mo>≡</mo><mrow><mo>[</mo> <mrow><mi>a</mi><mi>s</mi><mo>;</mo><mi>a</mi><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow> <mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>More complex quaternion multiplication is defined as</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-630-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_713&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;1&lt;/mtext&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;2&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;2&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;1&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;1&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;2&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_713" overflow="scroll" style="width: 20.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.591em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1019.55em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-33981"><span class="msub" id="MathJax-Span-33982"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33983" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33984" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33985" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="msub" id="MathJax-Span-33986" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33987" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33988" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33989" style="font-family: MathJax_Main; padding-left: 0.26em;">≡</span><span class="mrow" id="MathJax-Span-33990" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-33991" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-33992"><span class="msub" id="MathJax-Span-33993"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33994" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33995" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-33996"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33997" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-33998" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-33999" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-34000" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34001"><span class="mrow" id="MathJax-Span-34002"><span class="mi" id="MathJax-Span-34003" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34004" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-34005"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34006"><span class="mrow" id="MathJax-Span-34007"><span class="mi" id="MathJax-Span-34008" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34009" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34010" style="font-family: MathJax_Main;">;</span><span class="msub" id="MathJax-Span-34011" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34012" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-34013" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-34014"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34015"><span class="mrow" id="MathJax-Span-34016"><span class="mi" id="MathJax-Span-34017" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34018" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34019" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-34020" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34021" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-34022" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-34023"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34024"><span class="mrow" id="MathJax-Span-34025"><span class="mi" id="MathJax-Span-34026" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34027" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34028" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-34029" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34030"><span class="mrow" id="MathJax-Span-34031"><span class="mi" id="MathJax-Span-34032" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34033" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34034" style="font-family: MathJax_Main; padding-left: 0.208em;">×</span><span class="msub" id="MathJax-Span-34035" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34036"><span class="mrow" id="MathJax-Span-34037"><span class="mi" id="MathJax-Span-34038" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34039" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34040" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-34041" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_713"><msub><mi>q</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>q</mi><mn>2</mn></msub><mo>≡</mo><mrow><mo>[</mo><mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub><mo>;</mo><msub><mi>s</mi><mn>1</mn></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><mo>+</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><mo>×</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub></mrow><mo>]</mo></mrow><mo>,</mo></math></span></span><script type="math/mml" id="MathJax-Element-630"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_713"><msub><mi>q</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>q</mi><mn>2</mn></msub><mo>≡</mo><mrow><mo>[</mo> <mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub><mo>;</mo><msub><mi>s</mi><mn>1</mn></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><mo>+</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>1</mtext></msub><mo>×</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msub></mrow> <mo>]</mo></mrow><mo>,</mo></math></script></p>
<p>where × denotes a vector cross product. It is easy to see that, similar to matrices, quaternion multiplication is associative, but not commutative. We will be interested mostly in normalized quaternions—those for which the quaternion norm <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-631-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_70&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;2&lt;/mtext&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_70" style="width: 6.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.327em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1006.34em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34043"><span class="mrow" id="MathJax-Span-34044"><span class="mrow" id="MathJax-Span-34045"><span class="mo" id="MathJax-Span-34046" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-34047" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-34048" style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-34049" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msqrt" id="MathJax-Span-34050" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.013em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.15em, 4.27em, -1000.01em); top: -4.008em; left: 0.825em;"><span class="mrow" id="MathJax-Span-34051"><span class="mrow" id="MathJax-Span-34052"><span class="msup" id="MathJax-Span-34053"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34054" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.465em;"><span class="mn" id="MathJax-Span-34055" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34056" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msup" id="MathJax-Span-34057" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34058"><span class="mrow" id="MathJax-Span-34059"><span class="mi" id="MathJax-Span-34060" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.62em;"><span class="mtext" id="MathJax-Span-34061" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1003.15em, 3.961em, -1000.01em); top: -4.573em; left: 0.825em;"><span style="display: inline-block; position: relative; width: 3.139em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 2.47em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.414em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.928em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.442em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.956em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1000.83em, 4.373em, -1000.01em); top: -4.059em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_70"><mrow><mrow><mo>|</mo><mi>q</mi><mo>|</mo></mrow><mo>=</mo><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msup></mrow></msqrt></mrow></math></span></span><script type="math/mml" id="MathJax-Element-631"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_70"><mrow><mrow><mo>|</mo> <mi>q</mi> <mo>|</mo></mrow><mo>=</mo><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>2</mtext></msup></mrow></msqrt></mrow></math></script> is equal to one. One final definition we need is that of an inverse quaternion:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-632-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_714&quot;&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_714" overflow="scroll" style="width: 9.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1008.91em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34063"><span class="msup" id="MathJax-Span-34064"><span style="display: inline-block; position: relative; width: 1.494em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34065" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mrow" id="MathJax-Span-34066"><span class="mo" id="MathJax-Span-34067" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-34068" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34069" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-34070" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34071" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34072"><span class="mn" id="MathJax-Span-34073" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-34074" style="font-family: MathJax_Main;">/</span><span class="mo" id="MathJax-Span-34075" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mi" id="MathJax-Span-34076" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-34077" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-34078" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-34079" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34080" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34081"><span class="mi" id="MathJax-Span-34082" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-34083" style="font-family: MathJax_Main;">;</span><span class="mo" id="MathJax-Span-34084" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mstyle" id="MathJax-Span-34085"><span class="mrow" id="MathJax-Span-34086"><span class="mi" id="MathJax-Span-34087" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span class="mo" id="MathJax-Span-34088" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-34089" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_714"><msup><mi>q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>/</mo><mo>|</mo><mi>q</mi><mo>|</mo></mrow><mo>)</mo></mrow><mrow><mo>[</mo><mrow><mi>s</mi><mo>;</mo><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-632"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_714"><msup><mi>q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>/</mo><mo>|</mo><mi>q</mi><mo>|</mo></mrow><mo>)</mo></mrow><mrow><mo>[</mo> <mrow><mi>s</mi><mo>;</mo><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow> <mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>To represent a rotation by angle <span class="cItalic">ϕ</span> around an axis passing through the origin whose direction is given by the normalized vector <span class="cBold">n</span>, a normalized quaternion</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-633-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_715&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_715" overflow="scroll" style="width: 12.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.085em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1011.99em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34091"><span class="mi" id="MathJax-Span-34092" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-34093" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-34094" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34095" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mrow" id="MathJax-Span-34096"><span class="mi" id="MathJax-Span-34097" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-34098" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-34099" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34100" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34101"><span class="mi" id="MathJax-Span-34102" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-34103" style="font-family: MathJax_Main;">/</span><span class="mn" id="MathJax-Span-34104" style="font-family: MathJax_Main;">2</span></span><span class="mo" id="MathJax-Span-34105" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-34106" style="font-family: MathJax_Main; padding-left: 0.157em;">;</span><span class="mi" id="MathJax-Span-34107" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-34108" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-34109" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34110" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34111"><span class="mi" id="MathJax-Span-34112" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-34113" style="font-family: MathJax_Main;">/</span><span class="mn" id="MathJax-Span-34114" style="font-family: MathJax_Main;">2</span></span><span class="mo" id="MathJax-Span-34115" style="font-family: MathJax_Main;">)</span></span><span class="mstyle" id="MathJax-Span-34116" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34117"><span class="mi" id="MathJax-Span-34118" style="font-family: MathJax_Main-bold;">n</span></span></span></span><span class="mo" id="MathJax-Span-34119" style=""><span style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_715"><mi>q</mi><mo>=</mo><mrow><mo>[</mo><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mi>ϕ</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>;</mo><mi>sin</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mi>ϕ</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>]</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-633"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_715"><mi>q</mi><mo>=</mo><mrow><mo>[</mo> <mrow><mi>cos</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mi>ϕ</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>;</mo><mi>sin</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mi>ϕ</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow> <mo>]</mo></mrow></math></script></p>
<p>is formed. To rotate point <span class="cBold">p</span>, one turns it into the quaternion <span class="cItalic">q<span class="cSubscript">p</span></span> = [0; <span class="cBold">p</span>] and computes the quaternion product</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-634-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_716&quot;&gt;&lt;msub&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_716" overflow="scroll" style="width: 6.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.738em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1006.75em, 2.625em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34121"><span class="msub" id="MathJax-Span-34122"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.78em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="msup" id="MathJax-Span-34123"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34124" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mo" id="MathJax-Span-34125" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 0.774em;"><span class="mi" id="MathJax-Span-34126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34127" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-34128" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-34129" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="msub" id="MathJax-Span-34130" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34131" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-34132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34133" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="msup" id="MathJax-Span-34134" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.494em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34135" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mrow" id="MathJax-Span-34136"><span class="mo" id="MathJax-Span-34137" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-34138" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_716"><msub><msup><mi>q</mi><mo>′</mo></msup><mi>p</mi></msub><mo>=</mo><mi>q</mi><mo>⋅</mo><msub><mi>q</mi><mi>p</mi></msub><mo>⋅</mo><msup><mi>q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-634"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_716"><msub><msup><mi>q</mi><mo>′</mo></msup><mi>p</mi></msub><mo>=</mo><mi>q</mi><mo>⋅</mo><msub><mi>q</mi><mi>p</mi></msub><mo>⋅</mo><msup><mi>q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></math></script></p>
<p>which is guaranteed to have a zero scalar part and the rotated point as its vector part. Composite rotation is given simply by the product of quaternions representing each of the separate rotation steps. To animate with quaternions, one can treat them as points in a four-dimensional space and set keys directly in this space. To keep quaternions normalized, one should, strictly speaking, restrict interpolation procedures to a unit sphere (a 3D object) in this 4D space. However, a spherical version of even linear interpolation (often called <span class="cItalic">slerp)</span> already results in rather unpleasant math. Simple 4D linear interpolation followed by projection onto the unit sphere shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-12">Figure 16.12</a> is much simpler and often sufficient in practice. smoother results can be obtained via repeated application of a linear interpolation procedure using the de Casteljau algorithm.</p>
<div id="art_Dest_fig_16-12" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-12"></a><span class="cBold">Figure 16.12</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-12.png" alt="Figure showing interpolating quaternions should be done on the surface of a 3D unit sphere embedded in 4D space. However, much simpler interpolation along a 4D straight line (open circles) followed by reprojection of the results onto the sphere (black circles) is often sufficient." width="410" height="459" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-12.png"></p>
<p class="Text figcaption">Interpolating quaternions should be done on the surface of a 3D unit sphere embedded in 4D space. However, much simpler interpolation along a 4D straight line (open circles) followed by reprojection of the results onto the sphere (black circles) is often sufficient.</p>
</div>
<h2><a id="page_418"></a><a id="sec16-3"></a>16.3 Deformations</h2>
<p>Although techniques for object deformation might be more properly treated as modeling tools, they are traditionally discussed together with animation methods. Probably the simplest example of an operation which changes object shape is a nonuniform scaling. More generally, some function can be applied to local coordinates of all points specifying the object (i.e., vertices of a triangular mesh or control polygon of a spline surface), repositioning these points and creating a new shape: <span class="cBold">p</span>′ = <span class="cItalic">f</span> (<span class="cBold">p</span>, γ) where γ is a vector of parameters used by the deformation function. Choosing different <span class="cItalic">f</span> (and combining them by applying one after another) can help to create very interesting deformations. Examples of useful simple functions include bend, twist, and taper which are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-13">Figure 16.13</a>. Animating shape change is very easy in this case by keyframing the parameters of the deformation function. Disadvantages of this technique include difficulty of choosing the mathematical function for some nonstandard deformations and the fact that the resulting deformation is <span class="cItalic">global</span> in the sense that the complete object, and not just some part of it, is reshaped.</p>
<div id="art_Dest_fig_16-13" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-13"></a><span class="cBold">Figure 16.13</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-13.png" alt="Figure showing popular examples of global deformations. Bending and twist angles, as well as the degree of taper, can all be animated to achieve dynamic shape change." width="409" height="458" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-13.png"></p>
<p class="Text figcaption">Popular examples of global deformations. Bending and twist angles, as well as the degree of taper, can all be animated to achieve dynamic shape change.</p>
</div>
<p>To deform an object locally while providing more direct control over the result, one can choose a single vertex, move it to a new location and adjust vertices within some neighborhood to follow the seed vertex. The area affected by the deformation and the specific amount of displacement in different parts of the object are controlled by an attenuation function which decreases with distance (typically computed over the object’s surface) to the seed vertex. Seed vertex motion can be keyframed to produce animated shape change.</p>
<p>A more general deformation technique is called free-form deformation (FFD) (Sederberg &amp; Parry, 1986). A local (in most cases rectilinear) coordinate grid is first established to encapsulate the part of the object to be deformed, and coordinates (<span class="cItalic">s, t, u)</span> of all relevant points are computed with respect to this grid. The user then freely reshapes the grid of lattice points <span class="cBold">P</span><span class="cSubscript">ijk</span> into a new distorted lattice <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-635-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_71&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;ijk&lt;/mo&gt;&lt;mi&gt;&amp;#x2032;&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_71" style="width: 1.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1001.66em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34140"><span class="mrow" id="MathJax-Span-34141"><span class="msubsup" id="MathJax-Span-34142"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34143"><span class="mrow" id="MathJax-Span-34144"><span class="mi" id="MathJax-Span-34145" style="font-family: MathJax_Main-bold;">P</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1000.27em, 4.116em, -1000.01em); top: -4.419em; left: 0.774em;"><span class="mi" id="MathJax-Span-34146" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.88em, 4.321em, -1000.01em); top: -3.751em; left: 0.774em;"><span class="mo" id="MathJax-Span-34147" style="font-size: 70.7%; font-family: MathJax_Main;">ijk</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_71"><mrow><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>P</mi></mstyle><mo>ijk</mo><mi>′</mi></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-635"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_71"><mrow><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>P</mi></mstyle><mo>ijk</mo><mi>′</mi></msubsup></mrow></math></script> (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-14">Figure 16.14</a>). The object is reconstructed using coordinates computed in the original undistorted grid in the trivariate analog of Bézier interpolants (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C015.xhtml">Chapter 15</a>) with distorted lattice points <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-636-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_72&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;ijk&lt;/mo&gt;&lt;mi&gt;&amp;#x2032;&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_72" style="width: 1.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1001.66em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34149"><span class="mrow" id="MathJax-Span-34150"><span class="msubsup" id="MathJax-Span-34151"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34152"><span class="mrow" id="MathJax-Span-34153"><span class="mi" id="MathJax-Span-34154" style="font-family: MathJax_Main-bold;">P</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1000.27em, 4.116em, -1000.01em); top: -4.419em; left: 0.774em;"><span class="mi" id="MathJax-Span-34155" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.88em, 4.321em, -1000.01em); top: -3.751em; left: 0.774em;"><span class="mo" id="MathJax-Span-34156" style="font-size: 70.7%; font-family: MathJax_Main;">ijk</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_72"><mrow><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>P</mi></mstyle><mo>ijk</mo><mi>′</mi></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-636"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_72"><mrow><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>P</mi></mstyle><mo>ijk</mo><mi>′</mi></msubsup></mrow></math></script> serving as control points in this expression:</p>
<div id="art_Dest_fig_16-14" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-14"></a><span class="cBold">Figure 16.14</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-14.png" alt="Figure showing adjusting the FFD lattice results in the deformation of the object." width="410" height="536" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-14.png"></p>
<p class="Text figcaption">Adjusting the FFD lattice results in the deformation of the object.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-637-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_717&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mtext&gt;ijk&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_717" overflow="scroll" style="width: 37.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 36.815em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.442em, 1036.77em, 4.836em, -1000.01em); top: -3.339em; left: 0em;"><span class="mrow" id="MathJax-Span-34158"><span class="mi" id="MathJax-Span-34159" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mrow" id="MathJax-Span-34160" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34161" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34162"><span class="mi" id="MathJax-Span-34163" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-34164" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34165" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">u</span><span class="mo" id="MathJax-Span-34166" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34167" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">t</span></span><span class="mo" id="MathJax-Span-34168" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-34169" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-34170" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-34171"><span class="munderover" id="MathJax-Span-34172"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-34173" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.27em, -1000.01em); top: -2.928em; left: 0.157em;"><span class="mrow" id="MathJax-Span-34174"><span class="mi" id="MathJax-Span-34175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-34176" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-34177" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.47em, 4.167em, -1000.01em); top: -5.139em; left: 0.465em;"><span class="mi" id="MathJax-Span-34178" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-34179" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34180"><span class="mo" id="MathJax-Span-34181" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-34182"><span class="mtable" id="MathJax-Span-34183" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.63em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.32em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.152em;"><span class="mtd" id="MathJax-Span-34184"><span class="mrow" id="MathJax-Span-34185"><span class="mi" id="MathJax-Span-34186" style="font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.357em;"><span class="mtd" id="MathJax-Span-34187"><span class="mrow" id="MathJax-Span-34188"><span class="mi" id="MathJax-Span-34189" style="font-family: MathJax_Math-italic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34190" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="msup" id="MathJax-Span-34191" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.27em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.84em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-34192"><span class="mrow" id="MathJax-Span-34193"><span class="mo" id="MathJax-Span-34194" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34195"><span class="mn" id="MathJax-Span-34196" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-34197" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-34198" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">s</span></span><span class="mo" id="MathJax-Span-34199" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 2.933em;"><span class="mrow" id="MathJax-Span-34200"><span class="mi" id="MathJax-Span-34201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-34202" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-34204"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34205" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.465em;"><span class="mi" id="MathJax-Span-34206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-34207" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34208"><span class="munderover" id="MathJax-Span-34209"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-34210" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.19em, 4.424em, -1000.01em); top: -2.928em; left: 0.105em;"><span class="mrow" id="MathJax-Span-34211"><span class="mi" id="MathJax-Span-34212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-34213" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-34214" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.73em, 4.167em, -1000.01em); top: -5.139em; left: 0.362em;"><span class="mi" id="MathJax-Span-34215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-34216" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34217"><span class="mo" id="MathJax-Span-34218" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-34219"><span class="mtable" id="MathJax-Span-34220" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1001.04em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.373em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.203em;"><span class="mtd" id="MathJax-Span-34221"><span class="mrow" id="MathJax-Span-34222"><span class="mi" id="MathJax-Span-34223" style="font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1001.04em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-34224"><span class="mrow" id="MathJax-Span-34225"><span class="mi" id="MathJax-Span-34226" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34227" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="msup" id="MathJax-Span-34228" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.476em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.74em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-34229"><span class="mrow" id="MathJax-Span-34230"><span class="mo" id="MathJax-Span-34231" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34232"><span class="mn" id="MathJax-Span-34233" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-34234" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-34235" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span></span><span class="mo" id="MathJax-Span-34236" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 2.83em;"><span class="mrow" id="MathJax-Span-34237"><span class="mi" id="MathJax-Span-34238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34239" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-34241"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34242" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.362em;"><span class="mi" id="MathJax-Span-34243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-34244" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34245"><span class="munderover" id="MathJax-Span-34246"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-34247" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.25em, 4.27em, -1000.01em); top: -2.877em; left: 0.105em;"><span class="mrow" id="MathJax-Span-34248"><span class="mi" id="MathJax-Span-34249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-34250" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-34251" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.63em, 4.167em, -1000.01em); top: -5.139em; left: 0.414em;"><span class="mi" id="MathJax-Span-34252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-34253" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-34254"><span class="mo" id="MathJax-Span-34255" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-34256"><span class="mtable" id="MathJax-Span-34257" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.88em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-34258"><span class="mrow" id="MathJax-Span-34259"><span class="mi" id="MathJax-Span-34260" style="font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.88em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-34261"><span class="mrow" id="MathJax-Span-34262"><span class="mi" id="MathJax-Span-34263" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34264" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="msup" id="MathJax-Span-34265" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.681em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.94em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-34266"><span class="mrow" id="MathJax-Span-34267"><span class="mo" id="MathJax-Span-34268" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34269"><span class="mn" id="MathJax-Span-34270" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-34271" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-34272" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">u</span></span><span class="mo" id="MathJax-Span-34273" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.036em;"><span class="mrow" id="MathJax-Span-34274"><span class="mi" id="MathJax-Span-34275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34276" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-34278"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34279" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.568em;"><span class="mi" id="MathJax-Span-34280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-34281"><span style="display: inline-block; position: relative; width: 1.905em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1001.04em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="msup" id="MathJax-Span-34282"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34283" style="font-family: MathJax_Main-bold;">P</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.774em;"><span class="mo" id="MathJax-Span-34284" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 1.082em;"><span class="mrow" id="MathJax-Span-34285"><span class="mtext" id="MathJax-Span-34286" style="font-size: 70.7%; font-family: MathJax_Main;">ijk</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34287" style="font-family: MathJax_Main;">,</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.345em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.286em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_717"><mi>P</mi><mrow><mo>(</mo><mrow><mi>s</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>L</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>i</mi></mtd></mtr><mtr><mtd><mi>L</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>L</mi><mo>−</mo><mi>i</mi></mrow></msup><msup><mi>s</mi><mi>i</mi></msup></mrow></mstyle><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>j</mi></mtd></mtr><mtr><mtd><mi>M</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>M</mi><mo>−</mo><mi>j</mi></mrow></msup><msup><mi>t</mi><mi>j</mi></msup></mrow></mstyle><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>k</mi></mtd></mtr><mtr><mtd><mi>N</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>u</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>N</mi><mo>−</mo><mi>k</mi></mrow></msup><msup><mi>u</mi><mi>k</mi></msup><msub><msup><mi mathvariant="bold">P</mi><mo>′</mo></msup><mrow><mtext>ijk</mtext></mrow></msub><mo>,</mo></mrow></mstyle></math></span></span><script type="math/mml" id="MathJax-Element-637"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_717"><mi>P</mi><mrow><mo>(</mo><mrow><mi>s</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>L</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>i</mi></mtd></mtr><mtr><mtd><mi>L</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>L</mi><mo>−</mo><mi>i</mi></mrow></msup><msup><mi>s</mi><mi>i</mi></msup></mrow></mstyle><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>j</mi></mtd></mtr><mtr><mtd><mi>M</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>M</mi><mo>−</mo><mi>j</mi></mrow></msup><msup><mi>t</mi><mi>j</mi></msup></mrow></mstyle><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>k</mi></mtd></mtr><mtr><mtd><mi>N</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>u</mi></mrow><mo>)</mo></mrow></mrow><mrow><mi>N</mi><mo>−</mo><mi>k</mi></mrow></msup><msup><mi>u</mi><mi>k</mi></msup><msub><msup><mi mathvariant="bold">P</mi><mo>′</mo></msup><mrow><mtext>ijk</mtext></mrow></msub><mo>,</mo></mrow></mstyle></math></script></p>
<p>where <span class="cItalic">L, M, N</span> are maximum indices of lattice points in each dimension. In effect, the lattice serves as a low-resolution version of the object for the purpose of deformation, allowing for a smooth shape change of an arbitrarily complex object <a id="page_419"></a>through a relatively small number of intuitive adjustments. FFD lattices can themselves be treated as regular objects by the system and can be transformed, animated, and even further deformed if necessary, leading to corresponding changes in the object to which the lattice is attached. For example, moving a <span class="cItalic">deformation tool</span> consisting of the original lattice and distorted lattice representing a bulge across an object results in a bulge moving across the object.</p>
<h2><a id="sec16-4"></a>16.4 Character Animation</h2>
<p>Animation of articulated figures is most often performed through a combination of keyframing and specialized deformation techniques. The character model intended for animation typically consists of at least two main layers as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-15">Figure 16.15</a>. The motion of a highly detailed surface representing the outer shell or <span class="cItalic">skin</span> of the character is what the viewer will eventually see in the final product. The <span class="cItalic">skeleton</span> underneath it is a hierarchical structure (a tree) of joints which provides a kinematic model of the figure and is used exclusively for animation. In some cases, additional intermediate layer(s) roughly corresponding to muscles are inserted between the skeleton and the skin.</p>
<div id="art_Dest_fig_16-15" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-15"></a><span class="cBold">Figure 16.15</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-15.png" alt="Figure showing (left) A hierarchy of joints, a skeleton, serves as a kinematic abstraction of the character; (middle) repositioning the skeleton deforms a separate skin object attached to it; (right) a tree data structure is used to represent the skeleton. For compactness, the internal structure of several nodes is hidden (they are identical to a corresponding sibling)." width="600" height="395" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-15.png"></p>
<p class="Text figcaption">(Left) A hierarchy of joints, a skeleton, serves as a kinematic abstraction of the character; (middle) repositioning the skeleton deforms a separate skin object attached to it; (right) a tree data structure is used to represent the skeleton. For compactness, the internal structure of several nodes is hidden (they are identical to a corresponding sibling).</p>
</div>
<p><a id="page_420"></a>Each of the skeleton’s joints acts as a parent for the hierarchy below it. The root represents the whole character and is positioned directly in the world coordinate system. If a local transformation matrix which relates a joint to its parent in the hierarchy is available, one can obtain a transformation which relates local space of any joint to the world system (i.e., the system of the root) by simply concatenating transformations along the path from the root to the joint. To evaluate the whole skeleton (i.e., find position and orientation of all joints), a depth-first traversal of the complete tree of joints is performed. A transformation stack is a natural data structure to help with this task. While traversing down the tree, the current composite matrix is pushed on the stack and a new one is created by multiplying the current matrix with the one stored at the joint. When backtracking to the parent, this extra transformation should be undone before another branch is visited; this is easily done by simply popping the stack. Although this general and simple technique for evaluating hierarchies is used throughout computer graphics, in animation (and robotics) it is given a special name—<span class="cItalic">forward kinematics</span> (FK). While general representations for all transformations can be used, it is common to use specialized sets of parameters, such as link lengths or joint angles, to specify skeletons. To animate with forward kinematics, rotational parameters of all joints are manipulated directly. The technique also allows the animator to change the distance between joints (link lengths), but one should be aware that this corresponds to limb stretching and can often look rather unnatural.</p>
<p>Forward kinematics requires the user to set parameters for all joints involved in the motion (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-16">Figure 16.16</a> (top)). Most of these joints, however, belong to internal<a id="page_421"></a> nodes of the hierarchy, and their motion is typically not something the animator wants to worry about. In most situations, the animator just wants them to move naturally “on their own,” and one is much more interested in specifying the behavior of the endpoint of a joint chain, which typically corresponds to something performing a specific action, such as an ankle or a tip of a finger. The animator would rather have parameters of all internal joints be determined from the motion of the end effector automatically by the system. <span class="cItalic">Inverse kinematics</span> (IK) allows us to do just that (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-16">Figure 16.16</a> (bottom)).</p>
<div id="art_Dest_fig_16-16" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-16"></a><span class="cBold">Figure 16.16</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-16.png" alt="Figure showing forward kinematics (top) requires the animator to put all joints into correct position. In inverse kinematic (bottom), parameters of some internal joints are computed based on desired end effector motion." width="600" height="421" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-16.png"></p>
<p class="Text figcaption">Forward kinematics (top) requires the animator to put all joints into correct position. In inverse kinematic (bottom), parameters of some internal joints are computed based on desired end effector motion.</p>
</div>
<p>Let <span class="cBold">x</span> be the position of the end effector and <span class="cItalic">α</span> be the vector of parameters needed to specify all internal joints along the chain from the root to the final joint. Sometimes the orientation of the final joint is also directly set by the animator, in which case we assume that the corresponding variables are included in the vector <span class="cBold">x</span>. For simplicity, however, we will write all specific expressions for the vector:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-638-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_718&quot;&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_718" overflow="scroll" style="width: 7.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.406em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1007.31em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34289"><span class="mstyle" id="MathJax-Span-34290"><span class="mrow" id="MathJax-Span-34291"><span class="mi" id="MathJax-Span-34292" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-34293" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msup" id="MathJax-Span-34294" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 5.247em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1004.54em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-34295"><span class="mo" id="MathJax-Span-34296" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34297"><span class="msub" id="MathJax-Span-34298"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34299" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-34300" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34301" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-34302" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34303" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-34304" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34305" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-34306" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34307" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-34308" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34309" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 4.63em;"><span class="mi" id="MathJax-Span-34310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34311" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_718"><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>=</mo><msup><mrow><mo>(</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><mo>)</mo></mrow><mi>T</mi></msup><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-638"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_718"><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>=</mo><msup><mrow><mo>(</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><mo>)</mo></mrow><mi>T</mi></msup><mo>.</mo></math></script></p>
<p>Since each of the variables in <span class="cBold">x</span> is a function of <span class="cItalic">α,</span> it can be written as a vector equation <span class="cBold">x</span> = <span class="cBold">F</span><span class="cItalic">(α).</span> If we change the internal joint parameters by a small amount <span class="cItalic">δα,</span> a resulting change <span class="cItalic">δ</span><span class="cBold">x</span> in the position of the end effector can be approximately written as</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-639-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_7196_1&quot;&gt;&lt;mi&gt;&amp;#x3B4;&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x3B4;&lt;/mi&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(16.1)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_7196_1" overflow="scroll" style="width: 9.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.206em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1009.11em, 2.728em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34313"><span class="mi" id="MathJax-Span-34314" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mstyle" id="MathJax-Span-34315"><span class="mrow" id="MathJax-Span-34316"><span class="mi" id="MathJax-Span-34317" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-34318" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-34319" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.83em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-34320"><span class="mo" id="MathJax-Span-34321" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mstyle" id="MathJax-Span-34322"><span class="mrow" id="MathJax-Span-34323"><span class="mi" id="MathJax-Span-34324" style="font-size: 70.7%; font-family: MathJax_Main-bold;">F</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34325"><span class="mo" id="MathJax-Span-34326" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.031em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mi" id="MathJax-Span-34328" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-34329" style="font-family: MathJax_Math-italic;">α</span><span class="mtext" id="MathJax-Span-34330" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(16.1)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_7196_1"><mi>δ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>=</mo><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac><mi>δ</mi><mi>α</mi><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(16.1)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-639"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_7196_1"><mi>δ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>=</mo><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac><mi>δ</mi><mi>α</mi><mtext>        (16.1)</mtext></math></script></p>
<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-640-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_73&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_73" style="width: 1.288em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1001.25em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34332"><span class="mfrac" id="MathJax-Span-34333"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.83em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-34334"><span class="mo" id="MathJax-Span-34335" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mstyle" id="MathJax-Span-34336"><span class="mrow" id="MathJax-Span-34337"><span class="mi" id="MathJax-Span-34338" style="font-size: 70.7%; font-family: MathJax_Main-bold;">F</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34339"><span class="mo" id="MathJax-Span-34340" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34341" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.031em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_73"><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac></math></span></span><script type="math/mml" id="MathJax-Element-640"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_73"><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac></math></script> is the matrix of partial derivatives called the Jacobian:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-641-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_720&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_720" overflow="scroll" style="width: 13.113em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.702em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1012.61em, 7.92em, -1000.01em); top: -5.19em; left: 0em;"><span class="mrow" id="MathJax-Span-34343"><span class="mfrac" id="MathJax-Span-34344"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.83em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-34345"><span class="mo" id="MathJax-Span-34346" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mstyle" id="MathJax-Span-34347"><span class="mrow" id="MathJax-Span-34348"><span class="mi" id="MathJax-Span-34349" style="font-size: 70.7%; font-family: MathJax_Main-bold;">F</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34350"><span class="mo" id="MathJax-Span-34351" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.031em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34353" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-34354" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34355" style="vertical-align: 3.087em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 1.031em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.614em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.049em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-34356"><span class="mtable" id="MathJax-Span-34357" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 8.075em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.5em, 9.411em, -1000.01em); top: -6.681em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.494em; height: 0px;"><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -6.013em; left: 0em;"><span class="mtd" id="MathJax-Span-34358"><span class="mrow" id="MathJax-Span-34359"><span class="mrow" id="MathJax-Span-34360"><span class="mfrac" id="MathJax-Span-34361"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34362"><span class="mo" id="MathJax-Span-34363" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34364"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34366" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34367"><span class="mo" id="MathJax-Span-34368" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34369"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34370" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34371" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-34403"><span class="mrow" id="MathJax-Span-34404"><span class="mrow" id="MathJax-Span-34405"><span class="mfrac" id="MathJax-Span-34406"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34407"><span class="mo" id="MathJax-Span-34408" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34409"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34410" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34411" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34412"><span class="mo" id="MathJax-Span-34413" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34414"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34416" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -1.951em; left: 0em;"><span class="mtd" id="MathJax-Span-34448"><span class="mrow" id="MathJax-Span-34449"><span class="mrow" id="MathJax-Span-34450"><span class="mfrac" id="MathJax-Span-34451"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.373em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34452"><span class="mo" id="MathJax-Span-34453" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34454"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34455" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34456" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34457"><span class="mo" id="MathJax-Span-34458" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34459"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34461" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.686em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.5em, 9.411em, -1000.01em); top: -6.681em; left: 2.316em;"><span style="display: inline-block; position: relative; width: 1.494em; height: 0px;"><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -6.013em; left: 0em;"><span class="mtd" id="MathJax-Span-34372"><span class="mrow" id="MathJax-Span-34373"><span class="mrow" id="MathJax-Span-34374"><span class="mfrac" id="MathJax-Span-34375"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34376"><span class="mo" id="MathJax-Span-34377" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34378"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34380" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34381"><span class="mo" id="MathJax-Span-34382" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34383"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34385" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-34417"><span class="mrow" id="MathJax-Span-34418"><span class="mrow" id="MathJax-Span-34419"><span class="mfrac" id="MathJax-Span-34420"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34421"><span class="mo" id="MathJax-Span-34422" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34423"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34425" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34426"><span class="mo" id="MathJax-Span-34427" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34428"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34430" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.5em, 4.681em, -1000.01em); top: -1.951em; left: 0em;"><span class="mtd" id="MathJax-Span-34462"><span class="mrow" id="MathJax-Span-34463"><span class="mrow" id="MathJax-Span-34464"><span class="mfrac" id="MathJax-Span-34465"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.373em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34466"><span class="mo" id="MathJax-Span-34467" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34468"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34470" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34471"><span class="mo" id="MathJax-Span-34472" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34473"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mn" id="MathJax-Span-34475" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.25em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.237em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.686em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1001.09em, 7.252em, -1000.01em); top: -5.19em; left: 4.578em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1001.09em, 3.961em, -1000.01em); top: -6.013em; left: 0em;"><span class="mtd" id="MathJax-Span-34386"><span class="mrow" id="MathJax-Span-34387"><span class="mo" id="MathJax-Span-34388" style="font-family: MathJax_Main;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.09em, 3.961em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-34431"><span class="mrow" id="MathJax-Span-34432"><span class="mo" id="MathJax-Span-34433" style="font-family: MathJax_Main;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.09em, 3.961em, -1000.01em); top: -1.951em; left: 0em;"><span class="mtd" id="MathJax-Span-34476"><span class="mrow" id="MathJax-Span-34477"><span class="mo" id="MathJax-Span-34478" style="font-family: MathJax_Main;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.195em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.55em, 9.411em, -1000.01em); top: -6.681em; left: 6.532em;"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(2.779em, 1001.55em, 4.681em, -1000.01em); top: -6.013em; left: 0em;"><span class="mtd" id="MathJax-Span-34389"><span class="mrow" id="MathJax-Span-34390"><span class="mrow" id="MathJax-Span-34391"><span class="mfrac" id="MathJax-Span-34392"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34393"><span class="mo" id="MathJax-Span-34394" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34395"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34396" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34397" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34398"><span class="mo" id="MathJax-Span-34399" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34400"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-34402" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.3em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.288em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.55em, 4.681em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-34434"><span class="mrow" id="MathJax-Span-34435"><span class="mrow" id="MathJax-Span-34436"><span class="mfrac" id="MathJax-Span-34437"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34438"><span class="mo" id="MathJax-Span-34439" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34440"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34442" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34443"><span class="mo" id="MathJax-Span-34444" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34445"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34446" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-34447" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.3em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.288em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1001.55em, 4.681em, -1000.01em); top: -1.951em; left: 0em;"><span class="mtd" id="MathJax-Span-34479"><span class="mrow" id="MathJax-Span-34480"><span class="mrow" id="MathJax-Span-34481"><span class="mfrac" id="MathJax-Span-34482"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.373em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34483"><span class="mo" id="MathJax-Span-34484" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34485"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mn" id="MathJax-Span-34487" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-34488"><span class="mo" id="MathJax-Span-34489" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="msub" id="MathJax-Span-34490"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-34491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-34492" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.3em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.288em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.686em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34493" style="vertical-align: 3.087em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 1.031em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.614em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.049em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34494" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 5.195em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.698em; border-left: 0px solid; width: 0px; height: 5.987em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_720"><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac><mo>=</mo><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-641"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_720"><mfrac><mrow><mo>∂</mo><mstyle mathvariant="bold" mathsize="normal"><mi>F</mi></mstyle></mrow><mrow><mo>∂</mo><mi>α</mi></mrow></mfrac><mo>=</mo><mrow><mo>[</mo> <mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>⋯</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>α</mi><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>.</mo>
</math></script></p>
<p>At each moment in time, we know the desired position of the end effector (set by the animator) and, of course, the effector’s current position. Subtracting the two, we will get the desired adjustment <span class="cItalic">δ</span><span class="cBold">x</span>. Elements of the Jacobian matrix are related to changes in a coordinate of the end effector when a particular internal parameter is changed while others remain fixed (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-17">Figure 16.17</a>). These elements can be computed for any given skeleton configuration using geometric relationships. The only remaining unknowns in the system of equations (16.1) are the changes in internal parameters <span class="cItalic">α.</span> Once we solve for them, we update <span class="cItalic">α = α+δα</span> which gives all the necessary information for the FK procedure to reposition the skeleton.</p>
<div id="art_Dest_fig_16-17" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-17"></a><span class="cBold">Figure 16.17</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-17.png" alt="Figure showing partial derivative ∂x/∂αknee is given by the limit of Δx/Δαknee. Effector displacement is computed while all joints, except the knee, are kept fixed." width="410" height="776" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-17.png"></p>
<p class="Text figcaption">Partial derivative ∂<span class="cItalic">x/</span>∂α<span class="cSubscript">knee</span> is given by the limit of Δ<span class="cItalic">x/</span>Δ<span class="cItalic">α</span><span class="cSubscript">knee</span>. Effector displacement is computed while all joints, except the knee, are kept fixed.</p>
</div>
<p>Unfortunately, the system (16.1) cannot usually be solved analytically and, moreover, it is in most cases underconstrained, i.e., the number of unknown internal joint parameters <span class="cItalic">α</span> exceeds the number of variables in vector <span class="cBold">x</span>. This means that different motions of the skeleton can result in the same motion of the end <a id="page_422"></a>effector. Some examples are shown on <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-18">Figure 16.18</a>. Many ways of obtaining specific solution for such systems are available, including those taking into account natural <span class="cItalic">constraints</span> needed for some real-life joints (bending a knee only in one direction, for example). One should also remember that the computed Jacobian matrix is valid only for one specific configuration, and it has to be updated as the skeleton moves. The complete IK framework is presented in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-19">Figure 16.19</a>. Of course, the root joint for IK does not have to be the root of the whole hierarchy, and multiple IK solvers can be applied to independent parts of the skeleton. For example, one can use separate solvers for right and left feet and yet another one to help animate grasping with the right hand, each with its own root.</p>
<div id="art_Dest_fig_16-18" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-18"></a><span class="cBold">Figure 16.18</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-18.png" alt="Figure showing multiple configurations of internal joints can result in the same effector position. (Top) disjoint “flipped” solutions; (bottom) a continuum of solutions." width="579" height="596" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-18.png"></p>
<p class="Text figcaption">Multiple configurations of internal joints can result in the same effector position. (Top) disjoint “flipped” solutions; (bottom) a continuum of solutions.</p>
</div>
<div id="art_Dest_fig_16-19" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-19"></a><span class="cBold">Figure 16.19</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-19.png" alt="Figure showing a diagram of the inverse kinematic algorithm." width="600" height="469" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-19.png"></p>
<p class="Text figcaption">A diagram of the inverse kinematic algorithm.</p>
</div>
<p>A combination of FK and IK approaches is typically used to animate the skeleton. Many common motions (walking or running cycles, grasping, reaching, etc.) exhibit well-known patterns of mutual joint motion making it possible to quickly <a id="page_423"></a>create naturally looking motion or even use a library of such “clips.” The animator then adjusts this generic result according to the physical parameters of the character and also to give it more individuality.</p>
<p>When a skeleton changes its position, it acts as a special type of deformer applied to the skin of the character. The motion is transferred to this surface by assigning each skin vertex one <span class="cItalic">(rigid skinning)</span> or more <span class="cItalic">(smooth skinning)</span> joints as drivers (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-20">Figure 16.20</a>). In the first case, a skin vertex is simply frozen into the local space of the corresponding joint, which can be the one nearest in space or one chosen directly by the user. The vertex then repeats whatever motion this joint experiences, and its position in world coordinates is determined by standard FK procedure. Although it is simple, rigid skinning makes it difficult to obtain sufficiently smooth skin deformation in areas near the joints or also for more subtle effects resembling breathing or muscle action. Additional specialized deformers <span class="cItalic">called flexors</span> can be used for this purpose. In smooth skinning, several joints can influence a skin vertex according to some weight assigned by the animator, providing more detailed control over the results. Displacement vectors, d<span class="cSubscript">i</span>, suggested by different joints affecting a given skin vertex (each again computed with standard FK) are averaged according to their weights <span class="cItalic">w<span class="cSubscript">i</span></span> to compute the final displacement of the vertex <span class="cBold">d</span> = Σ <span class="cItalic">w<span class="cSubscript">i</span></span><span class="cBold">d</span><span class="cSubscript">i</span>. Normalized weights (Σ<span class="cItalic">w<span class="cSubscript">i</span></span> = 1) are the most common but not fundamentally necessary. Setting smooth skinning weights to achieve the desired effect is not easy and requires significant skill from the animator.</p>
<div id="art_Dest_fig_16-20" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-20"></a><span class="cBold">Figure 16.20</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-20.png" alt="Figure showing top: Rigid skinning assigns skin vertices to a specific joint. Those belonging to the elbow joint are shown in black; Bottom: Soft skinning can blend the influence of several joints. Weights for the elbow joint are shown (lighter = greater weight). Note smoother skin deformation of the inner part of the skin near the joint." width="410" height="343" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-20.png"></p>
<p class="Text figcaption">Top: Rigid skinning assigns skin vertices to a specific joint. Those belonging to the elbow joint are shown in black; Bottom: Soft skinning can blend the influence of several joints. Weights for the elbow joint are shown (lighter = greater weight). Note smoother skin deformation of the inner part of the skin near the joint.</p>
</div>
<h3><a id="sec16-4-1"></a>16.4.1 Facial Animation</h3>
<p>Skeletons are well suited for creating most motions of a character’s body, but they are not very convenient for realistic facial animation. The reason is that the skin of a human face is moved by muscles directly attached to it, contrary to other parts of the body where the primary objective of the muscles is to move the bones of the skeleton and any skin deformation is a secondary outcome. The result of this facial anatomical arrangement is a very rich set of dynamic facial expressions humans use as one of the main instruments of communication. We are all very well trained to recognize such facial variations and can easily notice any unnatural appearance. This not only puts special demands on the animator but also requires a high-resolution geometric model of the face and, if photorealism is desired, accurate skin reflection properties and textures.</p>
<p>While it is possible to set key poses of the face vertex-by-vertex and interpolate between them or directly simulate the behavior of the underlying muscle structure using physics-based techniques (see Section 16.5), more specialized <a id="page_424"></a>high-level approaches also exist. The static shape of a specific face can be characterized by a relatively small set of so-called <span class="cItalic">conformational parameters</span> (overall scale, distance from the eye to the forehead, length of the nose, width of the jaws, etc.) which are used to morph a generic face model into one with individual features. An additional set of <span class="cItalic">expressive parameters</span> can be used to describe the dynamic shape of the face for animation. Examples include rigid rotation of the head, how wide the eyes are open, movement of some feature point from its static position, etc. These are chosen so that most of the interesting expressions can be obtained through some combination of parameter adjustments, therefore, allowing a face to be animated via standard keyframing. To achieve a higher level of control, one can use expressive parameters to create a set of expressions corresponding to common emotions (neutral, sadness, happiness, anger, surprise, etc.) and then blend these key poses to obtain a “slightly sad” or “angrily surprised” face. Similar techniques can be used to perform lip-synch animation, but key poses in this case correspond to different phonemes. Instead of using a sequence of static expressions to describe a dynamic one, the Facial Action Coding System (FACS) (Eckman &amp; Friesen, 1978) decomposes dynamic facial expressions directly into a sum of elementary motions called action units (AUs). The set of AUs is based on extensive psychological research and includes such movements as raising the inner brow, wrinkling the nose, stretching lips, etc. Combining AUs can be used to synthesize a necessary expression.</p>
<h3><a id="sec16-4-2"></a>16.4.2 Motion Capture</h3>
<p>Even with the help of the techniques described above, creating realistic-looking character animation from scratch remains a daunting task. It is therefore only natural that much attention is directed toward techniques which record an actor’s motion in the real world and then apply it to computer-generated characters. Two main classes of such <span class="cItalic">motion capture</span> (MC) techniques exist: electromagnetic and optical.</p>
<p>In electromagnetic motion capture, an electromagnetic sensor directly measures its position (and possibly orientation) in 3D, often providing the captured results in real time. Disadvantages of this technique include significant equipment cost, possible interference from nearby metal objects, and noticeable size of sensors and batteries which can be an obstacle in performing high-amplitude motions. In optical MC, small colored markers are used instead of active sensors making it a much less intrusive procedure. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-21">Figure 16.21</a> shows the operation of such a system. In the most basic arrangement, the motion is recorded by two calibrated video cameras, and simple triangulation is used to extract the marker’s 3D position. More advanced computer vision algorithms used for accurate tracking <a id="page_425"></a>of multiple markers from video are computationally expensive, so, in most cases, such processing is done offline. Optical tracking is generally less robust than electromagnetic. Occlusion of a given marker in some frames, possible misidentification of markers, and noise in images are just a few of the common problem which have to be addressed. Introducing more cameras observing the motion from different directions improves both accuracy and robustness, but this approach is more expensive and it takes longer to process such data. Optical MC becomes more attractive as available computational power increases and better computer vision algorithms are developed. Because of low impact nature of markers, optical methods are suitable for delicate facial motion capture and can also be used with objects other than humans—for example, animals or even tree branches in the wind.</p>
<div id="art_Dest_fig_16-21" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-21"></a><span class="cBold">Figure 16.21</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-21.png" alt="Figure showing optical motion capture: markers attached to a performer’s body allow skeletal motion to be extracted." width="265" height="600" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-21.png"></p>
<p class="Text figcaption">Optical motion capture: markers attached to a performer’s body allow skeletal motion to be extracted.</p>
<p class="Text figsource"><span class="cItalic">Image courtesy of Motion Analysis Corp.</span></p>
</div>
<p>With several sensors or markers attached to a performer’s body, a set of time-dependant 3D positions of some collection of points can be recorded. These tracking locations are commonly chosen near joints, but, of course, they still lie on skin surface and not at points where actual bones meet. Therefore, some additional care and a bit of extra processing is necessary to convert recorded positions into those of the physical skeleton joints. For example, putting two markers on opposite sides of the elbow or ankle allows the system to obtain better joint position by averaging locations of the two markers. Without such extra care, very noticeable artifacts can appear due to offset joint positions as well as inherent noise and insufficient measurement accuracy. Because of physical inaccuracy during motion, for example, character limbs can lose contact with objects they are supposed to touch during walking or grasping, problems like foot-sliding (skating) of the skeleton can occur. Most of these problems can be corrected by using inverse kinematics techniques which can explicitly force the required behavior of the limb’s end.</p>
<p>Recovered joint positions can now be directly applied to the skeleton of a computer-generated character. This procedure assumes that the physical dimensions of the character are identical to those of the performer. Retargeting recorded motion to a different character and, more generally, editing MC data, requires significant care to satisfy necessary constraints (such as maintaining feet on the ground or not allowing an elbow to bend backwards) and preserve an overall natural appearance of the modified motion. Generally, the greater the desired change from the original, the less likely it will be possible to maintain the quality of the result. An interesting approach to the problem is to record a large collection of motions and stitch together short clips from this library to obtain desired movement. Although this topic is currently a very active research area, limited ability to adjust the recorded motion to the animator’s needs remains one of the main disadvantages of motion capture technique.</p>
<h2><a id="sec16-5"></a><a id="page_426"></a>16.5 Physics-Based Animation</h2>
<p>The world around us is governed by physical laws, many of which can be formalized as sets of partial or, in some simpler cases, ordinary differential equations. One of the original applications of computers was (and remains) solving such equations. It is therefore only natural to attempt to use numerical techniques developed over the several past decades to obtain realistic motion for computer animation.</p>
<p>Because of its relative complexity and significant cost, physics-based animation is most commonly used in situations when other techniques are either unavailable or do not produce sufficiently realistic results. Prime examples include animation of fluids (which includes many gaseous phase phenomena described by the same equations—smoke, clouds, fire, etc.), cloth simulation (an example is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-22">Figure 16.22</a>), rigid body motion, and accurate deformation of elastic objects. Governing equations and details of commonly used numerical approaches are different in each of these cases, but many fundamental ideas and difficulties remain applicable across applications. Many methods for numerically solving ODEs and PDEs exist, but discussing them in details is far beyond the scope of this book. To give the reader a flavor of physics-based techniques and some of the issues involved, we will briefly mention here only the finite difference approach—one of the conceptually simplest and most popular families of algorithms which has been applied to most, if not all, differential equations encountered in animation.</p>
<div id="art_Dest_fig_16-22" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-22"></a><span class="cBold">Figure 16.22</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-22.png" alt="Figure showing realistic cloth simulation is often performed with physics-based methods. In this example, forces are due to collisions and gravity." width="409" height="299" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-22.png"></p>
<p class="Text figcaption">Realistic cloth simulation is often performed with physics-based methods. In this example, forces are due to collisions and gravity.</p>
</div>
<p>The key idea of this approach is to replace a differential equation with its discrete analog—a difference equation. To do this, the continuous domain of interest is represented by a finite set of points at which the solution will be computed. In the simplest case, these are defined on a uniform rectangular grid as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-23">Figure 16.23</a>. Every derivative present in the original ODE or PDE is then replaced by its approximation through function values at grid points. One way of doing this is to subtract the function value at a given point from the function value for its neighboring point on the grid:</p>
<div id="art_Dest_fig_16-23" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-23"></a><span class="cBold">Figure 16.23</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-23.png" alt="Figure showing two possible difference schemes for an equation involving derivatives ∂f/∂x and ∂f/∂t. (Left) An explicit scheme expresses unknown values (open circles) only through known values at the current (orange circles) and possibly past (blue circles) time; (Right) Implicit schemes mix known and unknown values in a single equation making it necessary to solve all such equations as a system. For both schemes, information about values on the right boundary is needed to close the process." width="600" height="303" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-23.png"></p>
<p class="Text figcaption">Two possible difference schemes for an equation involving derivatives <span class="cItalic">∂f/∂x</span> and <span class="cItalic">∂f/∂t</span>. (Left) An explicit scheme expresses unknown values (open circles) only through known values at the current (orange circles) and possibly past (blue circles) time; (Right) Implicit schemes mix known and unknown values in a single equation making it necessary to solve all such equations as a system. For both schemes, information about values on the right boundary is needed to close the process.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-642-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_7216_2&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;or&lt;/mi&gt;&lt;/mstyle&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(16.2)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_7216_2" overflow="scroll" style="width: 29.977em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.103em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.877em, 1029.01em, 2.728em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34496"><span class="mfrac" id="MathJax-Span-34497"><span style="display: inline-block; position: relative; width: 1.699em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.5em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-34498"><span class="mi" id="MathJax-Span-34499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-34500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34501"><span class="mo" id="MathJax-Span-34502" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-34503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34504" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.63em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.306em;"><span class="mrow" id="MathJax-Span-34505"><span class="mi" id="MathJax-Span-34506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-34507" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.71em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.699em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34508" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-34509" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.99em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34510"><span class="mo" id="MathJax-Span-34511" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.83em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34513"><span class="mo" id="MathJax-Span-34514" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.09em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34516" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-34517" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.476em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1004.28em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.157em;"><span class="mrow" id="MathJax-Span-34518"><span class="mi" id="MathJax-Span-34519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34520"><span class="mo" id="MathJax-Span-34521" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34522"><span class="mi" id="MathJax-Span-34523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34524" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-34525" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34527" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-34528" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34529" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34530"><span class="mo" id="MathJax-Span-34531" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-34532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34533" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.83em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34534"><span class="mo" id="MathJax-Span-34535" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.43em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.476em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-34537"><span class="mrow" id="MathJax-Span-34538"><span class="mi" id="MathJax-Span-34539" style="font-family: MathJax_Main-bold;">o<span style="font-family: MathJax_Main-bold;">r</span></span></span></span><span class="mfrac" id="MathJax-Span-34540" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.316em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1002.12em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-34541"><span class="mo" id="MathJax-Span-34542" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34544"><span class="mo" id="MathJax-Span-34545" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34546"><span class="mi" id="MathJax-Span-34547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34548" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34550" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34551"><span class="mo" id="MathJax-Span-34552" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.27em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.316em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34554" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-34555" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.99em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34556"><span class="mo" id="MathJax-Span-34557" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34558" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34559"><span class="mo" id="MathJax-Span-34560" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.09em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.134em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34562" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-34563" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 5.812em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005.62em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.825em;"><span class="mrow" id="MathJax-Span-34564"><span class="mi" id="MathJax-Span-34565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34566"><span class="mo" id="MathJax-Span-34567" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34568"><span class="mi" id="MathJax-Span-34569" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34570" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-34571" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34573" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34574" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34575" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-34576" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34578"><span class="mo" id="MathJax-Span-34579" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34580"><span class="mi" id="MathJax-Span-34581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34582" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34584" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34585"><span class="mo" id="MathJax-Span-34586" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.82em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.812em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-34588" style="font-family: MathJax_Main;">.</span><span class="mtext" id="MathJax-Span-34589" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(16.2)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.697em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_7216_2"><mfrac><mrow><mi>d</mi><mi>f</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mo>Δ</mo><mi>f</mi></mrow><mrow><mo>Δ</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>t</mi></mrow></mfrac><mstyle mathvariant="bold" mathsize="normal"><mi>or</mi></mstyle><mfrac><mrow><mo>∂</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mo>Δ</mo><mi>f</mi></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mo>Δ</mo><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac><mo>.</mo><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(16.2)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-642"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_7216_2"><mfrac><mrow><mi>d</mi><mi>f</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mo>Δ</mo><mi>f</mi></mrow><mrow><mo>Δ</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>t</mi></mrow></mfrac><mstyle mathvariant="bold" mathsize="normal"><mi>or</mi></mstyle><mfrac><mrow><mo>∂</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mo>Δ</mo><mi>f</mi></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mo>Δ</mo><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac><mo>.</mo><mtext>        (16.2)</mtext></math></script></p>
<p>These expressions are, of course, not the only way. One can, for example, use <span class="cItalic">f(t</span> − <span class="cItalic">Δt)</span> instead of <span class="cItalic">f</span>(<span class="cItalic">t</span>) above and divide by <span class="cItalic">2Δt.</span> For an equation containing a time derivative, it is now possible to propagate values of an unknown function forward in time in a sequence of Δ<span class="cItalic">t</span>-size steps by solving the system of difference equations (one at each spatial location) for unknown <span class="cItalic">f</span>(<span class="cItalic">t</span> + Δ<span class="cItalic">t</span>). Some initial <a id="page_427"></a>conditions, i.e., values of the unknown function at <span class="cItalic">t</span> = 0, are necessary to start the process. Other information, such as values on the boundary of the domain, might also be required depending on the specific problem.</p>
<p>The computation of <span class="cItalic">f</span>(<span class="cItalic">t</span>+Δ<span class="cItalic">t</span>) can be done easily for so-called <span class="cItalic">explicit</span> schemes when all other values present are taken at the current time and the only unknown in the corresponding difference equation <span class="cItalic">f</span>(<span class="cItalic">t</span> + Δ<span class="cItalic">t</span>) is expressed through these known values. <span class="cItalic">Implicit</span> schemes mix values at current and future times and might use, for example,</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-643-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_722&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_722" overflow="scroll" style="width: 9.051em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.794em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1008.8em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34591"><span class="mfrac" id="MathJax-Span-34592"><span style="display: inline-block; position: relative; width: 8.589em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1008.39em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -4.213em;"><span class="mrow" id="MathJax-Span-34593"><span class="mi" id="MathJax-Span-34594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34595"><span class="mo" id="MathJax-Span-34596" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34597"><span class="mi" id="MathJax-Span-34598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34599" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-34600" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34601" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34602" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34604" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-34605" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34606" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34607" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-34608" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-34609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34610"><span class="mo" id="MathJax-Span-34611" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-34612"><span class="mi" id="MathJax-Span-34613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-34614" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-34615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34616" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-34617" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34618" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-34619" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-34620"><span class="mo" id="MathJax-Span-34621" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1008.6em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.589em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.697em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_722"><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mo>Δ</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac></math></span></span><script type="math/mml" id="MathJax-Element-643"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_722"><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mo>Δ</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>+</mo><mo>Δ</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow><mrow><mo>Δ</mo><mi>x</mi></mrow></mfrac></math></script></p>
<p>as an approximation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-644-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_74&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_74" style="width: 1.185em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.877em, 1001.14em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34624"><span class="mfrac" id="MathJax-Span-34625"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-34626"><span class="mo" id="MathJax-Span-34627" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-34629"><span class="mo" id="MathJax-Span-34630" style="font-size: 70.7%; font-family: MathJax_Main;">∂</span><span class="mi" id="MathJax-Span-34631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.928em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_74"><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></math></span></span><script type="math/mml" id="MathJax-Element-644"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_74"><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></math></script>. In this case one has to solve a system of algebraic equations at each step.</p>
<p>The choice of difference scheme can dramatically affect all aspects of the algorithm. The most obvious among them is <span class="cItalic">accuracy.</span> In the limit Δ<span class="cItalic">t</span> → 0 or Δ<span class="cItalic">x</span> → 0, expressions of the type in Equation (16.2) are exact, but for finite step size some schemes allow better approximation of the derivative than others. <span class="cItalic">Stability</span> of a difference scheme is related to how fast numerical errors, which are always present in practice, can grow with time. For stable schemes this growth is bounded, while for unstable ones it is exponential and can quickly overwhelm the solution one seeks (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-24">Figure 16.24</a>). It is important to realize that while some inaccuracy in the solution is tolerable (and, in fact, accuracy demanded in physics and engineering is rarely needed for animation), an unstable result is completely <a id="page_428"></a>meaningless, and one should avoid using unstable schemes. Generally, explicit schemes are either unstable or can become unstable at larger step sizes while implicit ones are unconditionally stable. Implicit schemes allows greater step size (and, therefore, fewer steps) which is why they are popular despite the need to solve a system of algebraic equations at each step. Explicit schemes are attractive because of their simplicity if their stability conditions can be satisfied. Developing a good difference scheme and corresponding algorithm for a specific problem is not easy, and for most standard situations it is well advised to use an existing method. Ample literature discussing details of these techniques is available.</p>
<div id="art_Dest_fig_16-24" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-24"></a><span class="cBold">Figure 16.24</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-24.png" alt="Figure showing an unstable solution might follow the exact one initially, but can deviate arbitrarily far from it with time. Accuracy of a stable solution might still be insufficient for a specific application." width="410" height="274" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-24.png"></p>
<p class="Text figcaption">An unstable solution might follow the exact one initially, but can deviate arbitrarily far from it with time. Accuracy of a stable solution might still be insufficient for a specific application.</p>
</div>
<p>One should remember that, in many cases, just computing all necessary terms in the equation is a difficult and time-consuming task on its own. In rigid body or cloth simulation, for example, most of the forces acting on the system are due to collisions among objects. At each step during animation, one therefore has to solve a purely geometric, but very nontrivial, problem of collision detection. In such conditions, schemes which require fewer evaluations of such forces might provide significant computational savings.</p>
<p>Although the result of solving appropriate time-dependant equations gives very realistic motion, this approach has its limitations. First of all, it is very hard to control the result of physics-based animation. Fundamental mathematical properties of these equations state that once the initial conditions are set, the solution is uniquely defined. This does not leave much room for animator input and, if the result is not satisfactory for some reason, one has only a few options. They are mostly limited to adjusting initial condition used, changing physical properties of the system, or even modifying the equations themselves by introducing artificial terms intended to “drive” the solution in the direction the animator wants. Making such changes requires significant skill as well as understanding of the underlying physics and, ideally, numerical methods. Without this knowledge, the realism provided by physics-based animation can be destroyed or severe numerical problems might appear.</p>
<h2><a id="sec16-6"></a>16.6 Procedural Techniques</h2>
<p>Imagine that one could write (and implement on a computer) a mathematical function which outputs precisely the desired motion given some animator guidance. Physics-based techniques outlined above can be treated as a special case of such an approach when the “function” involved is the procedure to solve a particular differential equation and “guidance” is the set of initial and boundary conditions, extra equation terms, etc.</p>
<p><a id="page_429"></a>However, if we are only concerned with the final result, we do not have to follow a physics-based approach. For example, a simple constant amplitude wave on the surface of a lake can be directly created by applying the function <span class="cItalic">f(<span class="cBold">x</span>, t)</span> = <span class="cItalic">A</span> cos(<span class="cItalic">ωt</span> - <span class="cBold">kx</span> + <span class="cItalic">ϕ</span>) with constant frequency <span class="cItalic">ω</span>, wave vector <span class="cBold">k</span> and phase <span class="cItalic">ϕ</span> to get displacement at the 2D point <span class="cBold">x</span> at time <span class="cItalic">t</span>. A collection of such waves with random phases and appropriately chosen amplitudes, frequencies, and wave vectors can result in a very realistic animation of the surface of water without explicitly solving any fluid dynamics equations. It turns out that other rather simple mathematical functions can also create very interesting patterns or objects. Several such functions, most based on lattice noises, have been described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-5">Section 11.5</a>. Adding time dependance to these functions allows us to animate certain complex phenomena much easier and cheaper than with physics-based techniques while maintaining very high visual quality of the results. If <span class="cItalic">noise</span>(<span class="cBold">x</span>) is the underlying pattern-generating function, one can create a time-dependant variant of it by moving the argument position through the lattice. The simplest case is motion with constant speed: <span class="cItalic">timenoise</span>(<span class="cBold">x</span>, <span class="cItalic">t</span>) = <span class="cItalic">noise</span>(<span class="cBold">x</span> + <span class="cBold">v</span><span class="cItalic">t</span>), but more complex motion through the lattice is, of course, also possible and, in fact, more common. One such path, a spiral, is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-25">Figure 16.25</a>. Another approach is to animate parameters used to generate the <span class="cItalic">noise</span> function. This is especially appropriate if the appearance changes significantly with time—a cloud becoming more turbulent, for example. In this way one can animate the dynamic process of formation of clouds using the function which generates static ones.</p>
<div id="art_Dest_fig_16-25" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-25"></a><span class="cBold">Figure 16.25</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-25.png" alt="Figure showing a path through the cube defining procedural noise is traversed to animate the resulting pattern." width="410" height="410" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-25.png"></p>
<p class="Text figcaption">A path through the cube defining procedural noise is traversed to animate the resulting pattern.</p>
</div>
<p>For some procedural techniques, time dependance is a more integral component. The simplest <span class="cItalic">cellular automata</span> operate on a 2D rectangular grid where a binary value is stored at each location (cell). To create a time varying pattern, some user-provided rules for modifying these values are repeatedly applied. Rules typically involve some set of conditions on the current value and that of the cell’s neighbors. For example, the rules of the popular 2D <span class="cItalic">Game of Life</span> cellular automaton invented in 1970 by British mathematician John Conway are the following:</p>
<ol>
<li class="LX">A dead cell (i.e., binary value at a given location is 0) with exactly three live neighbors becomes a live cell (i.e., its value set to 1).</li>
<li class="LX">A live cell with two or three live neighbors stays alive.</li>
<li class="LX">In all other cases, a cell dies or remains dead.</li>
</ol>
<p>Once the rules are applied to all grid locations, a new pattern is created and a new evolution cycle can be started. Three sample snapshots of the live cell distribution at different times are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-26">Figure 16.26</a>. More sophisticated automata <a id="page_430"></a>simultaneously operate on several 3D grids of possibly floating point values and can be used for modeling dynamics of clouds and other gaseous phenomena or biological systems for which this apparatus was originally invented (note the terminology). Surprising pattern complexity can arise from just a few well-chosen rules, but how to write such rules to create the desired behavior is often not obvious. This is a common problem with procedural techniques: there is only limited, if any, guidance on how to create new procedures or even adjust parameters of existing ones. Therefore, a lot of tweaking and learning by trial-and-error (“by experience”) is usually needed to unlock the full potential of procedural methods.</p>
<div id="art_Dest_fig_16-26" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-26"></a><span class="cBold">Figure 16.26</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-26.png" alt="Figure showing several (non-consecutive) stages in the evolution of a Game of Life automaton. Live cells are shown in black. Stable objects, oscillators, traveling patterns, and many other interesting constructions can result from the application of very simple rules." width="600" height="196" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-26.png"></p>
<p class="Text figcaption">Several (non-consecutive) stages in the evolution of a <span class="cItalic">Game of Life</span> automaton. Live cells are shown in black. Stable objects, oscillators, traveling patterns, and many other interesting constructions can result from the application of very simple rules.</p>
<p class="Text figsource"><span class="cItalic">Figure created using a program by Alan Hensel.</span></p>
</div>
<p>Another interesting approach which was also originally developed to describe biological objects is the technique called <span class="cItalic">L-systems</span> (after the name of their original inventor, Astrid Lindenmayer). This approach is based on <span class="cItalic">grammars</span> or sets of recursive rules for rewriting strings of symbols. There are two types of symbols: <span class="cItalic">terminal symbols</span> stand for elements of something we want to represent with a grammar. Depending on their meaning, grammars can describe structure of trees and bushes, buildings and whole cities, or programming and natural languages. In animation, L-systems are most popular for representing plants and corresponding terminals are instructions to the geometric modeling system: put a leaf (or a branch) at a current position—we will use the symbol @ and just draw a circle, move current position forward by some number of units (symbol <span class="cItalic">f</span>), turn current direction 60 degrees around world <span class="cItalic">Z</span>-axis (symbol +), pop (symbol [) or push (symbol]) current position/orientation, etc. Auxiliary <span class="cItalic">nonterminal symbols</span> (denoted by capital letters) have only semantic rather than any direct meaning. They are intended to be eventually rewritten through terminals. We start from the special nonterminal start symbol <span class="cItalic">S</span> and keep applying grammar rules to the current string in parallel, i.e., replace all nonterminals currently present to get the new <a id="page_431"></a>string, until we end up with a string containing only terminals and no more substitution is therefore possible. This string of modeling instructions is then used to output the actual geometry. For example, a set of rules (productions)</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-645-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_723&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;@&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_723" overflow="scroll" style="width: 6.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.121em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-1.694em, 1005.92em, 5.401em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34633"><span class="mtable" id="MathJax-Span-34634" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.812em; height: 0px;"><span style="position: absolute; clip: rect(4.013em, 1005.82em, 11.005em, -1000.01em); top: -7.71em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.812em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1002.89em, 4.167em, -1000.01em); top: -6.836em; left: 0em;"><span class="mtd" id="MathJax-Span-34635"><span class="mrow" id="MathJax-Span-34636"><span class="mrow" id="MathJax-Span-34637"><span class="mi" id="MathJax-Span-34638" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34639" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mi" id="MathJax-Span-34640" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">A</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1005.82em, 4.424em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-34641"><span class="mrow" id="MathJax-Span-34642"><span class="mrow" id="MathJax-Span-34643"><span class="mi" id="MathJax-Span-34644" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-34645" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mrow" id="MathJax-Span-34646" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34647" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34648"><span class="mo" id="MathJax-Span-34649" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34650" style="font-family: MathJax_Math-italic;">B</span></span><span class="mo" id="MathJax-Span-34651" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34652" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34653" style="font-family: MathJax_Math-italic;">A</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1003.04em, 4.167em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-34654"><span class="mrow" id="MathJax-Span-34655"><span class="mrow" id="MathJax-Span-34656"><span class="mi" id="MathJax-Span-34657" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-34658" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mi" id="MathJax-Span-34659" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">B</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1003.61em, 4.373em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-34660"><span class="mrow" id="MathJax-Span-34661"><span class="mrow" id="MathJax-Span-34662"><span class="mi" id="MathJax-Span-34663" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-34664" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mi" id="MathJax-Span-34665" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34666" style="font-family: MathJax_Math-italic;">B</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1003.56em, 4.373em, -1000.01em); top: -1.077em; left: 0em;"><span class="mtd" id="MathJax-Span-34667"><span class="mrow" id="MathJax-Span-34668"><span class="mrow" id="MathJax-Span-34669"><span class="mi" id="MathJax-Span-34670" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-34671" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mi" id="MathJax-Span-34672" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34673" style="font-family: MathJax_Main;">@</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.715em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.281em; border-left: 0px solid; width: 0px; height: 7.099em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_723"><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>S</mi><mo>→</mo><mi>A</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>A</mi><mo>→</mo><mrow><mo>[</mo><mrow><mo>+</mo><mi>B</mi></mrow><mo>]</mo></mrow><mi>f</mi><mi>A</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>B</mi><mo>→</mo><mi>f</mi><mi>B</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>B</mi><mo>→</mo><mi>f</mi><mo>@</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-645"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_723"><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>S</mi><mo>→</mo><mi>A</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>A</mi><mo>→</mo><mrow><mo>[</mo> <mrow><mo>+</mo><mi>B</mi></mrow> <mo>]</mo></mrow><mi>f</mi><mi>A</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>B</mi><mo>→</mo><mi>f</mi><mi>B</mi></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>B</mi><mo>→</mo><mi>f</mi><mo>@</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>might result in the following sequence of rewriting steps demonstrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-27">Figure 16.27</a>:</p>
<div id="art_Dest_fig_16-27" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-27"></a><span class="cBold">Figure 16.27</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-27.png" alt="Figure showing consecutive derivation steps using a simple L-system. Capital letters denote nonterminals and illustrate positions at which corresponding nonterminal will be expanded. They are not part of the actual output." width="410" height="612" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-27.png"></p>
<p class="Text figcaption">Consecutive derivation steps using a simple L-system. Capital letters denote nonterminals and illustrate positions at which corresponding nonterminal will be expanded. They are not part of the actual output.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-646-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_724&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;@&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;@&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;@&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;@&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_724" overflow="scroll" style="width: 38.358em; display: inline-block;"><span style="display: inline-block; position: relative; width: 37.227em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1037.13em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34675"><span class="mi" id="MathJax-Span-34676" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34677" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mi" id="MathJax-Span-34678" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">A</span><span class="mo" id="MathJax-Span-34679" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-34680" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34681" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34682"><span class="mo" id="MathJax-Span-34683" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34684" style="font-family: MathJax_Math-italic;">B</span></span><span class="mo" id="MathJax-Span-34685" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34686" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34687" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-34688" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-34689" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34690" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34691"><span class="mo" id="MathJax-Span-34692" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34693" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34694" style="font-family: MathJax_Math-italic;">B</span></span><span class="mo" id="MathJax-Span-34695" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34696" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34697" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34698" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34699"><span class="mo" id="MathJax-Span-34700" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34701" style="font-family: MathJax_Math-italic;">B</span></span><span class="mo" id="MathJax-Span-34702" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34703" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34704" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-34705" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-34706" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34707" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34708"><span class="mo" id="MathJax-Span-34709" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34710" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34711" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34712" style="font-family: MathJax_Main;">@</span></span><span class="mo" id="MathJax-Span-34713" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34714" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34715" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34716" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34717"><span class="mo" id="MathJax-Span-34718" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34719" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34720" style="font-family: MathJax_Math-italic;">B</span></span><span class="mo" id="MathJax-Span-34721" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34722" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34723" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-34724" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-34725" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-34726" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34727"><span class="mo" id="MathJax-Span-34728" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34729" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34730" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34731" style="font-family: MathJax_Main;">@</span></span><span class="mo" id="MathJax-Span-34732" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34733" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-34734" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-34735" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-34736"><span class="mo" id="MathJax-Span-34737" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34738" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34739" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34740" style="font-family: MathJax_Main;">@</span></span><span class="mo" id="MathJax-Span-34741" style="font-family: MathJax_Main;">]</span></span><span class="mi" id="MathJax-Span-34742" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-34743" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34744" style="font-family: MathJax_Main;">@</span><span class="mo" id="MathJax-Span-34745" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_724"><mi>S</mi><mo>↦</mo><mi>A</mi><mo>↦</mo><mrow><mo>[</mo><mrow><mo>+</mo><mi>B</mi></mrow><mo>]</mo></mrow><mi>f</mi><mi>A</mi><mo>↦</mo><mrow><mo>[</mo><mrow><mo>+</mo><mi>f</mi><mi>B</mi></mrow><mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo><mrow><mo>+</mo><mi>B</mi></mrow><mo>]</mo></mrow><mi>f</mi><mi>A</mi><mo>↦</mo><mrow><mo>[</mo><mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow><mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo><mrow><mo>+</mo><mi>f</mi><mi>B</mi></mrow><mo>]</mo></mrow><mi>f</mi><mi>B</mi><mo>↦</mo><mrow><mo>[</mo><mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow><mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo><mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow><mo>]</mo></mrow><mi>f</mi><mi>f</mi><mo>@</mo><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-646"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_724"><mi>S</mi><mo>↦</mo><mi>A</mi><mo>↦</mo><mrow><mo>[</mo> <mrow><mo>+</mo><mi>B</mi></mrow> <mo>]</mo></mrow><mi>f</mi><mi>A</mi><mo>↦</mo><mrow><mo>[</mo> <mrow><mo>+</mo><mi>f</mi><mi>B</mi></mrow> <mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo> <mrow><mo>+</mo><mi>B</mi></mrow> <mo>]</mo></mrow><mi>f</mi><mi>A</mi><mo>↦</mo><mrow><mo>[</mo> <mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow> <mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo> <mrow><mo>+</mo><mi>f</mi><mi>B</mi></mrow> <mo>]</mo></mrow><mi>f</mi><mi>B</mi><mo>↦</mo><mrow><mo>[</mo> <mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow> <mo>]</mo></mrow><mi>f</mi><mrow><mo>[</mo> <mrow><mo>+</mo><mi>f</mi><mi>f</mi><mo>@</mo></mrow> <mo>]</mo></mrow><mi>f</mi><mi>f</mi><mo>@</mo><mo>.</mo></math></script></p>
<p>As shown above, there are typically many different productions for the same nonterminal allowing the generation of many different objects with the same grammar. The choice of which rule to apply can depend on which symbols are located next to the one being replaced (context-sensitivity) or can be performed at random with some assigned probability for each rule (stochastic L-systems). More complex rules can model interaction with the environment, such as pruning to a particular shape, and parameters can be associated with symbols to control geometric commands issued.</p>
<p>L-systems already capture plant topology changes with time: each intermediate string obtained in the rewriting process can be interpreted as a “younger” version of the plant (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-27">Figure 16.27</a>). For more significant changes, different productions can be in effect at different times allowing the structure of the plant to change significantly as it grows. A young tree, for example, produces a lot of new branches, while an older one branches only moderately.</p>
<p>Very realistic plant models have been created with L-systems. However, as with most procedural techniques, one needs some experience to meaningfully apply existing L-systems, and writing new grammars to capture some desired effect is certainly not easy.</p>
<h2><a id="sec16-7"></a>16.7 Groups of Objects</h2>
<p>To animate multiple objects one can, of course, simply apply standard techniques described in the chapter so far to each of them. This works reasonably well for a moderate number of independent objects whose desired motion is known in <a id="page_432"></a>advance. However, in many cases, some kind of coordinated action in a dynamic environment is necessary. If only a few objects are involved, the animator can use an artificial intelligence (AI)-based system to automatically determine immediate tasks for each object based on some high-level goal, plan necessary motion, and execute the plan. Many modern games use such <span class="cItalic">autonomous objects</span> to create smart monsters or player’s collaborators.</p>
<p>Interestingly, as the number of objects in a group grows from just a few to several dozens, hundreds, and thousands, individual members of a group must have only very limited “intelligence” in order for the group as a whole to exhibit what looks like coordinated goal-driven motion. It turns out that this <span class="cItalic">flocking</span> is <span class="cItalic">emergent behavior</span> which can arise as a result of limited interaction of group members with just a few of their closest neighbors (Reynolds, 1987). Flocking should be familiar to anyone who has observed the fascinatingly synchronized motion of a flock of birds or a school of fish. The technique can also be used to control groups of animals moving over terrain or even a human crowd.</p>
<p>At any given moment, the motion of a member of a group, often called boid when applied to flocks, is the result of balancing several often contradictory tendencies, each of which suggests its own velocity vector (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-28">Figure 16.28</a>). First, there are external physical forces <span class="cItalic">F</span> acting on the boid, such as gravity or wind. New velocity due to those forces can be computed directly through Newton’s law as</p>
<div id="art_Dest_fig_16-28" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-28"></a><span class="cBold">Figure 16.28</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-28.png" alt="Figure showing (left) Individual flock member (boid) can experience several urges of different importance (shown by line thickness) which have to be negotiated into a single velocity vector. A boid is aware of only its limited neighborhood (circle). (Right) Boid control is commonly implemented as three separate modules." width="600" height="316" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-28.png"></p>
<p class="Text figcaption">(Left) Individual flock member (boid) can experience several urges of different importance (shown by line thickness) which have to be negotiated into a single velocity vector. A boid is aware of only its limited neighborhood (circle). (Right) Boid control is commonly implemented as three separate modules.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-647-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_72512a&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mtext&gt;v&lt;/mtext&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;italic&quot;&gt;new&lt;/mtext&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;italic&quot;&gt;physics&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;v&lt;/mtext&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;old&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;F&lt;/mtext&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_72512a" overflow="scroll" style="width: 10.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.594em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1010.5em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-34747"><span class="mrow" id="MathJax-Span-34748"><span class="msubsup" id="MathJax-Span-34749"><span style="display: inline-block; position: relative; width: 2.933em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-34750" style="font-family: MathJax_Main;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.38em, 4.321em, -1000.01em); top: -4.522em; left: 0.517em;"><span class="mrow" id="MathJax-Span-34751"><span class="mtext" id="MathJax-Span-34752" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p<span style="font-family: MathJax_Math-italic;">h</span><span style="font-family: MathJax_Math-italic;">y</span><span style="font-family: MathJax_Math-italic;">s</span><span style="font-family: MathJax_Math-italic;">i</span><span style="font-family: MathJax_Math-italic;">c</span><span style="font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.35em, 4.167em, -1000.01em); top: -3.854em; left: 0.517em;"><span class="mrow" id="MathJax-Span-34753"><span class="mtext" id="MathJax-Span-34754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n<span style="font-family: MathJax_Math-italic;">e</span><span style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34755" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-34756" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.596em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-34757" style="font-family: MathJax_Main-bold;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34758"><span class="mi" id="MathJax-Span-34759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o<span style="font-family: MathJax_Math-italic;">l</span><span style="font-family: MathJax_Math-italic;">d</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-34760" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mtext" id="MathJax-Span-34761" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">F</span><span class="mo" id="MathJax-Span-34762" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-34763" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-34764" style="font-family: MathJax_Main;">/</span><span class="mi" id="MathJax-Span-34765" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-34766" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_72512a"><mrow><msubsup><mtext>v</mtext><mrow><mtext mathvariant="italic">new</mtext></mrow><mrow><mtext mathvariant="italic">physics</mtext></mrow></msubsup><mo>=</mo><msub><mtext mathvariant="bold">v</mtext><mrow><mi mathvariant="italic">old</mi></mrow></msub><mo>+</mo><mtext mathvariant="bold">F</mtext><mo>Δ</mo><mi>t</mi><mo>/</mo><mi>m</mi><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-647"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_72512a"><mrow><msubsup><mtext>v</mtext><mrow><mtext mathvariant="italic">new</mtext></mrow><mrow><mtext mathvariant="italic">physics</mtext></mrow></msubsup><mo>=</mo><msub><mtext mathvariant="bold">v</mtext><mrow><mi mathvariant="italic">old</mi></mrow></msub><mo>+</mo><mtext mathvariant="bold">F</mtext><mo>Δ</mo><mi>t</mi><mo>/</mo><mi>m</mi><mo>.</mo></mrow></math></script></p>
<p><a id="page_433"></a>Second, a boid should react to global environment and to the behavior of other group members. Collision avoidance is one of the main results of such interaction. It is crucial for flocking that each group member has only limited field of view, and therefore is aware only of things happening within some neighborhood of its current position. To avoid objects in the environment, the simplest, if imperfect, strategy is to set up a limited extent repulsive force field around each such object. This will create a second desired velocity vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-648-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_75&quot;&gt;&lt;msubsup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;_&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_75" style="width: 3.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.55em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1003.56em, 2.419em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34768"><span class="msubsup" id="MathJax-Span-34769"><span style="display: inline-block; position: relative; width: 3.55em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34770"><span class="mrow" id="MathJax-Span-34771"><span class="mi" id="MathJax-Span-34772" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.94em, 4.219em, -1000.01em); top: -4.419em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34773"><span class="mi" id="MathJax-Span-34774" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-34775" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-34776" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-34777" style="font-size: 70.7%; font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-34778" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-34779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-34780" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-34781" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-34782" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.35em, 4.167em, -1000.01em); top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34783"><span class="mi" id="MathJax-Span-34784" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-34785" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-34786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.209em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_75"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>c</mi><mi>o</mi><mi>l</mi><mo>_</mo><mi>a</mi><mi>v</mi><mi>o</mi><mi>i</mi><mi>d</mi></mrow></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-648"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_75"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>c</mi><mi>o</mi><mi>l</mi><mo>_</mo><mi>a</mi><mi>v</mi><mi>o</mi><mi>i</mi><mi>d</mi></mrow></msubsup></math></script>, also given by Newton’s law. Interaction with other group members can be modeled by simultaneously applying different steering behaviors resulting in several additional desired velocity vectors <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-649-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_76&quot;&gt;&lt;msubsup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_76" style="width: 2.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1002.27em, 2.419em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34788"><span class="msubsup" id="MathJax-Span-34789"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34790"><span class="mrow" id="MathJax-Span-34791"><span class="mi" id="MathJax-Span-34792" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.66em, 4.167em, -1000.01em); top: -4.368em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34793"><span class="mi" id="MathJax-Span-34794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-34795" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-34796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-34797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-34798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.35em, 4.167em, -1000.01em); top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34799"><span class="mi" id="MathJax-Span-34800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-34801" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-34802" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.209em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_76"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>e</mi><mi>e</mi><mi>r</mi></mrow></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-649"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_76"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>e</mi><mi>e</mi><mi>r</mi></mrow></msubsup></math></script>. Moving away from neighbors to avoid crowding, steering toward flock mates to ensure flock cohesion, and adjusting a boid’s speed to align with average heading of neighbors are most common. Finally, some additional desired velocity vectors <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-650-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_77&quot;&gt;&lt;msubsup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_77" style="width: 2.008em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1001.97em, 2.419em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-34804"><span class="msubsup" id="MathJax-Span-34805"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-34806"><span class="mrow" id="MathJax-Span-34807"><span class="mi" id="MathJax-Span-34808" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.35em, 4.321em, -1000.01em); top: -4.522em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34809"><span class="mi" id="MathJax-Span-34810" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-34811" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-34812" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-34813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1001.35em, 4.167em, -1000.01em); top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-34814"><span class="mi" id="MathJax-Span-34815" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-34816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-34817" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.209em; border-left: 0px solid; width: 0px; height: 1.274em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_77"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>g</mi><mi>o</mi><mi>a</mi><mi>l</mi></mrow></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-650"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_77"><msubsup><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow><mrow><mi>g</mi><mi>o</mi><mi>a</mi><mi>l</mi></mrow></msubsup></math></script> are usually applied to achieve needed global goals. These can be vectors along some path in space, following some specific designated leader of the flock, or simply representing migratory urge of a flock member.</p>
<p>Once all <span class="cBold">v</span><span class="cItalic"><span class="cSubscript">new</span></span> are determined, the final desired vector is negotiated based on priorities among them. Collision avoidance and velocity matching typically have higher priority. Instead of simple averaging of desired velocity vectors which can lead to cancellation of urges and unnatural “moving nowhere” behavior, an acceleration allocation strategy is used. Some fixed total amount of acceleration is made available for a boid and fractions of it are being given to each urge in order of priority. If the total available acceleration runs out, some lower priority urges will have less effect on the motion or be completely ignored. The hope is that once the currently most important task (collision avoidance in most situations) is accomplished, other tasks can be taken care of in near future. It is also important to respect some physical limitations of real objects, for example, clamping too high accelerations or speeds to some realistic values. Depending on the internal complexity of the flock member, the final stage of animation might be to turn the negotiated velocity vector into a specific set of parameters (bird’s wing positions, orientation of plane model in space, leg skeleton bone configuration) used to control a boid’s motion. A diagram of a system implementing flocking is shown on <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#Text_Anchor_fig_16-28">Figure 16.28</a> (right).</p>
<p>A much simpler, but still very useful, version of group control is implemented by <span class="cItalic">particle systems</span> (Reeves, 1983). The number of particles in a system is typically much larger than number of boids in a flock and can be in the tens or hundreds of thousands, or even more. Moreover, the exact number of particles can fluctuate during animation with new particles being born and some of the old ones destroyed at each step. Particles are typically completely independent from <a id="page_434"></a>each other, ignoring one’s neighbors and interacting with the environment only by experiencing external forces and collisions with objects, <span class="cItalic">not</span> through collision avoidance as was the case for flocks. At each step during animation, the system first creates new particles with some initial parameters, terminates old ones, and then computes necessary forces and updates velocities and positions of the remaining particles according to Newton’s law.</p>
<div id="art_Dest_fig_16-29" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_16-29"></a><span class="cBold">Figure 16.29</span></p>
<p class="ObjectLine"><img src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/fig16-29.png" alt="Figure showing after being emitted by a directional source, particles collide with an object and then are blown down by a local wind field once they clear the obstacle." width="600" height="335" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig16-29.png"></p>
<p class="Text figcaption">After being emitted by a directional source, particles collide with an object and then are blown down by a local wind field once they clear the obstacle.</p>
</div>
<p>All parameters of a particle system (number of particles, particle life span, initial velocity, and location of a particle, etc.) are usually under the direct control of the animator. Prime applications of particle systems include modeling fireworks, explosions, spraying liquids, smoke and fire, or other fuzzy objects and phenomena with no sharp boundaries. To achieve a realistic appearance, it is important to introduce some randomness to all parameters, for example, having a random number of particles born (and destroyed) at each step with their velocities generated according to some distribution. In addition to setting appropriate initial parameters, controlling the motion of a particle system is commonly done by creating a specific force pattern in space—blowing a particle in a new direction once it reaches some specific location or adding a center of attraction, for example. One should remember that with all their advantages, simplicity of implementation and ease of control being the prime ones, particle systems typically do not provide the level of realism characteristic of true physics-based simulation of the same phenomena.</p>
<h2><a id="sec16-8"></a>Notes</h2>
<p>In this chapter we have concentrated on techniques used in 3D animation. There also exist a rich set of algorithms to help with 2D animation production and post-<a id="page_435"></a>processing of images created by computer graphics rendering systems. These include techniques for cleaning up scanned-in artist drawings, feature extraction, automatic 2D in-betweening, colorization, image warping, enhancement and compositing, and many others.</p>
<p>One of the most significant developments in the area of computer animation has been the increasing power and availability of sophisticated animation systems. While different in their specific set of features, internal structure, details of user interface, and price, most such systems include extensive support not only for animation, but also for modeling and rendering, turning them into complete production platforms. It is also common to use these systems to create still images. For example, many images for figures in this section were produced using Maya software generously donated by Alias.</p>
<p>Large-scale animation production is an extremely complex process which typically involves a combined effort by dozens of people with different backgrounds spread across many departments or even companies. To better coordinate this activity, a certain production pipeline is established which starts with a story and character sketches, proceeds to record necessary sound, build models, and rig characters for animation. Once actual animation commences, it is common to go back and revise the original designs, models, and rigs to fix any discovered motion and appearance problems. Setting up lighting and material properties is then necessary, after which it is possible to start rendering. In most sufficiently complex projects, extensive postprocessing and compositing stages bring together images from different sources and finalize the product.</p>
<p>We conclude this chapter by reminding the reader that in the field of computer animation, any technical sophistication is secondary to a good story, expressive characters, and other artistic factors, most of which are hard or simply impossible to quantify. It is safe to say that Snow White and her seven dwarfs will always share the screen with green ogres and donkeys, and most of the audience will be much more interested in the characters and the story rather than in which, if any, computers (and in what exact way) helped to create them.</p>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-13" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C015.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 15 Curves</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C017.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 17 Using Graphics Hardware</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 16 Computer Animation - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C016.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_SansSerif-italic, sans-serif;"></div></div></body></html>