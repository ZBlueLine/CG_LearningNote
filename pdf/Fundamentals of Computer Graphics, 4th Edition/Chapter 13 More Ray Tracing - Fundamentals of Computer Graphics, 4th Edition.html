<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><style type="text/css" title="ibis-book"></style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Script; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav  scalefonts subscribe-panel library nav-collapsed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 12 Data Structures for Graphics</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 14 Sampling</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 13</p>
<h1>More Ray Tracing</h1>
<p><a id="page_322"></a><a id="page_323"></a>A ray tracer is a great substrate on which to build all kinds of advanced rendering effects. Many effects that take significant work to fit into the object-order rasterization framework, including basics like the shadows and reflections already presented in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>, are simple and elegant in a ray tracer. In this chapter, we discuss some fancier techniques that can be used to ray-trace a wider variety of scenes and to include a wider variety of effects. Some extensions allow more general geometry: instancing and constructive solid geometry (CSG) are two ways to make models more complex with minimal complexity added to the program. Other extensions add to the range of materials we can handle: refraction through transparent materials, like glass and water, and glossy reflections on a variety of surfaces are essential for realism in many scenes.</p>
<p>This chapter also discusses the general framework of <span class="cItalic">distribution ray tracing</span> (Cook, Porter, &amp; Carpenter, 1984), a powerful extension to the basic ray-tracing idea in which multiple random rays are sent through each pixel in an image to produce images with smooth edges and to simply and elegantly (if slowly) produce a wide range of effects from soft shadows to camera depth-of-field.</p>
<p>The price of the elegance of ray tracing is exacted in terms of computer time: most of these extensions will trace a very large number of rays for any nontrivial scene. Because of this, it’s crucial to use the methods described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml">Chapter 12</a> to accelerate the tracing of rays.</p>
<div class="Sidebar">
<p class="SidebarText">If you start with a brute-force ray intersection loop, you’ll have ample time to implement an acceleration structure while you wait for images to render.</p>
</div>
<h2><a id="page_324"></a><a id="sec13-1"></a>13.1 Transparency and Refraction</h2>
<p>In <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>, we discussed the use of recursive ray tracing to compute specular, or mirror, reflection from surfaces. Another type of specular object is a <span class="cItalic">dielectric</span>—a transparent material that refracts light. Diamonds, glass, water, and air are dielectrics. Dielectrics also filter light; some glass filters out more red and blue light than green light, so the glass takes on a green tint. When a ray travels from a medium with refractive index <span class="cItalic">n</span> into one with a refractive index <span class="cItalic">n<span class="cSubscript">t</span></span>, some of the light is transmitted, and it bends. This is shown for <span class="cItalic">n<span class="cSubscript">t</span></span> &gt; <span class="cItalic">n</span> in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-1">Figure 13.1</a>. Snell’s Law tells us that</p>
<div id="art_Dest_fig_13-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-1"></a><span class="cBold">Figure 13.1</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-1.png" alt="Figure showing snell’s Law describes how the angle ϕ depends on the angle θ and the refractive indices of the object and the surrounding medium." width="600" height="437" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-1.png"></p>
<p class="Text figcaption">Snell’s Law describes how the angle <span class="cItalic">ϕ</span> depends on the angle <span class="cItalic">θ</span> and the refractive indices of the object and the surrounding medium.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-438-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_533&quot;&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_533" overflow="scroll" style="width: 8.486em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.229em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1008.13em, 2.47em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-23992"><span class="mrow" id="MathJax-Span-23993"><span class="mi" id="MathJax-Span-23994" style="font-family: MathJax_Math-italic;">n</span><span class="mtext" id="MathJax-Span-23995" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23996" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-23997" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mtext" id="MathJax-Span-23998" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23999" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-24000" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-24001" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24002" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-24003" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-24004" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-24005" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24006" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-24007" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.262em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_533"><mrow><mi>n</mi><mtext>&nbsp;</mtext><mi>sin</mi><mo>&nbsp;​⁡</mo><mtext>&nbsp;</mtext><mi>θ</mi><mo>=</mo><msub><mi>n</mi><mi>t</mi></msub><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-438"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_533"><mrow><mi>n</mi><mtext> </mtext><mi>sin</mi><mo> ​⁡</mo><mtext> </mtext><mi>θ</mi><mo>=</mo><msub><mi>n</mi><mi>t</mi></msub><mi>sin</mi><mo> ​⁡</mo><mi>ϕ</mi><mo>.</mo></mrow></math></script></p>
<p>Computing the sine of an angle between two vectors is usually not as convenient as computing the cosine, which is a simple dot product for the unit vectors such as we have here. Using the trigonometric identity sin<span class="cSuperscript">2</span> <span class="cItalic">θ</span> + cos<span class="cSuperscript">2</span> <span class="cItalic">θ</span> = 1, we can derive a refraction relationship for cosines:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-439-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_534&quot;&gt;&lt;msup&gt;&lt;mtext&gt;cos&lt;/mtext&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_534" overflow="scroll" style="width: 11.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.697em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.26em, 1010.6em, 2.933em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24009"><span class="msup" id="MathJax-Span-24010"><span style="display: inline-block; position: relative; width: 1.751em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.3em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-24011" style="font-family: MathJax_Main;">cos</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.339em;"><span class="mn" id="MathJax-Span-24012" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-24013" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-24014" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-24015" style="font-family: MathJax_Main; padding-left: 0.26em;">1</span><span class="mo" id="MathJax-Span-24016" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mfrac" id="MathJax-Span-24017" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.887em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1004.64em, 4.63em, -1000.01em); top: -4.882em; left: 50%; margin-left: -2.362em;"><span class="mrow" id="MathJax-Span-24018"><span class="msup" id="MathJax-Span-24019"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mn" id="MathJax-Span-24021" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-24022"><span class="mo" id="MathJax-Span-24023" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-24024"><span class="mn" id="MathJax-Span-24025" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24026" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-24027"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1001.66em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-24028"><span class="mi" id="MathJax-Span-24029" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-24030" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.648em;"><span class="mn" id="MathJax-Span-24031" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-24032" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-24033" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.73em, 4.373em, -1000.01em); top: -3.545em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-24034"><span class="msubsup" id="MathJax-Span-24035"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24036" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.265em; left: 0.414em;"><span class="mn" id="MathJax-Span-24037" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.22em, 4.167em, -1000.01em); top: -3.802em; left: 0.414em;"><span class="mi" id="MathJax-Span-24038" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.9em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.887em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24039" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_534"><msup><mtext>cos</mtext><mn>2</mn></msup><mi>ϕ</mi><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mi>n</mi><mi>t</mi><mn>2</mn></msubsup></mrow></mfrac><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-439"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_534"><msup><mtext>cos</mtext><mn>2</mn></msup><mi>ϕ</mi><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mi>cos</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mi>n</mi><mi>t</mi><mn>2</mn></msubsup></mrow></mfrac><mo>.</mo></math></script></p>
<div class="Sidebar">
<p class="SidebarText">Example values of <span class="cItalic">n:</span></p>
<p class="SidebarText">air: 1.00;</p>
<p class="SidebarText">water: 1.33-1.34;</p>
<p class="SidebarText">window glass: 1.51;</p>
<p class="SidebarText">optical glass: 1.49-1.92;</p>
<p class="SidebarText">diamond: 2.42.</p>
</div>
<p>Note that if <span class="cItalic">n</span> and <span class="cItalic">n<span class="cSubscript">t</span></span> are reversed, then so are <span class="cItalic">θ</span> and <span class="cItalic">ϕ</span> as shown on the right of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-1">Figure 13.1</a>.</p>
<p>To convert sin <span class="cItalic">ϕ</span> and cos <span class="cItalic">ϕ</span> into a 3D vector, we can set up a 2D orthonormal basis in the plane of the surface normal, <span class="cBold">n</span>, and the ray direction, <span class="cBold">d</span>.</p>
<p>From <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-2">Figure 13.2</a>, we can see that <span class="cBold">n</span> and <span class="cBold">b</span> form an orthonormal basis for the plane of refraction. By definition, we can describe the direction of the transformed <a id="page_325"></a>ray, <span class="cBold">t</span>, in terms of this basis:</p>
<div id="art_Dest_fig_13-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-2"></a><span class="cBold">Figure 13.2</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-2.png" alt="Figure showing the vectors n and b form a 2D orthonormal basis that is parallel to the transmission vector t." width="401" height="411" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-2.png"></p>
<p class="Text figcaption">The vectors <span class="cBold">n</span> and <span class="cBold">b</span> form a 2D orthonormal basis that is parallel to the transmission vector <span class="cBold">t</span>.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-440-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_535&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;b&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_535" overflow="scroll" style="width: 9.206em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.949em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1008.85em, 2.522em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-24041"><span class="mi" id="MathJax-Span-24042" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-24043" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-24044" style="font-family: MathJax_Main; padding-left: 0.26em;">sin</span><span class="mo" id="MathJax-Span-24045" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24046" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mtext" id="MathJax-Span-24047" style="font-family: MathJax_Main-bold;">b</span><span class="mo" id="MathJax-Span-24048" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-24049" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-24050" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24051" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mtext" id="MathJax-Span-24052" style="font-family: MathJax_Main-bold;">n</span><span class="mo" id="MathJax-Span-24053" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.262em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_535"><mi>t</mi><mo>=</mo><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi><mtext mathvariant="bold">b</mtext><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi><mtext mathvariant="bold">n</mtext><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-440"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_535"><mi>t</mi><mo>=</mo><mi>sin</mi><mo> ​⁡</mo><mi>ϕ</mi><mtext mathvariant="bold">b</mtext><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>ϕ</mi><mtext mathvariant="bold">n</mtext><mo>.</mo></math></script></p>
<p>Since we can describe <span class="cBold">d</span> in the same basis, and <span class="cBold">d</span> is known, we can solve for <span class="cBold">b</span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-441-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_536&quot;&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_536" overflow="scroll" style="width: 11.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.851em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.105em, 1010.6em, 3.602em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24055"><span class="mtable" id="MathJax-Span-24056" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 10.543em; height: 0px;"><span style="position: absolute; clip: rect(2.111em, 1000.63em, 4.887em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -5.036em; right: 0em;"><span class="mtd" id="MathJax-Span-24057"><span class="mrow" id="MathJax-Span-24058"><span class="mstyle" id="MathJax-Span-24059"><span class="mrow" id="MathJax-Span-24060"><span class="mi" id="MathJax-Span-24061" style="font-family: MathJax_Main-bold;">d</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -3.288em; right: 0em;"><span class="mtd" id="MathJax-Span-24080"><span class="mrow" id="MathJax-Span-24081"><span class="mstyle" id="MathJax-Span-24082"><span class="mrow" id="MathJax-Span-24083"><span class="mi" id="MathJax-Span-24084" style="font-family: MathJax_Main-bold;">b</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.162em, 1009.06em, 5.658em, -1000.01em); top: -4.162em; left: 1.442em;"><span style="display: inline-block; position: relative; width: 9.103em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1009.06em, 4.373em, -1000.01em); top: -5.036em; left: 0em;"><span class="mtd" id="MathJax-Span-24062"><span class="mrow" id="MathJax-Span-24063"><span class="mrow" id="MathJax-Span-24064"><span class="mo" id="MathJax-Span-24065" style="font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-24066" style="font-family: MathJax_Main; padding-left: 0.26em;">sin</span><span class="mo" id="MathJax-Span-24067" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24068" style="font-family: MathJax_Math-italic;">θ</span><span class="mstyle" id="MathJax-Span-24069"><span class="mrow" id="MathJax-Span-24070"><span class="mi" id="MathJax-Span-24071" style="font-family: MathJax_Main-bold;">b</span></span></span><span class="mo" id="MathJax-Span-24072" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-24073" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-24074" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24075" style="font-family: MathJax_Math-italic;">θ</span><span class="mstyle" id="MathJax-Span-24076"><span class="mrow" id="MathJax-Span-24077"><span class="mi" id="MathJax-Span-24078" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-24079" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1005.2em, 4.784em, -1000.01em); top: -3.288em; left: 0em;"><span class="mtd" id="MathJax-Span-24085"><span class="mrow" id="MathJax-Span-24086"><span class="mrow" id="MathJax-Span-24087"><span class="mo" id="MathJax-Span-24088" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-24089" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 3.756em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1003.61em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.797em;"><span class="mrow" id="MathJax-Span-24090"><span class="mstyle" id="MathJax-Span-24091"><span class="mrow" id="MathJax-Span-24092"><span class="mi" id="MathJax-Span-24093" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-24094" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mstyle" id="MathJax-Span-24095"><span class="mrow" id="MathJax-Span-24096"><span class="mi" id="MathJax-Span-24097" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mi" id="MathJax-Span-24098" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-24099" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24100" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1001.91em, 4.321em, -1000.01em); top: -3.545em; left: 50%; margin-left: -0.974em;"><span class="mrow" id="MathJax-Span-24101"><span class="mi" id="MathJax-Span-24102" style="font-size: 70.7%; font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-24103" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1003.76em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.756em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24105" style="font-family: MathJax_Main;">.</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.167em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.339em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_536"><mtable><mtr><mtd columnalign="right"><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle></mtd><mtd columnalign="left"><mrow><mo>=</mo><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>θ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mrow><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow></mfrac><mo>.</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-441"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_536"><mtable><mtr><mtd columnalign="right"><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle></mtd><mtd columnalign="left"><mrow><mo>=</mo><mi>sin</mi><mo> ​⁡</mo><mi>θ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mrow><mi>sin</mi><mo> ​⁡</mo><mi>θ</mi></mrow></mfrac><mo>.</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>This means that we can solve for <span class="cBold">t</span> with known variables:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-442-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_537&quot;&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext&gt;n&lt;/mtext&gt;&lt;mtext&gt;cos&lt;/mtext&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow /&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_537" overflow="scroll" style="width: 17.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.661em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.82em, 1016.51em, 4.527em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24107"><span class="mrow" id="MathJax-Span-24108"><span class="mtable" id="MathJax-Span-24109" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 16.352em; height: 0px;"><span style="position: absolute; clip: rect(2.111em, 1000.37em, 5.967em, -1000.01em); top: -4.522em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px;"><span style="position: absolute; clip: rect(3.242em, 1000.37em, 4.167em, -1000.01em); top: -5.602em; right: 0em;"><span class="mtd" id="MathJax-Span-24110"><span class="mrow" id="MathJax-Span-24111"><span class="mrow" id="MathJax-Span-24112"><span class="mstyle" id="MathJax-Span-24113"><span class="mrow" id="MathJax-Span-24114"><span class="mi" id="MathJax-Span-24115" style="font-family: MathJax_Main-bold;">t</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.859em, 1000.01em, 4.167em, -1000.01em); top: -2.722em; right: 0em;"><span class="mtd" id="MathJax-Span-24150"><span class="mrow" id="MathJax-Span-24151"><span class="mrow" id="MathJax-Span-24152"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.527em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1015.08em, 8.435em, -1000.01em); top: -6.013em; left: 1.237em;"><span style="display: inline-block; position: relative; width: 15.118em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1010.86em, 4.63em, -1000.01em); top: -5.602em; left: 0em;"><span class="mtd" id="MathJax-Span-24116"><span class="mrow" id="MathJax-Span-24117"><span class="mrow" id="MathJax-Span-24118"><span class="mo" id="MathJax-Span-24119" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-24120" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1005em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.517em;"><span class="mrow" id="MathJax-Span-24121"><span class="mi" id="MathJax-Span-24122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-24123"><span class="mrow" id="MathJax-Span-24124"><span class="mrow" id="MathJax-Span-24125"><span class="mo" id="MathJax-Span-24126" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-24127"><span class="mstyle" id="MathJax-Span-24128"><span class="mrow" id="MathJax-Span-24129"><span class="mi" id="MathJax-Span-24130" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-24131" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mstyle" id="MathJax-Span-24132"><span class="mrow" id="MathJax-Span-24133"><span class="mi" id="MathJax-Span-24134" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mtext" id="MathJax-Span-24135" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-24136" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-24137" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-24139" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span class="mo" id="MathJax-Span-24140" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.68em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.306em;"><span class="mrow" id="MathJax-Span-24141"><span class="msub" id="MathJax-Span-24142"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-24144" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.2em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.195em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24145" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mtext" id="MathJax-Span-24146" style="font-family: MathJax_Main; padding-left: 0.208em;">n</span><span class="mtext" id="MathJax-Span-24147" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-24148" style="font-family: MathJax_Main;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24149" style="font-family: MathJax_Math-italic;">ϕ</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(1.853em, 1015.08em, 5.144em, -1000.01em); top: -2.722em; left: 0em;"><span class="mtd" id="MathJax-Span-24153"><span class="mrow" id="MathJax-Span-24154"><span class="mrow" id="MathJax-Span-24155"><span class="mo" id="MathJax-Span-24156" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-24157" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.219em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1004.02em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -2.054em;"><span class="mrow" id="MathJax-Span-24158"><span class="mi" id="MathJax-Span-24159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-24160"><span class="mo" id="MathJax-Span-24161" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-24162"><span class="mstyle" id="MathJax-Span-24163"><span class="mrow" id="MathJax-Span-24164"><span class="mi" id="MathJax-Span-24165" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-24166" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mstyle" id="MathJax-Span-24167"><span class="mrow" id="MathJax-Span-24168"><span class="mi" id="MathJax-Span-24169" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mrow" id="MathJax-Span-24170"><span class="mo" id="MathJax-Span-24171" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-24172"><span class="mstyle" id="MathJax-Span-24173"><span class="mrow" id="MathJax-Span-24174"><span class="mi" id="MathJax-Span-24175" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-24176" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mstyle" id="MathJax-Span-24177"><span class="mrow" id="MathJax-Span-24178"><span class="mi" id="MathJax-Span-24179" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span></span><span class="mo" id="MathJax-Span-24180" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-24181" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.68em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.306em;"><span class="mrow" id="MathJax-Span-24182"><span class="msub" id="MathJax-Span-24183"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-24185" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.18em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.219em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24186" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mstyle" id="MathJax-Span-24187" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-24188"><span class="mi" id="MathJax-Span-24189" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="msqrt" id="MathJax-Span-24190"><span style="display: inline-block; position: relative; width: 7.766em; height: 0px;"><span style="position: absolute; clip: rect(2.162em, 1006.7em, 4.836em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-24191"><span class="mrow" id="MathJax-Span-24192"><span class="mn" id="MathJax-Span-24193" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24194" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mfrac" id="MathJax-Span-24195" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1004.28em, 4.63em, -1000.01em); top: -4.882em; left: 50%; margin-left: -2.208em;"><span class="mrow" id="MathJax-Span-24196"><span class="msup" id="MathJax-Span-24197"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mn" id="MathJax-Span-24199" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-24200"><span class="mo" id="MathJax-Span-24201" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-24202"><span class="mn" id="MathJax-Span-24203" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24204" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-24205"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1001.61em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-24206"><span class="mrow" id="MathJax-Span-24207"><span class="mo" id="MathJax-Span-24208" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-24209"><span class="mstyle" id="MathJax-Span-24210"><span class="mrow" id="MathJax-Span-24211"><span class="mi" id="MathJax-Span-24212" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-24213" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mstyle" id="MathJax-Span-24214"><span class="mrow" id="MathJax-Span-24215"><span class="mi" id="MathJax-Span-24216" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span></span><span class="mo" id="MathJax-Span-24217" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.648em;"><span class="mn" id="MathJax-Span-24218" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-24219" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.73em, 4.373em, -1000.01em); top: -3.545em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-24220"><span class="msubsup" id="MathJax-Span-24221"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.265em; left: 0.414em;"><span class="mn" id="MathJax-Span-24223" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.22em, 4.167em, -1000.01em); top: -3.802em; left: 0.414em;"><span class="mi" id="MathJax-Span-24224" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.54em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24225" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1006.8em, 3.961em, -1000.01em); top: -5.704em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 6.789em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 6.069em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.465em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.031em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.596em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.162em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.728em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.293em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.859em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.424em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.99em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 5.555em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.111em, 1001.04em, 5.401em, -1000.01em); top: -4.265em; left: 0em;"><span style="font-family: MathJax_Size4;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.018em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.38em; border-left: 0px solid; width: 0px; height: 5.298em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_537"><mrow><mtable><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>t</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mrow><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mtext>&nbsp;</mtext><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub></mrow></mfrac><mo>−</mo><mtext>n</mtext><mtext>cos</mtext><mo>&nbsp;​⁡</mo><mi>ϕ</mi></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub></mrow></mfrac><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mi>n</mi><mi>t</mi><mn>2</mn></msubsup></mrow></mfrac><mo>.</mo></mrow></msqrt></mrow></mtd></mtr></mtable></mrow></math></span></span><script type="math/mml" id="MathJax-Element-442"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_537"><mrow><mtable><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>t</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mrow> <mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mtext> </mtext><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow> <mo>)</mo></mrow></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub></mrow></mfrac><mo>−</mo><mtext>n</mtext><mtext>cos</mtext><mo> ​⁡</mo><mi>ϕ</mi></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub></mrow></mfrac><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mi>n</mi><mi>t</mi><mn>2</mn></msubsup></mrow></mfrac><mo>.</mo></mrow></msqrt></mrow></mtd></mtr></mtable></mrow></math></script></p>
<p>Note that this equation works regardless of which of <span class="cItalic">n</span> and <span class="cItalic">n<span class="cSubscript">t</span></span> is larger. An immediate question is, “What should you do if the number under the square root is negative?” In this case, there is no refracted ray and all of the energy is reflected. This is known as <span class="cItalic">total internal reflection</span>, and it is responsible for much of the rich appearance of glass objects.</p>
<p>The reflectivity of a dielectric varies with the incident angle according to the <span class="cItalic">Fresnel equations</span>. A nice way to implement something close to the Fresnel equations is to use the <span class="cItalic">Schlick approximation</span> (Schlick, 1994a),</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-443-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_538&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_538" overflow="scroll" style="width: 15.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.53em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1015.49em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24227"><span class="mi" id="MathJax-Span-24228" style="font-family: MathJax_Math-italic;">R</span><span class="mrow" id="MathJax-Span-24229" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-24230" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24231" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-24232" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-24233" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-24234" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24235" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-24236" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24237" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-24238" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-24239" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-24240"><span class="mn" id="MathJax-Span-24241" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24242" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-24243" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24244" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-24245" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-24246" style="font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-24247" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.1em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-24248"><span class="mo" id="MathJax-Span-24249" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-24250"><span class="mn" id="MathJax-Span-24251" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24252" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-24253" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-24254" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-24255" style="font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-24256" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.195em;"><span class="mn" id="MathJax-Span-24257" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24258" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_538"><mi>R</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow><mn>5</mn></msup><mo>,</mo></math></span></span><script type="math/mml" id="MathJax-Element-443"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_538"><mi>R</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow><mn>5</mn></msup><mo>,</mo></math></script></p>
<p>where <span class="cItalic">R</span><span class="cSubscript">0</span> is the reflectance at normal incidence:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-444-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_539&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_539" overflow="scroll" style="width: 6.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.327em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1006.23em, 2.933em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24260"><span class="msub" id="MathJax-Span-24261"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24262" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-24263" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24264" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msup" id="MathJax-Span-24265" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 3.55em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1002.94em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-24266"><span class="mo" id="MathJax-Span-24267" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-24268"><span class="mfrac" id="MathJax-Span-24269"><span style="display: inline-block; position: relative; width: 1.699em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1001.5em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-24270"><span class="msub" id="MathJax-Span-24271"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-24273" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24274" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-24275" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.5em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-24276"><span class="msub" id="MathJax-Span-24277"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-24279" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24280" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-24281" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.71em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.699em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-24282" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 3.139em;"><span class="mn" id="MathJax-Span-24283" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24284" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 2.174em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_539"><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><msup><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>−</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-444"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_539"><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><msup><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>−</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>.</mo></math></script></p>
<p>Note that the cos <span class="cItalic">θ</span> terms above are always for the angle in air (the larger of the internal and external angles relative to the normal).</p>
<p>For homogeneous impurities, as is found in typical colored glass, a light-carrying ray’s intensity will be attenuated according to <span class="cItalic">Beer’s Law</span>. As the ray travels through the medium it loses intensity according to <span class="cItalic">dI</span> = −<span class="cItalic">CI dx</span>, where <span class="cItalic">dx</span> is distance. Thus, <span class="cItalic">dI/dx</span> = −<span class="cItalic">CI</span>. We can solve this equation and get the exponential <span class="cItalic">I</span> = <span class="cItalic">k</span> exp(−<span class="cItalic">Cx</span>). The degree of attenuation is described by the RGB attenuation constant <span class="cItalic">a</span>, which is the amount of attenuation after one unit of distance. Putting in boundary conditions, we know that <span class="cItalic">I</span>(0) = <span class="cItalic">I</span><span class="cSubscript">0</span>, and <span class="cItalic">I</span>(1) = <a id="page_326"></a><span class="cItalic">aI</span>(0). The former implies <span class="cItalic">I(x)</span> = <span class="cItalic">I</span><span class="cSubscript">0</span> exp(−<span class="cItalic">Cx</span>). The latter implies <span class="cItalic">I</span><span class="cSubscript">0</span><span class="cItalic">a</span> = <span class="cItalic">I</span><span class="cSubscript">0</span> exp(−<span class="cItalic">C</span>), so −<span class="cItalic">C</span> = ln(<span class="cItalic">a</span>). Thus, the final formula is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-445-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_540&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_540" overflow="scroll" style="width: 8.897em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.64em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1008.6em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24286"><span class="mi" id="MathJax-Span-24287" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-24288" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-24289" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24290" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-24291" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-24292" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-24293" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-24294" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-24295" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-24296" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24297" style="font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-24298" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 3.087em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24299" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mrow" id="MathJax-Span-24300"><span class="mi" id="MathJax-Span-24301" style="font-size: 70.7%; font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-24302" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-24303"><span class="mo" id="MathJax-Span-24304" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-24306" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-24307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24308" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_540"><mi>I</mi><mrow><mo>(</mo><mi>s</mi><mo>)</mo></mrow><mo>=</mo><mi>I</mi><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><msup><mi>e</mi><mrow><mi>ln</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mi>s</mi></mrow></msup><mo>,</mo></math></span></span><script type="math/mml" id="MathJax-Element-445"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_540"><mi>I</mi><mrow><mo>(</mo><mi>s</mi><mo>)</mo></mrow><mo>=</mo><mi>I</mi><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><msup><mi>e</mi><mrow><mi>ln</mi><mo> ​⁡</mo><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mi>s</mi></mrow></msup><mo>,</mo></math></script></p>
<p>where <span class="cItalic">I</span>(<span class="cItalic">s</span>) is the intensity of the beam at distance <span class="cItalic">s</span> from the interface. In practice, we reverse-engineer <span class="cItalic">a</span> by eye, because such data is rarely easy to find. The effect of Beer’s Law can be seen in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-3">Figure 13.3</a>, where the glass takes on a green tint.</p>
<div id="art_Dest_fig_13-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-3"></a><span class="cBold">Figure 13.3</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-3.png" alt="Figure showing the color of the glass is affected by total internal reflection and Beer’s Law. The amount of light transmitted and reflected is determined by the Fresnel equations. The complex lighting on the ground plane was computed using particle tracing as described in Chapter 23." width="600" height="450" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-3.png"></p>
<p class="Text figcaption">The color of the glass is affected by total internal reflection and Beer’s Law. The amount of light transmitted and reflected is determined by the Fresnel equations. The complex lighting on the ground plane was computed using particle tracing as described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml">Chapter 23</a>.</p>
</div>
<p>To add transparent materials to our code, we need a way to determine when a ray is going “into” an object. The simplest way to do this is to assume that all objects are embedded in air with refractive index very close to 1.0, and that surface normals point “out” (toward the air). The code segment for rays and dielectrics with these assumptions is:</p>
<pre><span class="code"><span class="cBold">if</span> (<span class="cBold">p</span> is on a dielectric) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">r</span> = reflect(<span class="cBold">d</span>, <span class="cBold">n</span>)</span></pre>
<pre><span class="code"> <span class="cBold">if</span> (<span class="cBold">d</span> · <span class="cBold">n</span> &lt; 0) <span class="cBold">then</span></span></pre>
<pre><span class="code"> refract(<span class="cBold">d</span>, <span class="cBold">n</span>, <span class="cItalic">n</span>, <span class="cBold">t</span>)</span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = −<span class="cBold">d</span> · <span class="cBold">n</span></span></pre>
<pre><span class="code"> <span class="cItalic">k<span class="cSubscript">r</span></span> = <span class="cItalic">k<span class="cSubscript">g</span></span> = <span class="cItalic">k<span class="cSubscript">b</span></span> = 1</span></pre>
<pre><span class="code"> <span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cItalic">k<span class="cSubscript">r</span></span> = exp(−<span class="cItalic">a<span class="cSubscript">r</span>t</span>)</span></pre>
<pre><span class="code"> <span class="cItalic">k<span class="cSubscript">g</span></span> = exp(−<span class="cItalic">a<span class="cSubscript">g</span>t</span>)</span></pre>
<pre><span class="code"> <span class="cItalic">k<span class="cSubscript">b</span></span> = exp(−<span class="cItalic">a<span class="cSubscript">b</span>t)</span></span></pre>
<pre><span class="code"> <span class="cBold">if</span> refract(<span class="cBold">d</span>, − <span class="cBold">n</span>, 1/<span class="cItalic">n</span>, <span class="cBold">t</span>) <span class="cBold">then</span></span></pre>
<pre><span class="code">  <span class="cItalic">c</span> = <span class="cBold">t</span> · <span class="cBold">n</span></span></pre>
<pre><span class="code"> <span class="cBold">else</span></span></pre>
<pre><span class="code">  <span class="cBold">return</span> <span class="cItalic">k</span> * color(<span class="cBold">p</span> + <span class="cItalic">t</span><span class="cBold">r</span>)</span></pre>
<pre><span class="code"><span class="cItalic">R</span><span class="cSubscript">0</span> = (<span class="cItalic">n</span> − 1)<span class="cSuperscript">2</span><span class="cItalic">/</span>(<span class="cItalic">n</span> + 1)<span class="cSuperscript">2</span></span></pre>
<pre><span class="code"><a id="page_327"></a><span class="cItalic">R</span> = <span class="cItalic">R</span><span class="cSubscript">0</span> + (1 – <span class="cItalic">R</span><span class="cSubscript">0</span>)(1 − <span class="cItalic">c</span>)<span class="cSuperscript">5</span></span></pre>
<pre><span class="code"><span class="cBold">return</span> <span class="cItalic">k</span>(<span class="cItalic">R</span> color(<span class="cBold">p</span> + <span class="cItalic">t</span><span class="cBold">r</span>) + (1 − <span class="cItalic">R</span>) color(<span class="cBold">p</span> + <span class="cItalic">t</span><span class="cBold">t</span>))</span></pre>
<p>The code above assumes that the natural log has been folded into the constants <span class="cItalic">(a<span class="cSubscript">r</span></span>, <span class="cItalic">a<span class="cSubscript">g</span></span>, <span class="cItalic">a<span class="cSubscript">b</span>)</span>. The <span class="cItalic">refract</span> function returns false if there is total internal reflection, and otherwise it fills in the last argument of the argument list.</p>
<h2><a id="sec13-2"></a>13.2 Instancing</h2>
<p>An elegant property of ray tracing is that it allows very natural <span class="cItalic">instancing</span>. The basic idea of instancing is to distort all points on an object by a transformation matrix before the object is displayed. For example, if we transform the unit circle (in 2D) by a scale factor (2,1) in <span class="cItalic">x</span> and <span class="cItalic">y</span>, respectively, then rotate it by 45°, and move one unit in the <span class="cItalic">x</span>-direction, the result is an ellipse with an eccentricity of 2 and a long axis along the (<span class="cItalic">x</span> = − <span class="cItalic">y</span>)-direction centered at (0,1) (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-4">Figure 13.4</a>). The key thing that makes that entity an “instance” is that we store the circle and the composite transform matrix. Thus, the explicit construction of the ellipse is left as a future operation at render time.</p>
<div id="art_Dest_fig_13-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-4"></a><span class="cBold">Figure 13.4</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-4.png" alt="Figure showing an instance of a circle with a series of three transforms is an ellipse." width="410" height="456" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-4.png"></p>
<p class="Text figcaption">An instance of a circle with a series of three transforms is an ellipse.</p>
</div>
<p>The advantage of instancing in ray tracing is that we can choose the space in which to do intersection. If the base object is composed of a set of points, one of which is <span class="cBold">p</span>, then the transformed object is composed of that set of points transformed by matrix <span class="cBold">M</span>, where the example point is transformed to <span class="cBold">Mp</span>. If we have a ray <span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">b</span> that we want to intersect with the transformed object, we can instead intersect an <span class="cItalic">inverse-transformed ray</span> with the untransformed object (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-5">Figure 13.5</a>). There are two potential advantages to computing in the untransformed space (i.e., the right-hand side of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-5">Figure 13.5</a>):</p>
<div id="art_Dest_fig_13-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-5"></a><span class="cBold">Figure 13.5</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-5.png" alt="Figure showing the ray intersection problem in the two spaces are just simple transforms of each other. The object is specified as a sphere plus matrix M. The ray is specified in the transformed (world) space by location a and direction b." width="600" height="395" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-5.png"></p>
<p class="Text figcaption">The ray intersection problem in the two spaces are just simple transforms of each other. The object is specified as a sphere plus matrix <span class="cBold">M</span>. The ray is specified in the transformed (world) space by location <span class="cBold">a</span> and direction <span class="cBold">b</span>.</p>
</div>
<ol>
<li class="LX">The untransformed object may have a simpler intersection routine, e.g., a sphere versus an ellipsoid.</li>
<li class="LX">Many transformed objects can share the same untransformed object thus reducing storage, e.g., a traffic jam of cars, where individual cars are just transforms of a few base (untransformed) models.</li>
</ol>
<p>As discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C006.xhtml#sec6-2-2">Section 6.2.2</a>, surface normal vectors transform differently. With this in mind and using the concepts illustrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-5">Figure 13.5</a>, we can determine the intersection of a ray and an object transformed by matrix <span class="cBold">M</span>. If we create an instance class of type <span class="cItalic">surface</span>, we need to create a <span class="cItalic">hit</span> function:</p>
<pre><span class="code">instance::hit(ray <span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">b</span>, real <span class="cItalic">t</span><span class="cSubscript">0</span>, real <span class="cItalic">t</span><span class="cSubscript">1</span>, hit-record rec)</span></pre>
<pre><span class="code">ray <span class="cBold">r′</span> = <span class="cBold">M</span><span class="cSuperscript">-1</span><span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">M</span><span class="cSuperscript">-1</span><span class="cBold">b</span></span></pre>
<pre><span class="code"><a id="page_328"></a><span class="cBold">if</span> (base-object<span class="cBold">→</span>hit<span class="cBold">(r′</span>, <span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>, rec)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> rec.<span class="cBold">n</span> = (<span class="cBold">M</span><span class="cSuperscript">−1</span>)<span class="cSuperscript">T</span>rec.<span class="cBold">n</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> true</span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> false</span></pre>
<p>An elegant thing about this function is that the parameter rec. <span class="cItalic">t</span> does not need to be changed, because it is the same in either space. Also note that we need not compute or store the matrix <span class="cBold">M</span>.</p>
<p>This brings up a very important point: the ray direction <span class="cBold">b</span> must <span class="cItalic">not</span> be restricted to a unit-length vector, or none of the infrastructure above works. For this reason, it is useful not to restrict ray directions to unit vectors.</p>
<h2><a id="sec13-3"></a>13.3 Constructive Solid Geometry</h2>
<p>One nice thing about ray tracing is that any geometric primitive whose intersection with a 3D line can be computed can be seamlessly added to a ray tracer. It turns out to also be straightforward to add <span class="cItalic">constructive solid geometry</span> (CSG) to a ray <a id="page_329"></a>tracer (Roth, 1982). The basic idea of CSG is to use set operations to combine solid shapes. These basic operations are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-6">Figure 13.6</a>. The operations can be viewed as <span class="cItalic">set</span> operations. For example, we can consider <span class="cItalic">C</span> the set of all points in the circle and <span class="cItalic">S</span> the set of all points in the square. The intersection operation <span class="cItalic">C</span> ∩ <span class="cItalic">S</span> is the set of all points that are both members of <span class="cItalic">C</span> and <span class="cItalic">S</span>. The other operations are analogous.</p>
<div id="art_Dest_fig_13-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-6"></a><span class="cBold">Figure 13.6</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-6.png" alt="Figure showing the basic CSG operations on a 2D circle and square." width="410" height="645" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-6.png"></p>
<p class="Text figcaption">The basic CSG operations on a 2D circle and square.</p>
</div>
<p>Although one can do CSG directly on the model, if all that is desired is an image, we do not need to explicitly change the model. Instead, we perform the set operations directly on the rays as they interact with a model. To make this natural, we find all the intersections of a ray with a model rather than just the closest. For example, a ray <span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">b</span> might hit a sphere at <span class="cItalic">t</span> = 1 and <span class="cItalic">t</span> = 2. In the context of CSG, we think of this as the ray being inside the sphere for <span class="cItalic">t</span> ∈ [1<span class="cItalic">,</span> 2]. We can compute these “inside intervals” for all of the surfaces and do set operations on those intervals (recall <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-1-2">Section 2.1.2</a>). This is illustrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-7">Figure 13.7</a>, where the hit intervals are processed to indicate that there are two intervals inside the difference object. The first hit for <span class="cItalic">t &gt;</span> 0 is what the ray actually intersects.</p>
<div id="art_Dest_fig_13-7" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-7"></a><span class="cBold">Figure 13.7</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-7.png" alt="Figure showing intervals are processed to indicate how the ray hits the composite object." width="410" height="764" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-7.png"></p>
<p class="Text figcaption">Intervals are processed to indicate how the ray hits the composite object.</p>
</div>
<p>In practice, the CSG intersection routine must maintain a list of intervals. When the first hitpoint is determined, the material property and surface normal is that associated with the hitpoint. In addition, you must pay attention to precision issues because there is nothing to prevent the user from taking two objects that abut and taking an intersection. This can be made robust by eliminating any interval whose thickness is below a certain tolerance.</p>
<h2><a id="sec13-4"></a>13.4 Distribution Ray Tracing</h2>
<p>For some applications, ray-traced images are just too “clean.” This effect can be mitigated using <span class="cItalic">distribution ray tracing</span> (Cook et al., 1984). The conventionally ray-traced images look clean, because everything is crisp; the shadows are perfectly sharp, the reflections have no fuzziness, and everything is in perfect focus. Sometimes we would like to have the shadows be soft (as they are in real life), the reflections be fuzzy as with brushed metal, and the image have variable degrees of focus as in a photograph with a large aperture. While accomplishing these things from first principles is somewhat involved (as is developed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml">Chapter 23</a>), we can get most of the visual impact with some fairly simple changes to the basic ray tracing algorithm. In addition, the framework gives us a relatively simple way to antialias (recall <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml#sec8-3">Section 8.3</a>) the image.</p>
<div id="art_Dest_fig_13-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-8"></a><span class="cBold">Figure 13.8</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-8.png" alt="Figure showing a simple scene rendered with one sample per pixel (lower left half) and nine samples per pixel (upper right half)." width="377" height="624" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-8.png"></p>
<p class="Text figcaption">A simple scene rendered with one sample per pixel (lower left half) and nine samples per pixel (upper right half).</p>
</div>
<h3><a id="page_330"></a><a id="sec13-4-1"></a>13.4.1 Antialiasing</h3>
<p>Recall that a simple way to antialias an image is to compute the average color for the area of the pixel rather than the color at the center point. In ray tracing, our computational primitive is to compute the color at a point on the screen. If we average many of these points across the pixel, we are approximating the true average. If the screen coordinates bounding the pixel are [<span class="cItalic">i, i</span> + 1] <span class="cItalic">×</span> [<span class="cItalic">j, j</span> + 1], then we can replace the loop:</p>
<pre><span class="code"><span class="cBold">for</span> each pixel (<span class="cItalic">i, j</span>) <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c<span class="cSubscript">ij</span></span> = ray-color(<span class="cItalic">i</span> + 0.5, <span class="cItalic">j</span> + 0.5)</span></pre>
<p>with code that samples on a regular <span class="cItalic">n × n</span> grid of samples within each pixel:</p>
<pre><span class="code"> <span class="cBold">for</span> each pixel (<span class="cItalic">i, j</span>) <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = 0</span></pre>
<pre><span class="code">  <span class="cBold">for</span> <span class="cItalic">p</span> = 0 to <span class="cItalic">n −</span> 1 <span class="cBold">do</span></span></pre>
<pre><span class="code">   <span class="cBold">for</span> <span class="cItalic">q</span> = 0 to <span class="cItalic">n</span> − 1 <span class="cBold">do</span></span></pre>
<pre><span class="code">  <span class="cItalic">c</span> = <span class="cItalic">c</span> + ray-color(<span class="cItalic">i</span> + (<span class="cItalic">p</span> + 0<span class="cItalic">.</span>5)<span class="cItalic">/n</span>, <span class="cItalic">j</span> + (<span class="cItalic">q</span> + 0<span class="cItalic">.</span>5)<span class="cItalic">/n</span>)</span></pre>
<pre><span class="code"> <span class="cItalic">c<span class="cSubscript">ij</span></span> = <span class="cItalic">c/n</span><span class="cSuperscript">2</span></span></pre>
<p>This is usually called <span class="cItalic">regular sampling</span>. The 16 sample locations in a pixel for <span class="cItalic">n</span> = 4 are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-9">Figure 13.9</a>. Note that this produces the same answer as rendering a traditional ray-traced image with one sample per pixel at <span class="cItalic">n<span class="cSubscript">x</span>n</span> by <span class="cItalic">n<span class="cSubscript">y</span>n</span> resolution and then averaging blocks of <span class="cItalic">n</span> by <span class="cItalic">n</span> pixels to get a <span class="cItalic">n<span class="cSubscript">x</span></span> by <span class="cItalic">n<span class="cSubscript">y</span></span> image.</p>
<div id="art_Dest_fig_13-9" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-9"></a><span class="cBold">Figure 13.9</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-9.png" alt="Figure showing sixteen regular samples for a single pixel." width="409" height="409" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-9.png"></p>
<p class="Text figcaption">Sixteen regular samples for a single pixel.</p>
</div>
<p>One potential problem with taking samples in a regular pattern within a pixel is that regular artifacts such as moiré patterns can arise. These artifacts can be turned into noise by taking samples in a random pattern within each pixel as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-10">Figure 13.10</a>. This is usually called <span class="cItalic">random sampling</span> and involves just a small change to the code:</p>
<div id="art_Dest_fig_13-10" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-10"></a><span class="cBold">Figure 13.10</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-10.png" alt="Figure showing sixteen random samples for a single pixel." width="409" height="409" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-10.png"></p>
<p class="Text figcaption">Sixteen random samples for a single pixel.</p>
</div>
<pre><span class="code"><span class="cBold">for</span> each pixel (<span class="cItalic">i, j</span>) <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = 0</span></pre>
<pre><span class="code"> <span class="cBold">for</span> <span class="cItalic">p</span> = 1 to <span class="cItalic">n</span><span class="cSuperscript">2</span> <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = <span class="cItalic">c</span> + ray-color(<span class="cItalic">i</span> + <span class="cItalic">ξ</span>, <span class="cItalic">j</span> + <span class="cItalic">ξ</span>)</span></pre>
<pre><span class="code"> <span class="cItalic">c<span class="cSubscript">ij</span></span> = <span class="cItalic">c/n</span><span class="cSuperscript">2</span></span></pre>
<p>Here <span class="cItalic">ξ</span> is a call that returns a uniform random number in the range [0<span class="cItalic">,</span> 1). Unfortunately, the noise can be quite objectionable unless many samples are taken. A compromise is to make a hybrid strategy that randomly perturbs a regular grid:</p>
<pre><span class="code"><span class="cBold">for</span> each pixel (<span class="cItalic">i, j</span>) <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = 0</span></pre>
<pre><span class="code"> <span class="cBold">for</span> <span class="cItalic">p</span> = 0 to <span class="cItalic">n</span> − 1 <span class="cBold">do</span></span></pre>
<pre><span class="code"><a id="page_331"></a> <span class="cBold">for</span> <span class="cItalic">q</span> = 0 to <span class="cItalic">n</span> − 1 <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = <span class="cItalic">c</span> + ray-color(<span class="cItalic">i</span> + (<span class="cItalic">p</span> + <span class="cItalic">ξ</span>)<span class="cItalic">/n</span>, <span class="cItalic">j</span> + (<span class="cItalic">q</span> + <span class="cItalic">ξ</span>)<span class="cItalic">/n</span>)</span></pre>
<pre><span class="code"><span class="cItalic">c<span class="cSubscript">ij</span></span> = <span class="cItalic">c/n</span><span class="cSuperscript">2</span></span></pre>
<p>That method is usually called <span class="cItalic">jittering</span> or <span class="cItalic">stratified sampling</span> (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-11">Figure 13.11</a>).</p>
<div id="art_Dest_fig_13-11" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-11"></a><span class="cBold">Figure 13.11</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-11.png" alt="Figure showing sixteen stratified (jittered) samples for a single pixel shown with and without the bins highlighted. There is exactly one random sample taken within each bin." width="401" height="800" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-11.png"></p>
<p class="Text figcaption">Sixteen stratified (jittered) samples for a single pixel shown with and without the bins highlighted. There is exactly one random sample taken within each bin.</p>
</div>
<h3><a id="sec13-4-2"></a>13.4.2 Soft Shadows</h3>
<p>The reason shadows are hard to handle in standard ray tracing is that lights are infinitesimal points or directions and are thus either visible or invisible. In real life, lights have nonzero area and can thus be partially visible. This idea is shown in 2D in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-12">Figure 13.12</a>. The region where the light is entirely invisible is called the <span class="cItalic">umbra</span>. The partially visible region is called the <span class="cItalic">penumbra</span>. There is not a commonly used term for the region not in shadow, but it is sometimes called the <span class="cItalic">anti-umbra</span>.</p>
<div id="art_Dest_fig_13-12" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-12"></a><span class="cBold">Figure 13.12</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-12.png" alt="Figure showing a soft shadow has a gradual transition from the unshadowed to shadowed region. The transition zone is the “penumbra” denoted by p in the figure." width="410" height="640" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-12.png"></p>
<p class="Text figcaption">A soft shadow has a gradual transition from the unshadowed to shadowed region. The transition zone is the “penumbra” denoted by <span class="cItalic">p</span> in the figure.</p>
</div>
<p>The key to implementing soft shadows is to somehow account for the light being an area rather than a point. An easy way to do this is to approximate the light with a distributed set of <span class="cItalic">N</span> point lights each with one <span class="cItalic">N</span>th of the intensity of the base light. This concept is illustrated at the left of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-13">Figure 13.13</a> where nine lights are used. You can do this in a standard ray tracer, and it is a common trick to get soft shadows in an off-the-shelf renderer. There are two potential problems with this technique. First, typically dozens of point lights are needed to achieve visually smooth results, which slows down the program a great deal. The second problem is that the shadows have sharp transitions inside the penumbra.</p>
<div id="art_Dest_fig_13-13" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-13"></a><span class="cBold">Figure 13.13</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-13.png" alt="Figure showing left: an area light can be approximated by some number of point lights; four of the nine points are visible to p so it is in the penumbra. Right: a random point on the light is chosen for the shadow ray, and it has some chance of hitting the light or not." width="600" height="346" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-13.png"></p>
<p class="Text figcaption">Left: an area light can be approximated by some number of point lights; four of the nine points are visible to <span class="cBold">p</span> so it is in the penumbra. Right: a random point on the light is chosen for the shadow ray, and it has some chance of hitting the light or not.</p>
</div>
<p>Distribution ray tracing introduces a small change in the shadowing code. Instead of representing the area light at a discrete number of point sources, we represent it as an infinite number and choose one at random for each viewing ray. This amounts to choosing a random point on the light for any surface point being lit as is shown at the right of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-13">Figure 13.13</a>.</p>
<p>If the light is a parallelogram specified by a corner point <span class="cBold">c</span> and two edge vectors <span class="cBold">a</span> and <span class="cBold">b</span> (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-14">Figure 13.14</a>), then choosing a random point <span class="cBold">r</span> is straightforward:</p>
<div id="art_Dest_fig_13-14" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-14"></a><span class="cBold">Figure 13.14</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-14.png" alt="Figure showing the geometry of a parallelogram light specified by a corner point and two edge vectors." width="409" height="301" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-14.png"></p>
<p class="Text figcaption">The geometry of a parallelogram light specified by a corner point and two edge vectors.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-446-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_541&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_541" overflow="scroll" style="width: 8.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.288em, 1007.83em, 2.522em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-24310"><span class="mrow" id="MathJax-Span-24311"><span class="mstyle" id="MathJax-Span-24312"><span class="mrow" id="MathJax-Span-24313"><span class="mi" id="MathJax-Span-24314" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-24315" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-24316" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-24317"><span class="mi" id="MathJax-Span-24318" style="font-family: MathJax_Main-bold;">c</span></span></span><span class="mo" id="MathJax-Span-24319" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-24320" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24321" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-24322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-24323"><span class="mrow" id="MathJax-Span-24324"><span class="mi" id="MathJax-Span-24325" style="font-family: MathJax_Main-bold;">a</span></span></span><span class="mo" id="MathJax-Span-24326" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-24327" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24328" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-24329" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-24330"><span class="mrow" id="MathJax-Span-24331"><span class="mi" id="MathJax-Span-24332" style="font-family: MathJax_Main-bold;">b</span></span></span><span class="mo" id="MathJax-Span-24333" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.262em; border-left: 0px solid; width: 0px; height: 1.062em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_541"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle><mo>+</mo><msub><mi>ξ</mi><mn>1</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>a</mi></mstyle><mo>+</mo><msub><mi>ξ</mi><mn>2</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-446"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_541"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle><mo>+</mo><msub><mi>ξ</mi><mn>1</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>a</mi></mstyle><mo>+</mo><msub><mi>ξ</mi><mn>2</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>b</mi></mstyle><mo>,</mo></mrow></math></script></p>
<p>where <span class="cItalic">ξ</span><span class="cSubscript">1</span> and <span class="cItalic">ξ</span><span class="cSubscript">2</span> are uniform random numbers in the range [0, 1).</p>
<p>We then send a shadow ray to this point as shown at the right in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-13">Figure 13.13</a>. Note that the direction of this ray is not unit length, which may require some modification to your basic ray tracer depending upon its assumptions.</p>
<p>We would really like to jitter points on the light. However, it can be dangerous to implement this without some thought. We would not want to always have the <a id="page_332"></a>ray in the upper left-hand corner of the pixel generate a shadow ray to the upper left-hand corner of the light. Instead we would like to scramble the samples, such that the pixel samples and the light samples are each themselves jittered, but so that there is no correlation between pixel samples and light samples. A good way to accomplish this is to generate two distinct sets of <span class="cItalic">n</span><span class="cSuperscript">2</span> jittered samples and pass samples into the light source routine:</p>
<pre><span class="code"><span class="cBold">for</span> each pixel (<span class="cItalic">i, j</span>) <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = 0</span></pre>
<pre><span class="code"> generate <span class="cItalic">N</span> = <span class="cItalic">n</span><span class="cSuperscript">2</span> jittered 2D points and store in array r[]</span></pre>
<pre><span class="code"> generate <span class="cItalic">N</span> = <span class="cItalic">n</span><span class="cSuperscript">2</span> jittered 2D points and store in array s[]</span></pre>
<pre><span class="code"> shuffle the points in array s[]</span></pre>
<pre><span class="code"> <span class="cBold">for</span> <span class="cItalic">p</span> = 0 to <span class="cItalic">N</span> − 1 <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = <span class="cItalic">c</span> + ray-color(<span class="cItalic">i</span> + r[<span class="cItalic">p</span>].x(), <span class="cItalic">j</span> + r[<span class="cItalic">p</span>].y(), s[<span class="cItalic">p</span>])</span></pre>
<pre><span class="code"> <span class="cItalic">c<span class="cSubscript">ij</span></span> = <span class="cItalic">c/N</span></span></pre>
<p>This shuffle routine eliminates any coherence between arrays <span class="cItalic">r</span> and <span class="cItalic">s</span>. The shadow routine will just use the 2D random point stored in <span class="cItalic">s</span>[<span class="cItalic">p</span>] rather than calling the random number generator. A shuffle routine for an array indexed from 0 to <span class="cItalic">N</span> − 1 is:</p>
<pre><span class="code"><span class="cBold">for</span> <span class="cItalic">i</span> = <span class="cItalic">N</span> − 1 downto 1 <span class="cBold">do</span></span></pre>
<pre><span class="code"> choose random integer <span class="cItalic">j</span> between 0 and <span class="cItalic">i</span> inclusive</span></pre>
<pre><span class="code"> swap array elements <span class="cItalic">i</span> and <span class="cItalic">j</span></span></pre>
<h3><a id="sec13-4-3"></a>13.4.3 Depth of Field</h3>
<p>The soft focus effects seen in most photos can be simulated by collecting light at a nonzero size “lens” rather than at a point. This is called <span class="cItalic">depth of field</span>. The <a id="page_333"></a>lens collects light from a cone of directions that has its apex at a distance where everything is in focus (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-15">Figure 13.15</a>). We can place the “window” we are sampling on the plane where everything is in focus (rather than at the <span class="cItalic">z</span> = <span class="cItalic">n</span> plane as we did previously) and the lens at the eye. The distance to the plane where everything is in focus we call the <span class="cItalic">focus plane</span>, and the distance to it is set by the user, just as the distance to the focus plane in a real camera is set by the user or range finder.</p>
<div id="art_Dest_fig_13-15" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-15"></a><span class="cBold">Figure 13.15</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-15.png" alt="Figure showing the lens averages over a cone of directions that hit the pixel location being sampled." width="410" height="376" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-15.png"></p>
<p class="Text figcaption">The lens averages over a cone of directions that hit the pixel location being sampled.</p>
</div>
<p>To be most faithful to a real camera, we should make the lens a disk. However, we will get very similar effects with a square lens (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-16">Figure 13.16</a>). So we choose the side-length of the lens and take random samples on it. The origin of the view rays will be these perturbed positions rather than the eye position. Again, a shuffling routine is used to prevent correlation with the pixel sample positions. An example using 25 samples per pixel and a large disk lens is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-17">Figure 13.17</a>.</p>
<div id="art_Dest_fig_13-16" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-16"></a><span class="cBold">Figure 13.16</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-16.png" alt="Figure showing to create depth-of-field effects, the eye is randomly selected from a square region." width="410" height="325" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-16.png"></p>
<p class="Text figcaption">To create depth-of-field effects, the eye is randomly selected from a square region.</p>
</div>
<div id="art_Dest_fig_13-17" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-17"></a><span class="cBold">Figure 13.17</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-17.png" alt="Figure showing an example of depth of field. The caustic in the shadow of the wine glass is computed using particle tracing as described in Chapter 23." width="600" height="450" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-17.png"></p>
<p class="Text figcaption">An example of depth of field. The caustic in the shadow of the wine glass is computed using particle tracing as described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml">Chapter 23</a>.</p>
</div>
<h3><a id="sec13-4-4"></a>13.4.4 Glossy Reflection</h3>
<p>Some surfaces, such as brushed metal, are somewhere between an ideal mirror and a diffuse surface. Some discernible image is visible in the reflection, but it is blurred. We can simulate this by randomly perturbing ideal specular reflection rays as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-18">Figure 13.18</a>.</p>
<div id="art_Dest_fig_13-18" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-18"></a><span class="cBold">Figure 13.18</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-18.png" alt="Figure showing the reflection ray is perturbed to a random vector r′." width="409" height="247" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-18.png"></p>
<p class="Text figcaption">The reflection ray is perturbed to a random vector <span class="cBold">r</span>′.</p>
</div>
<p>Only two details need to be worked out: how to choose the vector <span class="cBold">r′</span> and what to do when the resulting perturbed ray is below the surface from which the ray is <a id="page_334"></a>reflected. The latter detail is usually settled by returning a zero color when the ray is below the surface.</p>
<p>To choose <span class="cBold">r′</span>, we again sample a random square. This square is perpendicular to <span class="cBold">r</span> and has width <span class="cItalic">a</span> which controls the degree of blur. We can set up the square’s orientation by creating an orthonormal basis with <span class="cBold">w</span> = <span class="cBold">r</span> using the techniques in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-4-6">Section 2.4.6</a>. Then, we create a random point in the 2D square with side length <span class="cItalic">a</span> centered at the origin. If we have 2D sample points <span class="cItalic">(ξ, ξ′)</span> ∈ [0, 1]<span class="cSuperscript">2</span>, then the analogous point on the desired square is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-447-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_542&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_542" overflow="scroll" style="width: 6.584em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.378em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.311em, 1006.13em, 3.396em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24335"><span class="mtable" id="MathJax-Span-24336" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 6.069em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1005.98em, 5.298em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.069em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1005.77em, 4.527em, -1000.01em); top: -4.83em; left: 0em;"><span class="mtd" id="MathJax-Span-24337"><span class="mrow" id="MathJax-Span-24338"><span class="mi" id="MathJax-Span-24339" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-24340" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mo" id="MathJax-Span-24341" style="font-family: MathJax_Main; padding-left: 0.26em;">−</span><span class="mfrac" id="MathJax-Span-24342"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-24343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-24344" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24345" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-24346" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-24347" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-24348" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1005.98em, 4.527em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-24349"><span class="mrow" id="MathJax-Span-24350"><span class="mi" id="MathJax-Span-24351" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-24352" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mo" id="MathJax-Span-24353" style="font-family: MathJax_Main; padding-left: 0.26em;">−</span><span class="mfrac" id="MathJax-Span-24354"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-24355" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-24356" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-24357" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msup" id="MathJax-Span-24358" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24359" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mo" id="MathJax-Span-24360" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-24361" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-24362" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.215em; border-left: 0px solid; width: 0px; height: 2.968em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_542"><mtable columnalign="left"><mtr><mtd><mi>u</mi><mo>=</mo><mo>−</mo><mfrac><mi>a</mi><mn>2</mn></mfrac><mo>+</mo><mi>ξ</mi><mi>a</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo>=</mo><mo>−</mo><mfrac><mi>a</mi><mn>2</mn></mfrac><mo>+</mo><msup><mi>ξ</mi><mo>′</mo></msup><mi>a</mi><mo>.</mo></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-447"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_542"> <mtable columnalign="left"><mtr><mtd><mi>u</mi><mo>=</mo><mo>−</mo><mfrac><mi>a</mi><mn>2</mn></mfrac><mo>+</mo><mi>ξ</mi><mi>a</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo>=</mo><mo>−</mo><mfrac><mi>a</mi><mn>2</mn></mfrac><mo>+</mo><msup><mi>ξ</mi><mo>′</mo></msup><mi>a</mi><mo>.</mo></mtd></mtr></mtable></math></script></p>
<p>Because the square over which we will perturb is parallel to both the <span class="cBold">u</span> and <span class="cBold">v</span> vectors, the ray <span class="cBold">r</span>′ is just</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-448-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_543&quot;&gt;&lt;msup&gt;&lt;mtext&gt;r&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;.&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_543" overflow="scroll" style="width: 7.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.406em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1007.31em, 2.419em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-24364"><span class="msup" id="MathJax-Span-24365"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-24366" style="font-family: MathJax_Main;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.414em;"><span class="mo" id="MathJax-Span-24367" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24368" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-24369" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-24370"><span class="mi" id="MathJax-Span-24371" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-24372" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-24373" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">u</span><span class="mstyle" id="MathJax-Span-24374"><span class="mrow" id="MathJax-Span-24375"><span class="mi" id="MathJax-Span-24376" style="font-family: MathJax_Main-bold;">u</span></span></span><span class="mo" id="MathJax-Span-24377" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-24378" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">v</span><span class="mstyle" id="MathJax-Span-24379"><span class="mrow" id="MathJax-Span-24380"><span class="mi" id="MathJax-Span-24381" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mtext" id="MathJax-Span-24382" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.156em; border-left: 0px solid; width: 0px; height: 0.956em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_543"><msup><mtext>r</mtext><mo>′</mo></msup><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>+</mo><mi>u</mi><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mo>+</mo><mi>v</mi><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>.</mtext></math></span></span><script type="math/mml" id="MathJax-Element-448"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_543"><msup><mtext>r</mtext><mo>′</mo></msup><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>+</mo><mi>u</mi><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mo>+</mo><mi>v</mi><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle><mtext>.</mtext></math></script></p>
<p>Note that <span class="cBold">r′</span> is not necessarily a unit vector and should be normalized if your code requires that for ray directions.</p>
<h3><a id="sec13-4-5"></a>13.4.5 Motion Blur</h3>
<p>We can add a blurred appearance to objects as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#Text_Anchor_fig_13-19">Figure 13.19</a>. This is called <span class="cItalic">motion blur</span> and is the result of the image being formed over a nonzero <a id="page_335"></a>span of time. In a real camera, the aperture is open for some time interval during which objects move. We can simulate the open aperture by setting a time variable ranging from <span class="cItalic">T</span><span class="cSubscript">0</span> to <span class="cItalic">T</span><span class="cSubscript">1</span>. For each viewing ray we choose a random time,</p>
<div id="art_Dest_fig_13-19" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_13-19"></a><span class="cBold">Figure 13.19</span></p>
<p class="ObjectLine"><img src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig13-19.png" alt="Figure showing the bottom right sphere is in motion, and a blurred appearance results." width="600" height="600" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig13-19.png"></p>
<p class="Text figcaption">The bottom right sphere is in motion, and a blurred appearance results.</p>
<p class="Text figsource"><span class="cItalic">Image courtesy Chad Barb.</span></p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-449-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_544&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_544" overflow="scroll" style="width: 9.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.257em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1009.16em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-24384"><span class="mi" id="MathJax-Span-24385" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-24386" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-24387" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24388" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-24389" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24390" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-24391" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-24392" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-24393" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-24394"><span class="msub" id="MathJax-Span-24395"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24396" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-24397" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-24398" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-24399" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-24400" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mn" id="MathJax-Span-24401" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-24402" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-24403" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_544"><mi>T</mi><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>+</mo><mi>ξ</mi><mrow><mo>(</mo><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-449"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_544"><mi>T</mi><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>+</mo><mi>ξ</mi><mrow><mo>(</mo><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></math></script></p>
<p>We may also need to create some objects to move with time. For example, we might have a moving sphere whose center travels from <span class="cBold">c</span><span class="cSubscript">0</span> to <span class="cBold">c</span><span class="cSubscript">1</span> during the interval. Given <span class="cItalic">T</span> , we could compute the actual center and do a ray—intersection with that sphere. Because each ray is sent at a different time, each will encounter the sphere at a different position, and the final appearance will be blurred. Note that the bounding box for the moving sphere should bound its entire path so an efficiency structure can be built for the whole time interval (Glassner, 1988).</p>
<h2><a id="sec13-5"></a>Notes</h2>
<p>There are many, many other advanced methods that can be implemented in the ray-tracing framework. Some resources for further information are Glassner’s <span class="cItalic">An Introduction to Ray Tracing</span> and <span class="cItalic">Principles of Digital Image Synthesis</span>, Shirley’s <span class="cItalic">Realistic Ray Tracing</span>, and Pharr and Humphreys’s <span class="cItalic">Physically Based Rendering: From Theory to Implementation</span>.</p>
<h2><a id="sec13-6"></a>Frequently Asked Questions</h2>
<ul>
<li class="LX">What is the best ray-intersection efficiency structure?
<p>The most popular structures are binary space partitioning trees (BSP trees), uniform subdivision grids, and bounding volume hierarchies. Most people who use BSP trees make the splitting planes axis-aligned, and such trees are usually called k-d trees. There is no clear-cut answer for which is best, but all are much, much better than brute-force search in practice. If I were to implement only one, it would be the bounding volume hierarchy because of its simplicity and robustness.</p></li>
<li class="LX">Why do people use bounding boxes rather than spheres or ellipsoids?
<p>Sometimes spheres or ellipsoids are better. However, many models have polygonal elements that are tightly bounded by boxes, but they would be difficult to tightly bind with an ellipsoid.</p></li>
</ul>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-10" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 12 Data Structures for Graphics</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 14 Sampling</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 13 More Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Script, sans-serif;"></div></div></body></html>