<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Script; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav  scalefonts subscribe-panel library nav-collapsed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 10 Surface Shading</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 12 Data Structures for Graphics</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 11</p>
<h1><a id="page_243"></a>Texture Mapping</h1>
<p>When trying to replicate the look of the real world, one quickly realizes that hardly any surfaces are featureless. Wood grows with grain; skin grows with wrinkles; cloth shows its woven structure; paint shows the marks of the brush or roller that laid it down. Even smooth plastic is made with bumps molded into it, and smooth metal shows the marks of the machining process that made it. Materials that were once featureless quickly become covered with marks, dents, stains, scratches, fingerprints, and dirt.</p>
<p>In computer graphics we lump all these phenomena under the heading of “spatially varying surface properties”—attributes of surfaces that vary from place to place but don’t really change the <span class="cItalic">shape</span> of the surface in a meaningful way. To allow for these effects, all kinds of modeling and rendering systems provide some means for <span class="cItalic">texture mapping</span> : using an image, called a <span class="cItalic">texture map</span> , <span class="cItalic">texture image</span> , or just a <span class="cItalic">texture</span> , to store the details that you want to go on a surface, then mathematically “mapping” the image onto the surface.</p>
<div class="Sidebar">
<p class="SidebarText">This is mapping in the sense of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-1">Section 2.1</a>.</p>
</div>
<p>As it turns out, once the mechanism to map images onto surfaces exists, there are many less obvious ways it can be used that go beyond the basic purpose of introducing surface detail. Textures can be used to make shadows and reflections, to provide illumination, even to define surface shape. In sophisticated interactive programs, textures are used to store all kinds of data that doesn’t even have anything to do with pictures!</p>
<p>This chapter discusses the use of texture for representing surface detail, shadows, and reflections. While the basic ideas are simple, several practical problems<a id="page_244"></a> complicate the use of textures. First of all, textures easily become distorted, and designing the functions that map textures onto surfaces is challenging. Also, texture mapping is a resampling process, just like rescaling an image, and as we saw in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a>, resampling can very easily introduce aliasing artifacts. The use of texture mapping and animation together readily produces truly dramatic aliasing, and much of the complexity of texture mapping systems is created by the <span class="cItalic">antialiasing</span> measures that are used to tame these artifacts.</p>
<h2><a id="sec11-1"></a>11.1 Looking Up Texture Values</h2>
<p>To start off, let’s consider a simple application of texture mapping. We have a scene with a wood floor, and we would like the diffuse color of the floor to be controlled by an image showing floorboards with wood grain. Regardless of whether we are using ray tracing or rasterization, the shading code that computes the color for a ray-surface intersection point or for a fragment generated by the rasterizer needs to know the color of the texture at the shading point, in order to use it as the diffuse color in the Lambertian shading model from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml">Chapter 10</a>.</p>
<p>To get this color, the shader performs a <span class="cItalic">texture lookup</span>: it figures out the location, in the coordinate system of the texture image, that corresponds to the shading point, and it reads out the color at that point in the image, resulting in the <span class="cItalic">texture sample</span> . That color is then used in shading, and since the texture lookup happens at a different place in the texture for every pixel that sees the floor, a pattern of different colors shows up in the image. The code might look like this:</p>
<pre><span class="code">Color texture_lookup(Texture t, float u, float v) {</span></pre>
<pre><span class="code">   int i = round(u * t.width() - 0.5)</span></pre>
<pre><span class="code">   int j = round(v * t.height() - 0.5)</span></pre>
<pre><span class="code">   return t.get_pixel(i,j)</span></pre>
<pre><span class="code">}</span></pre>
<pre><span class="code">Color shade_surface_point(Surface s, Point p, Texture t) {</span></pre>
<pre><span class="code">   Vector normal = s.get_normal(p)</span></pre>
<pre><span class="code">   (u,v) = s.get_texcoord(p)</span></pre>
<pre><span class="code">   Color diffuse_color = texture_lookup(u,v)</span></pre>
<pre><span class="code">   // compute shading using diffuse_color and normal</span></pre>
<pre><span class="code">   // return shading result</span></pre>
<pre><span class="code">}</span></pre>
<p>In this code, the shader asks the surface where to look in the texture, and somehow every surface that we want to shade using a texture needs to be able to answer this query. This brings us to the first key ingredient of texture mapping: we need a function that maps from the surface to the texture that we can easily compute for every pixel. This is the <span class="cItalic">texture coordinate function</span> (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-1">Figure 11.1</a>) and we say<a id="page_245"></a> that it assigns texture coordinates to every point on the surface. Mathematically it is a mapping from the surface <span class="cItalic">S</span> to the domain of the texture, <span class="cItalic">T</span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-378-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_474&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_474" overflow="scroll" style="width: 9.823em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.514em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.465em, 1009.27em, 3.242em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-20751"><span class="mtable" id="MathJax-Span-20752" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 9.206em; height: 0px;"><span style="position: absolute; clip: rect(2.47em, 1009.11em, 5.144em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.206em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1004.28em, 4.373em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-20753"><span class="mrow" id="MathJax-Span-20754"><span class="mi" id="MathJax-Span-20755" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-20756" style="font-family: MathJax_Main; padding-left: 0.26em;">:</span><span class="mi" id="MathJax-Span-20757" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-20758" style="font-family: MathJax_Main; padding-left: 0.26em;">→</span><span class="mi" id="MathJax-Span-20759" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1009.11em, 4.424em, -1000.01em); top: -3.288em; left: 0em;"><span class="mtd" id="MathJax-Span-20760"><span class="mrow" id="MathJax-Span-20761"><span class="mtext" id="MathJax-Span-20762" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-20763" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-20764" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-20765" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-20766" style="font-family: MathJax_Main; padding-left: 0.26em;">:</span><span class="mrow" id="MathJax-Span-20767" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-20768" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20769"><span class="mi" id="MathJax-Span-20770" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20771" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20772" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20773" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20774" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-20775" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20776" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-20777" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-20778" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20779"><span class="mi" id="MathJax-Span-20780" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-20781" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20782" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-20783" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20784" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.65em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_474"><mtable columnalign="left"><mtr><mtd><mi>ϕ</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi>T</mi></mtd></mtr><mtr><mtd><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mo>:</mo><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>↦</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-378"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_474"><mtable columnalign="left"><mtr><mtd><mi>ϕ</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi>T</mi></mtd></mtr><mtr><mtd><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo>:</mo><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>↦</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></script></p>
<div id="art_Dest_fig_11-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-1"></a><span class="cBold">Figure 11.1</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-1.png" alt="Figure showing just like the viewing projection π maps every point on an object’s surface, S, to a point in the image, the texture coordinate function ϕ maps every point on the object’s surface to a point in the texture map, T . Appropriately defining this function ϕ is fundamental to all applications of texture mapping." width="600" height="187" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-1.png"></p>
<p class="Text figcaption">Just like the viewing projection π maps every point on an object’s surface, <span class="cItalic">S</span>, to a point in the image, the texture coordinate function <span class="cItalic">ϕ</span> maps every point on the object’s surface to a point in the texture map, <span class="cItalic">T</span> . Appropriately defining this function ϕ is fundamental to all applications of texture mapping.</p>
</div>
<p>The set <span class="cItalic">T</span>, often called “texture space,” is usually just a rectangle that contains the image; it is common to use the unit square (<span class="cItalic">u</span>, <span class="cItalic">v</span>) ∈ [0, 1]<span class="cSuperscript">2</span> (in this book we’ll use the names <span class="cItalic">u</span> and <span class="cItalic">v</span> for the two <span class="cItalic">texture coordinates</span>). In many ways it’s similar to the viewing projection discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C007.xhtml">Chapter 7</a>, called π in this chapter, which maps points on surfaces in the scene to points in the image; both are 3D-to-2D mappings, and both are needed for rendering—one to know where to get the texture value from, and one to know where to put the shading result in the image. But there are some important differences, too: π is almost always a perspective or orthographic projection, whereas ϕ can take on many forms; and there is only one viewing projection for an image, whereas each object in the scene is likely to have a completely separate texture coordinate function.</p>
<p>It may seem surprising that ϕ is a mapping <span class="cItalic">from</span> the surface <span class="cItalic">to</span> the texture, when our goal is to put the texture onto the surface, but this is the function we need.</p>
<div class="Sidebar">
<p class="SidebarText">So . . . the first thing you have to learn is how to think backwards?</p>
</div>
<p>For the case of the wood floor, if the floor happens to be at constant <span class="cItalic">z</span> and aligned to the <span class="cItalic">x</span> and <span class="cItalic">y</span> axes, we could just use the mapping</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-379-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_475&quot;&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_475" overflow="scroll" style="width: 7.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.892em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.288em, 1006.85em, 2.47em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-20786"><span class="mrow" id="MathJax-Span-20787"><span class="mi" id="MathJax-Span-20788" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-20789" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-20790" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">a</span><span class="mi" id="MathJax-Span-20791" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20792" style="font-family: MathJax_Main;">;</span><span class="mtext" id="MathJax-Span-20793" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;</span><span class="mi" id="MathJax-Span-20794" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-20795" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-20796" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">b</span><span class="mi" id="MathJax-Span-20797" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20798" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.262em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_475"><mrow><mi>u</mi><mo>=</mo><mi>a</mi><mi>x</mi><mo>;</mo><mtext>&nbsp;&nbsp;</mtext><mi>v</mi><mo>=</mo><mi>b</mi><mi>y</mi><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-379"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_475"><mrow><mi>u</mi><mo>=</mo><mi>a</mi><mi>x</mi><mo>;</mo><mtext>  </mtext><mi>v</mi><mo>=</mo><mi>b</mi><mi>y</mi><mo>,</mo></mrow></math></script></p>
<p>for some suitably chosen scale factors <span class="cItalic">a</span> and <span class="cItalic">b</span>, to assign texture coordinates (<span class="cItalic">s</span>, <span class="cItalic">t</span>) to the point (<span class="cItalic">x</span>, <span class="cItalic">y</span>, <span class="cItalic">z</span>)<span class="cSubscript">floor</span>, and then use the value of the texture pixel, or <span class="cItalic">texel</span>,<a id="page_246"></a> closest to (<span class="cItalic">u</span>, <span class="cItalic">v</span>) as the texture value at (<span class="cItalic">x</span>, <span class="cItalic">y</span>). In this way we rendered the image in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-2">Figure 11.2</a>.</p>
<div id="art_Dest_fig_11-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-2"></a><span class="cBold">Figure 11.2</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-2.png" alt="Figure showing a wood floor, textured using a texture coordinate function that simply uses the x and y coordinates of points directly." width="406" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-2.png"></p>
<p class="Text figcaption">A wood floor, textured using a texture coordinate function that simply uses the <span class="cItalic">x</span> and <span class="cItalic">y</span> coordinates of points directly.</p>
</div>
<p>This is pretty limiting, though: what if the room is modeled at an angle to the <span class="cItalic">x</span> and <span class="cItalic">y</span> axes, or what if we want the wood texture on the curved back of a chair? We will need some better way to compute texture coordinates for points on the surface.</p>
<p>Another problem that arises from the simplest form of texture mapping is illustrated dramatically by rendering at a high contrast texture from a very grazing angle into a low-resolution image. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-3">Figure 11.3</a> shows a larger plane textured using the same approach but with a high contrast grid pattern and a view toward the horizon. You can see it contains aliasing artifacts (stairsteps in the foreground, wavy and glittery patterns in the distance) similar to the ones that arise in image resampling (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a>) when appropriate filters are not used. Although it takes an extreme case to make these artifacts so obvious in a tiny still image printed in a book, in animations these patterns move around and are very distracting even when they are much more subtle.</p>
<div id="art_Dest_fig_11-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-3"></a><span class="cBold">Figure 11.3</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-3.png" alt="Figure showing a large horizontal plane, textured in the same way as in Figure 11.2 and displaying severe aliasing artifacts." width="405" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-3.png"></p>
<p class="Text figcaption">A large horizontal plane, textured in the same way as in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-2">Figure 11.2</a> and displaying severe aliasing artifacts.</p>
</div>
<p>We have now seen the two primary issues in basic texture mapping:</p>
<ul>
<li class="LX">defining texture coordinate functions, and</li>
<li class="LX">looking up texture values without introducing too much aliasing.</li>
</ul>
<p>These two concerns are fundamental to all kinds of applications of texture mapping and are discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-2">Sections 11.2</a> and <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-3">11.3</a>. Once you understand them and some of the solutions to them, then you understand texture mapping. The rest is just how to apply the basic texturing machinery for a variety of different purposes, which is discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-4">Section 11.4</a>.</p>
<h2><a id="sec11-2"></a>11.2 Texture Coordinate Functions</h2>
<p>Designing the texture coordinate function ϕ well is a key requirement for getting good results with texture mapping. You can think of this as deciding how you are going to deform a flat, rectangular image so that it conforms to the 3D surface you want to draw. Or alternatively, you are taking the surface and gently flattening it, without letting it wrinkle, tear, or fold, so that it lies flat on the image. Sometimes this is easy: maybe the 3D surface is already a flat rectangle! In other cases it’s very tricky: the 3D shape might be very complicated, like the surface of a character’s body.</p>
<p>The problem of defining texture coordinate functions is not new to computer graphics. Exactly the same problem is faced by cartographers when designing<a id="page_247"></a> maps that cover large areas of the Earth’s surface: the mapping from the curved globe to the flat map inevitably causes distortion of areas, angles, and/or distances that can easily make maps very misleading. Many map projections have been proposed over the centuries, all balancing the same competing concerns—of minimizing various kinds of distortion while covering a large area in one contiguous piece—that are faced in texture mapping.</p>
<p>In some applications (as we’ll see later in this chapter) there’s a clear reason to use a particular map. But in most cases, designing the texture coordinate map is a delicate task of balancing competing concerns, which skilled modelers put considerable effort into.</p>
<div class="Sidebar">
<p class="SidebarText">“UV mapping” or “surface parameterization” are other names you may encounter for the texture coordinate function.</p>
</div>
<p>You can define ϕ in just about any way you can dream up. But there are several competing goals to consider:</p>
<ul>
<li class="LX"><span class="cBold">Bijectivity.</span> In most cases you’d like ϕ to be bijective (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-1-1">Section 2.1.1</a>), so that each point on the surface maps to a <span class="cItalic">different</span> point in texture space. If several points map to the same texture space point, the value at one point in the texture will affect several points on the surface. In cases where you want a texture to repeat over a surface (think of wallpaper or carpet with their repeating patterns), it makes sense to deliberately introduce a many-to-one mapping from surface points to texture points, but you don’t want this to happen by accident.</li>
<li class="LX"><span class="cBold">Size distortion.</span> The scale of the texture should be approximately constant across the surface. That is, close-together points anywhere on the surface that are about the same distance apart should map to points about the same distance apart in the texture. In terms of the function ϕ , the magnitude of the derivatives of ϕ should not vary too much.</li>
<li class="LX"><span class="cBold">Shape distortion.</span> The texture should not be very distorted. That is, a small circle drawn on the surface should map to a reasonably circular shape in texture space, rather than an extremely squashed or elongated shape. In terms of ϕ , the derivative of ϕ should not be too different in different directions.</li>
<li class="LX"><span class="cBold">Continuity.</span> There should not be too many seams: neighboring points on the surface should map to neighboring points in the texture. That is, ϕ should be continuous, or have as few discontinuities as possible. In most cases, some discontinuities are inevitable, and we’d like to put them in inconspicuous locations.</li>
</ul>
<p>Surfaces that are defined by parametric equations (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5-8">Section 2.5.8</a>) come with a built-in choice for the texture coordinate function: simply invert the function <a id="page_248"></a>that defines the surface, and use the two parameters of the surface as texture coordinates. These texture coordinates may or may not have desirable properties, depending on the surface, but they do provide a mapping.</p>
<p>But for surfaces that are defined implicitly, or are just defined by a triangle mesh, we need some other way to define the texture coordinates, without relying on an existing parameterization. Broadly speaking, the two ways to define texture coordinates are to compute them geometrically, from the spatial coordinates of the surface point, or, for mesh surfaces, to store values of the texture coordinates at vertices and interpolate them across the surface. Let’s look at these options one at a time.</p>
<h3><a id="sec11-2-1"></a>11.2.1 Geometrically Determined Coordinates</h3>
<p>Geometrically determined texture coordinates are used for simple shapes or special situations, as a quick solution, or as a starting point for designing a hand-tweaked texture coordinate map.</p>
<p>We will illustrate the various texture coordinate functions by mapping the test image in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-4">Figure 11.4</a> onto the surface. The numbers in the image let you read the approximate (<span class="cItalic">u</span>, <span class="cItalic">v</span>) coordinates out of the rendered image, and the grid lets you see how distorted the mapping is.</p>
<div id="art_Dest_fig_11-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-4"></a><span class="cBold">Figure 11.4</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-4.png" alt="Figure showing test image." width="405" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-4.png"></p>
<p class="Text figcaption">Test image.</p>
</div>
<h4><a id="sec11-2-1-1"></a>Planar Projection</h4>
<p>Probably the simplest mapping from 3D to 2D is a parallel projection—the same mapping as used for orthographic viewing (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-5">Figure 11.5</a>). The machinery we developed already for viewing (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C007.xhtml#sec7-1">Section 7.1</a>) can be re-used directly for defining texture coordinates: just as orthographic viewing boils down to multiplying by a matrix and discarding the <span class="cItalic">z</span> component, generating texture coordinates by planar projection can be done with a simple matrix multiply:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-380-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_476&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;where&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;*&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_476" overflow="scroll" style="width: 19.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.923em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1018.88em, 7.56em, -1000.01em); top: -4.985em; left: 0em;"><span class="mrow" id="MathJax-Span-20800"><span class="mrow" id="MathJax-Span-20801"><span class="mi" id="MathJax-Span-20802" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-20803" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20804" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20805"><span class="mi" id="MathJax-Span-20806" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20807" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20808" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20809" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20810" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-20811" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20812" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-20813" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-20814" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20815"><span class="mi" id="MathJax-Span-20816" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-20817" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20818" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-20819" style="font-family: MathJax_Main;">)</span></span><span class="mtext" id="MathJax-Span-20820" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-20821" style="font-family: MathJax_Main;">where</span><span class="mtext" id="MathJax-Span-20822" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mrow" id="MathJax-Span-20823" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20824" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-20825" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.58em, 8.126em, -1000.01em); top: -5.756em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-20826"><span class="mrow" id="MathJax-Span-20827"><span class="mi" id="MathJax-Span-20828" style="font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-20829"><span class="mrow" id="MathJax-Span-20830"><span class="mi" id="MathJax-Span-20831" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1000.42em, 3.859em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-20832"><span class="mrow" id="MathJax-Span-20833"><span class="mo" id="MathJax-Span-20834" style="font-family: MathJax_Main;">*</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-20835"><span class="mrow" id="MathJax-Span-20836"><span class="mn" id="MathJax-Span-20837" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.761em;"></span></span></span></span><span class="mo" id="MathJax-Span-20838" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-20839" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-20840" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.04em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-20841" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.979em;"><span class="mi" id="MathJax-Span-20842" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-20843" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20844" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-20845" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.52em, 8.126em, -1000.01em); top: -5.756em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-20846"><span class="mrow" id="MathJax-Span-20847"><span class="mi" id="MathJax-Span-20848" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-20849"><span class="mrow" id="MathJax-Span-20850"><span class="mi" id="MathJax-Span-20851" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-20852"><span class="mrow" id="MathJax-Span-20853"><span class="mi" id="MathJax-Span-20854" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-20855"><span class="mrow" id="MathJax-Span-20856"><span class="mn" id="MathJax-Span-20857" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.761em;"></span></span></span></span><span class="mo" id="MathJax-Span-20858" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-20859" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.539em; border-left: 0px solid; width: 0px; height: 5.563em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_476"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mtext>&nbsp;&nbsp;</mtext><mtext>where</mtext><mtext>&nbsp;&nbsp;</mtext><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><msub><mi>M</mi><mi>t</mi></msub><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr><mtr><mtd><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-380"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_476"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mtext>  </mtext><mtext>where</mtext><mtext>  </mtext><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><msub><mi>M</mi><mi>t</mi></msub><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr><mtr><mtd><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo></mrow></math></script></p>
<div id="art_Dest_fig_11-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-5"></a><span class="cBold">Figure 11.5</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-5.png" alt="Figure showing planar projection makes a useful parameterization for objects or parts of objects that are nearly flat to start with, if the projection direction is chosen roughly along the overall normal." width="409" height="470" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-5.png"></p>
<p class="Text figcaption">Planar projection makes a useful parameterization for objects or parts of objects that are nearly flat to start with, if the projection direction is chosen roughly along the overall normal.</p>
</div>
<p>where the texturing matrix <span class="cItalic">M<span class="cSubscript">t</span></span> represents an affine transformation, and the asterisk indicates that we don’t care what ends up in the third coordinate.</p>
<p>This works quite well for surfaces that are mostly flat, without too much variation in surface normal, and a good projection direction can be found by taking the average normal. For any kind of closed shape, though, a planar projection will<a id="page_249"></a> not be injective: points on the front and back will map to the same point in texture space (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-6">Figure 11.6</a>).</p>
<div id="art_Dest_fig_11-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-6"></a><span class="cBold">Figure 11.6</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-6.png" alt="Figure showing using planar projection on a closed object will always result in a non-injective, one-to-many mapping, and extreme distortion near points where the projection direction is tangent to the surface." width="405" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-6.png"></p>
<p class="Text figcaption">Using planar projection on a closed object will always result in a non-injective, one-to-many mapping, and extreme distortion near points where the projection direction is tangent to the surface.</p>
</div>
<p>By simply substituting perspective projection for orthographic, we get <span class="cItalic">projective</span> texture coordinates (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-7">Figure 11.7</a>):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-381-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_477&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x2DC;&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2DC;&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;where&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x2DC;&lt;/mo&gt;&lt;/mover&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2DC;&lt;/mo&gt;&lt;/mover&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;*&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_477" overflow="scroll" style="width: 21.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.237em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1021.14em, 7.56em, -1000.01em); top: -4.985em; left: 0em;"><span class="mrow" id="MathJax-Span-20861"><span class="mrow" id="MathJax-Span-20862"><span class="mi" id="MathJax-Span-20863" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-20864" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20865" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20866"><span class="mi" id="MathJax-Span-20867" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20868" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20869" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20870" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20871" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-20872" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20873" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-20874" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-20875" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20876"><span class="mover" id="MathJax-Span-20877"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-20878" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 3.602em, -1000.01em); top: -4.008em; left: 0.054em;"><span class="mo" id="MathJax-Span-20879" style=""><span style="font-family: MathJax_Main;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-20880" style="font-family: MathJax_Main;">/</span><span class="mi" id="MathJax-Span-20881" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-20882" style="font-family: MathJax_Main;">,</span><span class="mover" id="MathJax-Span-20883" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-20884" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 3.602em, -1000.01em); top: -4.008em; left: 0.054em;"><span class="mo" id="MathJax-Span-20885" style=""><span style="font-family: MathJax_Main;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-20886" style="font-family: MathJax_Main;">/</span><span class="mi" id="MathJax-Span-20887" style="font-family: MathJax_Math-italic;">w</span></span><span class="mo" id="MathJax-Span-20888" style="font-family: MathJax_Main;">)</span></span><span class="mtext" id="MathJax-Span-20889" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-20890" style="font-family: MathJax_Main;">where</span><span class="mtext" id="MathJax-Span-20891" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mrow" id="MathJax-Span-20892" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20893" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-20894" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1000.68em, 8.332em, -1000.01em); top: -5.961em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-20895"><span class="mrow" id="MathJax-Span-20896"><span class="mover" id="MathJax-Span-20897"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-20898" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 3.602em, -1000.01em); top: -4.008em; left: 0.054em;"><span class="mo" id="MathJax-Span-20899" style=""><span style="font-family: MathJax_Main;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-20900"><span class="mrow" id="MathJax-Span-20901"><span class="mover" id="MathJax-Span-20902"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-20903" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 3.602em, -1000.01em); top: -4.008em; left: 0.054em;"><span class="mo" id="MathJax-Span-20904" style=""><span style="font-family: MathJax_Main;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1000.42em, 3.859em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-20905"><span class="mrow" id="MathJax-Span-20906"><span class="mo" id="MathJax-Span-20907" style="font-family: MathJax_Main;">*</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-20908"><span class="mrow" id="MathJax-Span-20909"><span class="mi" id="MathJax-Span-20910" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.967em;"></span></span></span></span><span class="mo" id="MathJax-Span-20911" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-20912" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-20913" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-20914" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-20915" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-20916" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20917" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-20918" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.52em, 8.126em, -1000.01em); top: -5.756em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-20919"><span class="mrow" id="MathJax-Span-20920"><span class="mi" id="MathJax-Span-20921" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-20922"><span class="mrow" id="MathJax-Span-20923"><span class="mi" id="MathJax-Span-20924" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-20925"><span class="mrow" id="MathJax-Span-20926"><span class="mi" id="MathJax-Span-20927" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-20928"><span class="mrow" id="MathJax-Span-20929"><span class="mn" id="MathJax-Span-20930" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.761em;"></span></span></span></span><span class="mo" id="MathJax-Span-20931" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-20932" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.539em; border-left: 0px solid; width: 0px; height: 5.563em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_477"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mover accent="true"><mi>u</mi><mo>˜</mo></mover><mo>/</mo><mi>w</mi><mo>,</mo><mover accent="true"><mi>v</mi><mo>˜</mo></mover><mo>/</mo><mi>w</mi></mrow><mo>)</mo></mrow><mtext>&nbsp;&nbsp;</mtext><mtext>where</mtext><mtext>&nbsp;&nbsp;</mtext><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mover accent="true"><mi>u</mi><mo>˜</mo></mover></mtd></mtr><mtr><mtd><mover accent="true"><mi>v</mi><mo>˜</mo></mover></mtd></mtr><mtr><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mi>w</mi></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>t</mi></msub><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr><mtr><mtd><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-381"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_477"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mover accent="true"><mi>u</mi><mo>˜</mo></mover><mo>/</mo><mi>w</mi><mo>,</mo><mover accent="true"><mi>v</mi><mo>˜</mo></mover><mo>/</mo><mi>w</mi></mrow><mo>)</mo></mrow><mtext>  </mtext><mtext>where</mtext><mtext>  </mtext><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mover accent="true"><mi>u</mi><mo>˜</mo></mover></mtd></mtr><mtr><mtd><mover accent="true"><mi>v</mi><mo>˜</mo></mover></mtd></mtr><mtr><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mi>w</mi></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>t</mi></msub><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr><mtr><mtd><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow></math></script></p>
<div id="art_Dest_fig_11-7" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-7"></a><span class="cBold">Figure 11.7</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-7.png" alt="Figure showing a projective texture transformation uses a viewing-like transformation that projects toward a point." width="410" height="427" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-7.png"></p>
<p class="Text figcaption">A projective texture transformation uses a viewing-like transformation that projects toward a point.</p>
</div>
<p>Now the 4 × 4 matrix <span class="cItalic">P</span><span class="cItalic">t</span> represents a projective (not necessarily affine) transformation—that is, the last row may not be [0, 0,0,1].</p>
<p>Projective texture coordinates are important in the technique of shadow mapping, discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-4-4">Section 11.4.4</a>.</p>
<h4><a id="sec11-2-1-2"></a>Spherical Coordinates</h4>
<p>For spheres, the latitude/longitude parameterization is familiar and widely used. It has a lot of distortion near the poles, which can lead to difficulties, but it does cover the whole sphere with discontinuities only along one line of latitude.</p>
<p>Surfaces that are roughly spherical in shape can be parameterized using a texture coordinate function that maps a point on the surface to a point on a sphere using radial projection: take a line from the center of the sphere through the point on the surface, and find the intersection with the sphere. The spherical coordinates of this intersection point are the texture coordinates of the point you started with on the surface.</p>
<p>Another way to say this is that you express the surface point in spherical coordinates (ρ θ, ϕ) and then discard the ρ coordinate and map θ and ϕ each to the range [0,1]. The formula depends on the spherical coordinates convention; using the convention of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5-8">Section 2.5.8</a>,</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-382-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_478&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;atan&lt;/mtext&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext&gt;acos&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;z/&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_478" overflow="scroll" style="width: 25.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.836em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1024.74em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-20934"><span class="mrow" id="MathJax-Span-20935"><span class="mi" id="MathJax-Span-20936" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-20937" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20938" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20939"><span class="mi" id="MathJax-Span-20940" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20941" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20942" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20943" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20944" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-20945" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20946" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-20947" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-20948" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20949"><span class="mrow" id="MathJax-Span-20950"><span class="mo" id="MathJax-Span-20951" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-20952"><span class="mi" id="MathJax-Span-20953" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20954" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mtext" id="MathJax-Span-20955" style="font-family: MathJax_Main; padding-left: 0.208em;">atan</span><span class="mn" id="MathJax-Span-20956" style="font-family: MathJax_Main;">2</span><span class="mrow" id="MathJax-Span-20957" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20958" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20959"><span class="mi" id="MathJax-Span-20960" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20961" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20962" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">x</span></span><span class="mo" id="MathJax-Span-20963" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-20964" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-20965" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mn" id="MathJax-Span-20966" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-20967" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20968" style="font-family: MathJax_Main;">,</span><span class="mrow" id="MathJax-Span-20969" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20970" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-20971"><span class="mi" id="MathJax-Span-20972" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20973" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mtext" id="MathJax-Span-20974" style="font-family: MathJax_Main; padding-left: 0.208em;">acos</span><span class="mrow" id="MathJax-Span-20975" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20976" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20977"><span class="mtext" id="MathJax-Span-20978" style="font-family: MathJax_Main;">z/</span><span class="mrow" id="MathJax-Span-20979" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20980" style="font-family: MathJax_Main;">||</span><span class="mi" id="MathJax-Span-20981" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20982" style="font-family: MathJax_Main;">||</span></span></span><span class="mo" id="MathJax-Span-20983" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-20984" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-20985" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mi" id="MathJax-Span-20986" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-20987" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-20988" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_478"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mi>π</mi><mo>+</mo><mtext>atan</mtext><mn>2</mn><mrow><mo>(</mo><mrow><mi>y</mi><mo>,</mo><mi>x</mi></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mo>/</mo><mn>2</mn><mi>π</mi><mo>,</mo><mrow><mo>[</mo><mrow><mi>π</mi><mo>−</mo><mtext>acos</mtext><mrow><mo>(</mo><mrow><mtext>z/</mtext><mrow><mo>||</mo><mi>x</mi><mo>||</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mo>/</mo><mi>π</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-382"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_478"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo> <mrow><mi>π</mi><mo>+</mo><mtext>atan</mtext><mn>2</mn><mrow><mo>(</mo><mrow><mi>y</mi><mo>,</mo><mi>x</mi></mrow><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><mo>/</mo><mn>2</mn><mi>π</mi><mo>,</mo><mrow><mo>[</mo> <mrow><mi>π</mi><mo>−</mo><mtext>acos</mtext><mrow><mo>(</mo><mrow><mtext>z/</mtext><mrow><mo>||</mo> <mi>x</mi> <mo>||</mo></mrow></mrow><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><mo>/</mo><mi>π</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>A spherical coordinates map will be bijective everywhere except at the poles if the whole surface is visible from the center point. It inherits the same distortion near the poles as the latitude-longitude map on the sphere. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-8">Figure 11.8</a> shows an object for which spherical coordinates provide a suitable texture coordinate function.</p>
<div id="art_Dest_fig_11-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-8"></a><span class="cBold">Figure 11.8</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-8.png" alt="Figure showing for this vaguely sphere-like object, projecting each point onto a sphere centered at the center of the object provides an injective mapping, which here is used to place the same map texture as was used for the globe images. Note that areas become magnified (surface points are crowded together in texture space) where the surface is far from the center, and areas shrink where the surface is closer to the center." width="406" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-8.png"></p>
<p class="Text figcaption">For this vaguely sphere-like object, projecting each point onto a sphere centered at the center of the object provides an injective mapping, which here is used to place the same map texture as was used for the globe images. Note that areas become magnified (surface points are crowded together in texture space) where the surface is far from the center, and areas shrink where the surface is closer to the center.</p>
</div>
<div class="Sidebar">
<p class="SidebarText">This and other texture coordinate functions in this chapter for objects that are in the box [−1,1]<span class="cSuperscript">3</span> and centered at the origin.</p>
</div>
<h4><a id="sec11-2-1-3"></a>Cylindrical Coordinates</h4>
<p>For objects that are more columnar than spherical, projection outward from an axis onto a cylinder may work better than projection from a point onto a sphere<a id="page_250"></a> (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-9">Figure 11.9</a>). Analogously to spherical projection, this amounts to converting to cylindrical coordinates and discarding the radius:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-383-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_479&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;atan&lt;/mtext&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_479" overflow="scroll" style="width: 20.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.363em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1020.27em, 2.728em, -1000.01em); top: -2.208em; left: 0em;"><span class="mrow" id="MathJax-Span-20990"><span class="mrow" id="MathJax-Span-20991"><span class="mi" id="MathJax-Span-20992" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-20993" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-20994" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-20995"><span class="mi" id="MathJax-Span-20996" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-20997" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20998" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-20999" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21000" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21001" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21002" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-21003" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-21004" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-21005"><span class="mfrac" id="MathJax-Span-21006"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21007" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-21008"><span class="mn" id="MathJax-Span-21009" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-21010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21011"><span class="mo" id="MathJax-Span-21012" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21013"><span class="mi" id="MathJax-Span-21014" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21015" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mtext" id="MathJax-Span-21016" style="font-family: MathJax_Main; padding-left: 0.208em;">atan</span><span class="mn" id="MathJax-Span-21017" style="font-family: MathJax_Main;">2</span><span class="mrow" id="MathJax-Span-21018" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21019" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21020"><span class="mi" id="MathJax-Span-21021" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21022" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21023" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">x</span></span><span class="mo" id="MathJax-Span-21024" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-21025" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21026" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mn" id="MathJax-Span-21027" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-21028" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21029" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-21030" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21031" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21032" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21033"><span class="mo" id="MathJax-Span-21034" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21035"><span class="mn" id="MathJax-Span-21036" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21037" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-21038" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21039" style="font-family: MathJax_Main;">]</span></span></span><span class="mo" id="MathJax-Span-21040" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-21041" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.213em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_479"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mrow><mo>[</mo><mrow><mi>π</mi><mo>+</mo><mtext>atan</mtext><mn>2</mn><mrow><mo>(</mo><mrow><mi>y</mi><mo>,</mo><mi>x</mi></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mo>/</mo><mn>2</mn><mi>π</mi><mo>,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mi>z</mi></mrow><mo>]</mo></mrow></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-383"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_479"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mrow><mo>[</mo> <mrow><mi>π</mi><mo>+</mo><mtext>atan</mtext><mn>2</mn><mrow><mo>(</mo><mrow><mi>y</mi><mo>,</mo><mi>x</mi></mrow><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><mo>/</mo><mn>2</mn><mi>π</mi><mo>,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mi>z</mi></mrow> <mo>]</mo></mrow></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<div id="art_Dest_fig_11-9" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-9"></a><span class="cBold">Figure 11.9</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-9.png" alt="Figure showing a far-from-spherical vase for which spherical projection produces a lot of distortion (left) and cylindrical projection produces a very good result on the outer surface." width="405" height="349" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-9.png"></p>
<p class="Text figcaption">A far-from-spherical vase for which spherical projection produces a lot of distortion (left) and cylindrical projection produces a very good result on the outer surface.</p>
</div>
<h4><a id="sec11-2-1-4"></a>Cubemaps</h4>
<p>Using spherical coordinates to parameterize a spherical or sphere-like shape leads to high distortion of shape and area near the poles, which often leads to visible artifacts that reveal that there are two special points where something is going wrong with the texture. A popular alternative is much more uniform at the cost of having more discontinuities. The idea is to project onto a cube, rather than a sphere, and then use six separate square textures for the six faces of the cube. The collection of six square textures is called a <span class="cItalic">cubemap.</span> This introduces discontinuities along all the cube edges, but it keeps distortion of shape and area low.</p>
<p>Computing cubemap texture coordinates is also cheaper than for spherical coordinates, because projecting onto a plane just requires a division—essentially the same as perspective projection for viewing. For instance, for a point that projects onto the <span class="cItalic">+z</span> face of the cube:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-384-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_480&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_480" overflow="scroll" style="width: 8.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1007.77em, 2.728em, -1000.01em); top: -2.208em; left: 0em;"><span class="mrow" id="MathJax-Span-21043"><span class="mrow" id="MathJax-Span-21044"><span class="mrow" id="MathJax-Span-21045"><span class="mo" id="MathJax-Span-21046" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21047"><span class="mi" id="MathJax-Span-21048" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21049" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21050" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21051" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21052" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21053" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21054" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mrow" id="MathJax-Span-21055" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-21056" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-21057"><span class="mfrac" id="MathJax-Span-21058"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-21059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-21060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.52em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-21061" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-21062" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-21063" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-21064" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21065" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-21066" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.213em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_480"><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>↦</mo><mrow><mo>(</mo><mrow><mfrac><mi>x</mi><mi>z</mi></mfrac><mo>,</mo><mfrac><mi>y</mi><mi>z</mi></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-384"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_480"><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>↦</mo><mrow><mo>(</mo><mrow><mfrac><mi>x</mi><mi>z</mi></mfrac><mo>,</mo><mfrac><mi>y</mi><mi>z</mi></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>A confusing aspect of cubemaps is establishing the convention for how the <span class="cItalic">u</span> and <span class="cItalic">v</span> directions are defined on the six faces. Any convention is fine, but the convention chosen affects the contents of textures, so standardization is important. Because<a id="page_251"></a> cubemaps are very often used for textures that are viewed from the inside of the cube (see environment mapping in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-4-5">Section 11.4.5</a>), the usual conventions have the <span class="cItalic">u</span> and <span class="cItalic">v</span> axes oriented so that <span class="cItalic">u</span> is clockwise from <span class="cItalic">v</span> as viewed from inside. The convention used by OpenGL is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-385-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_481&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_481" overflow="scroll" style="width: 16.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.633em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-3.134em, 1015.38em, 6.841em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21068"><span class="mtable" id="MathJax-Span-21069" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 15.324em; height: 0px;"><span style="position: absolute; clip: rect(5.452em, 1015.28em, 15.427em, -1000.01em); top: -10.692em; left: 0em;"><span style="display: inline-block; position: relative; width: 15.324em; height: 0px;"><span style="position: absolute; clip: rect(2.985em, 1015.28em, 4.527em, -1000.01em); top: -8.224em; left: 0em;"><span class="mtd" id="MathJax-Span-21070"><span class="mrow" id="MathJax-Span-21071"><span class="msub" id="MathJax-Span-21072"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21073" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21074"><span class="mo" id="MathJax-Span-21075" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-21076" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21077" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21078" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21079"><span class="mi" id="MathJax-Span-21080" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21081" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21082" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21083" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21084" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21085" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21086" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21087" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21088" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21089" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21090"><span class="mo" id="MathJax-Span-21091" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21092"><span class="mn" id="MathJax-Span-21093" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21094" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21095" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21096" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21097"><span class="mo" id="MathJax-Span-21098" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21099" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21100" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21101" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mi" id="MathJax-Span-21102" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21103" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21104" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21105" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21106" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21107" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21108" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21109" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21110" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1015.28em, 4.527em, -1000.01em); top: -6.527em; left: 0em;"><span class="mtd" id="MathJax-Span-21111"><span class="mrow" id="MathJax-Span-21112"><span class="msub" id="MathJax-Span-21113"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21114" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21115"><span class="mo" id="MathJax-Span-21116" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21118" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21119" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21120"><span class="mi" id="MathJax-Span-21121" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21122" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21123" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21124" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21125" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21126" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21127" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21128" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21129" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21130" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21131"><span class="mo" id="MathJax-Span-21132" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21133"><span class="mn" id="MathJax-Span-21134" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21135" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21136" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21137" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21138"><span class="mo" id="MathJax-Span-21139" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-21140" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21141" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21142" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mi" id="MathJax-Span-21143" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21144" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21145" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21146" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21147" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21148" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21149" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21150" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21151" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1015.23em, 4.527em, -1000.01em); top: -4.83em; left: 0em;"><span class="mtd" id="MathJax-Span-21152"><span class="mrow" id="MathJax-Span-21153"><span class="msub" id="MathJax-Span-21154"><span style="display: inline-block; position: relative; width: 1.596em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21155" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21156"><span class="mo" id="MathJax-Span-21157" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-21158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21159" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21160" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21161"><span class="mi" id="MathJax-Span-21162" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21163" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21164" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21165" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21166" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21167" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21168" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21169" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21170" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21171" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21172"><span class="mo" id="MathJax-Span-21173" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21174"><span class="mn" id="MathJax-Span-21175" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21176" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21177" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21178" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21179"><span class="mo" id="MathJax-Span-21180" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21181" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21182" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21183" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mi" id="MathJax-Span-21184" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21185" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21186" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21187" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21188" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21189" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21190" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21191" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21192" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1015.23em, 4.527em, -1000.01em); top: -3.185em; left: 0em;"><span class="mtd" id="MathJax-Span-21193"><span class="mrow" id="MathJax-Span-21194"><span class="msub" id="MathJax-Span-21195"><span style="display: inline-block; position: relative; width: 1.596em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21196" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21197"><span class="mo" id="MathJax-Span-21198" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21200" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21201" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21202"><span class="mi" id="MathJax-Span-21203" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21204" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21205" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21206" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21207" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21208" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21209" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21210" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21211" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21212" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21213"><span class="mo" id="MathJax-Span-21214" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21215"><span class="mn" id="MathJax-Span-21216" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21217" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21218" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21219" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21220"><span class="mo" id="MathJax-Span-21221" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21222" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21223" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21224" style="font-family: MathJax_Main; padding-left: 0.157em;">+</span><span class="mi" id="MathJax-Span-21225" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21226" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21227" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21228" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21229" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21230" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21231" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21232" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21233" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1015.18em, 4.527em, -1000.01em); top: -1.488em; left: 0em;"><span class="mtd" id="MathJax-Span-21234"><span class="mrow" id="MathJax-Span-21235"><span class="msub" id="MathJax-Span-21236"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21237" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21238"><span class="mo" id="MathJax-Span-21239" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-21240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21241" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21242" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21243"><span class="mi" id="MathJax-Span-21244" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21245" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21246" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21247" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21248" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21249" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21250" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21251" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21252" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21253" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21254"><span class="mo" id="MathJax-Span-21255" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21256"><span class="mn" id="MathJax-Span-21257" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21258" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21259" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21260" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21261"><span class="mo" id="MathJax-Span-21262" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-21263" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21264" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21265" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mi" id="MathJax-Span-21266" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21267" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21268" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21269" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21270" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21271" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21272" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21273" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21274" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1015.18em, 4.527em, -1000.01em); top: 0.208em; left: 0em;"><span class="mtd" id="MathJax-Span-21275"><span class="mrow" id="MathJax-Span-21276"><span class="msub" id="MathJax-Span-21277"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21278" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21279"><span class="mo" id="MathJax-Span-21280" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21282" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21283" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21284"><span class="mi" id="MathJax-Span-21285" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21286" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21287" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21288" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21289" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21290" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21291" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21292" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21293" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21294" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21295"><span class="mo" id="MathJax-Span-21296" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-21297"><span class="mn" id="MathJax-Span-21298" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21299" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-21300" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-21301" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21302"><span class="mo" id="MathJax-Span-21303" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21304" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21305" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21306" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="mi" id="MathJax-Span-21307" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21308" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21309" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="mrow" id="MathJax-Span-21310" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21311" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-21312" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21313" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-21314" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-21315" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.697em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.763em; border-left: 0px solid; width: 0px; height: 10.064em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_481"><mtable columnalign="left"><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>z</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>x</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>−</mo><mi>z</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>x</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>y</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>+</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>y</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>−</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>z</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo><mi>z</mi><mo>|</mo></mrow></mrow><mo>]</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-385"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_481"><mtable columnalign="left"><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>z</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>x</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>−</mo><mi>z</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>x</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>y</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>+</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>y</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>−</mo><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>−</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>z</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>ϕ</mi><mrow><mo>+</mo><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>[</mo> <mrow><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mrow><mo>+</mo><mi>x</mi><mo>,</mo><mo>−</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>|</mo> <mi>z</mi> <mo>|</mo></mrow></mrow> <mo>]</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></script></p>
<p>The subscripts indicate which face of the cube each projection corresponds to. For example, cItalic"&gt;ϕ<span class="cSubscript">−x</span> is used for points that project to the face of the cube at <span class="cItalic">x</span> = +1. You can tell which face a point projects to by looking at the coordinate with the largest absolute value: for example, if |<span class="cItalic">x</span>| &lt; |<span class="cItalic">y</span>| and |<span class="cItalic">x</span>| &gt; |<span class="cItalic">z</span>|, the point projects to the +<span class="cItalic">x</span> or −<span class="cItalic">x</span> face, depending on the sign of <span class="cItalic">x</span>.</p>
<p>A texture to be used with a cube map has six square pieces. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-10">Figure 11.10</a>.) Often they are packed together in a single image for storage, arranged as if the cube was unwrapped.</p>
<div id="art_Dest_fig_11-10" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-10"></a><span class="cBold">Figure 11.10</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-10.png" alt="Figure showing a surface being projected into a cubemap. Points on the surface project outward from the center, each mapping to a point on one of the six faces." width="600" height="251" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-10.png"></p>
<p class="Text figcaption">A surface being projected into a cubemap. Points on the surface project outward from the center, each mapping to a point on one of the six faces.</p>
</div>
<h3><a id="sec11-2-2"></a>11.2.2 Interpolated Texture Coordinates</h3>
<p>For more fine-grained control over the texture coordinate function on a triangle mesh surface, you can explicitly store the texture coordinates at each vertex,<a id="page_252"></a> and interpolate them across the triangles using barycentric interpolation (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml#sec8-1-2">Section 8.1.2</a>). It works in exactly the same way as any other smoothly varying quantities you might define over a mesh: colors, normals, even the 3D position itself.</p>
<p>Let’s look at an example with a single triangle. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-11">Figure 11.11</a> shows a triangle texture mapped with part of the by now familiar test pattern. By looking at the pattern that appears on the rendered triangle, you can deduce that the texture coordinates of the three vertices are (0.2, 0.2), (0.8, 0.2), and (0.2, 0.8), because those are the points in the texture that appear at the three corners of the triangle. Just as with the geometrically determined mappings in the previous section, we control where the texture goes on the surface by giving the mapping from the surface to the texture domain, in this case by specifying where each vertex should go in texture space. Once you position the vertices, linear (barycentric) interpolation across triangles takes care of the rest.</p>
<div id="art_Dest_fig_11-11" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-11"></a><span class="cBold">Figure 11.11</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-11.png" alt="Figure showing a single triangle using linearly interpolated texture coordinates. Left: the triangle drawn in texture space; right: the triangle rendered in a 3D scene." width="600" height="274" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-11.png"></p>
<p class="Text figcaption">A single triangle using linearly interpolated texture coordinates. Left: the triangle drawn in texture space; right: the triangle rendered in a 3D scene.</p>
</div>
<div class="Sidebar">
<p class="SidebarText">The idea of interpolated texture coordinates is very simple—but it can be a bit confusing at first.</p>
</div>
<p>In <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-12">Figure 11.12</a> we show a common way to visualize texture coordinates on a whole mesh: simply draw triangles in texture space with the vertices positioned at<a id="page_253"></a> their texture coordinates. This visualization shows you what parts of the texture are being used by which triangles, and it is a handy tool for evaluating texture coordinates and for debugging all sorts of texture-mapping code.</p>
<div id="art_Dest_fig_11-12" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-12"></a><span class="cBold">Figure 11.12</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-12.png" alt="Figure showing an icosahedron with its triangles laid out in texture space to provide zero distortion but with many seams." width="600" height="274" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-12.png"></p>
<p class="Text figcaption">An icosahedron with its triangles laid out in texture space to provide zero distortion but with many seams.</p>
</div>
<p>The quality of a texture coordinate mapping that is defined by vertex texture coordinates depends on what coordinates are assigned to the vertices—that is, how the mesh is laid out in texture space. No matter what coordinates are assigned, as long as the triangles in the mesh share vertices (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml#sec12-1">Section 12.1</a>), the texture coordinate mapping is always continuous, because neighboring triangles will agree on the texture coordinate at points on their shared edge. But the other desirable qualities described above are not so automatic. Injectivity means the triangles don’t overlap in texture space—if they do, it means there’s some point in the texture that will show up at more than one place on the surface.</p>
<p>Size distortion is low when the areas of triangles in texture space are in proportion to their areas in 3D. For instance, if a character’s face is mapped with a continuous texture coordinate function, one often ends up with the nose squeezed into a relatively small area in texture space, as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-13">Figure 11.13</a>. Although triangles on the nose are smaller than on the cheek, the ratio of sizes is more extreme in texture space. The result is that the texture is enlarged on the nose, because a small area of texture has to cover a large area of surface. Similarly, comparing the forehead to the temple, the triangles are similar in size in 3D, but the triangles around the temple are larger in texture space, causing the texture to appear smaller there.</p>
<div id="art_Dest_fig_11-13" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-13"></a><span class="cBold">Figure 11.13</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-13.png" alt="Figure showing a face model, with texture coordinates assigned so as to achieve reasonably low shape distortion, but still showing moderate area distortion." width="393" height="800" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-13.png"></p>
<p class="Text figcaption">A face model, with texture coordinates assigned so as to achieve reasonably low shape distortion, but still showing moderate area distortion.</p>
</div>
<p>Similarly, shape distortion is low when the shapes of triangles are similar in 3D and in texture space. The face example has fairly low shape distortion, but, for example, the sphere in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-17">Figure 11.17</a> has very large shape distortion near the poles.</p>
<h3><a id="sec11-2-3"></a>11.2.3 Tiling, Wrapping Modes, and Texture Transformations</h3>
<p>It’s often useful to allow texture coordinates to go outside the bounds of the texture image. Sometimes this is a detail: rounding error in a texture coordinate calculation might cause a vertex that lands exactly on the texture boundary to be slightly outside, and the texture mapping machinery should not fail in that case. But it can also be a modeling tool.</p>
<p>If a texture is only supposed to cover part of the surface, but texture coordinates are already set up to map the whole surface to the unit square, one option is to prepare a texture image that is mostly blank with the content in a small area. But that might require a very high resolution texture image to get enough detail in the relevant area. Another alternative is to scale up all the texture coordinates so<a id="page_254"></a> that they cover a larger range—[−4.5, 5.5] × [−4.5, 5.5] for instance, to position the unit square at one-tenth size in the center of the surface.</p>
<p>For a case like this, texture lookups outside the unit-square area that’s covered by the texture image should return a constant background color. One way to do this is to set a background color to be returned by texture lookups outside the unit square. If the texture image already has a constant background color (for instance, a logo on a white background), another way to extend this background automatically over the plane is to arrange for lookups outside the unit square to return the color of the texture image at the closest point on the edge, achieved by <span class="cItalic">clamping</span> the u and v coordinates to the range from the first pixel to the last pixel in the image.</p>
<p>Sometimes we want a repeating pattern, such as a checkerboard, a tile floor, or a brick wall. If the pattern repeats on a rectangular grid, it would be wasteful to create an image with many copies of the same data. Instead we can handle texture lookups outside the texture image using wraparound indexing—when the lookup point exits the right edge of the texture image, it wraps around to the left edge. This is handled very simply using the integer remainder operation on the pixel coordinates.</p>
<pre><span class="code">Color texture_lookup_wrap(Texture t, float u, float v) {</span></pre>
<pre><span class="code">   int i = round(u * t.width() - 0.5)</span></pre>
<pre><span class="code">   int j = round(v * t.height() - 0.5)</span></pre>
<pre><span class="code">   return t.get_pixel(i % t.width(), j % t.height())</span></pre>
<pre><span class="code">}</span></pre>
<pre><span class="code">Color texture_lookup_wrap(Texture t, float u, float v) {</span></pre>
<pre><span class="code">   int i = round(u * t.width() - 0.5)</span></pre>
<pre><span class="code">   int j = round(v * t.height() - 0.5)</span></pre>
<pre><span class="code">   return t.get_pixel(max(0, min(i, t.width()-1)),</span></pre>
<pre><span class="code">    (max(0, min(j, t.height()-1))))</span></pre>
<pre><span class="code">}</span></pre>
<p>The choice between these two ways of handling out-of-bounds lookups is specified by selecting a <span class="cItalic">wrapping mode</span> from a list that includes tiling, clamping, and often combinations or variants of the two. With wrapping modes, we can freely think of a texture as a function that returns a color for any point in the infinite 2D plane (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-14">Figure 11.14</a>). When we specify a texture using an image, these modes describe how the finite image data is supposed to be used to define this function. In <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#sec11-5">Section 11.5</a>, we’ll see that procedural textures can naturally extend across an infinite plane, since they are not limited by finite image data. Since both are logically infinite in extent, the two types of textures are interchangeable.</p>
<div id="art_Dest_fig_11-14" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-14"></a><span class="cBold">Figure 11.14</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-14.png" alt="Figure showing a wood floor texture tiled over texture space by wrapping texel coordinates." width="600" height="364" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-14.png"></p>
<p class="Text figcaption">A wood floor texture tiled over texture space by wrapping texel coordinates.</p>
</div>
<p>When adjusting the scale and placement of textures, it’s convenient to avoid actually changing the functions that generate texture coordinates, or the texture coordinate values stored at vertices of meshes, by instead applying a matrix trans<a id="page_255"></a> formation to the texture coordinates before using them to sample the texture:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-386-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_482&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mtext&gt;model&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_482" overflow="scroll" style="width: 11.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.851em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1010.81em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-21317"><span class="mrow" id="MathJax-Span-21318"><span class="mi" id="MathJax-Span-21319" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-21320" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21321" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-21322"><span class="mrow" id="MathJax-Span-21323"><span class="mi" id="MathJax-Span-21324" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-21325" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21326" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-21327" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.04em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-21328"><span class="mrow" id="MathJax-Span-21329"><span class="mi" id="MathJax-Span-21330" style="font-family: MathJax_Main-bold;">M</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 1.082em;"><span class="mi" id="MathJax-Span-21331" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21332" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-21333" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.522em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21334" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-21335"><span class="mtext" id="MathJax-Span-21336" style="font-size: 70.7%; font-family: MathJax_Main;">model</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21337" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21338" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-21339"><span class="mrow" id="MathJax-Span-21340"><span class="mi" id="MathJax-Span-21341" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-21342" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21343" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_482"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>M</mi></mstyle><mi>T</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mrow><mtext>model</mtext></mrow></msub><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-386"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_482"><mrow><mi>ϕ</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>M</mi></mstyle><mi>T</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mrow><mtext>model</mtext></mrow></msub><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>,</mo></mrow></math></script></p>
<p>where <span class="cItalic">ϕ</span><span class="cSubscript">model</span> is the texture coordinate function provided with the model, and <span class="cBold">M</span><span class="cItalic">T</span> is a 3 by 3 matrix representing an affine or projective transformation of the 2D texture coordinates using homogeneous coordinates. Such a transformation, sometimes limited just to scaling and/or translation, is supported by most renderers that use texture mapping.</p>
<h3><a id="sec11-2-4"></a>11.2.4 Perspective Correct Interpolation</h3>
<p>There are some subtleties in achieving correct-looking perspective by interpolating texture coordinates across triangles, but we can address this at the rasterization stage. The reason things are not straightforward is that just interpolating texture coordinates in screen space results in incorrect images, as shown for the grid texture in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-15">Figure 11.15</a>. Because things in perspective get smaller as the distance to the viewer increases, the lines that are evenly spaced in 3D should compress in 2D image space. More careful interpolation of texture coordinates is needed to accomplish this.</p>
<div id="art_Dest_fig_11-15" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-15"></a><span class="cBold">Figure 11.15</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-15.png" alt="Figure showing left: correct perspective. Right: interpolation in screen space." width="410" height="462" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-15.png"></p>
<p class="Text figcaption">Left: correct perspective. Right: interpolation in screen space.</p>
</div>
<p>We can implement texture mapping on triangles by interpolating the (<span class="cItalic">u</span>, <span class="cItalic">v</span>) coordinates, modifying the rasterization method of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml#sec8-1-2">Section 8.1.2</a>, but this results<a id="page_256"></a> in the problem shown at the right of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-15">Figure 11.15</a>. A similar problem occurs for triangles if screen space barycentric coordinates are used as in the following rasterization code:</p>
<pre><span class="code"><span class="cBold">for</span> all <span class="cItalic">x</span> <span class="cBold">do</span></span></pre>
<pre><span class="code">  <span class="cBold">for</span> all <span class="cItalic">y</span> <span class="cBold">do</span></span></pre>
<pre><span class="code">  compute (α, β, γ) for (<span class="cItalic">x</span>, <span class="cItalic">y</span>)</span></pre>
<pre><span class="code">  <span class="cBold">if</span> α ∈ (0,1) and <span class="cItalic">β</span> ∈ (0,1) and <span class="cItalic">γ</span> ∈ (0,1) <span class="cBold">then</span></span></pre>
<pre><span class="code">  <span class="cBold">t</span> = α <span class="cBold">t</span><span class="cSubscript">0</span> + β<span class="cBold">t</span><span class="cSubscript">1</span> + γ<span class="cBold">t</span><span class="cSubscript">2</span></span></pre>
<pre><span class="code">  drawpixel (<span class="cItalic">x</span>, <span class="cItalic">y</span>) with color texture(<span class="cBold">t</span>) for a solid texture</span></pre>
<pre><span class="code">  or with texture(β, γ) for a 2D texture.</span>
</pre>
<p>This code will generate images, but there is a problem. To unravel the basic problem, let’s consider the progression from world space <span class="cBold">q</span> to homogeneous point <span class="cBold">r</span> to homogenized point <span class="cBold">s</span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-387-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_483&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;munder accentunder=&quot;true&quot;&gt;&lt;mrow&gt;&lt;mtext&gt;transform&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;true&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;munder accentunder=&quot;true&quot;&gt;&lt;mrow&gt;&lt;mtext&gt;homogenize&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;true&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_483" overflow="scroll" style="width: 24.322em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.602em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1023.51em, 7.818em, -1000.01em); top: -5.139em; left: 0em;"><span class="mrow" id="MathJax-Span-21345"><span class="mrow" id="MathJax-Span-21346"><span class="mrow" id="MathJax-Span-21347"><span class="mo" id="MathJax-Span-21348" style="vertical-align: 3.036em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.877em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.18em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.666em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.152em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21349" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.99em, 8.486em, -1000.01em); top: -6.013em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.476em, -1000.01em); top: -6.219em; left: 0em;"><span class="mtd" id="MathJax-Span-21350"><span class="mrow" id="MathJax-Span-21351"><span class="msub" id="MathJax-Span-21352"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21353" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.476em, -1000.01em); top: -4.728em; left: 0em;"><span class="mtd" id="MathJax-Span-21355"><span class="mrow" id="MathJax-Span-21356"><span class="msub" id="MathJax-Span-21357"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21358" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.476em, -1000.01em); top: -3.185em; left: 0em;"><span class="mtd" id="MathJax-Span-21360"><span class="mrow" id="MathJax-Span-21361"><span class="msub" id="MathJax-Span-21362"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21363" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.694em; left: 0em;"><span class="mtd" id="MathJax-Span-21365"><span class="mrow" id="MathJax-Span-21366"><span class="mn" id="MathJax-Span-21367" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.018em;"></span></span></span></span><span class="mo" id="MathJax-Span-21368" style="vertical-align: 3.036em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.877em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.18em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.666em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.152em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="munder" id="MathJax-Span-21369" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.27em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1004.23em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-21370"><span class="mtext" id="MathJax-Span-21371" style="font-family: MathJax_Main;">transform</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1004.28em, 4.167em, -1000.01em); top: -3.288em; left: 0.003em;"><span class="mo" id="MathJax-Span-21372" style=""><span style="display: inline-block; position: relative; width: 4.27em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 3.293em;">→<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.362em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.877em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.339em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.853em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.316em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.83em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21373" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21374" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21375" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.242em, 1000.99em, 8.435em, -1000.01em); top: -5.91em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.321em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-21376"><span class="mrow" id="MathJax-Span-21377"><span class="msub" id="MathJax-Span-21378"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21379" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.373em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-21381"><span class="mrow" id="MathJax-Span-21382"><span class="msub" id="MathJax-Span-21383"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21384" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.321em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-21386"><span class="mrow" id="MathJax-Span-21387"><span class="msub" id="MathJax-Span-21388"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21389" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.99em, 4.321em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-21391"><span class="mrow" id="MathJax-Span-21392"><span class="msub" id="MathJax-Span-21393"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21394" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.915em;"></span></span></span></span><span class="mo" id="MathJax-Span-21396" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="munder" id="MathJax-Span-21397" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.041em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1005.05em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-21398"><span class="mtext" id="MathJax-Span-21399" style="font-family: MathJax_Main;">homogenize</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1005.05em, 4.167em, -1000.01em); top: -3.134em; left: 0.003em;"><span class="mo" id="MathJax-Span-21400" style=""><span style="display: inline-block; position: relative; width: 5.041em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 4.116em;">→<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.414em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.928em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.494em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.008em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.522em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.036em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.602em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21401" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21402" style="vertical-align: 2.985em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.774em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.231em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.717em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.255em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21403" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.419em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.43em, 8.589em, -1000.01em); top: -6.167em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.419em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.43em, 4.424em, -1000.01em); top: -6.167em; left: 0em;"><span class="mtd" id="MathJax-Span-21404"><span class="mrow" id="MathJax-Span-21405"><span class="msub" id="MathJax-Span-21406"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21407" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21409" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21410"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21411" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21412" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.38em, 4.424em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-21413"><span class="mrow" id="MathJax-Span-21414"><span class="msub" id="MathJax-Span-21415"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21416" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21418" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21419"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21420" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.33em, 4.424em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-21422"><span class="mrow" id="MathJax-Span-21423"><span class="msub" id="MathJax-Span-21424"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21425" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21427" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21428"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21429" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.746em; left: 0em;"><span class="mtd" id="MathJax-Span-21431"><span class="mrow" id="MathJax-Span-21432"><span class="mn" id="MathJax-Span-21433" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.172em;"></span></span></span></span><span class="mo" id="MathJax-Span-21434" style="vertical-align: 2.985em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.774em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.231em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.717em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.255em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21435" style="font-family: MathJax_Main; padding-left: 0.26em;">≡</span><span class="mrow" id="MathJax-Span-21436" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-21437" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21438" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.99em, 8.126em, -1000.01em); top: -5.756em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.321em, -1000.01em); top: -6.116em; left: 0em;"><span class="mtd" id="MathJax-Span-21439"><span class="mrow" id="MathJax-Span-21440"><span class="msub" id="MathJax-Span-21441"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21442" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.373em, -1000.01em); top: -4.676em; left: 0em;"><span class="mtd" id="MathJax-Span-21444"><span class="mrow" id="MathJax-Span-21445"><span class="msub" id="MathJax-Span-21446"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21447" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.321em, -1000.01em); top: -3.237em; left: 0em;"><span class="mtd" id="MathJax-Span-21449"><span class="mrow" id="MathJax-Span-21450"><span class="msub" id="MathJax-Span-21451"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21452" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -1.797em; left: 0em;"><span class="mtd" id="MathJax-Span-21454"><span class="mrow" id="MathJax-Span-21455"><span class="mn" id="MathJax-Span-21456" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.761em;"></span></span></span></span><span class="mo" id="MathJax-Span-21457" style="vertical-align: 2.882em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.62em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.283em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.82em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.357em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21458" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 5.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.645em; border-left: 0px solid; width: 0px; height: 5.828em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_483"><mrow><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>transform</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>homogenize</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>≡</mo><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-387"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_483"><mrow><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>q</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>transform</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>homogenize</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub><mo>/</mo><msub><mi>h</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>≡</mo><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>The simplest form of the texture coordinate interpolation problem is when we have texture coordinates (<span class="cItalic">u</span>, <span class="cItalic">v</span>) associated with two points, <span class="cBold">q</span> and <span class="cBold">Q</span>, and we need to generate texture coordinates in the image along the line between <span class="cBold">s</span> and <span class="cBold">S</span>. If the world-space point <span class="cBold">q</span>′ that is on the line between <span class="cBold">q</span> and <span class="cBold">Q</span> projects to the screen-space point <span class="cBold">s</span>′ on the line between <span class="cBold">s</span> and <span class="cBold">S</span>, then the two points should have the same texture coordinates.</p>
<p>The naïve screen-space approach, embodied by the algorithm above, says that at the point <span class="cBold">s</span><span class="cItalic">'</span> = <span class="cBold">s</span> + <span class="cItalic">α</span> (<span class="cBold">S</span> − s) we should use texture coordinates <span class="cItalic">u<span class="cSubscript">s</span></span> + <span class="cItalic">α(u<span class="cSubscript">S</span> - u<span class="cSubscript">s</span>)</span> and <span class="cItalic">v<span class="cSubscript">s</span></span> + <span class="cItalic">α(vS -v<span class="cSubscript">s</span>).</span> This doesn’t work correctly because the world-space point <span class="cBold">q</span>' that transforms to <span class="cBold">s</span>' is <span class="cItalic">not</span> <span class="cBold">q</span> + α (<span class="cBold">Q</span> − <span class="cBold">q</span>).</p>
<p>However, we know from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C007.xhtml#sec7-4">Section 7.4</a> that the points on the line segment between <span class="cBold">q</span> and <span class="cBold">Q</span> do end up somewhere on the line segment between <span class="cBold">s</span> and <span class="cBold">S</span>; in fact, in that section we showed that</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-388-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_484&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x21A6;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_484" overflow="scroll" style="width: 13.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.165em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1013.07em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-21460"><span class="mrow" id="MathJax-Span-21461"><span class="mstyle" id="MathJax-Span-21462"><span class="mrow" id="MathJax-Span-21463"><span class="mi" id="MathJax-Span-21464" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-21465" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-21466" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mrow" id="MathJax-Span-21467" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21468" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21469"><span class="mstyle" id="MathJax-Span-21470"><span class="mrow" id="MathJax-Span-21471"><span class="mi" id="MathJax-Span-21472" style="font-family: MathJax_Main-bold;">Q</span></span></span><span class="mo" id="MathJax-Span-21473" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mstyle" id="MathJax-Span-21474" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-21475"><span class="mi" id="MathJax-Span-21476" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21477" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21478" style="font-family: MathJax_Main; padding-left: 0.26em;">↦</span><span class="mstyle" id="MathJax-Span-21479" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-21480"><span class="mi" id="MathJax-Span-21481" style="font-family: MathJax_Main-bold;">s</span></span></span><span class="mo" id="MathJax-Span-21482" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-21483" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">α</span><span class="mrow" id="MathJax-Span-21484" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21485" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21486"><span class="mstyle" id="MathJax-Span-21487"><span class="mrow" id="MathJax-Span-21488"><span class="mi" id="MathJax-Span-21489" style="font-family: MathJax_Main-bold;">S</span></span></span><span class="mo" id="MathJax-Span-21490" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mstyle" id="MathJax-Span-21491" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-21492"><span class="mi" id="MathJax-Span-21493" style="font-family: MathJax_Main-bold;">s</span></span></span></span><span class="mo" id="MathJax-Span-21494" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21495" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_484"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>q</mi></mstyle><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>Q</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>q</mi></mstyle></mrow><mo>)</mo></mrow><mo>↦</mo><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>S</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-388"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_484"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>q</mi></mstyle><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>Q</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>q</mi></mstyle></mrow><mo>)</mo></mrow><mo>↦</mo><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>S</mi></mstyle><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>The interpolation parameters <span class="cItalic">t</span> and α are not the same, but we can compute one from the other:<span class="cSuperscript"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#ft1-1" id="ft1_1" class="totri-footnote">1</a></span></p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-389-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_4851_1&quot;&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;and&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(11.1)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_4851_1" overflow="scroll" style="width: 24.322em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.602em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1023.51em, 2.882em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21497"><span class="mrow" id="MathJax-Span-21498"><span class="mi" id="MathJax-Span-21499" style="font-family: MathJax_Math-italic;">t</span><span class="mrow" id="MathJax-Span-21500" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21501" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21502" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-21503" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21504" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21505" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.887em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1001.19em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-21506"><span class="msub" id="MathJax-Span-21507"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21509" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-21510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1004.69em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -2.362em;"><span class="mrow" id="MathJax-Span-21511"><span class="msub" id="MathJax-Span-21512"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21514" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21515" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">α</span><span class="mrow" id="MathJax-Span-21517"><span class="mo" id="MathJax-Span-21518" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21519"><span class="msub" id="MathJax-Span-21520"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21522" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21523" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-21524"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21526" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21527" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.9em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.887em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mtext" id="MathJax-Span-21528" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-21529" style="font-family: MathJax_Main;">and</span><span class="mtext" id="MathJax-Span-21530" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mi" id="MathJax-Span-21531" style="font-family: MathJax_Math-italic;">α</span><span class="mrow" id="MathJax-Span-21532" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21533" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21534" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-21535" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21536" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21537" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1001.19em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-21538"><span class="msub" id="MathJax-Span-21539"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21541" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-21542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1004.33em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -2.208em;"><span class="mrow" id="MathJax-Span-21543"><span class="msub" id="MathJax-Span-21544"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21545" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21546" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21547" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mrow" id="MathJax-Span-21549"><span class="mo" id="MathJax-Span-21550" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21551"><span class="msub" id="MathJax-Span-21552"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21554" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21555" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-21556"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21557" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21558" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21559" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.54em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-21560" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-21561" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.1)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 1.75em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4851_1"><mrow><mi>t</mi><mrow><mo>(</mo><mi>α</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>r</mi></msub><mi>α</mi></mrow><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>−</mo><msub><mi>w</mi><mi>R</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mtext>&nbsp;&nbsp;</mtext><mtext>and</mtext><mtext>&nbsp;&nbsp;</mtext><mi>α</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>R</mi></msub><mi>t</mi></mrow><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.1)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-389"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4851_1"><mrow><mi>t</mi><mrow><mo>(</mo><mi>α</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>r</mi></msub><mi>α</mi></mrow><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>−</mo><msub><mi>w</mi><mi>R</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mtext>  </mtext><mtext>and</mtext><mtext>  </mtext><mi>α</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>R</mi></msub><mi>t</mi></mrow><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>       (11.1)</mtext></math></script></p>
<p><a id="page_257"></a>These equations provide one possible fix to the screen-space interpolation idea. To get texture coordinates for the screen-space point <span class="cBold">s</span>′ = <span class="cBold">s</span> + α (<span class="cBold">S</span> − <span class="cBold">s</span>), compute <span class="cItalic">u</span>'<span class="cItalic">s</span> = <span class="cItalic">u</span><span class="cItalic">s</span>+<span class="cItalic">t</span> (α)(<span class="cItalic">u</span><span class="cItalic">S</span> − <span class="cItalic">u</span><span class="cItalic">s</span>) and <span class="cItalic">v</span>'<span class="cItalic">s</span> = <span class="cItalic">v</span><span class="cItalic">s</span> +<span class="cItalic">t</span> (α)(<span class="cItalic">v</span><span class="cItalic">S</span> −<span class="cItalic">v</span><span class="cItalic">s</span>). These are the coordinates of the point <span class="cBold">q</span>′ that maps to <span class="cBold">s</span>', so this will work. However, it is slow to evaluate <span class="cItalic">t</span>(α) for each fragment, and there is a simpler way.</p>
<p>The key observation is that because, as we know, the perspective transform preserves lines and planes, it is safe to linearly interpolate any attributes we want across triangles, but only as long as they go through the perspective transformation along with the points. To get a geometric intuition for this, reduce the dimension so that we have homogeneous points (<span class="cItalic">x</span><span class="cItalic">r</span>,<span class="cItalic">y</span><span class="cItalic">r</span>,w<span class="cSubscript">r</span>) and a single attribute <span class="cItalic">u</span> being interpolated. The attribute <span class="cItalic">u</span> is supposed to be a linear function of <span class="cItalic">x</span><span class="cItalic">r</span> and <span class="cItalic"><span class="cItalic">y</span><span class="cItalic">r</span>, so if we plot <span class="cItalic">u</span> as a height field over (<span class="cItalic">x</span><span class="cItalic">r</span>,<span class="cItalic">y</span><span class="cItalic">r</span>) the result isa plane. Now, if we think of <span class="cItalic">u</span> as a third spatial coordinate (call it <span class="cItalic">u<span class="cSubscript">r</span></span> to emphasize that it’s treated the same as the others) and send the whole 3D homogeneous point (<span class="cItalic">x</span><span class="cItalic">r</span>,<span class="cItalic">y</span><span class="cItalic">r</span>,u<span class="cSubscript">r</span>,<span class="cItalic">w</span><span class="cItalic">r</span>)</span> through the perspective transformation, the result (<span class="cItalic">x<span class="cSubscript">s</span>,y<span class="cSubscript">s</span>,u<span class="cSubscript">s</span>)</span> still generates points that lie on a plane. There will be some warping within the plane, but the plane stays flat. This means that <span class="cItalic">u<span class="cSubscript">s</span></span> is a linear function of (<span class="cItalic">x<span class="cSubscript">s</span>, y<span class="cSubscript">s</span></span>)—which is to say, we can compute <span class="cItalic">u<span class="cSubscript">s</span></span> anywhere by using linear interpolation based on the coordinates (<span class="cItalic">x<span class="cSubscript">s</span>,y<span class="cSubscript">s</span>).</span></p>
<p>Returning to the full problem, we need to interpolate texture coordinates (<span class="cItalic">u,v</span>) that are linear functions of the world space coordinates (<span class="cItalic">x</span><span class="cItalic">q</span>, <span class="cItalic">y</span><span class="cItalic">q</span>,<span class="cItalic">z</span><span class="cItalic">q</span>). After transforming the points to screen space, and adding the texture coordinates as if they were additional coordinates, we have</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-390-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_4861_2&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;munder accentunder=&quot;true&quot;&gt;&lt;mrow&gt;&lt;mtext&gt;homogenize&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;true&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(11.2)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_4861_2" overflow="scroll" style="width: 20.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.746em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1019.65em, 12.136em, -1000.01em); top: -7.298em; left: 0em;"><span class="mrow" id="MathJax-Span-21563"><span class="mrow" id="MathJax-Span-21564"><span class="mrow" id="MathJax-Span-21565"><span class="mo" id="MathJax-Span-21566" style="vertical-align: 5.041em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.938em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.643em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.563em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.517em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.082em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.648em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.162em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.728em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.293em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.859em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21567" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(5.35em, 1001.09em, 14.861em, -1000.01em); top: -10.177em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -8.275em; left: 0em;"><span class="mtd" id="MathJax-Span-21568"><span class="mrow" id="MathJax-Span-21569"><span class="mi" id="MathJax-Span-21570" style="font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -6.836em; left: 0em;"><span class="mtd" id="MathJax-Span-21571"><span class="mrow" id="MathJax-Span-21572"><span class="mi" id="MathJax-Span-21573" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-21574"><span class="mrow" id="MathJax-Span-21575"><span class="mn" id="MathJax-Span-21576" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.321em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-21577"><span class="mrow" id="MathJax-Span-21578"><span class="msub" id="MathJax-Span-21579"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21580" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.373em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-21582"><span class="mrow" id="MathJax-Span-21583"><span class="msub" id="MathJax-Span-21584"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21585" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.321em, -1000.01em); top: -1.077em; left: 0em;"><span class="mtd" id="MathJax-Span-21587"><span class="mrow" id="MathJax-Span-21588"><span class="msub" id="MathJax-Span-21589"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21590" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.321em, -1000.01em); top: 0.311em; left: 0em;"><span class="mtd" id="MathJax-Span-21592"><span class="mrow" id="MathJax-Span-21593"><span class="msub" id="MathJax-Span-21594"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21595" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.183em;"></span></span></span></span><span class="mo" id="MathJax-Span-21597" style="vertical-align: 5.041em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 4.938em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.643em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.563em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.003em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.517em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.082em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.648em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.162em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.728em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.293em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.859em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="munder" id="MathJax-Span-21598" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.041em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1005.05em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-21599"><span class="mtext" id="MathJax-Span-21600" style="font-family: MathJax_Main;">homogenize</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1005.05em, 4.167em, -1000.01em); top: -3.134em; left: 0.003em;"><span class="mo" id="MathJax-Span-21601" style=""><span style="display: inline-block; position: relative; width: 5.041em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 4.116em;">→<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.414em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.928em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.494em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.008em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.522em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.036em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.602em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21602" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21603" style="vertical-align: 5.195em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 5.247em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.614em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.1em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.465em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.979em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.494em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.008em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.573em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.087em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.602em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.167em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-21604" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.836em; height: 0px;"><span style="position: absolute; clip: rect(5.35em, 1004.84em, 15.273em, -1000.01em); top: -10.64em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.836em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1002.68em, 4.424em, -1000.01em); top: -8.378em; left: 0em;"><span class="mtd" id="MathJax-Span-21605"><span class="mrow" id="MathJax-Span-21606"><span class="mtext" id="MathJax-Span-21607" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mi" id="MathJax-Span-21608" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-21609" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21610"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21611" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21612" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.58em, 4.424em, -1000.01em); top: -6.938em; left: 0em;"><span class="mtd" id="MathJax-Span-21613"><span class="mrow" id="MathJax-Span-21614"><span class="mtext" id="MathJax-Span-21615" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mi" id="MathJax-Span-21616" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-21617" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21618"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21619" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.63em, 4.424em, -1000.01em); top: -5.447em; left: 0em;"><span class="mtd" id="MathJax-Span-21621"><span class="mrow" id="MathJax-Span-21622"><span class="mtext" id="MathJax-Span-21623" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mn" id="MathJax-Span-21624" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-21625" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21626"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21627" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1004.84em, 4.424em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-21629"><span class="mrow" id="MathJax-Span-21630"><span class="msub" id="MathJax-Span-21631"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21632" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21633" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21634" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21635"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21636" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21638" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-21639" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21640" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-21641" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1004.69em, 4.424em, -1000.01em); top: -2.465em; left: 0em;"><span class="mtd" id="MathJax-Span-21642"><span class="mrow" id="MathJax-Span-21643"><span class="msub" id="MathJax-Span-21644"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21645" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21647" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21648"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21649" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21651" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-21652" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21653" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-21654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1004.64em, 4.424em, -1000.01em); top: -0.974em; left: 0em;"><span class="mtd" id="MathJax-Span-21655"><span class="mrow" id="MathJax-Span-21656"><span class="msub" id="MathJax-Span-21657"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21658" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21659" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21660" style="font-family: MathJax_Main;">/</span><span class="msub" id="MathJax-Span-21661"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21662" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-21663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21664" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-21665" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21666" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-21667" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1001.45em, 4.167em, -1000.01em); top: 0.465em; left: 0em;"><span class="mtd" id="MathJax-Span-21668"><span class="mrow" id="MathJax-Span-21669"><span class="mtext" id="MathJax-Span-21670" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-21671" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mn" id="MathJax-Span-21672" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.645em;"></span></span></span></span><span class="mo" id="MathJax-Span-21673" style="vertical-align: 5.195em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 5.247em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.694em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.129em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.614em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.1em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.465em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.979em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.494em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.008em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 2.573em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.087em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 3.602em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 4.167em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21674" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span class="mtext" id="MathJax-Span-21675" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.2)</span></span><span style="display: inline-block; width: 0px; height: 7.303em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.869em; border-left: 0px solid; width: 0px; height: 10.276em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4861_2"><mrow><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>homogenize</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mtext>&nbsp;&nbsp;</mtext><mi>u</mi><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mtext>&nbsp;&nbsp;</mtext><mi>v</mi><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mtext>&nbsp;&nbsp;</mtext><mn>1</mn><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>x</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>y</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>z</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><mtext>&nbsp;&nbsp;</mtext><mtext>&nbsp;&nbsp;</mtext><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.2)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-390"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4861_2"><mrow><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><munder accentunder="true"><mrow><mtext>homogenize</mtext></mrow><mo stretchy="true">→</mo></munder><mrow><mo>[</mo> <mtable columnalign="left"><mtr><mtd><mtext>  </mtext><mi>u</mi><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mtext>  </mtext><mi>v</mi><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><mtext>  </mtext><mn>1</mn><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>x</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>y</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><msub><mi>z</mi><mi>r</mi></msub><mo>/</mo><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><msub><mi>z</mi><mi>s</mi></msub></mtd></mtr><mtr><mtd><mtext>  </mtext><mtext>  </mtext><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow><mtext>        (11.2)</mtext></math></script></p>
<p>The practical implication of the previous paragraph is that we <span class="cItalic">can</span> go ahead and interpolate all of these quantities based on the values of (<span class="cItalic">x<span class="cSubscript">s</span>, y<span class="cSubscript">s</span></span>)—including the value <span class="cItalic">z</span><span class="cItalic">s</span>, used in the z-buffer. The problem with the naïve approach is simply that we are interpolating components selected inconsistently—as long as the quantities involved are from before or all from after the perspective divide, all will be well.</p>
<div id="art_Dest_fig_11-16" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-16"></a><span class="cBold">Figure 11.16</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-16.png" alt="Figure showing geometric reasoning for screen-space interpolation. Top: ur is to be interpolated as a linear function of (xr, yr). Bottom: after a perspective transformation from (xr, yr, ur, wr) to (xs, ys, us, 1), us is a linear function of (xs, ys)." width="410" height="565" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-16.png"></p>
<p class="Text figcaption">Geometric reasoning for screen-space interpolation. Top: <span class="cItalic">u</span><span class="cItalic">r</span> is to be interpolated as a linear function of (<span class="cItalic">x</span><span class="cItalic">r</span>, <span class="cItalic">y</span><span class="cItalic">r</span>). Bottom: after a perspective transformation from (<span class="cItalic">x</span><span class="cItalic">r</span>, <span class="cItalic">y</span><span class="cItalic">r</span>, <span class="cItalic">u</span><span class="cItalic">r</span>, <span class="cItalic">w</span><span class="cItalic">r</span>) to (<span class="cItalic">x</span><span class="cItalic">s</span>, <span class="cItalic">y</span><span class="cItalic">s</span>, <span class="cItalic">u</span><span class="cItalic">s</span>, 1), <span class="cItalic">u</span><span class="cItalic">s</span> is a linear function of (<span class="cItalic">x</span><span class="cItalic">s</span>, <span class="cItalic">y</span><span class="cItalic">s</span>).</p>
</div>
<p>The one remaining problem is that (<span class="cItalic">u</span>/<span class="cItalic">w</span><span class="cItalic">r</span>, v/<span class="cItalic">w</span><span class="cItalic">r</span>) is not directly useful for looking up texture data; we need (<span class="cItalic">u</span>, <span class="cItalic">v</span>). This explains the purpose of the extra parameter we slipped into (11.2), whose value is always 1: once we have <span class="cItalic">u/<span class="cItalic">w</span><span class="cItalic">r</span></span>, <span class="cItalic">v/<span class="cItalic">w</span><span class="cItalic">r</span></span>, and 1<span class="cItalic">/<span class="cItalic">w</span><span class="cItalic">r</span></span>, we can easily recover (<span class="cItalic">u</span>, <span class="cItalic">v</span>) by dividing.</p>
<p><a id="page_258"></a>To verify that this is all correct, let’s check that interpolating the quantity 1/<span class="cItalic">w</span><span class="cItalic">r</span> in screen space indeed produces the reciprocal of the interpolated <span class="cItalic">w</span><span class="cItalic">r</span> in world space. To see this is true, confirm (Exercise 2):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-391-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_4871_3&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(11.3)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_4871_3" overflow="scroll" style="width: 23.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.368em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.905em, 1022.27em, 4.013em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-21677"><span class="mrow" id="MathJax-Span-21678"><span class="mfrac" id="MathJax-Span-21679"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21680" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.78em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21681"><span class="msub" id="MathJax-Span-21682"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21683" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21684" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.928em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-21685" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-21686" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">α</span><span class="mrow" id="MathJax-Span-21687" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21688" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21689" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-21690" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-21691" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21692" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-21693"><span class="mfrac" id="MathJax-Span-21694"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21695" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.94em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-21696"><span class="msub" id="MathJax-Span-21697"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21699" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.04em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-21700" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mfrac" id="MathJax-Span-21701" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21702" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.78em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21703"><span class="msub" id="MathJax-Span-21704"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21706" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.928em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21707" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-21708" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21709" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21710" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.27em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-21711"><span class="msub" id="MathJax-Span-21712"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="msup" id="MathJax-Span-21713"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21714" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.517em;"><span class="mo" id="MathJax-Span-21715" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.722em;"><span class="mi" id="MathJax-Span-21716" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.09em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-21717" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-21718" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-21719" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1004.33em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -2.208em;"><span class="mrow" id="MathJax-Span-21720"><span class="msub" id="MathJax-Span-21721"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21723" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21724" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-21725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mrow" id="MathJax-Span-21726"><span class="mo" id="MathJax-Span-21727" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21728"><span class="msub" id="MathJax-Span-21729"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21731" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21732" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-21733"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-21734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-21735" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21736" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.54em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mtext" id="MathJax-Span-21737" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.3)</span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 1.962em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4871_3"><mrow><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub></mrow></mfrac><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>R</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msub><msup><mi>w</mi><mo>′</mo></msup><mi>r</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(11.3)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-391"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_4871_3"><mrow><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub></mrow></mfrac><mo>+</mo><mi>α</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>R</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msub><msup><mi>w</mi><mo>′</mo></msup><mi>r</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac></mrow><mtext>        (11.3)</mtext></math></script></p>
<p>remembering that α(<span class="cItalic">t</span>) and <span class="cItalic">t</span> are related by Equation 11.1.</p>
<p>This ability to interpolate 1/<span class="cItalic">w</span><span class="cItalic">r</span> linearly with no error in the transformed space allows us to correctly texture triangles. We can use these facts to modify our scan-conversion code for three points <span class="cBold">t</span><span class="cItalic">i</span> = (<span class="cItalic">x</span><span class="cItalic">i</span>, <span class="cItalic">y</span><span class="cItalic">i</span>, <span class="cItalic">z</span><span class="cItalic">i</span>, <span class="cItalic">w</span><span class="cItalic">i</span>) that have been passed through the viewing matrices, but have not been homogenized, complete with texture coordinates <span class="cBold">t</span><span class="cItalic">i</span> = (<span class="cItalic">u</span><span class="cItalic">i</span>, <span class="cItalic">v</span><span class="cItalic">i</span>):</p>
<pre><span class="code"><span class="cBold">for</span> all <span class="cItalic">x</span><span class="cItalic">s</span> <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cBold">for</span> all <span class="cItalic">y</span><span class="cItalic">s</span> <span class="cBold">do</span></span></pre>
<pre><span class="code"> compute (α, β, γ) for (<span class="cItalic">x</span><span class="cItalic">s</span>, <span class="cItalic">y</span><span class="cItalic">s</span>)</span></pre>
<pre><span class="code"> <span class="cBold">if</span> (α ∈ [0,1] and β ∈ [0,1] and γ ∈ [0,1]) <span class="cBold">then</span></span></pre>
<pre><span class="code">   <span class="cItalic">u</span><span class="cItalic">s</span> = α (<span class="cItalic">u</span> <span class="cSubscript">0</span><span class="cItalic">/w</span> <span class="cSubscript">0</span>)<span class="cItalic"></span> +<span class="cItalic">β</span> (<span class="cItalic">u</span> <span class="cSubscript">1</span><span class="cItalic">/w</span> <span class="cSubscript">1</span>) + <span class="cItalic">γ</span> (<span class="cItalic">u</span> <span class="cSubscript">2</span><span class="cItalic">/w</span> <span class="cSubscript">2</span>)</span></pre>
<pre><span class="code">   <span class="cItalic">v<span class="cSubscript">s</span> = α</span> (<span class="cItalic">v</span> <span class="cSubscript">0</span><span class="cItalic">/w</span> <span class="cSubscript">0</span>)<span class="cItalic"></span> + <span class="cItalic">β</span> (<span class="cItalic">v</span> <span class="cSubscript">1</span><span class="cItalic">/w</span> <span class="cSubscript">1</span>)<span class="cItalic"></span> + <span class="cItalic">γ</span> (<span class="cItalic">v</span> <span class="cSubscript">2</span><span class="cItalic">/w</span> <span class="cSubscript">2</span>)</span></pre>
<pre><span class="code">   1<span class="cItalic">s</span> = α(1<span class="cItalic">/w</span> <span class="cSubscript">0</span>) + β(1<span class="cItalic">/w</span> <span class="cSubscript">1</span>) + γ (2<span class="cItalic">/w</span> <span class="cSubscript">2</span>)</span></pre>
<pre><span class="code">   <span class="cItalic">u = u<span class="cSubscript">s</span>/1<span class="cSubscript">s</span></span></span></pre>
<pre><span class="code">   <span class="cItalic">v = v<span class="cSubscript">s</span>/1<span class="cSubscript">s</span></span></span></pre>
<pre><span class="code">   drawpixel (<span class="cItalic">x<span class="cSubscript">s</span>, y<span class="cSubscript">s</span>)</span> with color texture(<span class="cItalic">u</span>, <span class="cItalic">v</span>)</span>
</pre>
<p>Of course, many of the expressions appearing in this pseudocode would be precomputed outside the loop for speed. For solid textures, it’s simple enough to include the original world space coordinates <span class="cItalic">x<span class="cSubscript">q</span>,y<span class="cSubscript">q</span>, z<span class="cSubscript">q</span></span> in the list of attributes, treated the same as <span class="cItalic">u</span> and <span class="cItalic">v,</span> and correct interpolated world space coordinates will be obtained, which can be passed to the solid texture function.</p>
<h3><a id="sec11-2-5"></a>11.2.5 Continuity and Seams</h3>
<p>Although low distortion and continuity are nice properties to have in a texture coordinate function, discontinuities are often unavoidable. For any closed 3D surface, it’s a basic result of topology that there is no continuous, bijective function that maps the whole surface into a texture image. Something has to give, and by introducing seams—curves on the surface where the texture coordinates change suddenly—we can have low distortion everywhere else. Many of the geometrically determined mappings discussed above already contain seams: in spherical and cylindrical coordinates, the seams are where the angle computed by atan2<a id="page_259"></a> wraps around from π to π, and in the cubemap, the seams are along the cube edges, where the mapping switches between the six square textures.</p>
<p>With interpolated texture coordinates, seams require special consideration, because they don’t happen naturally. We observed earlier that interpolated texture coordinates are automatically continuous on shared-vertex meshes—the sharing of texture coordinates guarantees it. But this means that if a triangle spans a seam, with some vertices on one side and some on the other, the interpolation machinery will cheerfully provide a continuous mapping, but it will likely be highly distorted or fold over so that it’s not injective. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-17">Figure 11.17</a> illustrates this problem on a globe mapped with spherical coordinates. For example, there is a triangle near the bottom of the globe that has one vertex at the tip of New Zealand’s South Island, and another vertex in the Pacific about 400 km northeast of the North Island. A sensible pilot flying between these points would fly over New Zealand, but the path starts at longitude 167°s E (+167) and ends at 179°s W (that is, longitude −179), so linear interpolation chooses a route that crosses South America on the way. This causes a backward copy of the entire map to be compressed into the strip of triangles that crosses the 180<span class="cSuperscript">th</span> meridian! The solution is to label the second vertex with the equivalent longitude of 181°s E, but this just pushes the problem to the next triangle.</p>
<div id="art_Dest_fig_11-17" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-17"></a><span class="cBold">Figure 11.17</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-17.png" alt="Figure showing polygonal globes: on the left, with all shared vertices, the texture coordinate function is continuous, but necessarily has problems with triangles that cross the 180th meridian, because texture coordinates are interpolated from longitudes near 180 to longitudes near −180. On the right, some vertices are duplicated, with identical 3D positions but texture coordinates differing by exactly 360 degrees in longitude, so that texture coordinates are interpolated across the meridian rather than all the way across the map." width="600" height="121" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-17.png"></p>
<p class="Text figcaption">Polygonal globes: on the left, with all shared vertices, the texture coordinate function is continuous, but necessarily has problems with triangles that cross the 180th meridian, because texture coordinates are interpolated from longitudes near 180 to longitudes near −180. On the right, some vertices are duplicated, with identical 3D positions but texture coordinates differing by exactly 360 degrees in longitude, so that texture coordinates are interpolated across the meridian rather than all the way across the map.</p>
</div>
<p>The only way to create a clean transition is to avoid sharing texture coordinates at the seam: the triangle crossing New Zealand needs to interpolate to longitude +181, and the next triangle in the Pacific needs to continue starting from to longitude −179. To do this, we duplicate the vertices at the seam: for each vertex we add a second vertex with an equivalent longitude, differing by 360<span class="cItalic">°</span>s, and the triangles on opposite sides of the seam use different vertices. This solution is shown in the right half of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-17">Figure 11.17</a>, in which the vertices at the far left and right of the texture space are duplicates, with the same 3D positions.</p>
<h2><a id="sec11-3"></a><a id="page_260"></a>11.3 Antialiasing Texture Lookups</h2>
<p>The second fundamental problem of texture mapping is antialiasing. Rendering a texture mapped image is a sampling process: mapping the texture onto the surface and then projecting the surface into the image produces a 2D function across the image plane, and we are sampling it at pixels. As we saw in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a>, doing this using point samples will produce aliasing artifacts when the image contains detail or sharp edges—and since the whole point of textures is to introduce detail, they become a prime source of aliasing problems like the ones we saw in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-3">Figure 11.3</a>.</p>
<div class="Sidebar">
<p class="SidebarText">It’s a good idea to review the first half of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a> now.</p>
</div>
<p>Just as with antialiased rasterization of lines or triangles, antialiased ray tracing (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#sec13-4">Section 13.4</a>), or downsampling images (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml#sec9-4">Section 9.4</a>), the solution is to make each pixel not a point sample but an area average of the image, over an area similar in size to the pixel. Using the same supersampling approach used for antialiased rasterization and ray tracing, with enough samples, excellent results can be obtained with no changes to the texture mapping machinery: many samples within a pixel’s area will land at different places in the texture map, and averaging the shading results computed using the different texture lookups is an accurate way to approximate the average color of the image over the pixel. However, with detailed textures it takes very many samples to get good results, which is slow. Computing this area average <span class="cItalic">efficiently</span> in the presence of textures on the surface is the first key topic in texture antialiasing.</p>
<p>Texture images are usually defined by raster images, so there is also a reconstruction problem to be considered, just as with upsampling images (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml#sec9-4">Section 9.4</a>). The solution is the same for textures: use a reconstruction filter to interpolate between texels.</p>
<p>We expand on each of these topics in the following sections.</p>
<h3><a id="sec11-3-1"></a>11.3.1 The Footprint of a Pixel</h3>
<p>What makes antialiasing textures more complex than other kinds of antialiasing is that the relationship between the rendered image and the texture is constantly changing. Every pixel value should be computed as an average color over the area belonging to the pixel in the image, and in the common case that the pixel is looking at a single surface, this corresponds to averaging over an area on the surface. If the surface color comes from a texture, this in turn amounts to averaging over a corresponding part of the texture, known as the <span class="cItalic">texture space footprint</span> of the pixel. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-18">Figure 11.18</a> illustrates how the footprints of square areas (which could be pixel areas in a lower-resolution image) map to very different sized and shaped areas in the floor’s texture space.</p>
<div id="art_Dest_fig_11-18" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-18"></a><span class="cBold">Figure 11.18</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-18.png" alt="Figure showing the footprints in texture space of identically sized square areas in the image vary in size and shape across the image." width="600" height="272" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-18.png"></p>
<p class="Text figcaption">The footprints in texture space of identically sized square areas in the image vary in size and shape across the image.</p>
</div>
<p><a id="page_261"></a>Recall the three spaces involved in rendering with textures: the projection π that maps 3D points into the image and the texture coordinate function ϕ that maps 3D points into texture space. To work with pixel footprints we need to understand the composition of these two mappings: first follow π backwards to get from the image to the surface, then follow ϕ forwards. This composition ψ = ϕ ∘ π−<span class="cSuperscript">1</span>is what determines pixel footprints: the footprint of a pixel is the image of that pixel’s square area of the image under the mapping ψ.</p>
<p>The core problem in texture antialiasing is computing an average value of the texture over the footprint of a pixel. To do this exactly in general could be a pretty complicated job: for a faraway object with a complicated surface shape, the footprint could be a complicated shape covering a large area, or possibly several disconnected areas, in texture space. But in the typical case, a pixel lands in a smooth area of surface that is mapped to a single area in the texture.</p>
<p>Because ψ contains both the mapping from image to surface and the mapping from surface to texture, the size and shape of the footprint depend on both the viewing situation and the texture coordinate function. When a surface is closer to the camera, pixel footprints will be smaller; when the same surface moves farther away, the footprint gets bigger. When surfaces are viewed at an oblique angle, the footprint of a pixel on the surface is elongated, which usually means it will be elongated in texture space also. Even with a fixed view, the texture coordinate function can cause variations in the footprint: if it distorts area, the size of footprints will vary, and if it distorts shape, they can be elongated even for head-on views of the surface.</p>
<p>However, to find an efficient algorithm for computing antialiased lookups, some substantial approximations will be needed. When a function is smooth,<a id="page_262"></a> a linear approximation is often useful. In the case of texture antialiasing, this means approximating the mapping ψ from image space to texture space as a linear mapping from 2D to 2D:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-392-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_488&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C8;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x3C8;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;0&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;0&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_488" overflow="scroll" style="width: 12.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.085em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1012.04em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-21739"><span class="mrow" id="MathJax-Span-21740"><span class="mi" id="MathJax-Span-21741" style="font-family: MathJax_Math-italic;">ψ</span><span class="mrow" id="MathJax-Span-21742" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21743" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-21744"><span class="mrow" id="MathJax-Span-21745"><span class="mi" id="MathJax-Span-21746" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-21747" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21748" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-21749" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">ψ</span><span class="mrow" id="MathJax-Span-21750" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21751" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21752"><span class="msub" id="MathJax-Span-21753"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-21754"><span class="mrow" id="MathJax-Span-21755"><span class="mi" id="MathJax-Span-21756" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-21757" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21758" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21759" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mstyle" id="MathJax-Span-21760" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-21761"><span class="mi" id="MathJax-Span-21762" style="font-family: MathJax_Main-bold;">J</span></span></span><span class="mrow" id="MathJax-Span-21763" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21764" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21765"><span class="mstyle" id="MathJax-Span-21766"><span class="mrow" id="MathJax-Span-21767"><span class="mi" id="MathJax-Span-21768" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-21769" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-21770" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-21771"><span class="mrow" id="MathJax-Span-21772"><span class="mi" id="MathJax-Span-21773" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mtext" id="MathJax-Span-21774" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21775" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21776" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_488"><mrow><mi>ψ</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mi>ψ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mtext>0</mtext></msub></mrow><mo>)</mo></mrow><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>J</mi></mstyle><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mtext>0</mtext></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-392"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_488"><mrow><mi>ψ</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mi>ψ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mtext>0</mtext></msub></mrow><mo>)</mo></mrow><mo>+</mo><mstyle mathvariant="bold" mathsize="normal"><mi>J</mi></mstyle><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mtext>0</mtext></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></script></p>
<div class="Sidebar">
<p class="SidebarText">In mathematicians’ terms, we have made a one-term Taylor series approximation to the function ψ.</p>
</div>
<p>where the 2-by-2 matrix <span class="cBold">J</span> is some approximation to the derivative of ψ. It has four entries, and if we denote the image-space position as <span class="cBold">x</span> = (<span class="cItalic">x</span>, <span class="cItalic">y</span>) and the texture-space position as <span class="cBold">u</span> = (<span class="cItalic">u</span>, <span class="cItalic">v</span>) then</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-393-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_489&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_489" overflow="scroll" style="width: 7.818em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.56em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1007.52em, 5.555em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-21778"><span class="mrow" id="MathJax-Span-21779"><span class="mstyle" id="MathJax-Span-21780"><span class="mrow" id="MathJax-Span-21781"><span class="mi" id="MathJax-Span-21782" style="font-family: MathJax_Main-bold;">M</span></span></span><span class="mo" id="MathJax-Span-21783" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-21784" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-21785" style="vertical-align: 1.905em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.334em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21786"><span class="mtable" id="MathJax-Span-21787" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 3.087em; height: 0px;"><span style="position: absolute; clip: rect(2.111em, 1001.14em, 5.607em, -1000.01em); top: -4.162em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.14em, 4.578em, -1000.01em); top: -5.036em; left: 0em;"><span class="mtd" id="MathJax-Span-21788"><span class="mrow" id="MathJax-Span-21789"><span class="mrow" id="MathJax-Span-21790"><span class="mfrac" id="MathJax-Span-21791"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21792"><span class="mi" id="MathJax-Span-21793" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21795"><span class="mi" id="MathJax-Span-21796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.933em, 1001.14em, 4.578em, -1000.01em); top: -3.134em; left: 0em;"><span class="mtd" id="MathJax-Span-21808"><span class="mrow" id="MathJax-Span-21809"><span class="mrow" id="MathJax-Span-21810"><span class="mfrac" id="MathJax-Span-21811"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.68em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-21812"><span class="mi" id="MathJax-Span-21813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21814" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21815"><span class="mi" id="MathJax-Span-21816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21817" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.167em;"></span></span><span style="position: absolute; clip: rect(2.265em, 1001.14em, 5.864em, -1000.01em); top: -4.316em; left: 1.956em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.14em, 4.733em, -1000.01em); top: -5.036em; left: 0em;"><span class="mtd" id="MathJax-Span-21798"><span class="mrow" id="MathJax-Span-21799"><span class="mrow" id="MathJax-Span-21800"><span class="mfrac" id="MathJax-Span-21801"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.78em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-21802"><span class="mi" id="MathJax-Span-21803" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21804" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-21805"><span class="mi" id="MathJax-Span-21806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.933em, 1001.09em, 4.733em, -1000.01em); top: -3.134em; left: 0em;"><span class="mtd" id="MathJax-Span-21818"><span class="mrow" id="MathJax-Span-21819"><span class="mrow" id="MathJax-Span-21820"><span class="mfrac" id="MathJax-Span-21821"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.68em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-21822"><span class="mi" id="MathJax-Span-21823" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21824" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.73em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-21825"><span class="mi" id="MathJax-Span-21826" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21827" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.83em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.825em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.321em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21828" style="vertical-align: 1.905em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.334em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21829" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.48em; border-left: 0px solid; width: 0px; height: 3.551em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_489"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>M</mi></mstyle><mo>=</mo><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>v</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>v</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-393"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_489"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>M</mi></mstyle><mo>=</mo><mrow><mo>[</mo> <mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>v</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mrow><mfrac><mrow><mi>d</mi><mi>v</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></mrow></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>,</mo></mrow></math></script></p>
<p>where the four derivatives describe how the texture point (<span class="cItalic">u</span>, <span class="cItalic">v</span>) that is seen at a point (<span class="cItalic">x</span>, <span class="cItalic">y</span>) in the image changes when we change <span class="cItalic">x</span> and <span class="cItalic">y</span>.</p>
<div id="art_Dest_fig_11-19" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-19"></a><span class="cBold">Figure 11.19</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-19.png" alt="Figure showing an approximation of the texture-space footprint of a pixel can be made using the derivative of the mapping from (x, y) to (u, v). The partial derivatives with respect to x and y are parallel to the images of the x and y isolines (blued) and span a parallelogram (shaded in orange) that approximates the curved shape of the exact footprint (outlined in black)." width="600" height="313" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-19.png"></p>
<p class="Text figcaption">An approximation of the texture-space footprint of a pixel can be made using the derivative of the mapping from (<span class="cItalic">x</span>, <span class="cItalic">y</span>) to (<span class="cItalic">u</span>, <span class="cItalic">v</span>). The partial derivatives with respect to <span class="cItalic">x</span> and <span class="cItalic">y</span> are parallel to the images of the <span class="cItalic">x</span> and <span class="cItalic">y</span> isolines (blued) and span a parallelogram (shaded in orange) that approximates the curved shape of the exact footprint (outlined in black).</p>
</div>
<p>A geometric interpretation of this approximation is that it says a unit-sized square pixel area centered at <span class="cBold">x</span> in the image will map approximately to a parallelogram in texture space, centered at ψ(<span class="cItalic">x</span>) and with its edges parallel to the vectors <span class="cBold">u</span><span class="cSubscript">x</span> = (<span class="cItalic">du/dx, dv/dx</span>) and <span class="cBold">u</span><span class="cItalic">y</span> = (<span class="cItalic">du</span>/<span class="cItalic">dy</span>, <span class="cItalic">dv</span>/<span class="cItalic">dy</span>).</p>
<p>The derivative matrix <span class="cBold">J</span> is useful because it tells the whole story of variation in the (approximated) texture-space footprint across the image. Derivatives that are larger in magnitude indicate larger texture-space footprints, and the relationship between the derivative vectors <span class="cBold">u</span><span class="cSubscript">x</span> and <span class="cBold">u</span><span class="cSubscript">y</span> indicates the shape. When they<a id="page_263"></a> are orthogonal and the same length, the footprint is square, and as they become skewed and/or very different in length, the footprint becomes elongated.</p>
<p>We’ve now reached the form of the problem that’s usually thought of as the “right answer”: a <span class="cItalic">filtered texture sample</span> at a particular image-space position should be the average value of the texture map over the parallelogram-shaped footprint defined by the texture coordinate derivatives at that point. This already has some assumptions baked into it—namely, that the mapping from image to texture is smooth—but it is sufficiently accurate for excellent image quality. However, this parallelogram area average is already too expensive to compute exactly, so various approximations are used. Approaches to texture antialiasing differ in the speed/quality tradeoffs they make in approximating this lookup. We discuss these in the following sections.</p>
<div class="Sidebar">
<p class="SidebarText">The approach here uses a box filter to sample the image. Some systems instead use a Gaussian pixel filter, which becomes an elliptical Gaussian in texture space; this is elliptical weighted averaging (EWA).</p>
</div>
<h3><a id="sec11-3-2"></a>11.3.2 Reconstruction</h3>
<p>When the footprint is smaller than a texel, we are magnifying the texture as it is mapped into the image. This case is analogous to upsampling an image, and the main consideration is interpolating between texels to produce a smooth image in which the texel grid is not obvious. Just as in image upsampling, this smoothing process is defined by a reconstruction filter that is used to compute texture samples at arbitrary locations in texture space. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-20">Figure 11.20</a>.)</p>
<div id="art_Dest_fig_11-20" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-20"></a><span class="cBold">Figure 11.20</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-20.png" alt="Figure showing the dominant issues in texture filtering change with the footprint size. For small footprints (left) interpolating between pixels is needed to avoid blocky artifacts; for large footprints, the challenge is to efficiently find the average of many pixels." width="600" height="350" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-20.png"></p>
<p class="Text figcaption">The dominant issues in texture filtering change with the footprint size. For small footprints (left) interpolating between pixels is needed to avoid blocky artifacts; for large footprints, the challenge is to efficiently find the average of many pixels.</p>
</div>
<p><a id="page_264"></a>The considerations are pretty much the same as in image resampling, with one important difference. In image resampling, the task is to compute output samples on a regular grid, and that regularity enabled an important optimization in the case of a separable reconstruction filter. In texture filtering, the pattern of lookups is not regular, and the samples have to be computed separately. This means large, high-quality reconstruction filters are very expensive to use, and for this reason the highest-quality filter normally used for textures is bilinear interpolation.</p>
<p>The calculation of a bilinearly interpolated texture sample is the same as computing one pixel in an image being upsampled with bilinear interpolation. First we express the texture-space sample point in terms of (real-valued) texel coordinates, then we read the values of the four neighboring texels and average them. Textures are usually parameterized over the unit square, and the texels are located in the same way as pixels in any image, spaced a distance 1<span class="cItalic">/n<span class="cSubscript">u</span></span> apart in the <span class="cItalic">u</span> direction and 1<span class="cItalic">/n<span class="cSubscript">v</span></span> in <span class="cItalic">v</span> , with texel (0,0) positioned half a texel in from the edge for symmetry. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a> for the full explanation.)</p>
<pre><span class="code">Color tex_sample_bilinear(Texture t, float u, float v) {</span></pre>
<pre><span class="code"> u_p = u * t.width - 0.5</span></pre>
<pre><span class="code"> v_p = v * t.height - 0.5</span></pre>
<pre><span class="code"> iu0 = floor(u_p); iu1 = iu0 + 1</span></pre>
<pre><span class="code"> iv0 = floor(v_p); iv1 = iv0 + 1</span></pre>
<pre><span class="code"> a_u = (iu1 - u_p); b_u = 1 - a_u</span></pre>
<pre><span class="code"> a_v = (iv1 - v_p); b_v = 1 - a_v</span></pre>
<pre><span class="code"> return a_u * a_v * t[iu0][iv0] + a_u * b_v * t[iu0][iv1] +</span></pre>
<pre><span class="code">  b_u * a_v * t[iu1][iv0] + b_u * b_v * t[iu1][iv1]</span></pre>
<pre><span class="code">}</span></pre>
<p>In many systems, this operation becomes an important performance bottleneck, mainly because of the memory latency involved in fetching the four texel values from the texture data. The pattern of sample points for textures is irregular, because the mapping from image to texture space is arbitrary, but often coherent, since nearby image points tend to map to nearby texture points that may read the same texels. For this reason, high-performance systems have special hardware devoted to texture sampling that handles interpolation and manages caches of recently used texture data to minimize the number of slow data fetches from the memory where the texture data is stored.</p>
<p>After reading <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C009.xhtml">Chapter 9</a> you may complain that linear interpolation may not be a smooth enough reconstruction for some demanding applications. However, it can always be made good enough by resampling the texture to a somewhat higher resolution using a better filter, so that the texture is smooth enough that bilinear interpolation works well.</p>
<h3><a id="sec11-3-3"></a><a id="page_265"></a>11.3.3 Mipmapping</h3>
<p>Doing a good job of interpolation only suffices in situations where the texture is being magnified: where the pixel footprint is small compared to the spacing of texels. When a pixel footprint covers many texels, good antialiasing requires computing the average of many texels to smooth out the signal so that it can be sampled safely.</p>
<p>One very accurate way to compute the average texture value over the footprint would be to find all the texels within the footprint and add them up. However, this is potentially very expensive when the footprint is large—it could require reading many thousands of texel just for a single lookup. A better approach is to precompute and store the averages of the texture over various areas of different size and position.</p>
<p>A very popular version of this idea is known as “MIP mapping” or just mipmapping. A mipmap is a sequence of textures that all contain the same image but at lower and lower resolution. The original, full-resolution texture image is called the <span class="cItalic">base level</span> , or level 0, of the mipmap, and level 1 is generated by taking that image and downsampling it by a factor of 2 in each dimension, resulting in an image with one-fourth as many texels. The texels in this image are, roughly speaking, averages of square areas 2 by 2 texels in size in the level-0 image.</p>
<p>This process can be continued to define as many mipmap levels as desired: the image at level <span class="cItalic">k</span> is computed by downsampling the image at level <span class="cItalic">k</span> − 1 by two. A texel at level <span class="cItalic">k</span> corresponds to a square area measuring 2<span class="cSuperscript"><span class="cItalic">k</span></span> by 2<span class="cSuperscript"><span class="cItalic">k</span></span> texels in the original texture. For instance, starting with a 1024 × 1024 texture image, we could generate a mipmap with 11 levels: level 0 is 1024 × 1024; level 1 is 512 × 512, and so on until level 10, which has just a single texel. This kind of structure, with images that represent the same content at a series of lower and lower sampling rates, is called an <span class="cItalic">image pyramid</span> , based on the visual metaphor of stacking all the smaller images on top of the original.</p>
<div class="Sidebar">
<p class="SidebarText">The name “mip” stands for the Latin phrase <span class="cItalic">multim in parvo</span> meaning “much in a small space.”</p>
</div>
<h3><a id="sec11-3-4"></a>11.3.4 Basic Texture Filtering with Mipmaps</h3>
<p>With the mipmap, or image pyramid, in hand, texture filtering can be done much more efficiently than by accessing many texels individually. When we need a texture value averaged over a large area, we simply use values from higher levels of the mipmap, which are already averages over large areas of the image. The simplest and fastest way to do this is to look up a single value from the mipmap, choosing the level so that the size covered by the texels at that level is roughly the same as the overall size of the pixel footprint. Of course, the pixel footprint might<a id="page_266"></a> be quite different in shape from the (always square) area represented by the texel, and we can expect that to produce some artifacts.</p>
<p>Setting aside for a moment the question of what to do when the pixel footprint has an elongated shape, suppose the footprint is a square of width <span class="cItalic">D</span>, measured in terms of texels in the full-resolution texture. What level of the mipmap is it appropriate to sample? Since the texels at level <span class="cItalic">k</span> cover squares of width 2<span class="cSuperscript"><span class="cItalic">k</span></span>, it seems appropriate to choose <span class="cItalic">k</span> so that</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-394-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_490&quot;&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_490" overflow="scroll" style="width: 3.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1002.99em, 2.265em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21831"><span class="mrow" id="MathJax-Span-21832"><span class="msup" id="MathJax-Span-21833"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-21834" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.517em;"><span class="mi" id="MathJax-Span-21835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21836" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mi" id="MathJax-Span-21837" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.05em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_490"><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>≈</mo><mi>D</mi></mrow></math></span></span><script type="math/mml" id="MathJax-Element-394"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_490"><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>≈</mo><mi>D</mi></mrow></math></script></p>
<p>so we let <span class="cItalic">k</span> = log<span class="cSubscript">2</span><span class="cItalic">D</span>. Of course this will give non-integer values of <span class="cItalic">k</span> most of the time, and we only have stored mipmap images for integer levels. Two possible solutions are to look up a value only for the integer nearest to <span class="cItalic">k</span> (efficient but produces seams at the abrupt transitions between levels) or to look up values for the <span class="cItalic">two</span> nearest integers to <span class="cItalic">k</span> and linearly interpolate the values (twice the work, but smoother).</p>
<p>Before we can actually write down the algorithm for sampling a mipmap, we have to decide how we will choose the “width” D when footprints are not square. Some possibilities might be to use the square root of the area or to find the longest axis of the footprint and call that the width. A practical compromise that is easy to compute is to use the length of the longest edge:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-395-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_491&quot;&gt;&lt;mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_491" overflow="scroll" style="width: 11.365em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.005em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1010.91em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21839"><span class="mrow" id="MathJax-Span-21840"><span class="mi" id="MathJax-Span-21841" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-21842" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-21843" style="font-family: MathJax_Main; padding-left: 0.26em;">max</span><span class="mo" id="MathJax-Span-21844" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-21845" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21846" style=""><span style="font-family: MathJax_Main;">{</span></span><span class="mrow" id="MathJax-Span-21847"><span class="mrow" id="MathJax-Span-21848"><span class="mo" id="MathJax-Span-21849" style="font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-21850"><span class="msub" id="MathJax-Span-21851"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-21852"><span class="mrow" id="MathJax-Span-21853"><span class="mi" id="MathJax-Span-21854" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-21855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21856" style="font-family: MathJax_Main;">||</span></span><span class="mo" id="MathJax-Span-21857" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span><span class="mrow" id="MathJax-Span-21858" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21859" style="font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-21860"><span class="msub" id="MathJax-Span-21861"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-21862"><span class="mrow" id="MathJax-Span-21863"><span class="mi" id="MathJax-Span-21864" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-21865" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21866" style="font-family: MathJax_Main;">||</span></span></span><span class="mo" id="MathJax-Span-21867" style=""><span style="font-family: MathJax_Main;">}</span></span></span><span class="mo" id="MathJax-Span-21868" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_491"><mrow><mi>D</mi><mo>=</mo><mi>max</mi><mo>&nbsp;​⁡</mo><mrow><mo>{</mo><mrow><mrow><mo>||</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mi>x</mi></msub></mrow><mo>||</mo></mrow><mo>,</mo><mrow><mo>||</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mi>y</mi></msub></mrow><mo>||</mo></mrow></mrow><mo>}</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-395"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_491"><mrow><mi>D</mi><mo>=</mo><mi>max</mi><mo> ​⁡</mo><mrow><mo>{</mo> <mrow><mrow><mo>||</mo> <mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mi>x</mi></msub></mrow> <mo>||</mo></mrow><mo>,</mo><mrow><mo>||</mo> <mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mi>y</mi></msub></mrow> <mo>||</mo></mrow></mrow> <mo>}</mo></mrow><mo>.</mo></mrow></math></script></p>
<pre><span class="code">Color mipmap_sample_trilinear(Texture mip[], float u, float v,</span></pre>
<pre><span class="code">   matrix J) {</span></pre>
<pre><span class="code">   D = max_column_norm(J)</span></pre>
<pre><span class="code">   k = log2(D)</span></pre>
<pre><span class="code">   k0 = floor(k); k1 = k0 + 1</span></pre>
<pre><span class="code">   a=k1-k;b=1-a</span></pre>
<pre><span class="code">   C0 = tex_sample_bilinear(mip[k0], u, v)</span></pre>
<pre><span class="code">   c1 = tex_sample_bilinear(mip[k1], u, v)</span></pre>
<pre><span class="code">   return a * C0 + b * c1</span></pre>
<pre><span class="code">}</span></pre>
<p>Basic mipmapping does a good job of removing aliasing, but because it’s unable to handle elongated, or <span class="cItalic">anisotropic</span> pixel footprints, it doesn’t perform well when surfaces are viewed at grazing angles. This is most commonly seen on large planes that represent a surface the viewer is standing on. Points on the floor that are far away are viewed at very steep angles, resulting in very anisotropic footprints that mipmapping approximates with much larger square areas. The resulting image will appear blurred in the horizontal direction.</p>
<h3><a id="sec11-3-5"></a><a id="page_267"></a>11.3.5 Anisotropic Filtering</h3>
<p>A mipmap can be used with multiple lookups to approximate an elongated footprint better. The idea is to select the mipmap level based on the <span class="cItalic">shortest</span> axis of the footprint rather than the largest, then average together several lookups spaced along the long axis. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-21">Figure 11.21</a>.)</p>
<div id="art_Dest_fig_11-21" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-21"></a><span class="cBold">Figure 11.21</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-21.png" alt="Figure showing the results of antialiasing a challenging test scene (reference images showing detailed structure, at left) using three different strategies: simply taking a single point sample with nearest-neighbor interpolation; using a mipmap pyramid to average a square area in the texture for each pixel; using several samples from a mipmap to average an anisotropic region in the texture." width="600" height="164" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-21.png"></p>
<p class="Text figcaption">The results of antialiasing a challenging test scene (reference images showing detailed structure, at left) using three different strategies: simply taking a single point sample with nearest-neighbor interpolation; using a mipmap pyramid to average a square area in the texture for each pixel; using several samples from a mipmap to average an anisotropic region in the texture.</p>
</div>
<h2><a id="sec11-4"></a>11.4 Applications of Texture Mapping</h2>
<p>Once you understand the idea of defining texture coordinates for a surface and the machinery of looking up texture values, this machinery has many uses. In this section we survey a few of the most important techniques in texture mapping, but textures are a very general tool with applications limited only by what the programmer can think up.</p>
<h3><a id="sec11-4-1"></a>11.4.1 Controlling Shading Parameters</h3>
<p>The most basic use of texture mapping is to introduce variation in color by making the diffuse color that is used in shading computations—whether in a ray tracer or in a fragment shader—dependent on a value looked up from a texture. A textured diffuse component can be used to paste decals, paint decorations, or print text on a surface, and it can also simulate the variation in material color, for example for wood or stone.</p>
<p>Nothing limits us to varying only the diffuse color, though. Any other parameters, such as the specular reflectance or specular roughness, can also be textured. For instance, a cardboard box with transparent packing tape stuck to it may have the same diffuse color everywhere but be shinier, with higher specular reflectance<a id="page_268"></a> and lower roughness, where the tape is than elsewhere. In many cases the maps for different parameters are correlated: for instance, a glossy white ceramic cup with a logo printed on it may be both rougher and darker where it is printed (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-22">Figure 11.22</a>), and a book with its title printed in metallic ink might change in diffuse color, specular color, and roughness, all at once.</p>
<div id="art_Dest_fig_11-22" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-22"></a><span class="cBold">Figure 11.22</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-22.png" alt="Figure showing a ceramic mug with specular roughness controlled by an inverted copy of the diffuse color texture." width="406" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-22.png"></p>
<p class="Text figcaption">A ceramic mug with specular roughness controlled by an inverted copy of the diffuse color texture.</p>
</div>
<h3><a id="sec11-4-2"></a>11.4.2 Normal Maps and Bump Maps</h3>
<p>Another quantity that is important for shading is the surface normal. With interpolated normals (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml#sec8-2">Section 8.2</a>), we know that the shading normal does not have to be the same as the geometric normal of the underlying surface. <span class="cItalic">Normal mapping</span> takes advantage of this fact by making the shading normal depend on values read from a texture map. The simplest way to do this is just to store the normals in a texture, with three numbers stored at every texel that are interpreted, instead of as the three components of a color, as the 3D coordinates of the normal vector.</p>
<p>Before a normal map can be used, though, we need to know what coordinate system the normals read from the map are represented in. Storing normals directly in object space, in the same coordinate system used for representing the surface geometry itself, is simplest: the normal read from the map can be used in exactly the same way as the normal reported by the surface itself: in most cases it will need to be transformed into world space for lighting calculations, just like a normal that came with the geometry.</p>
<p>However, normal maps that are stored in object space are inherently tied to the surface geometry—even for the normal map to have no effect, to reproduce the result with the geometric normals, the contents of the normal map have to track the orientation of the surface. Furthermore, if the surface is going to deform, so that the geometric normal changes, the object-space normal map can no longer be used, since it would keep providing the same shading normals.</p>
<p>The solution is to define a coordinate system for the normals that is attached to the surface. Such a coordinate system can be defined based on the tangent space of the surface (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5">Section 2.5</a>): select a pair of tangent vectors and use them to define an orthonormal basis (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-4-5">Section 2.4.5</a>). The texture coordinate function itself provides a useful way to select a pair of tangent vectors: use the directions tangent to lines of constant <span class="cItalic">u</span> and <span class="cItalic">v</span> . These tangents are not generally orthogonal, but we can use the procedure from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-4-7">Section 2.4.7</a> to “square up” the orthonormal basis, or it can be defined using the surface normal and just one tangent vector.</p>
<p>When normals are expressed in this basis they vary a lot less; since they are mostly pointing near the direction of the normal to the smooth surface, they will be near the vector (0, 0, 1)<span class="cSuperscript"><span class="cItalic">T</span></span> in the normal map.</p>
<p><a id="page_269"></a>Where do normal maps come from? Often they are computed from a more detailed model to which the smooth surface is an approximation; other times they can be measured directly from real surfaces. They can also be authored as part of the modeling process; in this case it’s often nice to use a <span class="cItalic">bump map</span> to specify the normals indirectly. The idea is that a bump map is a height field: a function that give the local height of the detailed surface above the smooth surface. Where the values are high (where the map looks bright, if you display it as an image) the surface is protruding outside the smooth surface; where the values are low (where the map looks dark) the surface is receding below it. For instance, a narrow dark line in the bump map is a scratch, or a small white dot is a bump.</p>
<p>Deriving a normal map from a bump map is simple: the normal map (expressed in the tangent frame) is the derivative of the bump map.</p>
<p><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-23">Figure 11.23</a> shows texture maps being used to create woodgrain color and to simulate increased surface roughness due to finish soaking into the more porous parts of the wood, together with a bump map to create an imperfect finish and gaps between boards, to make a realistic wood floor.</p>
<div id="art_Dest_fig_11-23" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-23"></a><span class="cBold">Figure 11.23</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-23.png" alt="Figure showing a wood floor rendered using texture maps to control the shading. (a) Only the diffuse color is modulated by a texture map. (b) The specular roughness is also modulated by a second texture map. (c) The surface normal is modified by a bump map." width="600" height="394" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-23.png"></p>
<p class="Text figcaption">A wood floor rendered using texture maps to control the shading. (a) Only the diffuse color is modulated by a texture map. (b) The specular roughness is also modulated by a second texture map. (c) The surface normal is modified by a bump map.</p>
</div>
<h3><a id="page_270"></a><a id="sec11-4-3"></a>11.4.3 Displacement Maps</h3>
<p>A problem with normal maps is that they don’t actually change the surface at all; they are just a shading trick. This becomes obvious when the geometry implied by the normal map should cause noticeable effects in 3D. In still images, the first problem to be noticed is usually that the silhouettes of objects remain smooth despite the appearance of bumps in the interior. In animations, the lack of parallax gives away that the bumps, however convincing, are really just “painted” on the surface.</p>
<p>Textures can be used for more than just shading, though: they can be used to alter geometry. A displacement map is one of the simplest versions of this idea. The concept is the same as a bump map: a scalar (one-channel) map that gives the height above the “average terrain.” But the effect is different. Rather than deriving a shading normal from the height map while using the smooth geometry, a displacement map actually changes the surface, moving each point along the normal of the smooth surface to a new location. The normals are roughly the same in each case, but the surface is different.</p>
<p>The most common way to implement displacement maps is to tessellate the smooth surface with a large number of small triangles, and then displace the vertices of the resulting mesh using the displacement map. In the graphics pipeline, this can be done using a texture lookup at the vertex stage, and is particularly handy for terrain.</p>
<h3><a id="sec11-4-4"></a>11.4.4 Shadow Maps</h3>
<p>Shadows are an important cue to object relationships in a scene, and as we have seen, they are simple to include in ray-traced images. However, it’s not obvious how to get shadows in rasterized renderings, because surfaces are considered one at a time, in isolation. Shadow maps are a technique for using the machinery of texture mapping to get shadows from point light sources.</p>
<p>The idea of a shadow map is to represent the volume of space that is illuminated by a point light source. Think of a source like a spotlight or video projector, which emits light from a point into a limited range of directions. The volume that is illuminated—the set of points where you would see light on your hand if you held it there—is the union of line segments joining the light source to the closest surface point along every ray leaving that point.</p>
<p>Interestingly, this volume is the same as the volume that is visible to a perspective camera located at the same point as the light source: a point is illuminated by a source if and only if it is visible from the light source location. In both<a id="page_271"></a> cases, there’s a need to evaluate visibility for points in the scene: for visibility, we needed to know whether a fragment was visible to the camera, to know whether to draw it in the image; and for shadowing, we need to know whether a fragment is visible to the light source, to know whether it’s illuminated by that source or not. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-24">Figure 11.24</a>.)</p>
<div id="art_Dest_fig_11-24" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-24"></a><span class="cBold">Figure 11.24</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-24.png" alt="Figure showing top: the region of space illuminated by a point light. Bottom: that region as approximated by a 10-pixel-wide shadow map." width="600" height="489" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-24.png"></p>
<p class="Text figcaption">Top: the region of space illuminated by a point light. Bottom: that region as approximated by a 10-pixel-wide shadow map.</p>
</div>
<p>In both cases, the solution is the same: a depth map that tells the distance to the closest surface along a bunch of rays. In the visibility case, this is the <span class="cItalic">z</span> -buffer (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml#sec8-2-3">Section 8.2.3</a>), and for the shadowing case, it is called a <span class="cItalic">shadow map</span>. In both cases, visibility is evaluated by comparing the depth of a new fragment to the depth stored in the map, and the surface is hidden from the projection point (occluded or shadowed) if its depth is greater than the depth of the closest visible surface. A difference is that the <span class="cItalic">z</span> buffer is used to keep track of the closest surface seen <span class="cItalic">so far</span> and is updated during rendering, whereas a shadow map tells the distance to the closest surface in the whole scene.</p>
<p>A shadow map is calculated in a separate rendering pass ahead of time: simply rasterize the whole scene as usual, and retain the resulting depth map (there is no need to bother with calculating pixel values). Then, with the shadow map in hand, you perform an ordinary rendering pass, and when you need to know whether a fragment is visible to the source, you project its location in the shadow map (using the same perspective projection that was used to render the shadow map in the first place) and compare the looked-up value <span class="cItalic">d</span> <span class="cSubscript">map</span> with the actual distance <span class="cItalic">d</span> to<a id="page_272"></a> the source. If the distances are the same, the fragment’s point is illuminated; if the <span class="cItalic">d</span> &gt; <span class="cItalic">d</span><span class="cSubscript">map</span>, that implies there is a different surface closer to the source, so it is shadowed.</p>
<p>The phrase “if the distances are the same” should raise some red flags in your mind: since all the quantities involved are approximations with limited precision, we can’t expect them to be exactly the same. For visible points, the <span class="cItalic">d</span> ≈ <span class="cItalic">d</span><span class="cSubscript">map</span>but sometimes <span class="cItalic">d</span> will be a bit larger and sometimes a bit smaller. For this reason, a tolerance is required: a point is considered illuminated if <span class="cItalic">d</span> − <span class="cItalic">d</span><span class="cSubscript">map</span> &gt; ∈. This tolerance ∈ is known as <span class="cItalic">shadow bias</span>.</p>
<p>When looking up in shadow maps it doesn’t make a lot of sense to interpolate between the depth values recorded in the map. This might lead to more accurate depths (requiring less shadow bias) in smooth areas, but will cause bigger problems near shadow boundaries, where the depth value changes suddenly. Therefore, texture lookups in shadow maps are done using nearest-neighbor reconstruction. To reduce aliasing, multiple samples can be used, with the 1-or-0 shadow results (rather than the depths) averaged; this is known as <span class="cItalic">percentage closer filtering.</span></p>
<h3><a id="sec11-4-5"></a>11.4.5 Environment Maps</h3>
<p>Just as a texture is handy for introducing detail into the shading on a surface without having to add more detail to the model, a texture can also be used to introduce detail into the illumination without having to model complicated light source geometry. When light comes from far away compared to the size of objects in view, the illumination changes very little from point to point in the scene. It is handy to make the assumption that the illumination depends only on the direction you look, and is the same for all points in the scene, and then to express this dependence of illumination on direction using an <span class="cItalic">environment map.</span></p>
<p>The idea of an environment map is that a function defined over directions in 3D is a function on the unit sphere, so it can be represented using a texture map in exactly the same way as we might represent color variation on a spherical object. Instead of computing texture coordinates from the 3D coordinates of a surface point, we use exactly the same formulas to compute texture coordinates from the 3D coordinates of the unit vector that represents the direction from which we want to know the illumination.</p>
<p>The simplest application of an environment map is to give colors to rays in a ray tracer that don’t hit any objects:</p>
<pre><span class="code">trace_ray(ray, scene) {</span></pre>
<pre><span class="code">   if (surface = scene.intersect(ray)) {</span></pre>
<pre><span class="code"><a id="page_273"></a>   return surface.shade(ray)</span></pre>
<pre><span class="code">} else {</span></pre>
<pre><span class="code">   u, v = spheremap_coords(r.direction)</span></pre>
<pre><span class="code">   return texture_lookup(scene.env_map, u, v)</span></pre>
<pre><span class="code">  }</span></pre>
<pre><span class="code">}</span></pre>
<p>With this change to the ray tracer, shiny objects that reflect other scene objects will now also reflect the background environment.</p>
<p>A similar effect can be achieved in the rasterization context by adding a mirror reflection to the shading computation, which is computed in the same way as in a ray tracer, but simply looks up directly in the environment map with no regard for other objects in the scene:</p>
<pre><span class="code">shade_fragment(view_dir, normal) {</span></pre>
<pre><span class="code">   out_color = diffuse_shading(k_d, normal)</span></pre>
<pre><span class="code">   out_color += specular_shading(k_s, view_dir, normal)</span></pre>
<pre><span class="code">   u, v = spheremap_coords(reflect(view_dir, normal))</span></pre>
<pre><span class="code">   out_color += k_m * texture_lookup(environment_map, u, v)</span></pre>
<pre><span class="code">}</span></pre>
<p>This technique is known as <span class="cItalic">reflection mapping</span>.</p>
<p>A more advanced used of environment maps computes all the illumination from the environment map, not just the mirror reflection. This is <span class="cItalic">environment lighting</span> , and can be computed in a ray tracer using Monte Carlo integration or in rasterization by approximating the environment with a collection of point sources and computing many shadow maps.</p>
<p>Environment maps can be stored in any coordinates that could be used for mapping a sphere. Spherical (longitude–latitude) coordinates are one popular option, though the compression of texture at the poles wastes texture resolution and can create artifacts at the poles. Cubemaps are a more efficient choice, widely used in interactive applications (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-25">Figure 11.25</a>).</p>
<div id="art_Dest_fig_11-25" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-25"></a><span class="cBold">Figure 11.25</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-25.png" alt="Figure showing a cube map of St. Peter’s Basilica, with the six faces stored in on image in the unwrapped “horizontal cross” arrangement. (texture: Emil Persson)" width="600" height="450" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-25.png"></p>
<p class="Text figcaption">A cube map of St. Peter’s Basilica, with the six faces stored in on image in the unwrapped “horizontal cross” arrangement. (texture: Emil Persson)</p>
</div>
<h2><a id="sec11-5"></a>11.5 Procedural 3D Textures</h2>
<p>In previous chapters, we used <span class="cItalic">c<span class="cSubscript">r</span></span> as the diffuse reflectance at a point on an object. For an object that does not have a solid color, we can replace this with a function <span class="cItalic">c</span><span class="cItalic">r</span>(<span class="cBold">p</span>) which maps 3D points to RGB colors (Peachey, 1985; Perlin, 1985). This function might just return the reflectance of the object that contains <span class="cBold">p</span>. But for objects with <span class="cItalic">texture</span>, we should expect <span class="cItalic">c</span><span class="cItalic">r</span>(<span class="cBold">p</span>) to vary as <span class="cBold">p</span> moves across a surface.</p>
<p>An alternative to defining texture mapping functions that map from a 3D surface to a 2D texture domain is to create a 3D texture that defines an RGB value at<a id="page_274"></a> every point in 3D space. We will only call it for points <span class="cBold">p</span> on the surface, but it is usually easier to define it for all 3D points than a potentially strange 2D subset of points that are on an arbitrary surface. The good thing about 3D texture mapping is that it is easy to define the mapping function, because the surface is already embedded in 3D space, and there is no distortion in the mapping from 3D to texture space. Such a strategy is clearly suitable for surfaces that are “carved” from a solid medium, such as a marble sculpture.</p>
<p>The downside to 3D textures is that storing them as 3D raster images or <span class="cItalic">volumes</span> consumes a great deal of memory. For this reason, 3D texture coordinates are most commonly used with <span class="cItalic">procedural textures</span> in which the texture values are computed using a mathematical procedure rather than by looking them up from a texture image. In this section, we look at a couple of the fundamental tools used to define procedural textures. These could also be used to define 2D procedural textures, though in 2D it is more common to use raster texture images.</p>
<h3><a id="sec11-5-1"></a>11.5.1 3D Stripe Textures</h3>
<p>There are a surprising number of ways to make a striped texture. Let’s assume we have two colors <span class="cItalic">c</span><span class="cSubscript">0</span> and <span class="cItalic">c</span><span class="cSubscript">1</span> that we want to use to make the stripe color. We need<a id="page_275"></a> some oscillating function to switch between the two colors. An easy one is a sine:</p>
<pre><span class="code">RGB stripe(point <span class="cBold">p</span>)</span></pre>
<pre><span class="code"><span class="cBold">if</span> (sin(<span class="cItalic">x<span class="cSubscript">p</span></span>) &gt; 0) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span><span class="cSubscript">0</span></span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span><span class="cSubscript">1</span></span></pre>
<p>We can also make the stripe’s width <span class="cItalic">w</span> controllable:</p>
<pre><span class="code">RGB stripe(point <span class="cBold">p</span>, real <span class="cItalic">w</span>)</span></pre>
<pre><span class="code"><span class="cBold">if</span> (sin(π<span class="cItalic">x</span><span class="cItalic">p</span>/<span class="cItalic">w</span>) &gt; 0) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span><span class="cSubscript">0</span></span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span><span class="cSubscript">1</span></span></pre>
<p>If we want to interpolate smoothly between the stripe colors, we can use a parameter <span class="cItalic">t</span> to vary the color linearly:</p>
<pre><span class="code">RGB stripe(point <span class="cBold">p</span>, real <span class="cItalic">w</span>)</span></pre>
<pre><span class="code"><span class="cItalic">t</span> = (1 + sin(<span class="cItalic">πp<span class="cSubscript">x</span>/w</span>))<span class="cItalic">/</span> 2</span></pre>
<pre><span class="code"><span class="cBold">return</span> (1 − <span class="cItalic">t</span>)<span class="cItalic">c</span><span class="cSubscript">0</span> + <span class="cItalic">tc</span><span class="cSubscript">1</span></span></pre>
<p>These three possibilities are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-26">Figure 11.26</a>.</p>
<div id="art_Dest_fig_11-26" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-26"></a><span class="cBold">Figure 11.26</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-26.png" alt="Figure showing various stripe textures result from drawing a regular array of xy points while keeping z constant." width="264" height="800" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-26.png"></p>
<p class="Text figcaption">Various stripe textures result from drawing a regular array of <span class="cItalic">xy</span> points while keeping <span class="cItalic">z</span> constant.</p>
</div>
<h3><a id="sec11-5-2"></a>11.5.2 Solid Noise</h3>
<p>Although regular textures such as stripes are often useful, we would like to be able to make “mottled” textures such as we see on birds’ eggs. This is usually done by using a sort of “solid noise,” usually called <span class="cItalic">Perlin noise</span> after its inventor, who received a technical Academy Award for its impact in the film industry (Perlin, 1985).</p>
<p>Getting a noisy appearance by calling a random number for every point would not be appropriate, because it would just be like “white noise” in TV static. We would like to make it smoother without losing the random quality. One possibility is to blur white noise, but there is no practical implementation of this. Another possibility is to make a large lattice with a random number at every lattice point, and then interpolate these random points for new points between lattice nodes; this is just a 3D texture array as described in the last section with random numbers in the array. This technique makes the lattice too obvious. Perlin used a variety of tricks to improve this basic lattice technique so the lattice was not so obvious. This results in a rather baroque-looking set of steps, but essentially there are just<a id="page_276"></a> three changes from linearly interpolating a 3D array of random values. The first change is to use Hermite interpolation to avoid mach bands, just as can be done with regular textures. The second change is the use of random vectors rather than values, with a dot product to derive a random number; this makes the underlying grid structure less visually obvious by moving the local minima and maxima off the grid vertices. The third change is to use a 1D array and hashing to create a virtual 3D array of random vectors. This adds computation to lower memory use. Here is his basic method:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-396-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_492&quot;&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3A9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_492" overflow="scroll" style="width: 22.779em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.111em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.105em, 1022.07em, 3.704em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21870"><span class="mrow" id="MathJax-Span-21871"><span class="mi" id="MathJax-Span-21872" style="font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-21873" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21874" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21875"><span class="mi" id="MathJax-Span-21876" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21877" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21878" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21879" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21880" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-21881" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21882" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-21883" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-21884"><span class="munderover" id="MathJax-Span-21885"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0.26em;"><span class="mo" id="MathJax-Span-21886" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.71em, 4.424em, -1000.01em); top: -2.877em; left: 0.054em;"><span class="mrow" id="MathJax-Span-21887"><span class="mi" id="MathJax-Span-21888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-21889" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mrow" id="MathJax-Span-21890"><span class="mo" id="MathJax-Span-21891" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21893" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1001.86em, 4.321em, -1000.01em); top: -5.242em; left: 0em;"><span class="mrow" id="MathJax-Span-21894"><span class="mrow" id="MathJax-Span-21895"><span class="mo" id="MathJax-Span-21896" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21898" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span><span class="mo" id="MathJax-Span-21899" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-21900" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21901" style="padding-left: 0.157em;"><span class="mstyle" id="MathJax-Span-21902"><span class="mrow" id="MathJax-Span-21903"><span class="munderover" id="MathJax-Span-21904"><span style="display: inline-block; position: relative; width: 1.905em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0.208em;"><span class="mo" id="MathJax-Span-21905" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.71em, 4.424em, -1000.01em); top: -2.877em; left: 0.054em;"><span class="mrow" id="MathJax-Span-21906"><span class="mi" id="MathJax-Span-21907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-21908" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mrow" id="MathJax-Span-21909"><span class="mo" id="MathJax-Span-21910" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21912" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1001.81em, 4.321em, -1000.01em); top: -5.242em; left: 0em;"><span class="mrow" id="MathJax-Span-21913"><span class="mrow" id="MathJax-Span-21914"><span class="mo" id="MathJax-Span-21915" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21917" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span><span class="mo" id="MathJax-Span-21918" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-21919" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21920" style="padding-left: 0.157em;"><span class="mstyle" id="MathJax-Span-21921"><span class="mrow" id="MathJax-Span-21922"><span class="munderover" id="MathJax-Span-21923"><span style="display: inline-block; position: relative; width: 1.905em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0.208em;"><span class="mo" id="MathJax-Span-21924" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.76em, 4.424em, -1000.01em); top: -2.877em; left: 0em;"><span class="mrow" id="MathJax-Span-21925"><span class="mi" id="MathJax-Span-21926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-21927" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mrow" id="MathJax-Span-21928"><span class="mo" id="MathJax-Span-21929" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21931" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1001.81em, 4.321em, -1000.01em); top: -5.242em; left: 0.003em;"><span class="mrow" id="MathJax-Span-21932"><span class="mrow" id="MathJax-Span-21933"><span class="mo" id="MathJax-Span-21934" style="font-size: 70.7%; font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-21935" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21936" style="font-size: 70.7%; font-family: MathJax_Main;">⌋</span></span><span class="mo" id="MathJax-Span-21937" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-21938" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21939" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-21940" style="font-family: MathJax_Math-italic;">Ω<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21941" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-21942" style="font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-21943" style="font-family: MathJax_Math-italic;">k</span><span class="mrow" id="MathJax-Span-21944" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21945" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21946"><span class="mi" id="MathJax-Span-21947" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-21948" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-21949" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">i</span><span class="mo" id="MathJax-Span-21950" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21951" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21952" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-21953" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">j</span><span class="mo" id="MathJax-Span-21954" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21955" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-21956" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-21957" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">k</span></span><span class="mo" id="MathJax-Span-21958" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21959" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.533em; border-left: 0px solid; width: 0px; height: 3.498em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_492"><mrow><mi>n</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mrow><mo>⌊</mo><mi>x</mi><mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo><mi>x</mi><mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mrow><mo>⌊</mo><mi>y</mi><mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo><mi>y</mi><mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mrow><mo>⌊</mo><mi>z</mi><mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo><mi>z</mi><mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mi>Ω</mi><mi>i</mi><mi>j</mi><mi>k</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>−</mo><mi>i</mi><mo>,</mo><mi>y</mi><mo>−</mo><mi>j</mi><mo>,</mo><mi>z</mi><mo>−</mo><mi>k</mi></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mstyle></mrow></mstyle></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-396"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_492"> <mrow><mi>n</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mrow><mo>⌊</mo> <mi>x</mi> <mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo> <mi>x</mi> <mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mrow><mo>⌊</mo> <mi>y</mi> <mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo> <mi>y</mi> <mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mrow><mo>⌊</mo> <mi>z</mi> <mo>⌋</mo></mrow></mrow><mrow><mrow><mo>⌊</mo> <mi>z</mi> <mo>⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mi>Ω</mi><mi>i</mi><mi>j</mi><mi>k</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>−</mo><mi>i</mi><mo>,</mo><mi>y</mi><mo>−</mo><mi>j</mi><mo>,</mo><mi>z</mi><mo>−</mo><mi>k</mi></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mstyle></mrow></mstyle></mrow></mstyle></mrow></math></script></p>
<p>where (<span class="cItalic">x</span>, <span class="cItalic">y</span>, <span class="cItalic">z</span>) are the Cartesian coordinates of x, and</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-397-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_493&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mtext&gt;&amp;#x3A9;&lt;/mtext&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x3C9;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C9;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C9;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mtext&gt;&amp;#x393;&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_493" overflow="scroll" style="width: 20.774em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.157em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1020.11em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-21961"><span class="mrow" id="MathJax-Span-21962"><span class="msub" id="MathJax-Span-21963"><span style="display: inline-block; position: relative; width: 1.699em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-21964" style="font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mrow" id="MathJax-Span-21965"><span class="mi" id="MathJax-Span-21966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-21967" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-21968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-21969" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21970" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21971"><span class="mi" id="MathJax-Span-21972" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-21973" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21974" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span><span class="mo" id="MathJax-Span-21975" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21976" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">w</span></span><span class="mo" id="MathJax-Span-21977" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-21978" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-21979" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">ω</span><span class="mrow" id="MathJax-Span-21980" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21981" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21982" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-21983" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-21984" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ω</span><span class="mrow" id="MathJax-Span-21985" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21986" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21987" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-21988" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-21989" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ω</span><span class="mrow" id="MathJax-Span-21990" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21991" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21992" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-21993" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-21994" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-21995" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-21996"><span class="msub" id="MathJax-Span-21997"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-21998" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-21999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22000" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mrow" id="MathJax-Span-22001" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-22002" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-22003"><span class="mi" id="MathJax-Span-22004" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-22005" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-22006" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;</span><span class="mi" id="MathJax-Span-22007" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-22008" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-22009" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;</span><span class="mi" id="MathJax-Span-22010" style="font-family: MathJax_Math-italic;">w</span></span><span class="mo" id="MathJax-Span-22011" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-22012" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-22013" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_493"><mrow><msub><mtext>Ω</mtext><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi><mo>,</mo><mi>w</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi>ω</mi><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow><mi>ω</mi><mrow><mo>(</mo><mi>v</mi><mo>)</mo></mrow><mi>ω</mi><mrow><mo>(</mo><mi>w</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mtext>Γ</mtext><mi>i</mi></msub><mo>⋅</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>v</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>w</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-397"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_493"><mrow><msub><mtext>Ω</mtext><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi><mo>,</mo><mi>w</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi>ω</mi><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow><mi>ω</mi><mrow><mo>(</mo><mi>v</mi><mo>)</mo></mrow><mi>ω</mi><mrow><mo>(</mo><mi>w</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mtext>Γ</mtext><mi>i</mi></msub><mo>⋅</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mtext> </mtext><mi>v</mi><mo>,</mo><mtext> </mtext><mi>w</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></script></p>
<p>and ω (<span class="cItalic">t</span>) is the cubic weighting function:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-398-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_494&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C9;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;otherwise&lt;/mtext&gt;&lt;mtext&gt;.&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_494" overflow="scroll" style="width: 15.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.067em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.648em, 1014.82em, 4.578em, -1000.01em); top: -3.339em; left: 0em;"><span class="mrow" id="MathJax-Span-22015"><span class="mrow" id="MathJax-Span-22016"><span class="mi" id="MathJax-Span-22017" style="font-family: MathJax_Math-italic;">ω</span><span class="mrow" id="MathJax-Span-22018" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22019" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-22020" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-22021" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-22022" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-22023" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-22024" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-22025" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 10.8em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1010.76em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.8em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1010.76em, 4.424em, -1000.01em); top: -4.625em; left: 0em;"><span class="mtd" id="MathJax-Span-22026"><span class="mrow" id="MathJax-Span-22027"><span class="mn" id="MathJax-Span-22028" style="font-family: MathJax_Main;">2</span><span class="msup" id="MathJax-Span-22029"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.78em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-22030"><span class="mo" id="MathJax-Span-22031" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-22032" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-22033" style="font-family: MathJax_Main;">|</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 0.928em;"><span class="mn" id="MathJax-Span-22034" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22035" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-22036" style="font-family: MathJax_Main; padding-left: 0.208em;">3</span><span class="msup" id="MathJax-Span-22037"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.78em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-22038"><span class="mo" id="MathJax-Span-22039" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-22040" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-22041" style="font-family: MathJax_Main;">|</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 0.928em;"><span class="mn" id="MathJax-Span-22042" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22043" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-22044" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span><span class="mtext" id="MathJax-Span-22045" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22046" style="font-family: MathJax_Main;">if</span><span class="mrow" id="MathJax-Span-22047" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22048" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-22049" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-22050" style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-22051" style="font-family: MathJax_Main; padding-left: 0.26em;">&lt;</span><span class="mn" id="MathJax-Span-22052" style="font-family: MathJax_Main; padding-left: 0.26em;">1</span><span class="mo" id="MathJax-Span-22053" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1007.31em, 4.167em, -1000.01em); top: -3.134em; left: 0em;"><span class="mtd" id="MathJax-Span-22054"><span class="mrow" id="MathJax-Span-22055"><span class="mn" id="MathJax-Span-22056" style="font-family: MathJax_Main;">0</span><span class="mtext" id="MathJax-Span-22057" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22058" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22059" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22060" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22061" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-22062" style="font-family: MathJax_Main;">otherwise</span><span class="mtext" id="MathJax-Span-22063" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.345em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.162em; border-left: 0px solid; width: 0px; height: 2.809em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_494"><mrow><mi>ω</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>2</mn><msup><mrow><mo>|</mo><mi>t</mi><mo>|</mo></mrow><mn>3</mn></msup><mo>−</mo><mn>3</mn><msup><mrow><mo>|</mo><mi>t</mi><mo>|</mo></mrow><mn>2</mn></msup><mo>+</mo><mn>1</mn><mtext>&nbsp;&nbsp;</mtext><mtext>if</mtext><mrow><mo>|</mo><mi>t</mi><mo>|</mo></mrow><mo>&lt;</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mtext>&nbsp;&nbsp;</mtext><mtext>&nbsp;&nbsp;</mtext><mtext>&nbsp;&nbsp;</mtext><mtext>&nbsp;&nbsp;</mtext><mtext>&nbsp;&nbsp;</mtext><mtext>otherwise</mtext><mtext>.</mtext></mtd></mtr></mtable></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-398"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_494"><mrow><mi>ω</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mrow><mo>{</mo> <mtable columnalign="left"><mtr><mtd><mn>2</mn><msup><mrow><mo>|</mo> <mi>t</mi> <mo>|</mo></mrow><mn>3</mn></msup><mo>−</mo><mn>3</mn><msup><mrow><mo>|</mo> <mi>t</mi> <mo>|</mo></mrow><mn>2</mn></msup><mo>+</mo><mn>1</mn><mtext>  </mtext><mtext>if</mtext><mrow><mo>|</mo> <mi>t</mi> <mo>|</mo></mrow><mo>&lt;</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>otherwise</mtext><mtext>.</mtext></mtd></mtr></mtable></mrow></mrow></math></script></p>
<p>The final piece is that Γ<span class="cItalic">ijk</span> is a random unit vector for the lattice point (<span class="cItalic">x,y,z</span>) = (<span class="cItalic">i</span>, <span class="cItalic">j</span>, <span class="cItalic">k</span>). Since we want any potential <span class="cItalic">ijk,</span> we use a pseudorandom table:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-399-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_495&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mtext&gt;&amp;#x393;&lt;/mtext&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_495" overflow="scroll" style="width: 13.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1013.33em, 2.625em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-22065"><span class="mrow" id="MathJax-Span-22066"><span class="msub" id="MathJax-Span-22067"><span style="display: inline-block; position: relative; width: 1.596em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-22068" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-22069"><span class="mi" id="MathJax-Span-22070" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-22071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-22072" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22073" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-22074" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-22075"><span class="mi" id="MathJax-Span-22076" style="font-family: MathJax_Main-bold;">G</span></span></span><span class="mrow" id="MathJax-Span-22077" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22078" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-22079"><span class="mi" id="MathJax-Span-22080" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mrow" id="MathJax-Span-22081" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22082" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-22083"><span class="mi" id="MathJax-Span-22084" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-22085" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-22086" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ϕ</span><span class="mrow" id="MathJax-Span-22087" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22088" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-22089"><span class="mi" id="MathJax-Span-22090" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-22091" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-22092" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ϕ</span><span class="mrow" id="MathJax-Span-22093" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22094" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-22095" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-22096" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-22097" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-22098" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-22099" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-22100" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_495"><mrow><msub><mtext>Γ</mtext><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>G</mi></mstyle><mrow><mo>(</mo><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>i</mi><mo>+</mo><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>j</mi><mo>+</mo><mi>ϕ</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-399"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_495"><mrow><msub><mtext>Γ</mtext><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>G</mi></mstyle><mrow><mo>(</mo><mrow><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>i</mi><mo>+</mo><mi>ϕ</mi><mrow><mo>(</mo><mrow><mi>j</mi><mo>+</mo><mi>ϕ</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></script></p>
<p>where <span class="cBold">G</span> is a precomputed array of <span class="cItalic">n</span> random unit vectors, and ϕ(<span class="cItalic">i</span>) = <span class="cItalic">P</span>[<span class="cItalic">i</span> mod <span class="cItalic">n</span>] where <span class="cItalic">P</span> is an array of length <span class="cItalic">n</span> containing a permutation of the integers 0 through <span class="cItalic">n</span> − 1. In practice, Perlin reports <span class="cItalic">n</span> = 256 works well. To choose a random unit vector (<span class="cItalic">v</span><span class="cItalic">x</span>,<span class="cItalic">v</span><span class="cItalic">y</span>,<span class="cItalic">v</span><span class="cItalic">z</span>) first set</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-400-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_496&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_496" overflow="scroll" style="width: 6.121em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.915em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.255em, 1005.67em, 4.013em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-22102"><span class="mtable" id="MathJax-Span-22103" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1005.56em, 6.789em, -1000.01em); top: -4.882em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1005.1em, 4.373em, -1000.01em); top: -5.447em; left: 0em;"><span class="mtd" id="MathJax-Span-22104"><span class="mrow" id="MathJax-Span-22105"><span class="msub" id="MathJax-Span-22106"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22107" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22109" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-22110" style="font-family: MathJax_Main; padding-left: 0.26em;">2</span><span class="mi" id="MathJax-Span-22111" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-22112" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-22113" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span><span class="mo" id="MathJax-Span-22114" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1005.36em, 4.476em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-22115"><span class="mrow" id="MathJax-Span-22116"><span class="msub" id="MathJax-Span-22117"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22118" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22120" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-22121" style="font-family: MathJax_Main; padding-left: 0.26em;">2</span><span class="msup" id="MathJax-Span-22122"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22123" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mo" id="MathJax-Span-22124" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22125" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-22126" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span><span class="mo" id="MathJax-Span-22127" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1005.56em, 4.373em, -1000.01em); top: -2.465em; left: 0em;"><span class="mtd" id="MathJax-Span-22128"><span class="mrow" id="MathJax-Span-22129"><span class="msub" id="MathJax-Span-22130"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22131" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22133" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-22134" style="font-family: MathJax_Main; padding-left: 0.26em;">2</span><span class="msup" id="MathJax-Span-22135"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22136" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.517em;"><span class="mo" id="MathJax-Span-22137" style="font-size: 70.7%; font-family: MathJax_Main;">′′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22138" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mn" id="MathJax-Span-22139" style="font-family: MathJax_Main; padding-left: 0.208em;">1</span><span class="mo" id="MathJax-Span-22140" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.851em; border-left: 0px solid; width: 0px; height: 4.186em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_496"><mtable columnalign="left"><mtr><mtd><msub><mi>v</mi><mi>x</mi></msub><mo>=</mo><mn>2</mn><mi>ξ</mi><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>y</mi></msub><mo>=</mo><mn>2</mn><msup><mi>ξ</mi><mo>′</mo></msup><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>z</mi></msub><mo>=</mo><mn>2</mn><msup><mi>ξ</mi><mo>″</mo></msup><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-400"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_496"><mtable columnalign="left"><mtr><mtd><msub><mi>v</mi><mi>x</mi></msub><mo>=</mo><mn>2</mn><mi>ξ</mi><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>y</mi></msub><mo>=</mo><mn>2</mn><msup><mi>ξ</mi><mo>′</mo></msup><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>z</mi></msub><mo>=</mo><mn>2</mn><msup><mi>ξ</mi><mo>″</mo></msup><mo>−</mo><mn>1</mn><mo>,</mo></mtd></mtr></mtable></math></script></p>
<p>where ξ, ξ', ξ" are canonical random numbers (uniform in the interval [0,1)). Then, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-401-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_57&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_57" style="width: 8.177em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.92em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1007.83em, 2.728em, -1000.01em); top: -2.208em; left: 0em;"><span class="mrow" id="MathJax-Span-22142"><span class="mrow" id="MathJax-Span-22143"><span class="mrow" id="MathJax-Span-22144"><span class="mo" id="MathJax-Span-22145" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-22146"><span class="msubsup" id="MathJax-Span-22147"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22148" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.368em; left: 0.465em;"><span class="mn" id="MathJax-Span-22149" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.47em, 4.167em, -1000.01em); top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22151" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msubsup" id="MathJax-Span-22152" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22153" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.368em; left: 0.465em;"><span class="mn" id="MathJax-Span-22154" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-22156" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msubsup" id="MathJax-Span-22157" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22158" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -4.368em; left: 0.465em;"><span class="mn" id="MathJax-Span-22159" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-22160" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-22161" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-22162" style="font-family: MathJax_Main; padding-left: 0.26em;">&lt;</span><span class="mn" id="MathJax-Span-22163" style="font-family: MathJax_Main; padding-left: 0.26em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.213em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_57"><mrow><mrow><mo>(</mo><mrow><msubsup><mi>v</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>z</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-401"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_57"><mrow><mrow><mo>(</mo><mrow><msubsup><mi>v</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>z</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow></math></script>, make the vector a unit vector. Otherwise keep setting it randomly until its length is less than one, and then make it a unit vector. This is an example of a <span class="cItalic">rejection method,</span> which will be discussed more in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml">Chapter 14</a>. Essentially, the “less than” test gets a random point in the unit sphere, and the vector for the origin to that point is uniformly random. That would not be true of random points in the cube, so we “get rid” of the corners with the test.</p>
<p><a id="page_277"></a>Because solid noise can be positive or negative, it must be transformed before being converted to a color. The absolute value of noise over a 10 <span class="cItalic">×</span> 10 square is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-27">Figure 11.27</a>, along with stretched versions. These versions are stretched by scaling the points input to the noise function.</p>
<div id="art_Dest_fig_11-27" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-27"></a><span class="cBold">Figure 11.27</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-27.png" alt="Figure showing absolute value of solid noise, and noise for scaled x and y values." width="600" height="188" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-27.png"></p>
<p class="Text figcaption">Absolute value of solid noise, and noise for scaled <span class="cItalic">x</span> and <span class="cItalic">y</span> values.</p>
</div>
<p>The dark curves are where the original noise function changed from positive to negative. Since noise varies from −1 to 1, a smoother image can be achieved by using (noise + 1)<span class="cItalic">/</span> 2 for color. However, since noise values close to 1 or −1 are rare, this will be a fairly smooth image. Larger scaling can increase the contrast (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-28">Figure 11.28</a>).</p>
<div id="art_Dest_fig_11-28" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-28"></a><span class="cBold">Figure 11.28</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-28.png" alt="Figure showing using 0.5(noise+1) (top) and 0.8(noise+1) (bottom) for intensity." width="399" height="800" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-28.png"></p>
<p class="Text figcaption">Using 0.5(noise+1) (top) and 0.8(noise+1) (bottom) for intensity.</p>
</div> 
<h3><a id="sec11-5-3"></a>11.5.3 Turbulence</h3>
<p>Many natural textures contain a variety of feature sizes in the same texture. Perlin uses a pseudofractal “turbulence” function:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-402-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_497&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_497" overflow="scroll" style="width: 9.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.309em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.311em, 1009.32em, 3.499em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-22165"><span class="mrow" id="MathJax-Span-22166"><span class="msub" id="MathJax-Span-22167"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-22168" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-22169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-22170" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22171" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-22172"><span class="mrow" id="MathJax-Span-22173"><span class="mi" id="MathJax-Span-22174" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-22175" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-22176" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-22177" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-22178"><span class="munder" id="MathJax-Span-22179"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-22180" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.22em, 4.27em, -1000.01em); top: -2.928em; left: 0.62em;"><span class="mi" id="MathJax-Span-22181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-22182" style="padding-left: 0.157em;"><span class="mfrac" id="MathJax-Span-22183"><span style="display: inline-block; position: relative; width: 3.756em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(2.985em, 1003.56em, 4.527em, -1000.01em); top: -4.83em; left: 50%; margin-left: -1.848em;"><span class="mrow" id="MathJax-Span-22184"><span class="mrow" id="MathJax-Span-22185"><span class="mo" id="MathJax-Span-22186" style="vertical-align: 0.877em;"><span style="display: inline-block; position: relative; width: 0.26em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.237em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.031em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-22187"><span class="mi" id="MathJax-Span-22188" style="font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-22189" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-22190" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-22191"><span class="msup" id="MathJax-Span-22192"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-22193" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.517em;"><span class="mi" id="MathJax-Span-22194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-22195"><span class="mrow" id="MathJax-Span-22196"><span class="mi" id="MathJax-Span-22197" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span class="mo" id="MathJax-Span-22198" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span class="mo" id="MathJax-Span-22199" style="vertical-align: 0.877em;"><span style="display: inline-block; position: relative; width: 0.26em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.237em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.031em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1000.83em, 4.167em, -1000.01em); top: -3.185em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-22200"><span class="msup" id="MathJax-Span-22201"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-22202" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.517em;"><span class="mi" id="MathJax-Span-22203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1003.76em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.756em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.268em; border-left: 0px solid; width: 0px; height: 3.074em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_497"><mrow><msub><mi>n</mi><mi>t</mi></msub><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder><mrow><mfrac><mrow><mrow><mo>|</mo><mrow><mi>n</mi><mrow><mo>(</mo><mrow><msup><mn>2</mn><mi>i</mi></msup><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow></mfrac></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-402"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_497"><mrow><msub><mi>n</mi><mi>t</mi></msub><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder><mrow><mfrac><mrow><mrow><mo>|</mo> <mrow><mi>n</mi><mrow><mo>(</mo><mrow><msup><mn>2</mn><mi>i</mi></msup><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle></mrow><mo>)</mo></mrow></mrow> <mo>|</mo></mrow></mrow><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow></mfrac></mrow></mstyle></mrow></math></script></p>
<p>This effectively repeatedly adds scaled copies of the noise function on top of itself as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-29">Figure 11.29</a>.</p>
<div id="art_Dest_fig_11-29" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-29"></a><span class="cBold">Figure 11.29</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-29.png" alt="Figure showing turbulence function with (from top left to bottom right) one through eight terms in the summation." width="600" height="300" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-29.png"></p>
<p class="Text figcaption">Turbulence function with (from top left to bottom right) one through eight terms in the summation.</p>
</div>
<p>The turbulence can be used to distort the stripe function:</p>
<pre><span class="code">RGB turbstripe(point <span class="cBold">p</span>, double w)</span></pre>
<pre><span class="code">double <span class="cItalic">t</span> = (1 + <span class="cItalic">s</span> in (<span class="cItalic">k</span><span class="cSubscript">1</span><span class="cItalic">z</span><span class="cSubscript">p</span> + turbulence(<span class="cItalic">k</span><span class="cSubscript">2</span><span class="cBold">p</span>))<span class="cItalic">/w</span>)<span class="cItalic">/</span>2</span></pre>
<pre><span class="code"><span class="cBold">return</span> <span class="cItalic">t</span> * <span class="cItalic">s</span>0 + (1 − <span class="cItalic">t</span>) * <span class="cItalic">s</span>1</span></pre>
<p>Various values for <span class="cItalic">k</span><span class="cSubscript">1</span> and <span class="cItalic">k</span><span class="cSubscript">2</span> were used to generate <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#Text_Anchor_fig_11-30">Figure 11.30</a>.</p>
<div id="art_Dest_fig_11-30" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_11-30"></a><span class="cBold">Figure 11.30</span></p>
<p class="ObjectLine"><img src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/fig11-30.png" alt="Figure showing various turbulent stripe textures with different k1, k2. The top row has only the first term of the turbulence series." width="600" height="300" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig11-30.png"></p>
<p class="Text figcaption">Various turbulent stripe textures with different <span class="cItalic">k</span><span class="cSubscript">1</span>, <span class="cItalic">k</span><span class="cSubscript">2</span>. The top row has only the first term of the turbulence series.</p>
</div>
<h2><a id="sec11-6"></a><a id="page_278"></a>Frequently Asked Questions</h2>
<ul>
<li class="LX"><p><span class="cBold">How do I implement displacement mapping in ray tracing?</span></p>
<p>There is no ideal way to do it. Generating all the triangles and caching the geometry when necessary will prevent memory overload (Pharr &amp; Hanrahan, 1996; Pharr, Kolb, Gershbein, &amp; Hanrahan, 1997). Trying to intersect the displaced surface directly is possible when the displacement function is restricted (Patterson, Hoggar, &amp; Logie, 1991; Heidrich &amp; Seidel, 1998; Smits, Shirley, &amp; Stark, 2000).</p></li>
<li class="LX"><p><a id="page_279"></a><span class="cBold">Why don’t my images with textures look realistic?</span></p>
<p>Humans are good at seeing small imperfections in surfaces. Geometric imperfections are typically absent in computer-generated images that use texture maps for details, so they look “too smooth.”</p></li></ul>
<h2><a id="sec11-7"></a>Notes</h2>
<p>The discussion of perspective-correct textures is based on <span class="cItalic">Fast Shadows and Lighting Effects Using Texture Mapping</span> (Segal, Korobkin, van Widenfelt, Foran, &amp; Haeberli, 1992) and on <span class="cItalic">3D Game Engine Design</span> (Eberly, 2000).</p>
<h2><a id="sec11-8"></a>Exercises</h2>
<ol>
<li class="LX">Find several ways to implement an infinite 2D checkerboard using surface and solid techniques. Which is best?</li>
<li class="LX">Verify that Equation (11.3) is a valid equality using brute-force algebra.</li>
<li class="LX">How could you implement solid texturing by using the z-buffer depth and a matrix transform?</li>
<li class="LX">Expand the function mipmap_sample_trilinear into a single function.</li>
</ol>
<p class="footnote"><span class="cSuperscript"><a id="ft1-1" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#ft1_1" class="totri-footnote">1</a></span> It is worthwhile to derive these functions yourself from Equation (7.6); in that chapter’s notation, α = <span class="cItalic">f</span>(<span class="cItalic">t</span>).</p>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-8" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 10 Surface Shading</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 12 Data Structures for Graphics</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 11 Texture Mapping - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Script, sans-serif;"></div></div></body></html>