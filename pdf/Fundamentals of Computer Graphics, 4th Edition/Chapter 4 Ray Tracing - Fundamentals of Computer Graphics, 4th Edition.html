<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav nav-collapsed  scalefonts subscribe-panel library"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 3 Raster Images</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C005.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 5 Linear Algebra</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 4</p>
<h1>Ray Tracing</h1>
<p><a id="page_69"></a>One of the basic tasks of computer graphics is <span class="cItalic">rendering</span> three-dimensional objects: taking a scene, or model, composed of many geometric objects arranged in 3D space and producing a 2D image that shows the objects as viewed from a particular viewpoint. It is the same operation that has been done for centuries by architects and engineers creating drawings to communicate their designs to others.</p>
<p>Fundamentally, rendering is a process that takes as its input a set of objects and produces as its output an array of pixels. One way or another, rendering involves considering how each object contributes to each pixel; it can be organized in two general ways. In <span class="cItalic">object-order rendering</span>, each object is considered in turn, and for each object all the pixels that it influences are found and updated. In <span class="cItalic">image-order rendering</span>, each pixel is considered in turn, and for each pixel all the objects that influence it are found and the pixel value is computed. You can think of the difference in terms of the nesting of loops: in image-order rendering the for each pixel loop is on the outside, whereas in object-order rendering the for each object loop is on the outside.</p>
<div class="Sidebar">
<p class="SidebarText">If the output is a vector image rather than a raster image, rendering doesnt have to involve pixels, but well assume raster images in this book.</p>
</div>
<p>Image-order and object-order rendering approaches can compute exactly the same images, but they lend themselves to computing different kinds of effects and have quite different performance characteristics. Well explore the comparative strengths of the approaches in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C008.xhtml">Chapter 8</a> after we have discussed them both, but, broadly speaking, image-order rendering is simpler to get working and more flexible in the effects that can be produced, and usually (though not always) takes much more execution time to produce a comparable image.</p>
<div class="Sidebar">
<p class="SidebarText">In a ray tracer, it is easy to compute accurate shadows and reflections, which are awkward in the object-order framework.</p>
</div>
<p><a id="page_70"></a>Ray tracing is an image-order algorithm for making renderings of 3D scenes, and well consider it first because its possible to get a ray tracer working without developing any of the mathematical machinery thats used for object-order rendering.</p>
<h2><a id="sec4-1"></a>4.1 The Basic Ray-Tracing Algorithm</h2>
<p>A ray tracer works by computing one pixel at a time, and for each pixel the basic task is to find the object that is seen at that pixels position in the image. Each pixel looks in a different direction, and any object that is seen by a pixel must intersect the <span class="cItalic">viewing ray</span>, a line that emanates from the viewpoint in the direction that pixel is looking. The particular object we want is the one that intersects the viewing ray nearest the camera, since it blocks the view of any other objects behind it. Once that object is found, a <span class="cItalic">shading</span> computation uses the intersection point, surface normal, and other information (depending on the desired type of rendering) to determine the color of the pixel. This is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-1">Figure 4.1</a>, where the ray intersects two triangles, but only the first triangle hit, <span class="cItalic">T</span><span class="cSubscript">2</span>, is shaded.</p>
<div id="art_Dest_fig_4-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-1"></a><span class="cBold">Figure 4.1</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-1.png" alt="Figure showing the ray is traced into the scene and the first object hit is the one seen through the pixel. In this case, the triangle T2 is returned." width="600" height="422" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-1.png"></p>
<p class="Text figcaption">The ray is traced into the scene and the first object hit is the one seen through the pixel. In this case, the triangle <span class="cItalic">T</span><span class="cSubscript">2</span> is returned.</p>
</div>
<p>A basic ray tracer therefore has three parts:</p>
<ol>
<li class="LX"><span class="cItalic">ray generation</span>, which computes the origin and direction of each pixels viewing ray based on the camera geometry;</li>
<li class="LX"><span class="cItalic">ray intersection</span>, which finds the closest object intersecting the viewing ray;</li>
<li class="LX"><span class="cItalic">shading</span>, which computes the pixel color based on the results of ray intersection.</li>
</ol>
<p>The structure of the basic ray tracing program is:</p>
<pre><span class="code"><a id="page_71"></a><span class="cBold">for</span> each pixel <span class="cBold">do</span></span></pre>
<pre><span class="code">  compute viewing ray</span></pre>
<pre><span class="code">  find first object hit by ray and its surface normal <span class="cBold">n</span></span></pre>
<pre><span class="code">  set pixel color to value computed from hit point, light, and <span class="cBold">n</span></span></pre>
<p>This chapter covers basic methods for ray generation, ray intersection, and shading, that are sufficient for implementing a simple demonstration ray tracer. For a really useful system, more efficient ray intersection techniques from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C012.xhtml">Chapter 12</a> need to be added, and the real potential of a ray tracer will be seen with the more advanced shading methods from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml">Chapter 10</a> and the additional rendering techniques from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml">Chapter 13</a>.</p>
<h2><a id="sec4-2"></a>4.2 Perspective</h2>
<p>The problem of representing a 3D object or scene with a 2D drawing or painting was studied by artists hundreds of years before computers. Photographs also represent 3D scenes with 2D images. While there are many unconventional ways to make images, from cubist painting to fisheye lenses (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-2">Figure 4.2</a>) to peripheral cameras, the standard approach for both art and photography, as well as computer graphics, is <span class="cItalic">linear perspective</span>, in which 3D objects are projected onto an <span class="cItalic">image plane</span> in such a way that straight lines in the scene become straight lines in the image.</p>
<div id="art_Dest_fig_4-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-2"></a><span class="cBold">Figure 4.2</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-2.png" alt="Figure showing an image taken with a fisheye lens is not a linear perspective image. Photo courtesy Philip Greenspun." width="405" height="608" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-2.png"></p>
<p class="Text figcaption">An image taken with a fisheye lens is not a linear perspective image. <span class="cItalic">Photo courtesy Philip Greenspun</span>.</p>
</div>
<p>The simplest type of projection is <span class="cItalic">parallel projection</span>, in which 3D points are mapped to 2D by moving them along a <span class="cItalic">projection direction</span> until they hit the image plane (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-3">Figures 4.3</a><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-4">4.4</a>). The view that is produced is determined by the choice of projection direction and image plane. If the image plane is <a id="page_72"></a>perpendicular to the view direction, the projection is called <span class="cItalic">orthographic</span>; otherwise it is called <span class="cItalic">oblique</span>.</p>
<div id="art_Dest_fig_4-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-3"></a><span class="cBold">Figure 4.3</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-3.png" alt="Figure showing when projection lines are parallel and perpendicular to the image plane, the resulting views are called orthographic." width="600" height="204" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-3.png"></p>
<p class="Text figcaption">When projection lines are parallel and perpendicular to the image plane, the resulting views are called orthographic.</p>
</div>
<div id="art_Dest_fig_4-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-4"></a><span class="cBold">Figure 4.4</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-4.png" alt="Figure showing a parallel projection that has the image plane at an angle to the projection direction is called oblique (right). In perspective projection, the projection lines all pass through the viewpoint, rather than being parallel (left). The illustrated perspective view is non-oblique because a projection line drawn through the center of the image would be perpendicular to the image plane." width="600" height="131" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-4.png"></p>
<p class="Text figcaption">A parallel projection that has the image plane at an angle to the projection direction is called oblique (right). In perspective projection, the projection lines all pass through the viewpoint, rather than being parallel (left). The illustrated perspective view is non-oblique because a projection line drawn through the center of the image would be perpendicular to the image plane.</p>
</div>
<p>Parallel projections are often used for mechanical and architectural drawings because they keep parallel lines parallel and they preserve the size and shape of planar objects that are parallel to the image plane.</p>
<div class="Sidebar">
<p class="SidebarText">Some books reserve orthographic for projection directions that are parallel to the coordinate axes.</p>
</div>
<p>The advantages of parallel projection are also its limitations. In our everyday experience (and even more so in photographs) objects look smaller as they get farther away, and as a result parallel lines receding into the distance do not appear parallel. This is because eyes and cameras dont collect light from a single viewing direction; they collect light that passes through a particular viewpoint. As has been recognized by artists since the Renaissance, we can produce natural-looking views using <span class="cItalic">perspective projection</span>: we simply project along lines that pass through a single point, the <span class="cItalic">viewpoint</span>, rather than along parallel lines (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-4">Figure 4.4</a>). <a id="page_73"></a>In this way, objects farther from the viewpoint naturally become smaller when they are projected. A perspective view is determined by the choice of viewpoint (rather than projection direction) and image plane. As with parallel views, there are oblique and non-oblique perspective views; the distinction is made based on the projection direction at the center of the image.</p>
<p>You may have learned about the artistic conventions of <span class="cItalic">three-point perspective</span>, a system for manually constructing perspective views (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-5">Figure 4.5</a>). A surprising fact about perspective is that all the rules of perspective drawing will be followed automatically if we follow the simple mathematical rule underlying perspective: objects are projected directly toward the eye, and they are drawn where they meet a view plane in front of the eye.</p>
<div id="art_Dest_fig_4-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-5"></a><span class="cBold">Figure 4.5</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-5.png" alt="Figure showing in three-point perspective, an artist picks vanishing points where parallel lines meet. Parallel horizontal lines will meet at a point on the horizon. Every set of parallel lines has its own vanishing points. These rules are followed automatically if we implement perspective based on the correct geometric principles." width="600" height="348" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-5.png"></p>
<p class="Text figcaption">In three-point perspective, an artist picks vanishing points where parallel lines meet. Parallel horizontal lines will meet at a point on the horizon. Every set of parallel lines has its own vanishing points. These rules are followed automatically if we implement perspective based on the correct geometric principles.</p>
</div>
<h2><a id="sec4-3"></a>4.3 Computing Viewing Rays</h2>
<p>From the previous section, the basic tools of ray generation are the viewpoint (or view direction, for parallel views) and the image plane. There are many ways to work out the details of camera geometry; in this section we explain one based on orthonormal bases that supports normal and oblique parallel and orthographic views.</p>
<p>In order to generate rays, we first need a mathematical representation for a ray. A ray is really just an origin point and a propagation direction; a 3D parametric line is ideal for this. As discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5-7">Section 2.5.7</a>, the 3D parametric line from the eye <span class="cBold">e</span> to a point <span class="cBold">s</span> on the image plane (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-6">Figure 4.6</a>) is given by</p>
<div id="art_Dest_fig_4-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-6"></a><span class="cBold">Figure 4.6</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-6.png" alt="Figure showing the ray from the eye to a point on the image plane." width="410" height="298" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-6.png"></p>
<p class="Text figcaption">The ray from the eye to a point on the image plane.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_158&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_158" overflow="scroll" style="width: 9.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.846em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1008.75em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="mrow" id="MathJax-Span-503"><span class="mstyle" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mrow" id="MathJax-Span-507" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-512" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Main-bold;">e</span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mrow" id="MathJax-Span-517" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-519"><span class="mstyle" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Main-bold;">s</span></span></span><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mstyle" id="MathJax-Span-524" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Main-bold;">e</span></span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_158"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>e</mi></mstyle><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>e</mi></mstyle></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-13"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_158"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>e</mi></mstyle><mo>+</mo><mi>t</mi><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>s</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>e</mi></mstyle></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>This should be interpreted as, we advance from e along the vector (<span class="cBold">s</span>  <span class="cBold">e</span>) a fractional distance <span class="cItalic">t</span> to find the point <span class="cBold">p</span>. So given <span class="cItalic">t</span>, we can determine a point <span class="cBold">p</span>. The point <span class="cBold">e</span> is the rays <span class="cItalic">origin</span>, and <span class="cBold">s</span>  <span class="cBold">e</span> is the rays <span class="cItalic">direction</span>.</p>
<p>Note that <span class="cBold">p</span>(0) = <span class="cBold">e</span>, and <span class="cBold">p</span>(1) = <span class="cBold">s</span>, and more generally, if 0 &lt; <span class="cItalic">t</span><span class="cSubscript">1</span> &lt; <span class="cItalic">t</span><span class="cSubscript">2</span>, then <span class="cBold">p</span>(<span class="cItalic">t</span><span class="cSubscript">1</span>) is closer to the eye than <span class="cBold">p</span>(<span class="cItalic">t</span><span class="cSubscript">2</span>). Also, if <span class="cItalic">t</span> &lt; 0, then <span class="cBold">p</span>(<span class="cItalic">t</span>) is behind the eye. These facts will be useful when we search for the closest object hit by the ray that is not behind the eye.</p>
<p>To compute a viewing ray, we need to know <span class="cBold">e</span> (which is given) and <span class="cBold">s</span>. Finding <span class="cBold">s</span> may seem difficult, but it is actually straightforward if we look at the problem in the right coordinate system.</p>
<div class="Sidebar">
<p class="SidebarText">Caution: we are overloading the variable <span class="cItalic">t,</span> which is the ray parameter and also the <span class="cItalic">v</span>-coordinate of the top edge of the image.</p>
</div>
<p>All of our ray-generation methods start from an orthonormal coordinate frame known as the <span class="cItalic">camera frame</span>, which well denote by <span class="cBold">e</span>, for the eye point, or viewpoint, and <span class="cBold">u</span>, <span class="cBold">v</span>, and <span class="cBold">w</span> for the three basis vectors, organized with <span class="cBold">u</span> pointing right-ward (from the cameras view), <span class="cBold">v</span> pointing upward, and <span class="cBold">w</span> pointing backward, so that {<span class="cBold">u</span>, <span class="cBold">v</span>, <span class="cBold">w</span>} forms a right-handed coordinate system. The most common way to construct the camera frame is from the viewpoint, which becomes <span class="cBold">e</span>, the <span class="cItalic">view direction</span>, which is <span class="cBold">w</span>, and the <span class="cItalic">up vector</span>, which is used to construct a basis that has <span class="cBold">v</span> and <span class="cBold">w</span> in the plane defined by the view direction and the up direction, using the process for constructing an orthonormal basis from two vectors described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-4-7">Section 2.4.7</a>.</p>
<div id="art_Dest_fig_4-7" class="ArtGroup">
<p class="Text fignumber"><a id="page_74"></a><a id="Text_Anchor_fig_4-7"></a><span class="cBold">Figure 4.7</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-7.png" alt="Figure showing the sample points on the screen are mapped to a similar array on the 3D window. A viewing ray is sent to each of these locations." width="600" height="287" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-7.png"></p>
<p class="Text figcaption">The sample points on the screen are mapped to a similar array on the 3D window. A viewing ray is sent to each of these locations.</p>
</div>
<div id="art_Dest_fig_4-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-8"></a><span class="cBold">Figure 4.8</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-8.png" alt="Figure showing the vectors of the camera frame, together with the view direction and up direction. The w vector is opposite the view direction, and the v vector is coplanar with w and the up vector." width="409" height="409" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-8.png"></p>
<p class="Text figcaption">The vectors of the camera frame, together with the view direction and up direction. The <span class="cBold">w</span> vector is opposite the view direction, and the <span class="cBold">v</span> vector is coplanar with <span class="cBold">w</span> and the up vector.</p>
</div>
<h3><a id="sec4-3-1"></a>4.3.1 Orthographic Views</h3>
<p>For an orthographic view, all the rays will have the direction <span class="cBold">w</span>. Even though a parallel view doesnt have a viewpoint per se, we can still use the origin of the camera frame to define the plane where the rays start, so that its possible for objects to be behind the camera.</p>
<div class="Sidebar">
<p class="SidebarText">Since <span class="cBold">v</span> and <span class="cBold">w</span> have to be perpendicular, the up vector and <span class="cBold">v</span> are not generally the same. But setting the up vector to point straight upward in the scene will orient the camera in the way we would think of as upright.</p>
</div>
<p>The viewing rays should start on the plane defined by the point <span class="cBold">e</span> and the vectors <span class="cBold">u</span> and <span class="cBold">v</span>; the only remaining information required is <span class="cItalic">where</span> on the plane the image is supposed to be. Well define the image dimensions with four numbers, for the four sides of the image: <span class="cItalic">l</span> and <span class="cItalic">r</span> are the positions of the left and right edges of the image, as measured from <span class="cBold">e</span> along the <span class="cBold">u</span> direction; and <span class="cItalic">b</span> and <span class="cItalic">t</span> are the positions of the bottom and top edges of the image, as measured from <span class="cBold">e</span> along the <span class="cBold">v</span> direction. Usually <span class="cItalic">l &lt;</span> 0 <span class="cItalic">&lt; r</span> and <span class="cItalic">b &lt;</span> 0 <span class="cItalic">&lt; t</span>. (See <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-9">Figure 4.9</a>.)</p>
<div id="art_Dest_fig_4-9" class="ArtGroup">
<p class="Text fignumber"><a id="page_75"></a><a id="Text_Anchor_fig_4-9"></a><span class="cBold">Figure 4.9</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-9.png" alt="Figure showing ray generation using the camera frame. Left: In an orthographic view, the rays start at the pixels locations on the image plane, and all share the same direction, which is equal to the view direction. Right: In a perspective view, the rays start at the viewpoint, and each rays direction is defined by the line through the viewpoint, e, and the pixels location on the image plane." width="600" height="274" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-9.png"></p>
<p class="Text figcaption">Ray generation using the camera frame. Left: In an orthographic view, the rays start at the pixels locations on the image plane, and all share the same direction, which is equal to the view direction. Right: In a perspective view, the rays start at the viewpoint, and each rays direction is defined by the line through the viewpoint, <span class="cBold">e</span>, and the pixels location on the image plane.</p>
</div>
<div class="Sidebar">
<p class="SidebarText">It might seem logical that orthographic viewing rays should start from infinitely far away, but then it would not be possible to make orthographic views of an object inside a room, for instance.</p>
</div>
<div class="Sidebar">
<p class="SidebarText">Many systems assume that <span class="cItalic">l</span> =  <span class="cItalic">r</span> and <span class="cItalic">b</span> =  <span class="cItalic">t</span> so that a width and a height suffice.</p>
</div>
<p>In <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml#sec3-2">Section 3.2</a> we discussed pixel coordinates in an image. To fit an image with <span class="cItalic">n</span><span class="cItalic">x</span>  <span class="cItalic">n</span><span class="cItalic">y</span> pixels into a rectangle of size (<span class="cItalic">r</span>  <span class="cItalic">l</span>)  (<span class="cItalic">t</span>  <span class="cItalic">b</span>), the pixels are spaced a distance (<span class="cItalic">r</span>  <span class="cItalic">l</span>)/<span class="cItalic">n</span><span class="cItalic">x</span> apart horizontally and (<span class="cItalic">t</span>  <span class="cItalic">b</span>)/<span class="cItalic">n</span><span class="cItalic">y</span> apart vertically, with a half-pixel space around the edge to center the pixel grid within the image rectangle. This means that the pixel at position (<span class="cItalic">i, j</span>) in the raster image has the position</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_159&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(4.1)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_159" overflow="scroll" style="width: 16.764em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.249em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.414em, 1016.15em, 3.293em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-530"><span class="mtable" id="MathJax-Span-531" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 11.879em; height: 0px;"><span style="position: absolute; clip: rect(2.368em, 1011.89em, 5.195em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.879em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1011.78em, 4.424em, -1000.01em); top: -4.728em; left: 0em;"><span class="mtd" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-535" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">l</span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-538" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-540"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mi" id="MathJax-Span-543" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">l</span></span><span class="mo" id="MathJax-Span-544" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-545" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-550" style="font-family: MathJax_Main; padding-left: 0.208em;">0.5</span></span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="msub" id="MathJax-Span-553"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1011.89em, 4.476em, -1000.01em); top: -3.288em; left: 0em;"><span class="mtd" id="MathJax-Span-557"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">b</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-563" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">b</span></span><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-570" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-571" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-575" style="font-family: MathJax_Main; padding-left: 0.208em;">0.5</span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.157em;">/</span><span class="msub" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-583" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.1)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.756em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_159"><mtable columnalign="left"><mtr><mtd><mi>u</mi><mo>=</mo><mi>l</mi><mo>+</mo><mrow><mo>(</mo><mrow><mi>r</mi><mo></mo><mi>l</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mi>i</mi><mo>+</mo><mn>0.5</mn></mrow><mo>)</mo></mrow><mo>/</mo><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo>=</mo><mi>b</mi><mo>+</mo><mrow><mo>(</mo><mrow><mi>t</mi><mo></mo><mi>b</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mi>j</mi><mo>+</mo><mn>0.5</mn></mrow><mo>)</mo></mrow><mo>/</mo><msub><mi>n</mi><mrow><mi>y</mi><mo>,</mo></mrow></msub></mtd></mtr></mtable><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.1)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-14"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_159"><mtable columnalign="left"><mtr><mtd><mi>u</mi><mo>=</mo><mi>l</mi><mo>+</mo><mrow><mo>(</mo><mrow><mi>r</mi><mo></mo><mi>l</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mi>i</mi><mo>+</mo><mn>0.5</mn></mrow><mo>)</mo></mrow><mo>/</mo><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo>=</mo><mi>b</mi><mo>+</mo><mrow><mo>(</mo><mrow><mi>t</mi><mo></mo><mi>b</mi></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mi>j</mi><mo>+</mo><mn>0.5</mn></mrow><mo>)</mo></mrow><mo>/</mo><msub><mi>n</mi><mrow><mi>y</mi><mo>,</mo></mrow></msub></mtd></mtr></mtable><mtext>(4.1)</mtext></math></script></p>
<p>where (<span class="cItalic">u, v</span>) are the coordinates of the pixels position on the image plane, measured with respect to the origin <span class="cBold">e</span> and the basis {<span class="cBold">u, v</span>}.</p>
<p>In an orthographic view, we can simply use the pixels image-plane position as the rays starting point, and we already know the rays direction is the view direction. The procedure for generating orthographic viewing rays is then:</p>
<pre><span class="code">compute <span class="cItalic">u</span> and <span class="cItalic">v</span> using (4.1)</span></pre>
<pre><span class="code">ray.direction  <span class="cBold">w</span></span></pre>
<pre><span class="code">ray.origin  <span class="cBold">e</span> + <span class="cItalic">u</span> <span class="cBold">u</span> + <span class="cItalic">v</span> <span class="cBold">v</span></span></pre>
<p>Its very simple to make an oblique parallel view: just allow the image plane normal <span class="cBold">w</span> to be specified separately from the view direction <span class="cBold">d</span>. The procedure is then exactly the same, but with <span class="cBold">d</span> substituted for <span class="cBold">w</span>. Of course w is still used to construct <span class="cBold">u</span> and <span class="cBold">v</span>.</p>
<div class="Sidebar">
<p class="SidebarText">With <span class="cItalic">l</span> and <span class="cItalic">r</span> both specified, there is redundancy: moving the viewpoint a bit to the right and correspondingly decreasing <span class="cItalic">l</span> and <span class="cItalic">r</span> will not change the view (and similarly on the <span class="cBold">v</span>-axis).</p>
</div>
<h3><a id="sec4-3-2"></a>4.3.2 Perspective Views</h3>
<p>For a perspective view, all the rays have the same origin, at the viewpoint; it is the directions that are different for each pixel. The image plane is no longer positioned at <span class="cBold">e</span>, but rather some distance <span class="cItalic">d</span> in front of e; this distance is the <span class="cItalic">image plane distance</span>, often loosely called the <span class="cItalic">focal length</span>, because choosing <span class="cItalic">d</span> plays the same role as choosing focal length in a real camera. The direction of each ray is defined by the viewpoint and the position of the pixel on the image plane. This situation is illustrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-9">Figure 4.9</a>, and the resulting procedure is similar to the <a id="page_76"></a>orthographic one:</p>
<pre><span class="code">compute <span class="cItalic">u</span> and <span class="cItalic">v</span> using (4.1)</span></pre>
<pre><span class="code">ray.direction  <span class="cItalic">d</span> <span class="cBold">w</span> + <span class="cItalic">u</span> <span class="cBold">u</span> + <span class="cItalic">v</span> <span class="cBold">v</span></span></pre>
<pre><span class="code">ray.origin  <span class="cBold">e</span></span></pre>
<p>As with parallel projection, oblique perspective views can be achieved by specifying the image plane normal separately from the projection direction, then replacing <span class="cItalic">d</span><span class="cBold">w</span> with <span class="cItalic">d</span><span class="cBold">d</span> in the expression for the ray direction.</p>
<h2><a id="sec4-4"></a>4.4 Ray-Object Intersection</h2>
<p>Once weve generated a ray <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span>, we next need to find the first intersection with any object where <span class="cItalic">t</span> &gt; 0. In practice, it turns out to be useful to solve a slightly more general problem: find the first intersection between the ray and a surface that occurs at a <span class="cItalic">t</span> in the interval [<span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>]. The basic ray intersection is the case where <span class="cItalic">t</span><span class="cSubscript">0</span> = 0 and <span class="cItalic">t</span><span class="cSubscript">1</span> = +. We solve this problem for both spheres and triangles. In the next section, multiple objects are discussed.</p>
<h3><a id="sec4-4-1"></a>4.4.1 Ray-Sphere Intersection</h3>
<p>Given a ray <span class="cBold">p</span>(<span class="cItalic">t</span>) = <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span> and an implicit surface <span class="cItalic">f</span>(<span class="cBold">p</span>) = 0 (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5-3">Section 2.5.3</a>), wed like to know where they intersect. Intersection points occur when points on the ray satisfy the implicit equation, so the values of <span class="cItalic">t</span> we seek are those that solve the equation</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_160&quot;&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;or&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_160" overflow="scroll" style="width: 13.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.319em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1013.23em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-588" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-589" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-590"><span class="mtext" id="MathJax-Span-591" style="font-family: MathJax_Main-bold;">p</span><span class="mrow" id="MathJax-Span-592" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.26em;">0</span><span class="mtext" id="MathJax-Span-599" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-600" style="font-family: MathJax_Main;">or</span><span class="mtext" id="MathJax-Span-601" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-603" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-605"><span class="mtext" id="MathJax-Span-606" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-607" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mtext" id="MathJax-Span-609" style="font-family: MathJax_Main-bold;">d</span></span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_160"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext>&nbsp;&nbsp;</mtext><mtext>or</mtext><mtext>&nbsp;&nbsp;</mtext><mi>f</mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-15"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_160"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext></mtext><mtext>or</mtext><mtext></mtext><mi>f</mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p>A sphere with center <span class="cBold">c</span> = (<span class="cItalic">x</span><span class="cItalic">c</span>, <span class="cItalic">y</span><span class="cItalic">c</span>, <span class="cItalic">z</span><span class="cItalic">c</span>) and radius <span class="cItalic">R</span> can be represented by the implicit equation</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_161&quot;&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_161" overflow="scroll" style="width: 18.769em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.203em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1018.11em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-614"><span class="mrow" id="MathJax-Span-615"><span class="msup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 3.91em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.4em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-623" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.499em;"><span class="mn" id="MathJax-Span-627" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msup" id="MathJax-Span-629" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 3.756em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.25em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-636" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.345em;"><span class="mn" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msup" id="MathJax-Span-642" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 3.704em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.2em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-643"><span class="mrow" id="MathJax-Span-644"><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-649" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-650" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.293em;"><span class="mn" id="MathJax-Span-653" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msup" id="MathJax-Span-655" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-656" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.774em;"><span class="mn" id="MathJax-Span-657" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-658" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-659" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_161"><mrow><msup><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mi>y</mi><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mi>z</mi><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-16"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_161"><mrow><msup><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mi>y</mi><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mi>z</mi><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p>We can write this same equation in vector form:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_162&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_162" overflow="scroll" style="width: 11.725em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.365em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1011.27em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="mrow" id="MathJax-Span-663"><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-665"><span class="mtext" id="MathJax-Span-666" style="font-family: MathJax_Main-bold;">p</span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-668" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mrow" id="MathJax-Span-671" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-673"><span class="mtext" id="MathJax-Span-674" style="font-family: MathJax_Main-bold;">p</span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-676" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-677" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msup" id="MathJax-Span-679" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.774em;"><span class="mn" id="MathJax-Span-681" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-683" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_162"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-17"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_162"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p>Any point <span class="cBold">p</span> that satisfies this equation is on the sphere. If we plug points on the ray <span class="cBold">p</span>(<span class="cItalic">t</span>) = <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span> into this equation, we get an equation in terms of <span class="cItalic">t</span> that is satisfied by the values of <span class="cItalic">t</span> that yield points on the sphere:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_163&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_163" overflow="scroll" style="width: 15.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.53em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1015.43em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-685"><span class="mrow" id="MathJax-Span-686"><span class="mrow" id="MathJax-Span-687"><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-689"><span class="mtext" id="MathJax-Span-690" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mtext" id="MathJax-Span-693" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-695" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mrow" id="MathJax-Span-698" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-700"><span class="mtext" id="MathJax-Span-701" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-702" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-705" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-706" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msup" id="MathJax-Span-709" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.774em;"><span class="mn" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-713" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_163"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mi mathvariant="bold">d</mi><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-18"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_163"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mi mathvariant="bold">d</mi><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p><a id="page_77"></a>Rearranging terms yields</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_164&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_164" overflow="scroll" style="width: 23.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.522em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1022.43em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-715"><span class="mrow" id="MathJax-Span-716"><span class="mrow" id="MathJax-Span-717"><span class="mo" id="MathJax-Span-718" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-719"><span class="mtext" id="MathJax-Span-720" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-721" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-722" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">d</span></span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-724" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-725" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.362em;"><span class="mn" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.208em;">2</span><span class="mtext" id="MathJax-Span-729" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mrow" id="MathJax-Span-731" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-733"><span class="mtext" id="MathJax-Span-734" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-736" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">t</span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-740" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-741" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-742"><span class="mtext" id="MathJax-Span-743" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-745" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mrow" id="MathJax-Span-748" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-750"><span class="mtext" id="MathJax-Span-751" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-753" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">c</span></span><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msup" id="MathJax-Span-756" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.774em;"><span class="mn" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-760" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_164"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mi>t</mi><mo>+</mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-19"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_164"><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mi>t</mi><mo>+</mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p>Here, everything is known except the parameter <span class="cItalic">t</span>, so this is a classic quadratic equation in <span class="cItalic">t,</span> meaning it has the form</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_165&quot;&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_165" overflow="scroll" style="width: 8.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1007.77em, 2.368em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Math-italic;">A</span><span class="msup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.362em;"><span class="mn" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-768" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">B</span><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-774" style="font-family: MathJax_Main; padding-left: 0.26em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.156em; border-left: 0px solid; width: 0px; height: 1.062em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_165"><mrow><mi>A</mi><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mi>B</mi><mi>t</mi><mo>+</mo><mi>C</mi><mo>=</mo><mn>0.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-20"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_165"><mrow><mi>A</mi><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mi>B</mi><mi>t</mi><mo>+</mo><mi>C</mi><mo>=</mo><mn>0.</mn></mrow></math></script></p>
<p>The solution to this equation is discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-2">Section 2.2</a>. The term under the square root sign in the quadratic solution, <span class="cItalic">B</span><span class="cSuperscript">2</span>  4<span class="cItalic">AC</span>, is called the <span class="cItalic">discriminant</span> and tells us how many real solutions there are. If the discriminant is negative, its square root is imaginary and the line and sphere do not intersect. If the discriminant is positive, there are two solutions: one solution where the ray enters the sphere and one where it leaves. If the discriminant is zero, the ray grazes the sphere, touching it at exactly one point. Plugging in the actual terms for the sphere and canceling a factor of two, we get</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_166&quot;&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#xB1;&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_166" overflow="scroll" style="width: 17.638em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.124em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.26em, 1017.13em, 2.882em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-776"><span class="mrow" id="MathJax-Span-777"><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-779" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-780" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 15.273em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1015.13em, 4.578em, -1000.01em); top: -4.83em; left: 50%; margin-left: -7.555em;"><span class="mrow" id="MathJax-Span-781"><span class="mo" id="MathJax-Span-782" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-783" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mrow" id="MathJax-Span-785"><span class="mo" id="MathJax-Span-786" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-787"><span class="mtext" id="MathJax-Span-788" style="font-size: 70.7%; font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-789" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-790" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span><span class="mo" id="MathJax-Span-791" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msqrt" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 11.571em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1010.76em, 4.424em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="msup" id="MathJax-Span-796"><span style="display: inline-block; position: relative; width: 3.345em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1002.99em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="mrow" id="MathJax-Span-798"><span class="mo" id="MathJax-Span-799" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-800"><span class="mtext" id="MathJax-Span-801" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-802" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mrow" id="MathJax-Span-803"><span class="mo" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-805"><span class="mtext" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-807" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-808" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 3.036em;"><span class="mn" id="MathJax-Span-811" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-812"><span class="mo" id="MathJax-Span-813" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-814"><span class="mtext" id="MathJax-Span-815" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-817" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span><span class="mo" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-819"><span class="mo" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mo" id="MathJax-Span-823" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-824"><span class="mtext" id="MathJax-Span-825" style="font-size: 70.7%; font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-826" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-827" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span></span></span><span class="mo" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-829" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mrow" id="MathJax-Span-830"><span class="mo" id="MathJax-Span-831" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-832"><span class="mtext" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-834" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-835" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span><span class="mo" id="MathJax-Span-836" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-837" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mrow" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="msup" id="MathJax-Span-840"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-841" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.517em;"><span class="mn" id="MathJax-Span-842" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-843" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1010.86em, 1.288em, -1000.01em); top: -1.951em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 10.851em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1000.73em, 4.63em, -1000.01em); top: -4.059em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.61em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.82em;"><span class="mrow" id="MathJax-Span-844"><span class="mrow" id="MathJax-Span-845"><span class="mo" id="MathJax-Span-846" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-847"><span class="mtext" id="MathJax-Span-848" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-850" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span></span><span class="mo" id="MathJax-Span-851" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1015.23em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 15.273em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 2.492em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_166"><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mo></mo><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msqrt><mrow><msup><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow></mrow></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow></msqrt></mrow><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></math></span></span><script type="math/mml" id="MathJax-Element-21"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_166"><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mo></mo><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><msqrt><mrow><msup><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow></mrow></mrow><mo>)</mo></mrow><mo></mo><mrow><mo>(</mo><mrow><mtext mathvariant="bold">e</mtext><mo></mo><mtext mathvariant="bold">c</mtext></mrow><mo>)</mo></mrow><mo></mo><mrow> <mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow></msqrt></mrow><mrow><mrow><mo>(</mo><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">d</mtext></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></math></script></p>
<p>In an actual implementation, you should first check the value of the discriminant before computing other terms. If the sphere is used only as a bounding object for more complex objects, then we need only determine whether we hit it; checking the discriminant suffices.</p>
<p>As discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-5-4">Section 2.5.4</a>, the normal vector at point <span class="cBold">p</span> is given by the gradient <span class="cBold">n</span> = 2(<span class="cBold">p</span>  <span class="cBold">c</span>). The unit normal is (<span class="cBold">p</span>  <span class="cBold">c</span>)/<span class="cItalic">R</span>.</p>
<h3><a id="sec4-4-2"></a>4.4.2 Ray-Triangle Intersection</h3>
<p>There are many algorithms for computing ray-triangle intersections. We will present the form that uses barycentric coordinates for the parametric plane containing the triangle, because it requires no long-term storage other than the vertices of the triangle (Snyder &amp; Barr, 1987).</p>
<p>To intersect a ray with a parametric surface, we set up a system of equations where the Cartesian coordinates all match:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_167&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;or,&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;f&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_167" overflow="scroll" style="width: 18.923em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.357em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1018.26em, 6.275em, -1000.01em); top: -4.368em; left: 0em;"><span class="mrow" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mrow" id="MathJax-Span-855"><span class="mrow" id="MathJax-Span-856"><span class="mtable" id="MathJax-Span-857" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 7.818em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1007.72em, 6.841em, -1000.01em); top: -4.933em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.818em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1007.72em, 4.424em, -1000.01em); top: -5.447em; left: 50%; margin-left: -3.905em;"><span class="mtd" id="MathJax-Span-858"><span class="mrow" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="msub" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-862" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-864" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-870" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-871" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-872" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-875" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1007.52em, 4.424em, -1000.01em); top: -4.008em; left: 50%; margin-left: -3.802em;"><span class="mtd" id="MathJax-Span-878"><span class="mrow" id="MathJax-Span-879"><span class="mrow" id="MathJax-Span-880"><span class="msub" id="MathJax-Span-881"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-889" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-891" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-893"><span class="mi" id="MathJax-Span-894" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-895" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1007.52em, 4.424em, -1000.01em); top: -2.517em; left: 50%; margin-left: -3.802em;"><span class="mtd" id="MathJax-Span-898"><span class="mrow" id="MathJax-Span-899"><span class="mrow" id="MathJax-Span-900"><span class="msub" id="MathJax-Span-901"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-903" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-904" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-905" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-906"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-909" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-910" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">h</span><span class="mrow" id="MathJax-Span-911" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-913"><span class="mi" id="MathJax-Span-914" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-915" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-917" style="font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.938em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-918" style="vertical-align: 2.265em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.134em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.871em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.871em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mtext" id="MathJax-Span-919" style="font-family: MathJax_Main;">&nbsp;&nbsp;</span><span class="mtext" id="MathJax-Span-920" style="font-family: MathJax_Main;">or,</span><span class="mtext" id="MathJax-Span-921" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-922" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-923" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-924" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mtext" id="MathJax-Span-926" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mtext" id="MathJax-Span-928" style="font-family: MathJax_Main-bold; padding-left: 0.26em;">f</span><span class="mrow" id="MathJax-Span-929" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-931"><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span></span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-936" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.851em; border-left: 0px solid; width: 0px; height: 4.239em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_167"><mrow><mrow><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>x</mi><mi>d</mi></msub><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>y</mi><mi>d</mi></msub><mo>=</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>z</mi><mi>d</mi></msub><mo>=</mo><mi>h</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow><mo>}</mo></mrow><mtext>&nbsp;&nbsp;</mtext><mtext>or,</mtext><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo>=</mo><mtext mathvariant="bold">f</mtext><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-22"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_167"><mrow><mrow><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>x</mi><mi>d</mi></msub><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>y</mi><mi>d</mi></msub><mo>=</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>z</mi><mi>d</mi></msub><mo>=</mo><mi>h</mi><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow> <mo>}</mo></mrow><mtext></mtext><mtext>or,</mtext><mtext></mtext><mtext></mtext><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo>=</mo><mtext mathvariant="bold">f</mtext><mrow><mo>(</mo><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p><a id="page_78"></a>Here, we have three equations and three unknowns (<span class="cItalic">t</span>, <span class="cItalic">u</span>, and <span class="cItalic">v</span>), so we can solve numerically for the unknowns. If we are lucky, we can solve for them analytically.</p>
<p>In the case where the parametric surface is a parametric plane, the parametric equation can be written in vector form as discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-7-2">Section 2.7.2</a>. If the vertices of the triangle are <span class="cBold">a</span>, <span class="cBold">b</span>, and <span class="cBold">c</span>, then the intersection will occur when</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_168&quot;&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;a&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;b&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;a&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;&amp;#x3B3;&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;c&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;a&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(4.2)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_168" overflow="scroll" style="width: 19.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.18em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1019.09em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-938"><span class="mrow" id="MathJax-Span-939"><span class="mtext" id="MathJax-Span-940" style="font-family: MathJax_Main-bold;">e</span><span class="mo" id="MathJax-Span-941" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="mtext" id="MathJax-Span-943" style="font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mtext" id="MathJax-Span-945" style="font-family: MathJax_Main-bold; padding-left: 0.26em;">a</span><span class="mo" id="MathJax-Span-946" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-948" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-950"><span class="mtext" id="MathJax-Span-951" style="font-family: MathJax_Main-bold;">b</span><span class="mo" id="MathJax-Span-952" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-953" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">a</span></span><span class="mo" id="MathJax-Span-954" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-955" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mtext" id="MathJax-Span-956" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"></span><span class="mrow" id="MathJax-Span-957" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-959"><span class="mtext" id="MathJax-Span-960" style="font-family: MathJax_Main-bold;">c</span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-962" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">a</span></span><span class="mo" id="MathJax-Span-963" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span><span class="mtext" id="MathJax-Span-965" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.2)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_168"><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo>=</mo><mtext mathvariant="bold">a</mtext><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">b</mtext><mo></mo><mtext mathvariant="bold">a</mtext></mrow><mo>)</mo></mrow><mo>+</mo><mtext></mtext><mrow><mo>(</mo><mrow><mtext mathvariant="bold">c</mtext><mo></mo><mtext mathvariant="bold">a</mtext></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.2)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-23"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_168"><mrow><mtext mathvariant="bold">e</mtext><mo>+</mo><mi>t</mi><mtext mathvariant="bold">d</mtext><mo>=</mo><mtext mathvariant="bold">a</mtext><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><mtext mathvariant="bold">b</mtext><mo></mo><mtext mathvariant="bold">a</mtext></mrow><mo>)</mo></mrow><mo>+</mo><mtext></mtext><mrow><mo>(</mo><mrow><mtext mathvariant="bold">c</mtext><mo></mo><mtext mathvariant="bold">a</mtext></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>(4.2)</mtext></math></script></p>
<p>for some <span class="cItalic">t</span>, <span class="cItalic"></span>, and <span class="cItalic"></span>. The intersection <span class="cBold">p</span> will be at <span class="cBold">e</span>+<span class="cItalic">t</span><span class="cBold">d</span> as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-10">Figure 4.10</a>. Again, from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C002.xhtml#sec2-7-2">Section 2.7.2</a>, we know the intersection is inside the triangle if and only if <span class="cItalic"></span> &gt; 0, <span class="cItalic"></span> &gt; 0, and <span class="cItalic"></span> + <span class="cItalic"></span> &lt; 1. Otherwise, the ray has hit the plane outside the triangle, so it misses the triangle. If there are no solutions, either the triangle is degenerate or the ray is parallel to the plane containing the triangle.</p>
<div id="art_Dest_fig_4-10" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-10"></a><span class="cBold">Figure 4.10</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-10.png" alt="Figure showing the ray hits the plane containing the triangle at point p." width="409" height="566" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-10.png"></p>
<p class="Text figcaption">The ray hits the plane containing the triangle at point <span class="cBold">p</span>.</p>
</div>
<p>To solve for <span class="cItalic">t</span>, <span class="cItalic"></span>, and <span class="cItalic"></span> in Equation (4.2), we expand it from its vector form into the three equations for the three coordinates:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_169&quot;&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_169" overflow="scroll" style="width: 18.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.306em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.306em, 1018.06em, 4.013em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-967"><span class="mtable" id="MathJax-Span-968" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 17.998em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1017.96em, 6.841em, -1000.01em); top: -4.933em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.998em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1017.96em, 4.424em, -1000.01em); top: -5.447em; left: 50%; margin-left: -8.995em;"><span class="mtd" id="MathJax-Span-969"><span class="mrow" id="MathJax-Span-970"><span class="mrow" id="MathJax-Span-971"><span class="msub" id="MathJax-Span-972"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-973" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-975" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-976" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-977"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-980" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-981" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-984" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-985" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-986" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-988"><span class="msub" id="MathJax-Span-989"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-992" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-993" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-997" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-999" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1000" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1001"><span class="msub" id="MathJax-Span-1002"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1006" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1009" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1010" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1017.39em, 4.424em, -1000.01em); top: -4.008em; left: 50%; margin-left: -8.738em;"><span class="mtd" id="MathJax-Span-1011"><span class="mrow" id="MathJax-Span-1012"><span class="mrow" id="MathJax-Span-1013"><span class="msub" id="MathJax-Span-1014"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1015" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1017" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-1019"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1020" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-1023" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1027" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1028" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1029" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1030"><span class="msub" id="MathJax-Span-1031"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1032" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1033" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1034" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1035" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1041" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1042" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1043"><span class="msub" id="MathJax-Span-1044"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1046" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1047" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1048" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1049" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1052" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1017.18em, 4.424em, -1000.01em); top: -2.517em; left: 50%; margin-left: -8.635em;"><span class="mtd" id="MathJax-Span-1053"><span class="mrow" id="MathJax-Span-1054"><span class="mrow" id="MathJax-Span-1055"><span class="msub" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1059" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">t</span><span class="msub" id="MathJax-Span-1061"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1062" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1063" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1064" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-1065" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1069" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1070" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1071" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1072"><span class="msub" id="MathJax-Span-1073"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1074" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1077" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1080" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1081" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_Math-italic; padding-left: 0.208em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1083" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1085"><span class="msub" id="MathJax-Span-1086"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1087" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1089" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1090" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1091" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1092" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1093" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.938em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.851em; border-left: 0px solid; width: 0px; height: 4.239em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_169"><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>x</mi><mi>d</mi></msub><mo>=</mo><msub><mi>x</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>b</mi></msub><mo></mo><msub><mi>x</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>c</mi></msub><mo></mo><msub><mi>x</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>y</mi><mi>d</mi></msub><mo>=</mo><msub><mi>y</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>y</mi><mi>b</mi></msub><mo></mo><msub><mi>y</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>y</mi><mi>c</mi></msub><mo></mo><msub><mi>y</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>z</mi><mi>d</mi></msub><mo>=</mo><msub><mi>z</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>z</mi><mi>b</mi></msub><mo></mo><msub><mi>z</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>z</mi><mi>c</mi></msub><mo></mo><msub><mi>z</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-24"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_169"><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>x</mi><mi>d</mi></msub><mo>=</mo><msub><mi>x</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>b</mi></msub><mo></mo><msub><mi>x</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>c</mi></msub><mo></mo><msub><mi>x</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>y</mi><mi>d</mi></msub><mo>=</mo><msub><mi>y</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>y</mi><mi>b</mi></msub><mo></mo><msub><mi>y</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>y</mi><mi>c</mi></msub><mo></mo><msub><mi>y</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>e</mi></msub><mo>+</mo><mi>t</mi><msub><mi>z</mi><mi>d</mi></msub><mo>=</mo><msub><mi>z</mi><mi>a</mi></msub><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>z</mi><mi>b</mi></msub><mo></mo><msub><mi>z</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi></mi><mrow><mo>(</mo><mrow><msub><mi>z</mi><mi>c</mi></msub><mo></mo><msub><mi>z</mi><mi>a</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>This can be rewritten as a standard linear system:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_170&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#xA0;&amp;#xA0;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_170" overflow="scroll" style="width: 20.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.208em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1020.11em, 6.172em, -1000.01em); top: -4.316em; left: 0em;"><span class="mrow" id="MathJax-Span-1096"><span class="mrow" id="MathJax-Span-1097"><span class="mo" id="MathJax-Span-1098" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1099"><span class="mtable" id="MathJax-Span-1100" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 8.949em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1003.15em, 6.429em, -1000.01em); top: -4.625em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1003.15em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -1.591em;"><span class="mtd" id="MathJax-Span-1101"><span class="mrow" id="MathJax-Span-1102"><span class="mrow" id="MathJax-Span-1103"><span class="msub" id="MathJax-Span-1104"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1105" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1108" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1109" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.99em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1127"><span class="mrow" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="msub" id="MathJax-Span-1130"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1131" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1134" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1135" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1153"><span class="mrow" id="MathJax-Span-1154"><span class="mrow" id="MathJax-Span-1155"><span class="msub" id="MathJax-Span-1156"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1157" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1159" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1160" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1003.15em, 6.429em, -1000.01em); top: -4.625em; left: 3.961em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1003.15em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -1.591em;"><span class="mtd" id="MathJax-Span-1111"><span class="mrow" id="MathJax-Span-1112"><span class="mrow" id="MathJax-Span-1113"><span class="msub" id="MathJax-Span-1114"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1115" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1117" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1118" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.99em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1137"><span class="mrow" id="MathJax-Span-1138"><span class="mrow" id="MathJax-Span-1139"><span class="msub" id="MathJax-Span-1140"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1144" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1163"><span class="mrow" id="MathJax-Span-1164"><span class="mrow" id="MathJax-Span-1165"><span class="msub" id="MathJax-Span-1166"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1167" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1170" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1171" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1001.04em, 6.275em, -1000.01em); top: -4.47em; left: 7.92em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.04em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-1121"><span class="mrow" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="msub" id="MathJax-Span-1124"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1125" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-1147"><span class="mrow" id="MathJax-Span-1148"><span class="mrow" id="MathJax-Span-1149"><span class="msub" id="MathJax-Span-1150"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1151" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-1173"><span class="mrow" id="MathJax-Span-1174"><span class="mrow" id="MathJax-Span-1175"><span class="msub" id="MathJax-Span-1176"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1177" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1178" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.476em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1179" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;</span><span class="mrow" id="MathJax-Span-1181" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1182" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1183"><span class="mtable" id="MathJax-Span-1184" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1000.58em, 6.224em, -1000.01em); top: -4.573em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -5.396em; left: 50%; margin-left: -0.306em;"><span class="mtd" id="MathJax-Span-1185"><span class="mrow" id="MathJax-Span-1186"><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-1188"><span class="mrow" id="MathJax-Span-1189"><span class="mi" id="MathJax-Span-1190" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -2.517em; left: 50%; margin-left: -0.203em;"><span class="mtd" id="MathJax-Span-1191"><span class="mrow" id="MathJax-Span-1192"><span class="mi" id="MathJax-Span-1193" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.578em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1194" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1195" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-1196" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-1197" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1198"><span class="mtable" id="MathJax-Span-1199" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1003.2em, 6.429em, -1000.01em); top: -4.625em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1003.2em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -1.591em;"><span class="mtd" id="MathJax-Span-1200"><span class="mrow" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="msub" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1207" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1208" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1003.04em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1210"><span class="mrow" id="MathJax-Span-1211"><span class="mrow" id="MathJax-Span-1212"><span class="msub" id="MathJax-Span-1213"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1214" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1217" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1218" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.99em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="mrow" id="MathJax-Span-1222"><span class="msub" id="MathJax-Span-1223"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1226" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1227" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1228" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1230" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1231" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 4.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.798em; border-left: 0px solid; width: 0px; height: 4.08em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_170"><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>&nbsp;&nbsp;</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mi></mi></mtd></mtr><mtr><mtd><mi></mi></mtd></mtr><mtr><mtd><mi>t</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-25"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_170"><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo></mo><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mi></mi></mtd></mtr><mtr><mtd><mi></mi></mtd></mtr><mtr><mtd><mi>t</mi></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo> <mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd></mtr></mtable></mrow> <mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>The fastest classic method to solve this 3 <span class="cItalic"></span> 3 linear system is <span class="cItalic">Cramers rule.</span> This gives us the solutions</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_171&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;A&lt;/mtext&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;A&lt;/mtext&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;A&lt;/mtext&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_171" overflow="scroll" style="width: 11.108em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.748em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-4.779em, 1010.5em, 8.486em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1233"><span class="mtable" id="MathJax-Span-1234" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 10.44em; height: 0px;"><span style="position: absolute; clip: rect(7.098em, 1010.4em, 20.363em, -1000.01em); top: -13.982em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.44em; height: 0px;"><span style="position: absolute; clip: rect(1.442em, 1009.37em, 5.812em, -1000.01em); top: -8.327em; left: 0em;"><span class="mtd" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1238" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-1239" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 7.046em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(2.162em, 1006.85em, 5.504em, -1000.01em); top: -5.756em; left: 50%; margin-left: -3.442em;"><span class="mrow" id="MathJax-Span-1240"><span class="mo" id="MathJax-Span-1241" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1242"><span class="mtable" id="MathJax-Span-1243" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 6.224em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1244"><span class="mrow" id="MathJax-Span-1245"><span class="mrow" id="MathJax-Span-1246"><span class="msub" id="MathJax-Span-1247"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1248" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1249" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1251"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1253" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.86em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1270"><span class="mrow" id="MathJax-Span-1271"><span class="mrow" id="MathJax-Span-1272"><span class="msub" id="MathJax-Span-1273"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1274" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1275" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1277"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1279" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1296"><span class="mrow" id="MathJax-Span-1297"><span class="mrow" id="MathJax-Span-1298"><span class="msub" id="MathJax-Span-1299"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1301" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1303"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1305" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 2.779em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1254"><span class="mrow" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="msub" id="MathJax-Span-1257"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1259" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1260" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1261"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1263" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1280"><span class="mrow" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="msub" id="MathJax-Span-1283"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1285" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1287"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1288" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1289" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1306"><span class="mrow" id="MathJax-Span-1307"><span class="mrow" id="MathJax-Span-1308"><span class="msub" id="MathJax-Span-1309"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1311" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1313"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1315" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.419em, 1000.73em, 5.452em, -1000.01em); top: -4.008em; left: 5.504em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.73em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="msub" id="MathJax-Span-1267"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1269" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.68em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1290"><span class="mrow" id="MathJax-Span-1291"><span class="mrow" id="MathJax-Span-1292"><span class="msub" id="MathJax-Span-1293"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1295" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.63em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1316"><span class="mrow" id="MathJax-Span-1317"><span class="mrow" id="MathJax-Span-1318"><span class="msub" id="MathJax-Span-1319"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1321" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1322" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-1323"><span class="mrow" id="MathJax-Span-1324"><span class="mo" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: MathJax_Main;">|</span><span class="mtext" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: MathJax_Main-bold;">A</span><span class="mo" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1007.05em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.046em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1328" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 5.041em;"></span></span><span style="position: absolute; clip: rect(1.442em, 1009.37em, 5.812em, -1000.01em); top: -3.905em; left: 0em;"><span class="mtd" id="MathJax-Span-1329"><span class="mrow" id="MathJax-Span-1330"><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1332" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-1333" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 7.046em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(2.162em, 1006.85em, 5.504em, -1000.01em); top: -5.756em; left: 50%; margin-left: -3.442em;"><span class="mrow" id="MathJax-Span-1334"><span class="mo" id="MathJax-Span-1335" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1336"><span class="mtable" id="MathJax-Span-1337" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 6.224em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1338"><span class="mrow" id="MathJax-Span-1339"><span class="mrow" id="MathJax-Span-1340"><span class="msub" id="MathJax-Span-1341"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1342" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1343" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1347" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mrow" id="MathJax-Span-1366"><span class="msub" id="MathJax-Span-1367"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1369" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1370" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1371"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1373" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1390"><span class="mrow" id="MathJax-Span-1391"><span class="mrow" id="MathJax-Span-1392"><span class="msub" id="MathJax-Span-1393"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1394" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1395" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1396" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1397"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1399" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 2.728em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1348"><span class="mrow" id="MathJax-Span-1349"><span class="mrow" id="MathJax-Span-1350"><span class="msub" id="MathJax-Span-1351"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1353" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1354" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1355"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1357" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.86em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1374"><span class="mrow" id="MathJax-Span-1375"><span class="mrow" id="MathJax-Span-1376"><span class="msub" id="MathJax-Span-1377"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1379" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1380" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1381"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1383" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1400"><span class="mrow" id="MathJax-Span-1401"><span class="mrow" id="MathJax-Span-1402"><span class="msub" id="MathJax-Span-1403"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1405" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1406" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1407"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1409" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.419em, 1000.73em, 5.452em, -1000.01em); top: -4.008em; left: 5.504em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.73em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1358"><span class="mrow" id="MathJax-Span-1359"><span class="mrow" id="MathJax-Span-1360"><span class="msub" id="MathJax-Span-1361"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1363" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.68em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1384"><span class="mrow" id="MathJax-Span-1385"><span class="mrow" id="MathJax-Span-1386"><span class="msub" id="MathJax-Span-1387"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1389" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.63em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1410"><span class="mrow" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"><span class="msub" id="MathJax-Span-1413"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1414" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1415" style="font-size: 50%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1416" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-1417"><span class="mrow" id="MathJax-Span-1418"><span class="mo" id="MathJax-Span-1419" style="font-size: 70.7%; font-family: MathJax_Main;">|</span><span class="mtext" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: MathJax_Main-bold;">A</span><span class="mo" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1007.05em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.046em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 5.041em;"></span></span><span style="position: absolute; clip: rect(1.442em, 1010.4em, 5.812em, -1000.01em); top: 0.568em; left: 0em;"><span class="mtd" id="MathJax-Span-1423"><span class="mrow" id="MathJax-Span-1424"><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1426" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-1427" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 8.28em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(2.162em, 1008.08em, 5.504em, -1000.01em); top: -5.756em; left: 50%; margin-left: -4.059em;"><span class="mrow" id="MathJax-Span-1428"><span class="mo" id="MathJax-Span-1429" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1430"><span class="mtable" id="MathJax-Span-1431" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 7.458em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1432"><span class="mrow" id="MathJax-Span-1433"><span class="mrow" id="MathJax-Span-1434"><span class="msub" id="MathJax-Span-1435"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1437" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1439"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1441" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1462"><span class="mrow" id="MathJax-Span-1463"><span class="mrow" id="MathJax-Span-1464"><span class="msub" id="MathJax-Span-1465"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1467" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1468" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1469"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1471" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1492"><span class="mrow" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="msub" id="MathJax-Span-1495"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1497" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1499"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1501" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 2.728em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1442"><span class="mrow" id="MathJax-Span-1443"><span class="mrow" id="MathJax-Span-1444"><span class="msub" id="MathJax-Span-1445"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1446" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1447" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1448" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1449"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1451" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1472"><span class="mrow" id="MathJax-Span-1473"><span class="mrow" id="MathJax-Span-1474"><span class="msub" id="MathJax-Span-1475"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1477" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1478" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1479"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1480" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1481" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1502"><span class="mrow" id="MathJax-Span-1503"><span class="mrow" id="MathJax-Span-1504"><span class="msub" id="MathJax-Span-1505"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1507" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1508" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1509"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1511" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.316em, 1001.97em, 5.452em, -1000.01em); top: -4.008em; left: 5.504em;"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1001.97em, 4.27em, -1000.01em); top: -5.139em; left: 0em;"><span class="mtd" id="MathJax-Span-1452"><span class="mrow" id="MathJax-Span-1453"><span class="mrow" id="MathJax-Span-1454"><span class="msub" id="MathJax-Span-1455"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1457" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1458" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1459"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-1461" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.86em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1482"><span class="mrow" id="MathJax-Span-1483"><span class="mrow" id="MathJax-Span-1484"><span class="msub" id="MathJax-Span-1485"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1487" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1488" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1489"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.362em;"><span class="mi" id="MathJax-Span-1491" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1001.81em, 4.27em, -1000.01em); top: -2.825em; left: 0em;"><span class="mtd" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"><span class="mrow" id="MathJax-Span-1514"><span class="msub" id="MathJax-Span-1515"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1517" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1518" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="msub" id="MathJax-Span-1519"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-1521" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1522" style="vertical-align: 1.699em;"><span style="display: inline-block; position: relative; width: 0.208em; height: 0px;"><span style="position: absolute; top: -3.494em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.18em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.877em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -2.311em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -1.746em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-1523"><span class="mrow" id="MathJax-Span-1524"><span class="mo" id="MathJax-Span-1525" style="font-size: 70.7%; font-family: MathJax_Main;">|</span><span class="mtext" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: MathJax_Main-bold;">A</span><span class="mo" id="MathJax-Span-1527" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1008.29em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.28em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1528" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 5.041em;"></span></span></span><span style="display: inline-block; width: 0px; height: 13.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.458em; border-left: 0px solid; width: 0px; height: 13.454em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_171"><mtable columnalign="left"><mtr><mtd><mi></mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>|</mo></mrow><mrow><mrow><mo>|</mo><mtext mathvariant="bold">A</mtext><mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd><mi></mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>|</mo></mrow><mrow><mrow><mo>|</mo><mtext mathvariant="bold">A</mtext><mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd><mi>t</mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd></mtr></mtable><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo><mtext mathvariant="bold">A</mtext><mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-26"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_171"><mtable columnalign="left"><mtr><mtd><mi></mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>|</mo></mrow><mrow><mrow><mo>|</mo> <mtext mathvariant="bold">A</mtext> <mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd><mi></mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>|</mo></mrow><mrow><mrow><mo>|</mo> <mtext mathvariant="bold">A</mtext> <mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd><mi>t</mi><mo>=</mo><mfrac><mrow><mo>|</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>e</mi></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd columnalign="left"><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>e</mi></msub></mrow></mtd></mtr></mtable><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo> <mtext mathvariant="bold">A</mtext> <mo>|</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr></mtable></math></script></p>
<p><a id="page_79"></a>where the matrix <span class="cBold">A</span> is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_172&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;A&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_172" overflow="scroll" style="width: 13.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.216em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1013.17em, 6.121em, -1000.01em); top: -4.265em; left: 0em;"><span class="mrow" id="MathJax-Span-1530"><span class="mtext" id="MathJax-Span-1531" style="font-family: MathJax_Main-bold;">A</span><span class="mo" id="MathJax-Span-1532" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-1533" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-1534" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1535"><span class="mtable" id="MathJax-Span-1536" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 8.949em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1003.15em, 6.429em, -1000.01em); top: -4.625em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1003.15em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -1.591em;"><span class="mtd" id="MathJax-Span-1537"><span class="mrow" id="MathJax-Span-1538"><span class="mrow" id="MathJax-Span-1539"><span class="msub" id="MathJax-Span-1540"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1541" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1543" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1544" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1546" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.99em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1563"><span class="mrow" id="MathJax-Span-1564"><span class="mrow" id="MathJax-Span-1565"><span class="msub" id="MathJax-Span-1566"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1567" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1568" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1569" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1570" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1571" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1589"><span class="mrow" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="msub" id="MathJax-Span-1592"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1595" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1596" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1597" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1003.15em, 6.429em, -1000.01em); top: -4.625em; left: 3.961em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1003.15em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -1.591em;"><span class="mtd" id="MathJax-Span-1547"><span class="mrow" id="MathJax-Span-1548"><span class="mrow" id="MathJax-Span-1549"><span class="msub" id="MathJax-Span-1550"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1553" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1554" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1555" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.99em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1573"><span class="mrow" id="MathJax-Span-1574"><span class="mrow" id="MathJax-Span-1575"><span class="msub" id="MathJax-Span-1576"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1577" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1579" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1580" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1581" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1002.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.488em;"><span class="mtd" id="MathJax-Span-1599"><span class="mrow" id="MathJax-Span-1600"><span class="mrow" id="MathJax-Span-1601"><span class="msub" id="MathJax-Span-1602"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1605" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1606" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1607" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1001.04em, 6.275em, -1000.01em); top: -4.47em; left: 7.92em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.04em, 4.321em, -1000.01em); top: -5.396em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-1557"><span class="mrow" id="MathJax-Span-1558"><span class="mrow" id="MathJax-Span-1559"><span class="msub" id="MathJax-Span-1560"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1561" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-1583"><span class="mrow" id="MathJax-Span-1584"><span class="mrow" id="MathJax-Span-1585"><span class="msub" id="MathJax-Span-1586"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1587" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1588" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.321em, -1000.01em); top: -2.517em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-1609"><span class="mrow" id="MathJax-Span-1610"><span class="mrow" id="MathJax-Span-1611"><span class="msub" id="MathJax-Span-1612"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1613" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-1614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.476em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1615" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1616" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span><span style="display: inline-block; width: 0px; height: 4.27em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.798em; border-left: 0px solid; width: 0px; height: 4.08em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_172"><mtext mathvariant="bold">A</mtext><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>,</mo></math></span></span><script type="math/mml" id="MathJax-Element-27"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_172"><mtext mathvariant="bold">A</mtext><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>a</mi></msub><mo></mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>a</mi></msub><mo></mo><msub><mi>y</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>y</mi><mi>d</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>b</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>a</mi></msub><mo></mo><msub><mi>z</mi><mi>c</mi></msub></mrow></mtd><mtd><mrow><msub><mi>z</mi><mi>d</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>,</mo></math></script></p>
<p>and |<span class="cBold">A</span>| denotes the determinant of <span class="cBold">A</span>. The 3 <span class="cItalic"></span> 3 determinants have common sub-terms that can be exploited. Looking at the linear systems with dummy variables</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_173&quot;&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_173" overflow="scroll" style="width: 13.113em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.702em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.255em, 1012.45em, 3.961em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1618"><span class="mtable" id="MathJax-Span-1619" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 12.393em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1004.59em, 6.738em, -1000.01em); top: -4.882em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.887em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1004.59em, 6.738em, -1000.01em); top: -4.882em; left: 0em;"><span class="mtd" id="MathJax-Span-1620"><span class="mrow" id="MathJax-Span-1621"><span class="mrow" id="MathJax-Span-1622"><span class="mrow" id="MathJax-Span-1623"><span class="mo" id="MathJax-Span-1624" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1625"><span class="mtable" id="MathJax-Span-1626" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 3.242em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1000.52em, 5.967em, -1000.01em); top: -4.316em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-family: MathJax_Math-italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-1636"><span class="mrow" id="MathJax-Span-1637"><span class="mi" id="MathJax-Span-1638" style="font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-1645"><span class="mrow" id="MathJax-Span-1646"><span class="mi" id="MathJax-Span-1647" style="font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.321em;"></span></span><span style="position: absolute; clip: rect(2.573em, 1000.58em, 6.635em, -1000.01em); top: -4.779em; left: 1.339em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-1630"><span class="mrow" id="MathJax-Span-1631"><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-1639"><span class="mrow" id="MathJax-Span-1640"><span class="mi" id="MathJax-Span-1641" style="font-family: MathJax_Math-italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-1648"><span class="mrow" id="MathJax-Span-1649"><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.784em;"></span></span><span style="position: absolute; clip: rect(2.316em, 1000.58em, 5.967em, -1000.01em); top: -4.316em; left: 2.676em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-1633"><span class="mrow" id="MathJax-Span-1634"><span class="mi" id="MathJax-Span-1635" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-1642"><span class="mrow" id="MathJax-Span-1643"><span class="mi" id="MathJax-Span-1644" style="font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.32em, 4.167em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-1651"><span class="mrow" id="MathJax-Span-1652"><span class="mi" id="MathJax-Span-1653" style="font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.321em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1654" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span><span style="position: absolute; clip: rect(2.522em, 1001.91em, 6.738em, -1000.01em); top: -4.882em; left: 5.71em;"><span style="display: inline-block; position: relative; width: 2.213em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1001.91em, 6.738em, -1000.01em); top: -4.882em; left: 0em;"><span class="mtd" id="MathJax-Span-1655"><span class="mrow" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mrow" id="MathJax-Span-1658"><span class="mo" id="MathJax-Span-1659" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1660"><span class="mtable" id="MathJax-Span-1661" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1000.58em, 6.224em, -1000.01em); top: -4.573em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-1662"><span class="mrow" id="MathJax-Span-1663"><span class="mi" id="MathJax-Span-1664" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-1665"><span class="mrow" id="MathJax-Span-1666"><span class="mi" id="MathJax-Span-1667" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-1668"><span class="mrow" id="MathJax-Span-1669"><span class="mi" id="MathJax-Span-1670" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.578em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1671" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span><span style="position: absolute; clip: rect(2.573em, 1003.56em, 6.738em, -1000.01em); top: -4.882em; left: 8.743em;"><span style="display: inline-block; position: relative; width: 3.653em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1003.56em, 6.738em, -1000.01em); top: -4.882em; left: 0em;"><span class="mtd" id="MathJax-Span-1672"><span class="mrow" id="MathJax-Span-1673"><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main;">=</span><span class="mrow" id="MathJax-Span-1675" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-1676"><span class="mo" id="MathJax-Span-1677" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1678"><span class="mtable" id="MathJax-Span-1679" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1000.52em, 6.172em, -1000.01em); top: -4.522em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.373em, -1000.01em); top: -5.396em; left: 0em;"><span class="mtd" id="MathJax-Span-1680"><span class="mrow" id="MathJax-Span-1681"><span class="mi" id="MathJax-Span-1682" style="font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -3.956em; left: 0em;"><span class="mtd" id="MathJax-Span-1683"><span class="mrow" id="MathJax-Span-1684"><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.27em, 4.167em, -1000.01em); top: -2.517em; left: 0em;"><span class="mtd" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mi" id="MathJax-Span-1688" style="font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.527em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1689" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;"><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1690" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.798em; border-left: 0px solid; width: 0px; height: 4.08em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_173"><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi>a</mi></mtd><mtd columnalign="left"><mi>d</mi></mtd><mtd columnalign="left"><mi>g</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>b</mi></mtd><mtd columnalign="left"><mi>e</mi></mtd><mtd columnalign="left"><mi>h</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>c</mi></mtd><mtd columnalign="left"><mi>f</mi></mtd><mtd columnalign="left"><mi>i</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></mtd><mtd columnalign="left"><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi></mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi></mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>t</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></mtd><mtd columnalign="left"><mo>=</mo><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi>j</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>k</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>l</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-28"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_173"><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi>a</mi></mtd><mtd columnalign="left"><mi>d</mi></mtd><mtd columnalign="left"><mi>g</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>b</mi></mtd><mtd columnalign="left"><mi>e</mi></mtd><mtd columnalign="left"><mi>h</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>c</mi></mtd><mtd columnalign="left"><mi>f</mi></mtd><mtd columnalign="left"><mi>i</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></mtd><mtd columnalign="left"><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi></mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi></mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>t</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></mtd><mtd columnalign="left"><mo>=</mo><mrow><mrow><mo>[</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mi>j</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>k</mi></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mi>l</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>Cramers rule gives us</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_174&quot;&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_174" overflow="scroll" style="width: 13.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.319em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.974em, 1013.07em, 4.681em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1692"><span class="mtable" id="MathJax-Span-1693" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 13.01em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1000.58em, 7.818em, -1000.01em); top: -5.602em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.58em, 4.373em, -1000.01em); top: -5.807em; right: 0em;"><span class="mtd" id="MathJax-Span-1694"><span class="mrow" id="MathJax-Span-1695"><span class="mrow" id="MathJax-Span-1696"><span class="mi" id="MathJax-Span-1697" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -3.905em; right: 0em;"><span class="mtd" id="MathJax-Span-1738"><span class="mrow" id="MathJax-Span-1739"><span class="mrow" id="MathJax-Span-1740"><span class="mi" id="MathJax-Span-1741" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.32em, 4.167em, -1000.01em); top: -1.951em; right: 0em;"><span class="mtd" id="MathJax-Span-1782"><span class="mrow" id="MathJax-Span-1783"><span class="mrow" id="MathJax-Span-1784"><span class="mi" id="MathJax-Span-1785" style="font-family: MathJax_Math-italic;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.607em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1011.58em, 8.949em, -1000.01em); top: -6.373em; left: 1.391em;"><span style="display: inline-block; position: relative; width: 11.674em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1011.07em, 4.578em, -1000.01em); top: -5.807em; left: 0em;"><span class="mtd" id="MathJax-Span-1698"><span class="mrow" id="MathJax-Span-1699"><span class="mrow" id="MathJax-Span-1700"><span class="mo" id="MathJax-Span-1701" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-1702" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 9.566em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1009.37em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -4.728em;"><span class="mrow" id="MathJax-Span-1703"><span class="mi" id="MathJax-Span-1704" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mrow" id="MathJax-Span-1705"><span class="mo" id="MathJax-Span-1706" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1707"><span class="mi" id="MathJax-Span-1708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1709" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1710" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1711" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span class="mo" id="MathJax-Span-1713" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mrow" id="MathJax-Span-1716"><span class="mo" id="MathJax-Span-1717" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1718"><span class="mi" id="MathJax-Span-1719" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1720" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1721" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span><span class="mo" id="MathJax-Span-1724" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1725" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mrow" id="MathJax-Span-1727"><span class="mo" id="MathJax-Span-1728" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1729"><span class="mi" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1731" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1733" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-1735" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.357em;"><span class="mi" id="MathJax-Span-1736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1009.57em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.566em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1010.71em, 4.578em, -1000.01em); top: -3.905em; left: 0em;"><span class="mtd" id="MathJax-Span-1742"><span class="mrow" id="MathJax-Span-1743"><span class="mrow" id="MathJax-Span-1744"><span class="mo" id="MathJax-Span-1745" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-1746" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 9.206em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1009.06em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -4.522em;"><span class="mrow" id="MathJax-Span-1747"><span class="mi" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mrow" id="MathJax-Span-1749"><span class="mo" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1751"><span class="mi" id="MathJax-Span-1752" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1758" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mrow" id="MathJax-Span-1760"><span class="mo" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1762"><span class="mi" id="MathJax-Span-1763" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1764" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span><span class="mo" id="MathJax-Span-1768" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1769" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1771"><span class="mo" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1773"><span class="mi" id="MathJax-Span-1774" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1775" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1776" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1777" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-1778" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.357em;"><span class="mi" id="MathJax-Span-1780" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1009.21em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.206em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1781" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1011.58em, 4.578em, -1000.01em); top: -1.951em; left: 0em;"><span class="mtd" id="MathJax-Span-1786"><span class="mrow" id="MathJax-Span-1787"><span class="mrow" id="MathJax-Span-1788"><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-1790" style="font-family: MathJax_Main; padding-left: 0.26em;"></span><span class="mfrac" id="MathJax-Span-1791"><span style="display: inline-block; position: relative; width: 9.309em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1009.11em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -4.573em;"><span class="mrow" id="MathJax-Span-1792"><span class="mi" id="MathJax-Span-1793" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-1794"><span class="mo" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1796"><span class="mi" id="MathJax-Span-1797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1799" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1801" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span><span class="mo" id="MathJax-Span-1802" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1803" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mrow" id="MathJax-Span-1805"><span class="mo" id="MathJax-Span-1806" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1807"><span class="mi" id="MathJax-Span-1808" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1809" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1810" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1811" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1812" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span><span class="mo" id="MathJax-Span-1813" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1814" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-1816"><span class="mo" id="MathJax-Span-1817" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1818"><span class="mi" id="MathJax-Span-1819" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1820" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1821" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-1823" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span><span class="mo" id="MathJax-Span-1824" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.73em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.357em;"><span class="mi" id="MathJax-Span-1825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1009.32em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.309em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1826" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.378em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.539em; border-left: 0px solid; width: 0px; height: 5.616em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_174"><mtable><mtr><mtd columnalign="right"><mrow><mi></mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>j</mi><mrow><mo>(</mo><mrow><mi>e</mi><mi>i</mi><mo></mo><mi>h</mi><mi>f</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><mrow><mo>(</mo><mrow><mi>g</mi><mi>f</mi><mo></mo><mi>d</mi><mi>i</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>l</mi><mrow><mo>(</mo><mrow><mi>d</mi><mi>h</mi><mo></mo><mi>e</mi><mi>g</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi></mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>i</mi><mrow><mo>(</mo><mrow><mi>a</mi><mi>k</mi><mo></mo><mi>j</mi><mi>b</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>h</mi><mrow><mo>(</mo><mrow><mi>j</mi><mi>c</mi><mo></mo><mi>a</mi><mi>l</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>b</mi><mi>l</mi><mo></mo><mi>k</mi><mi>c</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi>t</mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mo></mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>a</mi><mi>k</mi><mo></mo><mi>j</mi><mi>b</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>e</mi><mrow><mo>(</mo><mrow><mi>j</mi><mi>c</mi><mo></mo><mi>a</mi><mi>l</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>d</mi><mrow><mo>(</mo><mrow><mi>b</mi><mi>l</mi><mo></mo><mi>k</mi><mi>c</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-29"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_174"><mtable><mtr><mtd columnalign="right"><mrow><mi></mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>j</mi><mrow><mo>(</mo><mrow><mi>e</mi><mi>i</mi><mo></mo><mi>h</mi><mi>f</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><mrow><mo>(</mo><mrow><mi>g</mi><mi>f</mi><mo></mo><mi>d</mi><mi>i</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>l</mi><mrow><mo>(</mo><mrow><mi>d</mi><mi>h</mi><mo></mo><mi>e</mi><mi>g</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi></mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mi>i</mi><mrow><mo>(</mo><mrow><mi>a</mi><mi>k</mi><mo></mo><mi>j</mi><mi>b</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>h</mi><mrow><mo>(</mo><mrow><mi>j</mi><mi>c</mi><mo></mo><mi>a</mi><mi>l</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>b</mi><mi>l</mi><mo></mo><mi>k</mi><mi>c</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi>t</mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mo></mo><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>a</mi><mi>k</mi><mo></mo><mi>j</mi><mi>b</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>e</mi><mrow><mo>(</mo><mrow><mi>j</mi><mi>c</mi><mo></mo><mi>a</mi><mi>l</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>d</mi><mrow><mo>(</mo><mrow><mi>b</mi><mi>l</mi><mo></mo><mi>k</mi><mi>c</mi></mrow><mo>)</mo></mrow></mrow><mi>M</mi></mfrac><mo>,</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>where</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_175&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_175" overflow="scroll" style="width: 19.334em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.769em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1018.67em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1828"><span class="mi" id="MathJax-Span-1829" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-1830" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">a</span><span class="mrow" id="MathJax-Span-1832" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1833" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1834"><span class="mi" id="MathJax-Span-1835" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1836" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1837" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mi" id="MathJax-Span-1838" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">h</span><span class="mi" id="MathJax-Span-1839" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span class="mo" id="MathJax-Span-1840" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1841" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1842" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">b</span><span class="mrow" id="MathJax-Span-1843" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1844" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1845"><span class="mi" id="MathJax-Span-1846" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1847" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1848" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mi" id="MathJax-Span-1849" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1850" style="font-family: MathJax_Math-italic;">i</span></span><span class="mo" id="MathJax-Span-1851" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1852" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1853" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">c</span><span class="mrow" id="MathJax-Span-1854" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1855" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1856"><span class="mi" id="MathJax-Span-1857" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1859" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mi" id="MathJax-Span-1860" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">e</span><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span class="mo" id="MathJax-Span-1862" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1863" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_175"><mi>M</mi><mo>=</mo><mi>a</mi><mrow><mo>(</mo><mrow><mi>e</mi><mi>i</mi><mo></mo><mi>h</mi><mi>f</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>b</mi><mrow><mo>(</mo><mrow><mi>g</mi><mi>f</mi><mo></mo><mi>d</mi><mi>i</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>c</mi><mrow><mo>(</mo><mrow><mi>d</mi><mi>h</mi><mo></mo><mi>e</mi><mi>g</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-30"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_175"><mi>M</mi><mo>=</mo><mi>a</mi><mrow><mo>(</mo><mrow><mi>e</mi><mi>i</mi><mo></mo><mi>h</mi><mi>f</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>b</mi><mrow><mo>(</mo><mrow><mi>g</mi><mi>f</mi><mo></mo><mi>d</mi><mi>i</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>c</mi><mrow><mo>(</mo><mrow><mi>d</mi><mi>h</mi><mo></mo><mi>e</mi><mi>g</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></script></p>
<p>We can reduce the number of operations by reusing numbers such as <span class="cItalic">ei-minus-hf</span>.</p>
<p>The algorithm for the ray-triangle intersection for which we need the linear solution can have some conditions for early termination. Thus, the function should look something like:</p>
<p>boolean raytri (ray <span class="cBold">r</span>, vector3 <span class="cBold">a</span>, vector3 <span class="cBold">b</span>, vector3 <span class="cBold">c</span>, interval [<span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>])</p>
<pre><span class="code">compute <span class="cItalic">t</span></span></pre>
<pre><span class="code"><span class="cBold">if</span> (<span class="cItalic">t</span> &lt; <span class="cItalic">t</span><span class="cSubscript">0</span>) or (<span class="cItalic">t</span> &gt; <span class="cItalic">t</span><span class="cSubscript">1</span>) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> false</span></pre>
<pre><span class="code">compute <span class="cItalic"></span></span></pre>
<pre><span class="code"><span class="cBold">if</span> (<span class="cItalic"></span> &lt; 0) or (<span class="cItalic"></span> &gt; 1) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> false</span></pre>
<pre><span class="code">compute <span class="cItalic"></span></span></pre>
<pre><span class="code"><span class="cBold">if</span> (<span class="cItalic"></span> &lt; 0) or (<span class="cItalic"></span> &gt; 1  <span class="cItalic"></span>) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> false</span></pre>
<pre><span class="code"><span class="cBold">return</span> true</span></pre>
<h3><a id="sec4-4-3"></a><a id="page_80"></a>4.4.3 Ray-Polygon Intersection</h3>
<p>Given a planar polygon with <span class="cItalic">m</span> vertices <span class="cBold">p</span><span class="cSubscript">1</span> through <span class="cBold">p</span><span class="cItalic">m</span> and surface normal <span class="cBold">n</span>, we first compute the intersection points between the ray <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span> and the plane containing the polygon with implicit equation</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_176&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mtext&gt;1&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;0&lt;/mtext&gt;&lt;mtext&gt;.&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_176" overflow="scroll" style="width: 7.303em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.098em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1007em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-1865"><span class="mrow" id="MathJax-Span-1866"><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1868"><span class="mtext" id="MathJax-Span-1869" style="font-family: MathJax_Main-bold;">p</span><span class="mo" id="MathJax-Span-1870" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-1871" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-1872" style="font-family: MathJax_Main-bold;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 0.62em;"><span class="mtext" id="MathJax-Span-1873" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1874" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1875" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-1876" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">n</span><span class="mo" id="MathJax-Span-1877" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mtext" id="MathJax-Span-1878" style="font-family: MathJax_Main; padding-left: 0.26em;">0</span><span class="mtext" id="MathJax-Span-1879" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_176"><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><msub><mtext mathvariant="bold">p</mtext><mtext>1</mtext></msub></mrow><mo>)</mo></mrow><mo></mo><mtext mathvariant="bold">n</mtext><mo>=</mo><mtext>0</mtext><mtext>.</mtext></math></span></span><script type="math/mml" id="MathJax-Element-31"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_176"><mrow><mo>(</mo><mrow><mtext mathvariant="bold">p</mtext><mo></mo><msub><mtext mathvariant="bold">p</mtext><mtext>1</mtext></msub></mrow><mo>)</mo></mrow><mo></mo><mtext mathvariant="bold">n</mtext><mo>=</mo><mtext>0</mtext><mtext>.</mtext></math></script></p>
<p>We do this by setting <span class="cBold">p</span> = <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span> and solving for <span class="cItalic">t</span> to get</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_177&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;p&lt;/mtext&gt;&lt;mtext&gt;1&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;e&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;d&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_177" overflow="scroll" style="width: 5.298em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.144em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1005.05em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1881"><span class="mi" id="MathJax-Span-1882" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1883" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-1884" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.985em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1002.89em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.437em;"><span class="mrow" id="MathJax-Span-1885"><span class="mrow" id="MathJax-Span-1886"><span class="mo" id="MathJax-Span-1887" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1888"><span class="msub" id="MathJax-Span-1889"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-1890" style="font-size: 70.7%; font-family: MathJax_Main-bold;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mtext" id="MathJax-Span-1891" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-1893" style="font-size: 70.7%; font-family: MathJax_Main-bold;">e</span></span><span class="mo" id="MathJax-Span-1894" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1895" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-1896" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.09em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-1897"><span class="mtext" id="MathJax-Span-1898" style="font-size: 70.7%; font-family: MathJax_Main-bold;">d</span><span class="mo" id="MathJax-Span-1899" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-1900" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.985em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1901" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_177"><mi>t</mi><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><msub><mtext mathvariant="bold">p</mtext><mtext>1</mtext></msub><mo></mo><mtext mathvariant="bold">e</mtext></mrow><mo>)</mo></mrow><mo></mo><mtext mathvariant="bold">n</mtext></mrow><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">n</mtext></mrow></mfrac><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-32"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_177"><mi>t</mi><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><msub><mtext mathvariant="bold">p</mtext><mtext>1</mtext></msub><mo></mo><mtext mathvariant="bold">e</mtext></mrow><mo>)</mo></mrow><mo></mo><mtext mathvariant="bold">n</mtext></mrow><mrow><mtext mathvariant="bold">d</mtext><mo></mo><mtext mathvariant="bold">n</mtext></mrow></mfrac><mo>.</mo></math></script></p>
<p>This allows us to compute <span class="cBold">p</span>. If <span class="cBold">p</span> is inside the polygon, then the ray hits it; otherwise, it does not.</p>
<p>We can answer the question of whether <span class="cBold">p</span> is inside the polygon by projecting the point and polygon vertices to the <span class="cItalic">xy</span> plane and answering it there. The easiest way to do this is to send any 2D ray out from <span class="cBold">p</span> and to count the number of intersections between that ray and the boundary of the polygon (Sutherland, Sproull, &amp; Schumacker, 1974; Glassner, 1989). If the number of intersections is odd, then the point is inside the polygon; otherwise it is not. This is true because a ray that goes in must go out, thus creating a pair of intersections. Only a ray that starts inside will not create such a pair. To make computation simple, the 2D ray may as well propagate along the <span class="cItalic">x</span>-axis:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_178&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_178" overflow="scroll" style="width: 10.028em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.72em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.648em, 1009.63em, 4.527em, -1000.01em); top: -3.339em; left: 0em;"><span class="mrow" id="MathJax-Span-1903"><span class="mrow" id="MathJax-Span-1904"><span class="mo" id="MathJax-Span-1905" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-1906"><span class="mtable" id="MathJax-Span-1907" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1000.52em, 5.144em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.306em;"><span class="mtd" id="MathJax-Span-1908"><span class="mrow" id="MathJax-Span-1909"><span class="mi" id="MathJax-Span-1910" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-1911"><span class="mrow" id="MathJax-Span-1912"><span class="mi" id="MathJax-Span-1913" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1914" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-1915" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-1916" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-1917" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-1918"><span class="mtable" id="MathJax-Span-1919" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(2.676em, 1000.99em, 5.195em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.476em, -1000.01em); top: -4.779em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-1920"><span class="mrow" id="MathJax-Span-1921"><span class="mrow" id="MathJax-Span-1922"><span class="msub" id="MathJax-Span-1923"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-1925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.476em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-1926"><span class="mrow" id="MathJax-Span-1927"><span class="mrow" id="MathJax-Span-1928"><span class="msub" id="MathJax-Span-1929"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1930" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1932" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-1933" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-1934" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">s</span><span class="mrow" id="MathJax-Span-1935" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1936" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-1937"><span class="mtable" id="MathJax-Span-1938" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.47em, 4.938em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-1939"><span class="mrow" id="MathJax-Span-1940"><span class="mn" id="MathJax-Span-1941" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.255em;"><span class="mtd" id="MathJax-Span-1942"><span class="mrow" id="MathJax-Span-1943"><span class="mn" id="MathJax-Span-1944" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1945" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.345em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.809em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_178"><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>p</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>p</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>+</mo><mi>s</mi><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></math></span></span><script type="math/mml" id="MathJax-Element-33"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_178"><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mi>x</mi></mtd></mtr><mtr><mtd><mi>y</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>p</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>p</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>+</mo><mi>s</mi><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></math></script></p>
<p>It is straightforward to compute the intersection of that ray with the edges such as (<span class="cItalic">x</span><span class="cSubscript">1</span>, <span class="cItalic">y</span><span class="cSubscript">1</span>, <span class="cItalic">x</span><span class="cSubscript">2</span>, <span class="cItalic">y</span><span class="cSubscript">2</span>) for <span class="cItalic">s</span>  (0, ).</p>
<p>A problem arises, however, for polygons whose projection into the <span class="cItalic">xy</span> plane is a line. To get around this, we can choose among the <span class="cItalic">xy</span>, <span class="cItalic">yz</span>, or <span class="cItalic">zx</span> planes for whichever is best. If we implement our points to allow an indexing operation, e.g., <span class="cBold">p</span>(0) = <span class="cItalic">x<span class="cSubscript">p</span></span> then this can be accomplished as follows:</p>
<pre><span class="code"><span class="cBold">if</span> (abs(<span class="cItalic">z<span class="cSubscript">n</span></span>) &gt; abs(<span class="cItalic">x<span class="cSubscript">n</span></span>)) and (abs(<span class="cItalic">z<span class="cSubscript">n</span></span>) &gt; abs(<span class="cItalic">y<span class="cSubscript">n</span></span>)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> index0 = 0</span></pre>
<pre><span class="code"> index1 = 1</span></pre>
<pre><span class="code"><span class="cBold">else if</span> (abs(<span class="cItalic">y<span class="cSubscript">n</span></span>) &gt; abs (<span class="cItalic">x<span class="cSubscript">n</span></span>)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> index0 = 0</span></pre>
<pre><span class="code"> index1 = 2</span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> index0 = 1</span></pre>
<pre><span class="code"> index1 = 2</span></pre>
<p>Now, all computations can use <span class="cBold">p</span>(index0) rather than <span class="cItalic">x<span class="cSubscript">p</span></span>, and so on.</p>
<p><a id="page_81"></a>Another approach to polygons, one that is often used in practice, is to replace them by several triangles.</p>
<h3><a id="sec4-4-4"></a>4.4.4 Intersecting a Group of Objects</h3>
<p>Of course, most interesting scenes consist of more than one object, and when we intersect a ray with the scene we must find only the closest intersection to the camera along the ray. A simple way to implement this is to think of a group of objects as itself being another type of object. To intersect a ray with a group, you simply intersect the ray with the objects in the group and return the intersection with the smallest <span class="cItalic">t</span> value. The following code tests for hits in the interval <span class="cItalic">t</span>  [<span class="cItalic">t</span><span class="cSubscript">0</span><span class="cItalic">, <span class="cItalic">t</span><span class="cSubscript">1</span>]:</span></p>
<pre><span class="code">hit = false</span></pre>
<pre><span class="code"><span class="cBold">for</span> each object <span class="cBold">o</span> in the group <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cBold">if</span> (<span class="cBold">o</span> is hit at ray parameter <span class="cItalic">t</span> and <span class="cItalic">t</span> [<span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>]) <span class="cBold">then</span></span></pre>
<pre><span class="code"> hit = true</span></pre>
<pre><span class="code"> hitobject = <span class="cBold">o</span></span></pre>
<pre><span class="code"> <span class="cItalic">t</span><span class="cSubscript">1</span> = <span class="cItalic">t</span></span></pre>
<pre><span class="code"><span class="cBold">reture</span> hit</span></pre>
<div id="art_Dest_fig_4-11" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-11"></a><span class="cBold">Figure 4.11</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-11.png" alt="Figure showing a simple scene rendered with only ray generation and surface intersection, but no shading; each pixel is just set to a fixed color depending on which object it hit." width="404" height="404" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-11.png"></p>
<p class="Text figcaption">A simple scene rendered with only ray generation and surface intersection, but no shading; each pixel is just set to a fixed color depending on which object it hit.</p>
</div>
<h2><a id="sec4-5"></a>4.5 Shading</h2>
<p>Once the visible surface for a pixel is known, the pixel value is computed by evaluating a <span class="cItalic">shading model</span>. How this is done depends entirely on the applicationmethods range from very simple heuristics to elaborate numerical computations. In this chapter we describe the two most basic shading models; more advanced models are discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml">Chapter 10</a>.</p>
<p>Most shading models, one way or another, are designed to capture the process of light reflection, whereby surfaces are illuminated by light sources and reflect part of the light to the camera. Simple shading models are defined in terms of illumination from a point light source. The important variables in light reflection are the light direction <span class="cBold">l</span>, which is a unit vector pointing toward the light source; the view direction <span class="cBold">v</span>, which is a unit vector pointing toward the eye or camera; the surface normal <span class="cBold">n</span>, which is a unit vector perpendicular to the surface at the point where reflection is taking place; and the characteristics of the surfacecolor, shininess, or other properties depending on the particular model.</p>
<h3><a id="sec4-5-1"></a><a id="page_82"></a>4.5.1 Lambertian Shading</h3>
<p>The simplest shading model is based on an observation made by Lambert in the 18th century: the amount of energy from a light source that falls on an area of surface depends on the angle of the surface to the light. A surface facing directly toward the light receives maximum illumination; a surface tangent to the light direction (or facing away from the light) receives no illumination; and in between the illumination is proportional to the cosine of the angle <span class="cItalic"></span> between the surface normal and the light source (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-12">Figure 4.12</a>). This leads to the <span class="cItalic">Lambertian shading model</span>:</p>
<div id="art_Dest_fig_4-12" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-12"></a><span class="cBold">Figure 4.12</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-12.png" alt="Figure showing geometry for Lambertian shading." width="409" height="350" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-12.png"></p>
<p class="Text figcaption">Geometry for Lambertian shading.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_179&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;1&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_179" overflow="scroll" style="width: 10.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.131em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1010.04em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-1948"><span class="mi" id="MathJax-Span-1949" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1950" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-1951" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-1952" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-1953" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1954" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1955" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1956" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1957" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-1958" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="mrow" id="MathJax-Span-1959" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-1960" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-1961"><span class="mn" id="MathJax-Span-1962" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1963" style="font-family: MathJax_Main;">,</span><span class="mstyle" id="MathJax-Span-1964" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-1965"><span class="mi" id="MathJax-Span-1966" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-1967" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mstyle" id="MathJax-Span-1968" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-1969"><span class="mi" id="MathJax-Span-1970" style="font-family: MathJax_Main-bold;">1</span></span></span></span><span class="mo" id="MathJax-Span-1971" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_179"><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mtext>&nbsp;</mtext><mi>I</mi><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>1</mi></mstyle></mrow><mo>)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-34"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_179"><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mtext></mtext><mi>I</mi><mtext></mtext><mi>max</mi><mo></mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>1</mi></mstyle></mrow><mo>)</mo></mrow></math></script></p>
<div class="Sidebar">
<p class="SidebarText">Illumination from real point sources falls off as distance squared, but that is often more trouble than its worth in a simple renderer.</p>
</div>
<p>where <span class="cItalic">L</span> is the pixel color; <span class="cItalic">k<span class="cSubscript">d</span></span> is the <span class="cItalic">diffuse coefficient</span>, or the surface color; and <span class="cItalic">I</span> is the intensity of the light source. Because <span class="cBold">n</span> and <span class="cBold">l</span> are unit vectors, we can use <span class="cBold">n</span>  <span class="cBold">l</span> as a convenient shorthand (both on paper and in code) for cos <span class="cItalic"></span>. This equation (as with the other shading equations in this section) applies separately to the three color channels, so the red component of the pixel value is the product of the red diffuse component, the red light source intensity, and the dot product; the same holds for green and blue.</p>
<div class="Sidebar">
<p class="SidebarText">When in doubt, make light sources neutral in color, with equal red, green, and blue intensities.</p>
</div>
<p>The vector <span class="cBold">l</span> is computed by subtracting the intersection point of the ray and surface from the light source position. Dont forget that <span class="cBold">v, l</span>, and <span class="cBold">n</span> all must be unit vectors; failing to normalize these vectors is a very common error in shading computations.</p>
<h3><a id="sec4-5-2"></a>4.5.2 Blinn-Phong Shading</h3>
<p>Lambertian shading is <span class="cItalic">view independent</span>: the color of a surface does not depend on the direction from which you look. Many real surfaces show some degree of shininess, producing highlights, or <span class="cItalic">specular reflections</span>, that appear to move around as the viewpoint changes. Lambertian shading doesnt produce any highlights and leads to a very matte, chalky appearance, and many shading models add a <span class="cItalic">specular component</span> to Lambertian shading; the Lambertian part is then the <span class="cItalic">diffuse component</span>.</p>
<p>A very simple and widely used model for specular highlights was proposed by Phong (Phong, 1975) and later updated by Blinn (J. F. Blinn, 1976) to the form most commonly used today. The idea is to produce reflection that is at its brightest when <span class="cBold">v</span> and <span class="cBold">l</span> are symmetrically positioned across the surface normal, which is when mirror reflection would occur; the reflection then decreases smoothly as the vectors move away from a mirror configuration.</p>
<div id="art_Dest_fig_4-13" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-13"></a><span class="cBold">Figure 4.13</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-13.png" alt="Figure showing a simple scene rendered with diffuse shading from a single light source." width="405" height="397" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-13.png"></p>
<p class="Text figcaption">A simple scene rendered with diffuse shading from a single light source.</p>
</div>
<div id="art_Dest_fig_4-14" class="ArtGroup">
<p class="Text fignumber"><a id="page_83"></a><a id="Text_Anchor_fig_4-14"></a><span class="cBold">Figure 4.14</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-14.png" alt="Figure showing a simple scene rendered with diffuse shading and shadows (Section 4.7) from three light sources." width="404" height="398" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-14.png"></p>
<p class="Text figcaption">A simple scene rendered with diffuse shading and shadows (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#sec4-7">Section 4.7</a>) from three light sources.</p>
</div>
<div id="art_Dest_fig_4-15" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-15"></a><span class="cBold">Figure 4.15</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-15.png" alt="Figure showing a simple scene rendered with diffuse shading (blue sphere), Blinn-Phong shading (green sphere), and shadows from three light sources." width="404" height="398" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-15.png"></p>
<p class="Text figcaption">A simple scene rendered with diffuse shading (blue sphere), Blinn-Phong shading (green sphere), and shadows from three light sources.</p>
</div>
<p>We can tell how close we are to a mirror configuration by comparing the half vector <span class="cBold">h</span> (the bisector of the angle between <span class="cBold">v</span> and <span class="cBold">l</span>) to the surface normal (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-16">Figure 4.16</a>). If the half vector is near the surface normal, the specular component should be bright; if it is far away it should be dim. This result is achieved by computing the dot product between <span class="cBold">h</span> and <span class="cBold">n</span> (remember they are unit vectors, so <span class="cBold">n</span> <span class="cItalic"></span> <span class="cBold">h</span> reaches its maximum of 1 when the vectors are equal), then taking the result to a power <span class="cItalic">p</span> &gt; 1 to make it decrease faster. The power, or <span class="cItalic">Phong exponent,</span> controls the apparent shininess of the surface. The half vector itself is easy to compute: since <span class="cBold">v</span> and <span class="cBold">l</span> are the same length, their sum is a vector that bisects the angle between them, which only needs to be normalized to produce <span class="cBold">h</span>.</p>
<div id="art_Dest_fig_4-16" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-16"></a><span class="cBold">Figure 4.16</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-16.png" alt="Figure showing geometry for Blinn-Phong shading." width="410" height="354" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-16.png"></p>
<p class="Text figcaption">Geometry for Blinn-Phong shading.</p>
</div>
<p>Putting this all together, the Blinn-Phong shading model is as follows:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_180&quot;&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;v&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;l&lt;/mtext&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;v&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;1&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;1&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_180" overflow="scroll" style="width: 22.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.956em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.157em, 1021.71em, 3.55em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-1973"><span class="mtable" id="MathJax-Span-1974" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 21.648em; height: 0px;"><span style="position: absolute; clip: rect(2.368em, 1000.63em, 5.195em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.83em; right: 0em;"><span class="mtd" id="MathJax-Span-1975"><span class="mrow" id="MathJax-Span-1976"><span class="mrow" id="MathJax-Span-1977"><span class="mtext" id="MathJax-Span-1978" style="font-family: MathJax_Main-bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -2.979em; right: 0em;"><span class="mtd" id="MathJax-Span-1997"><span class="mrow" id="MathJax-Span-1998"><span class="mrow" id="MathJax-Span-1999"><span class="mi" id="MathJax-Span-2000" style="font-family: MathJax_Math-italic;">L</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.111em, 1020.11em, 5.504em, -1000.01em); top: -4.059em; left: 1.494em;"><span style="display: inline-block; position: relative; width: 20.157em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1003.51em, 4.784em, -1000.01em); top: -4.83em; left: 0em;"><span class="mtd" id="MathJax-Span-1979"><span class="mrow" id="MathJax-Span-1980"><span class="mrow" id="MathJax-Span-1981"><span class="mo" id="MathJax-Span-1982" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-1983"><span style="display: inline-block; position: relative; width: 2.316em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.19em, 4.219em, -1000.01em); top: -4.47em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-1984"><span class="mtext" id="MathJax-Span-1985" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span><span class="mo" id="MathJax-Span-1986" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mtext" id="MathJax-Span-1987" style="font-size: 70.7%; font-family: MathJax_Main-bold;">l</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.07em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-1988"><span class="mrow" id="MathJax-Span-1989"><span class="mo" id="MathJax-Span-1990" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-1991"><span class="mtext" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span><span class="mo" id="MathJax-Span-1993" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mtext" id="MathJax-Span-1994" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span></span><span class="mo" id="MathJax-Span-1995" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.27em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.316em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-1996" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1020.11em, 4.424em, -1000.01em); top: -2.979em; left: 0em;"><span class="mtd" id="MathJax-Span-2001"><span class="mrow" id="MathJax-Span-2002"><span class="mrow" id="MathJax-Span-2003"><span class="mo" id="MathJax-Span-2004" style="font-family: MathJax_Main;">=</span><span class="msub" id="MathJax-Span-2005" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2006" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2008" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2009" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-2010" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2011" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2012" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="mrow" id="MathJax-Span-2013" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-2014" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2015"><span class="mn" id="MathJax-Span-2016" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2017" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2018" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2019" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-2020" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">1</span></span><span class="mo" id="MathJax-Span-2021" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-2022" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-2023" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2024" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2026" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2027" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-2028" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2029" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2030" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="msup" id="MathJax-Span-2031"><span style="display: inline-block; position: relative; width: 4.116em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.61em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-2032"><span class="mrow" id="MathJax-Span-2033"><span class="mo" id="MathJax-Span-2034" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2035"><span class="mn" id="MathJax-Span-2036" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2038" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2039" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-2040" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">h</span></span><span class="mo" id="MathJax-Span-2041" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.704em;"><span class="mi" id="MathJax-Span-2042" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-2043" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.064em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.374em; border-left: 0px solid; width: 0px; height: 3.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_180"><mtable><mtr><mtd columnalign="right"><mrow><mtext mathvariant="bold">h</mtext></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mtext mathvariant="bold">v</mtext><mo>+</mo><mtext mathvariant="bold">l</mtext></mrow><mrow><mrow><mo>||</mo><mrow><mtext mathvariant="bold">v</mtext><mo>+</mo><mtext mathvariant="bold">1</mtext></mrow><mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi>L</mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mtext>&nbsp;</mtext><mi>I</mi><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">1</mtext></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext>&nbsp;</mtext><mi>I</mi><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">h</mtext></mrow><mo>)</mo></mrow></mrow><mi>p</mi></msup><mo>,</mo></mrow></mtd></mtr></mtable></math></span></span><script type="math/mml" id="MathJax-Element-35"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_180"><mtable><mtr><mtd columnalign="right"><mrow><mtext mathvariant="bold">h</mtext></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><mtext mathvariant="bold">v</mtext><mo>+</mo><mtext mathvariant="bold">l</mtext></mrow><mrow><mrow><mo>||</mo> <mrow><mtext mathvariant="bold">v</mtext><mo>+</mo><mtext mathvariant="bold">1</mtext></mrow> <mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mi>L</mi></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mtext></mtext><mi>I</mi><mtext></mtext><mi>max</mi><mo></mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">1</mtext></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext></mtext><mi>I</mi><mtext></mtext><mi>max</mi><mo></mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">h</mtext></mrow><mo>)</mo></mrow></mrow><mi>p</mi></msup><mo>,</mo></mrow></mtd></mtr></mtable></math></script></p>
<p>where <span class="cItalic">k<span class="cSubscript">s</span></span> is the <span class="cItalic">specular coefficient</span>, or the specular color, of the surface.</p>
<div class="Sidebar">
<p class="SidebarText">Typical values of <span class="cItalic">p</span>:</p>
<p class="SidebarText">10eggshell;</p>
<p class="SidebarText">100mildly shiny;</p>
<p class="SidebarText">1000really glossy;</p>
<p class="SidebarText">10,000nearlymirror-like.</p>
</div>
<div class="Sidebar">
<p class="SidebarText">When in doubt, make the specular color gray, with equal red, green, and blue values.</p>
</div>
<h3><a id="sec4-5-3"></a>4.5.3 Ambient Shading</h3>
<div class="Sidebar">
<p class="SidebarText">In the real world, surfaces that are not illuminated by light sources are illuminated by indirect reflections from other surfaces.</p>
</div>
<p>Surfaces that receive no illumination at all will be rendered as completely black, which is often not desirable. A crude but useful heuristic to avoid black shadows is to add a constant component to the shading model, one whose contribution to the pixel color depends only on the object hit, with no dependence on the surface geometry at all. This is known as ambient shadingit is as if surfaces were illuminated by ambient light that comes equally from everywhere. For <a id="page_84"></a>convenience in tuning the parameters, ambient shading is usually expressed as the product of a surface color with an ambient light color, so that ambient shading can be tuned for surfaces individually or for all surfaces together. Together with the rest of the Blinn-Phong model, ambient shading completes the full version of a simple and useful shading model:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_181&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;1&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(4.3)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_181" overflow="scroll" style="width: 28.178em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.355em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1027.26em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-2045"><span class="mrow" id="MathJax-Span-2046"><span class="mi" id="MathJax-Span-2047" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-2048" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-2049" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2050" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2052" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-2053"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2054" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-2055" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-2056" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-2057" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2058" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2060" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2061" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-2062" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2064" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="mrow" id="MathJax-Span-2065" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-2066" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2067"><span class="mn" id="MathJax-Span-2068" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2069" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2070" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2071" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-2072" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">1</span></span><span class="mo" id="MathJax-Span-2073" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-2074" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-2075" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2076" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2078" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2079" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-2080" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2081" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2082" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="msup" id="MathJax-Span-2083"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.61em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-2084"><span class="mrow" id="MathJax-Span-2085"><span class="mo" id="MathJax-Span-2086" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2087"><span class="mn" id="MathJax-Span-2088" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2089" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2090" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2091" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mtext" id="MathJax-Span-2092" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">h</span></span><span class="mo" id="MathJax-Span-2093" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.704em;"><span class="mi" id="MathJax-Span-2094" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-2095" style="font-family: MathJax_Main;">,</span></span><span class="mtext" id="MathJax-Span-2096" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.3)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_181"><mrow><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>a</mi></msub><mtext>&nbsp;</mtext><msub><mi>I</mi><mi>a</mi></msub><mo>+</mo><msub><mi>k</mi><mi>d</mi></msub><mtext>&nbsp;</mtext><mi>I</mi><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">1</mtext></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext>&nbsp;</mtext><mi>I</mi><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">h</mtext></mrow><mo>)</mo></mrow></mrow><mi>n</mi></msup><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.3)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-36"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_181"><mrow><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>a</mi></msub><mtext></mtext><msub><mi>I</mi><mi>a</mi></msub><mo>+</mo><msub><mi>k</mi><mi>d</mi></msub><mtext></mtext><mi>I</mi><mtext></mtext><mi>max</mi><mo></mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">1</mtext></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext></mtext><mi>I</mi><mtext></mtext><mi>max</mi><mo></mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><mtext mathvariant="bold">h</mtext></mrow><mo>)</mo></mrow></mrow><mi>n</mi></msup><mo>,</mo></mrow><mtext>(4.3)</mtext></math></script></p>
<p>where <span class="cItalic">k<span class="cSubscript">a</span></span> is the surfaces ambient coefficient, or ambient color, and <span class="cItalic">I<span class="cSubscript">a</span></span> is the ambient light intensity.</p>
<div class="Sidebar">
<p class="SidebarText">When in doubt set the ambient color to be the same as the diffuse color.</p>
</div>
<h3><a id="sec4-5-4"></a>4.5.4 Multiple Point Lights</h3>
<p>A very useful property of light is <span class="cItalic">superposition</span>the effect caused by more than one light source is simply the sum of the effects of the light sources individually. For this reason, our simple shading model can easily be extended to handle <span class="cItalic">N</span> light sources:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_182&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;1&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;n&lt;/mtext&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;h&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(4.4)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_182" overflow="scroll" style="width: 31.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.005em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.26em, 1030.91em, 3.499em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-2098"><span class="mi" id="MathJax-Span-2099" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-2100" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-2101" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2102" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2104" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-2105"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2106" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-2107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-2108" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mstyle" id="MathJax-Span-2109" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-2110"><span class="munderover" id="MathJax-Span-2111"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-2112" style="font-family: MathJax_Size2; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.27em, -1000.01em); top: -2.928em; left: 0.157em;"><span class="mrow" id="MathJax-Span-2113"><span class="mi" id="MathJax-Span-2114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2115" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.63em, 4.167em, -1000.01em); top: -5.139em; left: 0.414em;"><span class="mi" id="MathJax-Span-2117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2118" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-2119"><span class="mo" id="MathJax-Span-2120" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mrow" id="MathJax-Span-2121"><span class="msub" id="MathJax-Span-2122"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2123" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2125" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-2126"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2127" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-2128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2129" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2130" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2131" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="mrow" id="MathJax-Span-2132" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2134"><span class="mn" id="MathJax-Span-2135" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2136" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2137" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2138" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-2139" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-2140" style="font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-2141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2142" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-2143" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-2144" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2145" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2147" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-2148"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-2150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2151" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2152" style="font-family: MathJax_Main; padding-left: 0.157em;">max</span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;"></span></span><span class="msup" id="MathJax-Span-2154"><span style="display: inline-block; position: relative; width: 4.424em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.92em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-2155"><span class="mrow" id="MathJax-Span-2156"><span class="mo" id="MathJax-Span-2157" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2158"><span class="mn" id="MathJax-Span-2159" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2160" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2161" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">n</span><span class="mo" id="MathJax-Span-2162" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="msub" id="MathJax-Span-2163" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-2164" style="font-family: MathJax_Main-bold;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-2165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2166" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 4.013em;"><span class="mi" id="MathJax-Span-2167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2168" style=""><span style="font-family: MathJax_Main;">]</span></span></span><span class="mo" id="MathJax-Span-2169" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span></span><span class="mtext" id="MathJax-Span-2170" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.4)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.268em; border-left: 0px solid; width: 0px; height: 3.127em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_182"><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>a</mi></msub><mtext>&nbsp;</mtext><msub><mi>I</mi><mi>a</mi></msub><mo>+</mo><mstyle displaystyle="true"><munderover><mo></mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>[</mo><mrow><msub><mi>k</mi><mi>d</mi></msub><mtext>&nbsp;</mtext><msub><mi>I</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><msub><mtext mathvariant="bold">1</mtext><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext>&nbsp;</mtext><msub><mi>I</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mi>max</mi><mo>&nbsp;</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><msub><mtext mathvariant="bold">h</mtext><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow><mi>p</mi></msup></mrow><mo>]</mo></mrow><mo>,</mo></mrow></mstyle><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.4)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-37"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_182"><mi>L</mi><mo>=</mo><msub><mi>k</mi><mi>a</mi></msub><mtext></mtext><msub><mi>I</mi><mi>a</mi></msub><mo>+</mo><mstyle displaystyle="true"><munderover><mo></mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>[</mo> <mrow><msub><mi>k</mi><mi>d</mi></msub><mtext></mtext><msub><mi>I</mi><mi>i</mi></msub><mtext></mtext><mi>max</mi><mo></mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><msub><mtext mathvariant="bold">1</mtext><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>k</mi><mi>s</mi></msub><mtext></mtext><msub><mi>I</mi><mi>i</mi></msub><mtext></mtext><mi>max</mi><mo></mo><msup><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="bold">n</mtext><mo></mo><msub><mtext mathvariant="bold">h</mtext><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow><mi>p</mi></msup></mrow> <mo>]</mo></mrow><mo>,</mo></mrow></mstyle><mtext>(4.4)</mtext></math></script></p>
<p>where <span class="cItalic">I<span class="cSubscript">i</span></span>, <span class="cBold">l</span><span class="cItalic">i</span>, and <span class="cBold">h</span><span class="cItalic">i</span> are the intensity, direction, and half vector of the <span class="cItalic">i</span><span class="cSuperscript">th</span> light source.</p>
<h2><a id="sec4-6"></a>4.6 A Ray-Tracing Program</h2>
<p>We now know how to generate a viewing ray for a given pixel, how to find the closest intersection with an object, and how to shade the resulting intersection. These are all the parts required for a program that produces shaded images with hidden surfaces removed.</p>
<pre><span class="code"><span class="cBold">for</span> each pixel <span class="cBold">do</span></span></pre>
<pre><span class="code"> compute viewing ray</span></pre>
<pre><span class="code"> <span class="cBold">if</span> (ray hits an object with <span class="cItalic">t</span>  [0,)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> Compute <span class="cBold">n</span></span></pre>
<pre><span class="code"> Evaluate shading model and set pixel to that color</span></pre>
<pre><span class="code"> <span class="cBold">else</span></span></pre>
<pre><span class="code"> set pixel color to background color</span></pre>
<p><a id="page_85"></a>Here the statement if ray hits an object ...  can be implemented using the algorithm of <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#sec4-4-4">Section 4.4.4</a>.</p>
<p>In an actual implementation, the surface intersection routine needs to somehow return either a reference to the object that is hit, or at least its normal vector and shading-relevant material properties. This is often done by passing a record/structure with such information. In an object-oriented implementation, it is a good idea to have a class called something like <span class="cItalic">surface</span> with derived classes <span class="cItalic">triangle, sphere, group</span>, etc. Anything that a ray can intersect would be under that class. The ray-tracing program would then have one reference to a surface for the whole model, and new types of objects and efficiency structures can be added transparently.</p>
<h3><a id="sec4-6-1"></a>4.6.1 Object-Oriented Design for a Ray-Tracing Program</h3>
<p>As mentioned earlier, the key class hierarchy in a ray tracer are the geometric objects that make up the model. These should be subclasses of some geometric object class, and they should support a <span class="cItalic">hit</span> function (Kirk &amp; Arvo, 1988). To avoid confusion from use of the word object, <span class="cItalic">surface</span> is the class name often used. With such a class, you can create a ray tracer that has a general interface that assumes little about modeling primitives and debug it using only spheres. An important point is that anything that can be hit by a ray should be part of this class hierarchy, e.g., even a collection of surfaces should be considered a subclass of the surface class. This includes efficiency structures, such as bounding volume hierarchies; they can be hit by a ray, so they are in the class.</p>
<p>For example, the abstract or base class would specify the hit function as well as a bounding box function that will prove useful later:</p>
<pre><span class="code">class surface</span></pre>
<pre><span class="code"> virtual bool hit(ray <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span>, real <span class="cItalic">t</span><span class="cSubscript">0</span>, real <span class="cItalic">t</span><span class="cSubscript">1</span>, hit-record rec)</span></pre>
<pre><span class="code"> virtual box bounding-box()</span></pre>
<p>Here (<span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>) is the interval on the ray where hits will be returned, and rec is a record that is passed by reference; it contains data such as the <span class="cItalic">t</span> at the intersection when hit returns true. The type box is a 3D bounding box, that is two points that define an axis-aligned box that encloses the surface. For example, for a sphere, the function would be implemented by</p>
<pre><span class="code">box sphere::bounding-box()</span></pre>
<pre><span class="code"> vector3 min = center  vector3(radius,radius,radius)</span></pre>
<pre><span class="code"> vector3 max = center + vector3(radius,radius,radius)</span></pre>
<pre><span class="code"> <span class="cBold">return</span> box(min, max)</span></pre>
<p><a id="page_86"></a>Another class that is useful is material. This allows you to abstract the material behavior and later add materials transparently. A simple way to link objects and materials is to add a pointer to a material in the surface class, although more programmable behavior might be desirable. A big question is what to do with textures; are they part of the material class or do they live outside of the material class? This will be discussed more in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C011.xhtml">Chapter 11</a>.</p>
<h2><a id="sec4-7"></a>4.7 Shadows</h2>
<p>Once you have a basic ray tracing program, shadows can be added very easily. Recall from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#sec4-5">Section 4.5</a> that light comes from some direction <span class="cBold">l</span>. If we imagine ourselves at a point <span class="cBold">p</span> on a surface being shaded, the point is in shadow if we look in direction <span class="cBold">l</span> and see an object. If there are no objects, then the light is not blocked.</p>
<p>This is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-17">Figure 4.17</a>, where the ray <span class="cBold">p</span> + <span class="cItalic">t</span><span class="cBold">l</span> does not hit any objects and is thus not in shadow. The point <span class="cBold">q</span> is in shadow because the ray <span class="cBold">q</span> + <span class="cItalic">t</span><span class="cBold">l</span> does hit an object. The vector l is the same for both points because the light is far away. This assumption will later be relaxed. The rays that determine in or out of shadow are called <span class="cItalic">shadow rays</span> to distinguish them from viewing rays.</p>
<div id="art_Dest_fig_4-17" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-17"></a><span class="cBold">Figure 4.17</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-17.png" alt="Figure showing the point p is not in shadow, while the point q is in shadow." width="400" height="465" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-17.png"></p>
<p class="Text figcaption">The point <span class="cBold">p</span> is not in shadow, while the point <span class="cBold">q</span> is in shadow.</p>
</div>
<p>To get the algorithm for shading, we add an if statement to determine whether the point is in shadow. In a naive implementation, the shadow ray will check for <span class="cItalic">t</span>  [0, ), but because of numerical imprecision, this can result in an intersection with the surface on which <span class="cBold">p</span> lies. Instead, the usual adjustment to avoid that problem is to test for <span class="cItalic">t</span>  [, ) where  is some small positive constant (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-18">Figure 4.18</a>).</p>
<div id="art_Dest_fig_4-18" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-18"></a><span class="cBold">Figure 4.18</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-18.png" alt="Figure showing by testing in the interval starting at , we avoid numerical imprecision causing the ray to hit the surface p is on." width="400" height="366" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-18.png"></p>
<p class="Text figcaption">By testing in the interval starting at , we avoid numerical imprecision causing the ray to hit the surface <span class="cBold">p</span> is on.</p>
</div>
<p>If we implement shadow rays for Phong lighting with Equation 4.3 then we have the following:</p>
<pre><span class="code"><span class="cBold">function</span> raycolor(ray <span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span>, real <span class="cItalic">t</span><span class="cSubscript">0</span>, real <span class="cItalic">t</span><span class="cSubscript">1</span>)</span></pre>
<pre><span class="code">hit-record rec, srec</span></pre>
<pre><span class="code"><span class="cBold">if</span> (scenehit(<span class="cBold">e</span> + <span class="cItalic">t</span><span class="cBold">d</span>, <span class="cItalic">t</span><span class="cSubscript">0</span>, <span class="cItalic">t</span><span class="cSubscript">1</span>, rec)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">p</span> = <span class="cBold">e</span> + (rec.<span class="cItalic">t</span>) <span class="cBold">d</span></span></pre>
<pre><span class="code"> color <span class="cItalic">c</span> = rec.<span class="cItalic">k<span class="cSubscript">a</span> I<span class="cSubscript">a</span></span></span></pre>
<pre><span class="code"> <span class="cBold">if</span> (not scenehit(<span class="cBold">p</span> + <span class="cItalic">s</span><span class="cBold">l</span>, , , srec)) <span class="cBold">then</span></span></pre>
<pre><span class="code"> vector3 <span class="cBold">h</span> = normalized(normalized(<span class="cBold">l</span>) + normalized(<span class="cBold">d</span>))</span></pre>
<pre><span class="code"> <span class="cItalic">c</span> = <span class="cItalic">c</span> + rec.<span class="cItalic">k<span class="cSubscript">d</span> I</span> max (0, rec.<span class="cBold">n</span><span class="cBold">l</span>) + (rec.<span class="cItalic">k<span class="cSubscript">s</span></span>) <span class="cItalic">I</span> (rec.<span class="cBold">n</span><span class="cBold">h</span>)<span class="cSuperscript">rec.<span class="cItalic">p</span></span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span></span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> background-color</span></pre>
<p><a id="page_87"></a>Note that the ambient color is added whether <span class="cBold">p</span> is in shadow or not. If there are multiple light sources, we can send a shadow ray before evaluating the shading model for each light. The code above assumes that <span class="cBold">d</span> and <span class="cBold">l</span> are not necessarily unit vectors. This is crucial for <span class="cBold">d</span>, in particular, if we wish to cleanly add <span class="cItalic">instancing</span> later (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml#sec13-2">Section 13.2</a>).</p>
<h2><a id="sec4-8"></a>4.8 Ideal Specular Reflection</h2>
<p>It is straightforward to add <span class="cItalic">ideal specular</span> reflection, or <span class="cItalic">mirror reflection,</span> to a ray-tracing program. The key observation is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#Text_Anchor_fig_4-19">Figure 4.19</a> where a viewer looking from direction <span class="cBold">e</span> sees what is in direction <span class="cBold">r</span> as seen from the surface. The vector <span class="cBold">r</span> is found using a variant of the Phong lighting reflection Equation (10.6). There are sign changes because the vector <span class="cBold">d</span> points toward the surface in this case, so,</p>
<div id="art_Dest_fig_4-19" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-19"></a><span class="cBold">Figure 4.19</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-19.png" alt="Figure showing when looking into a perfect mirror, the viewer looking in direction d will see whatever the viewer below the surface would see in direction r." width="401" height="360" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-19.png"></p>
<p class="Text figcaption">When looking into a perfect mirror, the viewer looking in direction <span class="cBold">d</span> will see whatever the viewer below the surface would see in direction <span class="cBold">r</span>.</p>
</div>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_183&quot;&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(4.5)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_183" overflow="scroll" style="width: 12.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.034em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1011.94em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-2172"><span class="mstyle" id="MathJax-Span-2173"><span class="mrow" id="MathJax-Span-2174"><span class="mi" id="MathJax-Span-2175" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-2176" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-2177" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-2178"><span class="mi" id="MathJax-Span-2179" style="font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-2180" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mn" id="MathJax-Span-2181" style="font-family: MathJax_Main; padding-left: 0.208em;">2</span><span class="mrow" id="MathJax-Span-2182" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-2183" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2184"><span class="mstyle" id="MathJax-Span-2185"><span class="mrow" id="MathJax-Span-2186"><span class="mi" id="MathJax-Span-2187" style="font-family: MathJax_Main-bold;">d</span></span></span><span class="mo" id="MathJax-Span-2188" style="font-family: MathJax_Main; padding-left: 0.208em;"></span><span class="mstyle" id="MathJax-Span-2189" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-2190"><span class="mi" id="MathJax-Span-2191" style="font-family: MathJax_Main-bold;">n</span></span></span></span><span class="mo" id="MathJax-Span-2192" style="font-family: MathJax_Main;">)</span></span><span class="mstyle" id="MathJax-Span-2193" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-2194"><span class="mi" id="MathJax-Span-2195" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-2196" style="font-family: MathJax_Main;">.</span><span class="mtext" id="MathJax-Span-2197" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.5)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_183"><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo></mo><mn>2</mn><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>.</mo><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4.5)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-38"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_183"><mstyle mathvariant="bold" mathsize="normal"><mi>r</mi></mstyle><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo></mo><mn>2</mn><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>d</mi></mstyle><mo></mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>.</mo><mtext>(4.5)</mtext></math></script></p>
<p>In the real world, some energy is lost when the light reflects from the surface, and this loss can be different for different colors. For example, gold reflects yellow more efficiently than blue, so it shifts the colors of the objects it reflects. This can be implemented by adding a recursive call in <span class="cItalic">raycolor</span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_184&quot;&gt;&lt;mtext&gt;color&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;raycolor&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;&amp;#x3B5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_184" overflow="scroll" style="width: 17.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.969em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1016.88em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-2199"><span class="mtext" id="MathJax-Span-2200" style="font-family: MathJax_Main;">color</span><span class="mtext" id="MathJax-Span-2201" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2202" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-2203" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-2204" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">c</span><span class="mo" id="MathJax-Span-2205" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-2206" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-2207" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-2208" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2209" style="font-family: MathJax_Main;">raycolor</span><span class="mrow" id="MathJax-Span-2210" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-2211" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2212"><span class="mi" id="MathJax-Span-2213" style="font-family: MathJax_Main-bold;">p</span><span class="mo" id="MathJax-Span-2214" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-2215" style="font-family: MathJax_Main-bold; padding-left: 0.208em;">s</span><span class="mi" id="MathJax-Span-2216" style="font-family: MathJax_Main-bold;">r</span><span class="mo" id="MathJax-Span-2217" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2218" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;</span><span class="mi" id="MathJax-Span-2219" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-2220" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2221" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;</span><span class="mi" id="MathJax-Span-2222" style="font-family: MathJax_Main;"></span></span><span class="mo" id="MathJax-Span-2223" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_184"><mtext>color</mtext><mtext>&nbsp;</mtext><mi>c</mi><mo>=</mo><mi>c</mi><mo>+</mo><msub><mi>k</mi><mi>m</mi></msub><mtext>raycolor</mtext><mrow><mo>(</mo><mrow><mi mathvariant="bold">p</mi><mo>+</mo><mi mathvariant="bold">s</mi><mi mathvariant="bold">r</mi><mo>,</mo><mtext>&nbsp;</mtext><mi></mi><mo>,</mo><mtext>&nbsp;</mtext><mi></mi></mrow><mo>)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-39"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_184"><mtext>color</mtext><mtext></mtext><mi>c</mi><mo>=</mo><mi>c</mi><mo>+</mo><msub><mi>k</mi><mi>m</mi></msub><mtext>raycolor</mtext><mrow><mo>(</mo><mrow><mi mathvariant="bold">p</mi><mo>+</mo><mi mathvariant="bold">s</mi><mi mathvariant="bold">r</mi><mo>,</mo><mtext></mtext><mi></mi><mo>,</mo><mtext></mtext><mi></mi></mrow><mo>)</mo></mrow></math></script></p>
<p>where <span class="cItalic">k<span class="cSubscript">m</span></span> (for mirror reflection) is the specular RGB color. We need to make sure we test for <span class="cItalic">s</span>  [, ) for the same reason as we did with shadow rays; we dont want the reflection ray to hit the object that generates it.</p>
<p>The problem with the recursive call above is that it may never terminate. For example, if a ray starts inside a room, it will bounce forever. This can be fixed by adding a maximum recursion depth. The code will be more efficient if a reflection ray is generated only if <span class="cItalic">k<span class="cSubscript">m</span></span> is not zero (black).</p>
<div id="art_Dest_fig_4-20" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_4-20"></a><span class="cBold">Figure 4.20</span></p>
<p class="ObjectLine"><img src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/fig4-20.png" alt="Figure showing a simple scene rendered with diffuse and Blinn-Phong shading, shadows from three light sources, and specular reflection from the floor." width="404" height="398" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig4-20.png"></p>
<p class="Text figcaption">A simple scene rendered with diffuse and Blinn-Phong shading, shadows from three light sources, and specular reflection from the floor.</p>
</div>
<h2><a id="sec4-9"></a>4.9 Historical Notes</h2>
<p>Ray tracing was developed early in the history of computer graphics (Appel, 1968) but was not used much until sufficient compute power was available (Kay &amp; Greenberg, 1979; Whitted, 1980).</p>
<p>Ray tracing has a lower asymptotic time complexity than basic object-order rendering (Snyder &amp; Barr, 1987; Muuss, 1995; S. Parker et al., 1999; Wald, Slusallek, Benthin, &amp; Wagner, 2001). Although it was traditionally thought of <a id="page_88"></a>as an offline method, real-time ray tracing implementations are becoming more and more common.</p>
<h2><a id="sec4-10"></a>Frequently Asked Questions</h2>
<ul>
<li class="LX"><p><span class="cBold">Why is there no perspective matrix in ray tracing?</span></p>
<p>The perspective matrix in a z-buffer exists so that we can turn the perspective projection into a parallel projection. This is not needed in ray tracing, because it is easy to do the perspective projection implicitly by fanning the rays out from the eye.</p></li>
<li class="LX"><p><span class="cBold">Can ray tracing be made interactive?</span></p>
<p>For sufficiently small models and images, any modern PC is sufficiently powerful for ray tracing to be interactive. In practice, multiple CPUs with a shared frame buffer are required for a full-screen implementation. Computer power is increasing much faster than screen resolution, and it is just a matter of time before conventional PCs can ray trace complex scenes at screen resolution.</p></li>
<li class="LX"><p><span class="cBold">Is ray tracing useful in a hardware graphics program?</span></p>
<p>Ray tracing is frequently used for <span class="cItalic">picking</span>. When the user clicks the mouse on a pixel in a 3D graphics program, the program needs to determine which object is visible within that pixel. Ray tracing is an ideal way to determine that.</p></li>
</ul>
<h2><a id="sec4-11"></a>Exercises</h2>
<ol>
<li class="LX">What are the ray parameters of the intersection points between ray (1, 1, 1)+ <span class="cItalic">t</span>(1, 1, 1) and the sphere centered at the origin with radius 1? Note: this is a good debugging case.</li>
<li class="LX">What are the barycentric coordinates and ray parameter where the ray (1, 1, 1) + <span class="cItalic">t</span>(1, 1, 1) hits the triangle with vertices (1, 0, 0), (0, 1, 0), and (0, 0, 1)? Note: this is a good debugging case.</li>
<li class="LX">Do a back of the envelope computation of the approximate time complexity of ray tracing on nice (non-adversarial) models. Split your analysis into the cases of preprocessing and computing the image, so that you can predict the behavior of ray tracing multiple frames for a static model.</li>
</ol>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-1" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 3 Raster Images</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C005.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 5 Linear Algebra</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright"> 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 4 Ray Tracing - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>