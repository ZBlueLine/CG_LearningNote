<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><style type="text/css" title="ibis-book"></style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Script; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_SansSerif-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav  scalefonts subscribe-panel library nav-collapsed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 23 Global Illumination</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C025.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 25 Computer Graphics in Games</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 24</p>
<h1>Reflection Models</h1>
<p><a id="page_627"></a>As we discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml">Chapter 18</a>, the reflective properties of a surface can be summarized using the BRDF (Nicodemus, Richmond, Hsia, Ginsberg, &amp; Limperis, 1977; Cook &amp; Torrance, 1982). In this chapter, we discuss some of the most visually important aspects of material properties and a few fairly simple models that are useful in capturing these properties. There are many BRDF models in use in graphics, and the models presented here are meant to give just an idea of nondiffuse BRDFs.</p>
<h2><a id="sec24-1"></a>24.1 Real-World Materials</h2>
<p>Many real materials have a visible structure at normal viewing distances. For example, most carpets have easily visible pile that contributes to appearance. For our purposes, such structure is not part of the material property but is, instead, part of the geometric model. Structure whose details are invisible at normal viewing distances, but which do determine macroscopic material appearance, are part of the material property. For example, the fibers in paper have a complex appearance under magnification, but they are blurred together into an homogeneous appearance when viewed at arm’s length. This distinction between microstructure that is folded into BRDF is somewhat arbitrary and depends on what one defines as “normal” viewing distance and visual acuity, but the distinction has proven quite useful in practice.</p>
<p>In this section, we define some categories of materials. Later in the chapter, we present reflection models that target each type of material. In the notes at the <a id="page_628"></a>end of the chapter, some models that account for more exotic materials are also discussed.</p>
<h3><a id="sec24-1-1"></a>24.1.1 smooth Dielectrics and Metals</h3>
<p>Dielectrics are clear materials that refract light; their basic properties were summarized in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>. Metals reflect and refract light much like dielectrics, but they absorb light very, very quickly. Thus, only very thin metal sheets are transparent at all, e.g., the thin gold plating on some glass objects. For a smooth material, there are only two important properties:</p>
<ol>
<li class="LX">How much light is reflected at each incident angle and wavelength.</li>
<li class="LX">What fraction of light is absorbed as it travels through the material for a given distance and wavelength.</li>
</ol>
<p>The amount of light transmitted is whatever is not reflected (a result of energy conservation). For a metal, in practice, we can assume all the light is immediately absorbed. For a dielectric, the fraction is determined by the constant used in Beer’s Law as discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C013.xhtml">Chapter 13</a>.</p>
<p>The amount of light reflected is determined by the <span class="cItalic">Fresnel equations</span> as discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>. These equations are straightforward, but cumbersome. The main effect of the Fresnel equations is to increase the reflectance as the incident angle increases, particularly near grazing angles. This effect works for transmitted light as well. These ideas are shown diagrammatically in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-1">Figure 24.1</a>. Note that the light is repeatedly reflected and refracted as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-2">Figure 24.2</a>. Usually only one or two of the reflected images is easily visible.</p>
<div id="art_Dest_fig_24-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-1"></a><span class="cBold">Figure 24.1</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-1.png" alt="Figure showing the amount of light reflected and transmitted by glass varies with the angle." width="409" height="593" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-1.png"></p>
<p class="Text figcaption">The amount of light reflected and transmitted by glass varies with the angle.</p>
</div>
<div id="art_Dest_fig_24-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-2"></a><span class="cBold">Figure 24.2</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-2.png" alt="Figure showing light is repeatedly reflected and refracted by glass, with the fractions of energy shown." width="409" height="236" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-2.png"></p>
<p class="Text figcaption">Light is repeatedly reflected and refracted by glass, with the fractions of energy shown.</p>
</div>
<h3><a id="sec24-1-2"></a>24.1.2 Rough Surfaces</h3>
<p>If a metal or dielectric is roughened to a small degree, but not so small that diffraction occurs, then we can think of it as a surface with <span class="cItalic">microfacets</span> (Cook &amp; Torrance, 1982). Such surfaces behave specularly at a closer distance, but viewed at a further distance seem to spread the light out in a distribution. For a metal, an example of this rough surface might be brushed steel, or the “cloudy” side of most aluminum foil.</p>
<p>For dielectrics, such as a sheet of glass, scratches or other irregular surface features make the glass blur the reflected and transmitted images that we can normally see clearly. If the surface is heavily scratched, we call it <span class="cItalic">translucent</span> rather than transparent. This is a somewhat arbitrary distinction, but it is usually clear whether we would consider a glass translucent or transparent.</p>
<h3><a id="sec24-1-3"></a><a id="page_629"></a>24.1.3 Diffuse Materials</h3>
<p>A material is <span class="cItalic">diffuse</span> if it is matte, i.e., not shiny. Many surfaces we see are diffuse, such as most stones, paper, and unfinished wood. To a first approximation, diffuse surfaces can be approximated with a Lambertian (constant) BRDF. Real diffuse materials usually become somewhat specular for grazing angles. This is a subtle effect, but can be important for realism.</p>
<h3><a id="sec24-1-4"></a>24.1.4 Translucent Materials</h3>
<p>Many thin objects, such as leaves and paper, both transmit and reflect light diffusely. For all practical purposes no clear image is transmitted by these objects. These surfaces can add a hue shift to the transmitted light. For example, red paper is red because it filters out non-red light for light that penetrates a short distance into the paper, and then scatters back out. The paper also transmits light with a red hue because the same mechanisms apply, but the transmitted light makes it all the way through the paper. One implication of this property is that the transmitted coefficient should be the same in both directions.</p>
<h3><a id="sec24-1-5"></a>24.1.5 Layered Materials</h3>
<p>Many surfaces are composed of “layers” or are dielectrics with embedded particles that give the surface a diffuse property (Phong, 1975). The surface of such materials reflects specularly as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-3">Figure 24.3</a>, and thus obeys the Fresnel equations. The light that is transmitted is either absorbed or scattered back up to the dielectric surface where it may or may not be transmitted. That light that is transmitted, scattered, and then retransmitted in the opposite direction forms a diffuse “reflection” component.</p>
<div id="art_Dest_fig_24-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-3"></a><span class="cBold">Figure 24.3</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-3.png" alt="Figure showing light hitting a layered surface can be reflected specularly, or it can be transmitted and then scatter diffusely off the substrate." width="404" height="331" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-3.png"></p>
<p class="Text figcaption">Light hitting a layered surface can be reflected specularly, or it can be transmitted and then scatter diffusely off the substrate.</p>
</div>
<p>Note that the diffuse component also is attenuated with the degree of the angle, because the Fresnel equations cause reflection back into the surface as the angle increases as shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-4">Figure 24.4</a>. Thus, instead of a constant diffuse BRDF, one that vanishes near the grazing angle is more appropriate.</p>
<div id="art_Dest_fig_24-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-4"></a><span class="cBold">Figure 24.4</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-4.png" alt="Figure showing the light scattered by the substrate is less and less likely to make it out of the surface as the angle relative to the surface normal increases." width="404" height="331" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-4.png"></p>
<p class="Text figcaption">The light scattered by the substrate is less and less likely to make it out of the surface as the angle relative to the surface normal increases.</p>
</div>
<h2><a id="sec24-2"></a>24.2 Implementing Reflection Models</h2>
<p>A BRDF model, as described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml#sec18-1-6">Section 18.1.6</a>, will produce a rendering which is more physically based than the rendering we get from point light sources and Phong-like models. Unfortunately, real BRDFs are typically quite complicated and cannot be deduced from first principles. Instead, they must either be measured <a id="page_630"></a>and directly approximated from raw data, or they must be crudely approximated in an empirical fashion. The latter empirical strategy is what is usually done, and the development of such approximate models is still an area of research. This section discusses several desirable properties of such empirical models.</p>
<p>First, physical constraints imply two properties of a BRDF model. The first constraint is energy conservation:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-837-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_854&quot;&gt;&lt;mrow&gt;&lt;mtext&gt;for&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1.&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_854" overflow="scroll" style="width: 21.237em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.62em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1020.52em, 3.293em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43778"><span class="mrow" id="MathJax-Span-43779"><span class="mtext" id="MathJax-Span-43780" style="font-family: MathJax_Main;">for</span><span class="mtext" id="MathJax-Span-43781" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-43782" style="font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-43783" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-43784"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43785"><span class="mrow" id="MathJax-Span-43786"><span class="mi" id="MathJax-Span-43787" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43788" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43789" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-43790" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">R</span><span class="mrow" id="MathJax-Span-43791" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43792" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43793"><span class="msub" id="MathJax-Span-43794"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43795"><span class="mrow" id="MathJax-Span-43796"><span class="mi" id="MathJax-Span-43797" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43799" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43800" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-43801" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-43802"><span class="mrow" id="MathJax-Span-43803"><span class="msub" id="MathJax-Span-43804"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-43805" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-43806"><span class="mtext" id="MathJax-Span-43807" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-43808" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-43809"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43810"><span class="mrow" id="MathJax-Span-43811"><span class="mi" id="MathJax-Span-43812" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-43813" style="font-size: 50%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43814" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-43815" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-43816" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43817" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43818"><span class="msub" id="MathJax-Span-43819"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43820"><span class="mrow" id="MathJax-Span-43821"><span class="mi" id="MathJax-Span-43822" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43823" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43824" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43825" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43826"><span class="mrow" id="MathJax-Span-43827"><span class="mi" id="MathJax-Span-43828" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43829" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43830" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span class="mi" id="MathJax-Span-43831" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-43832" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-43833"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43834" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-43835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-43836" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-43837"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43838" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43839" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43840" style="font-family: MathJax_Main; padding-left: 0.26em;">≤</span><span class="mn" id="MathJax-Span-43841" style="font-family: MathJax_Main; padding-left: 0.26em;">1.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_854"><mrow><mtext>for</mtext><mtext>&nbsp;</mtext><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><mi>R</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>o</mi></msub><mo>≤</mo><mn>1.</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-837"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_854"><mrow><mtext>for</mtext><mtext> </mtext><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><mi>R</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>o</mi></msub><mo>≤</mo><mn>1.</mn></mrow></math></script></p>
<p>If you send a beam of light at a surface from any direction <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>, then the total amount of light reflected over all directions will be at most the incident amount. The second physical property we expect all BRDFs to have is reciprocity:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-838-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_855&quot;&gt;&lt;mrow&gt;&lt;mtext&gt;for&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_855" overflow="scroll" style="width: 15.427em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.964em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1014.87em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43843"><span class="mrow" id="MathJax-Span-43844"><span class="mtext" id="MathJax-Span-43845" style="font-family: MathJax_Main;">for</span><span class="mtext" id="MathJax-Span-43846" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-43847" style="font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-43848" style="font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-43849"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43850"><span class="mrow" id="MathJax-Span-43851"><span class="mi" id="MathJax-Span-43852" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43853" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43854" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43855" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43856"><span class="mrow" id="MathJax-Span-43857"><span class="mi" id="MathJax-Span-43858" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43859" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43860" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-43861" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ρ</span><span class="mrow" id="MathJax-Span-43862" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43863" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43864"><span class="msub" id="MathJax-Span-43865"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43866"><span class="mrow" id="MathJax-Span-43867"><span class="mi" id="MathJax-Span-43868" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43869" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43870" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43871" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43872"><span class="mrow" id="MathJax-Span-43873"><span class="mi" id="MathJax-Span-43874" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43875" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43876" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43877" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-43878" style="font-family: MathJax_Math-italic; padding-left: 0.26em;">ρ</span><span class="mrow" id="MathJax-Span-43879" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43880" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43881"><span class="msub" id="MathJax-Span-43882"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43883"><span class="mrow" id="MathJax-Span-43884"><span class="mi" id="MathJax-Span-43885" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43887" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43888" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43889"><span class="mrow" id="MathJax-Span-43890"><span class="mi" id="MathJax-Span-43891" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43893" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43894" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_855"><mrow><mtext>for</mtext><mtext>&nbsp;</mtext><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>,</mo><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-838"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_855"><mrow><mtext>for</mtext><mtext> </mtext><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>,</mo><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>Second, we want a clear separation between diffuse and specular components. The reason for this is that, although there is a mathematically clean delta function formulation for ideal specular components, delta functions must be implemented as special cases in practice. Such special cases are only practical if the BRDF model clearly indicates what is specular and what is diffuse.</p>
<p>Third, we would like intuitive parameters. For example, one reason the Phong model has enjoyed such longevity is that its diffuse constant and exponent are both clearly related to the intuitive properties of the surface, namely surface color and highlight size.</p>
<p>Finally, we would like the BRDF function to be amenable to Monte Carlo sampling. Recall from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml">Chapter 14</a> that an integral can be sampled by <span class="cItalic">N</span> random points <span class="cItalic">xi</span> ~ <span class="cItalic">p</span> where <span class="cItalic">p</span> is defined with the same measure as the integral:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-839-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_856&quot;&gt;&lt;mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x3BC;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_856" overflow="scroll" style="width: 12.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.725em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.288em, 1011.63em, 4.681em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-43896"><span class="mrow" id="MathJax-Span-43897"><span class="mstyle" id="MathJax-Span-43898"><span class="mrow" id="MathJax-Span-43899"><span class="mrow" id="MathJax-Span-43900"><span class="mo" id="MathJax-Span-43901" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span class="mrow" id="MathJax-Span-43902" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-43903" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-43904" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43905" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-43906" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-43907" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-43908" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-43909" style="font-family: MathJax_Math-italic;">μ</span><span class="mo" id="MathJax-Span-43910" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-43911" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.19em, 1000.42em, 4.167em, -1000.01em); top: -4.676em; left: 50%; margin-left: -0.255em;"><span class="mn" id="MathJax-Span-43912" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.88em, 4.167em, -1000.01em); top: -3.339em; left: 50%; margin-left: -0.46em;"><span class="mi" id="MathJax-Span-43913" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.031em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-43914" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-43915"><span class="munderover" id="MathJax-Span-43916"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-43917" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.424em, -1000.01em); top: -2.928em; left: 0.105em;"><span class="mrow" id="MathJax-Span-43918"><span class="mi" id="MathJax-Span-43919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-43920" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-43921" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.63em, 4.167em, -1000.01em); top: -5.139em; left: 0.414em;"><span class="mi" id="MathJax-Span-43922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43923" style="padding-left: 0.157em;"><span class="mfrac" id="MathJax-Span-43924"><span style="display: inline-block; position: relative; width: 2.522em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.087em, 1002.33em, 4.476em, -1000.01em); top: -4.779em; left: 50%; margin-left: -1.231em;"><span class="mrow" id="MathJax-Span-43925"><span class="mi" id="MathJax-Span-43926" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-43927" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43928" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-43929"><span class="msub" id="MathJax-Span-43930"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43931" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43933" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.27em, 4.476em, -1000.01em); top: -3.288em; left: 50%; margin-left: -1.18em;"><span class="mrow" id="MathJax-Span-43934"><span class="mi" id="MathJax-Span-43935" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-43936" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43937" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-43938"><span class="msub" id="MathJax-Span-43939"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43940" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43941" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43942" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.53em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.522em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43943" style="font-family: MathJax_Main;">.</span></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.286em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_856"><mrow><mstyle displaystyle="true"><mrow><mo>∫</mo><mrow><mi>f</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>μ</mi><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></mstyle></mrow></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-839"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_856"><mrow><mstyle displaystyle="true"><mrow><mo>∫</mo><mrow><mi>f</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>μ</mi><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></mstyle></mrow></mrow></mstyle></mrow></math></script></p>
<p>Recall from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml#sec18-2">Section 18.2</a> that the surface radiance in direction <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span> is given by a transport equation:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-840-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_857&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;i&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_857" overflow="scroll" style="width: 18.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.998em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1017.9em, 3.242em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43945"><span class="mrow" id="MathJax-Span-43946"><span class="msub" id="MathJax-Span-43947"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43948" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43949" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43950" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43951" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43952"><span class="msub" id="MathJax-Span-43953"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43954"><span class="mrow" id="MathJax-Span-43955"><span class="mi" id="MathJax-Span-43956" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43957" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43958" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43959" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-43960" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-43961"><span class="mrow" id="MathJax-Span-43962"><span class="msub" id="MathJax-Span-43963"><span style="display: inline-block; position: relative; width: 2.162em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-43964" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-43965"><span class="mtext" id="MathJax-Span-43966" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-43967" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-43968"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43969"><span class="mrow" id="MathJax-Span-43970"><span class="mi" id="MathJax-Span-43971" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mtext" id="MathJax-Span-43972" style="font-size: 50%; font-family: MathJax_Main;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43973" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-43974" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-43975" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43976" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43977"><span class="msub" id="MathJax-Span-43978"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43979"><span class="mrow" id="MathJax-Span-43980"><span class="mi" id="MathJax-Span-43981" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43982" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43983" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43984" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43985"><span class="mrow" id="MathJax-Span-43986"><span class="mi" id="MathJax-Span-43987" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43989" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span class="msub" id="MathJax-Span-43990" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43991" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43993" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43994" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43995"><span class="msub" id="MathJax-Span-43996"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43997"><span class="mrow" id="MathJax-Span-43998"><span class="mi" id="MathJax-Span-43999" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44000" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44001" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-44002" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-44003" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-44004"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44005" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-44006" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44007" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-44008"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44009" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-44010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44011" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_857"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mtext>i</mtext></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-840"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_857"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mtext>i</mtext></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></script></p>
<p>If we sample directions with pdf <span class="cItalic">p</span>(k<span class="cItalic">i</span>) as discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml">Chapter 23</a>, then we can approximate the surface radiance with samples:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-841-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_858&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_858" overflow="scroll" style="width: 18.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.998em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.208em, 1017.9em, 3.602em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44013"><span class="mrow" id="MathJax-Span-44014"><span class="msub" id="MathJax-Span-44015"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44016" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-44017" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44018" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44019" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44020"><span class="msub" id="MathJax-Span-44021"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44022"><span class="mrow" id="MathJax-Span-44023"><span class="mi" id="MathJax-Span-44024" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44026" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44027" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-44028" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-44029" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.306em;"><span class="mi" id="MathJax-Span-44030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.73em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.774em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-44031" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-44032"><span class="munderover" id="MathJax-Span-44033"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-44034" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.424em, -1000.01em); top: -2.928em; left: 0.105em;"><span class="mrow" id="MathJax-Span-44035"><span class="mi" id="MathJax-Span-44036" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44037" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-44038" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.63em, 4.167em, -1000.01em); top: -5.139em; left: 0.414em;"><span class="mi" id="MathJax-Span-44039" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44040" style="padding-left: 0.157em;"><span class="mfrac" id="MathJax-Span-44041"><span style="display: inline-block; position: relative; width: 10.44em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1010.35em, 4.476em, -1000.01em); top: -4.779em; left: 50%; margin-left: -5.139em;"><span class="mrow" id="MathJax-Span-44042"><span class="mi" id="MathJax-Span-44043" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44044" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44045" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44046"><span class="msub" id="MathJax-Span-44047"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44048"><span class="mrow" id="MathJax-Span-44049"><span class="mi" id="MathJax-Span-44050" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44052" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44053" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44054"><span class="mrow" id="MathJax-Span-44055"><span class="mi" id="MathJax-Span-44056" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44058" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="msub" id="MathJax-Span-44059" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44060" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-44061" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44062" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44063" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44064"><span class="msub" id="MathJax-Span-44065"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44066"><span class="mrow" id="MathJax-Span-44067"><span class="mi" id="MathJax-Span-44068" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44069" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44070" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mi" id="MathJax-Span-44071" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-44072" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-44073"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44074" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-44075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.33em, 4.476em, -1000.01em); top: -3.288em; left: 50%; margin-left: -1.18em;"><span class="mrow" id="MathJax-Span-44076"><span class="mi" id="MathJax-Span-44077" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-44078" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44079" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44080"><span class="msub" id="MathJax-Span-44081"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44082"><span class="mrow" id="MathJax-Span-44083"><span class="mi" id="MathJax-Span-44084" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44085" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44086" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1010.45em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 10.44em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-44087" style="font-family: MathJax_Main;">.</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.286em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_858"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>j</mi></msub></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-841"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_858"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>j</mi></msub></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></mstyle></mrow></math></script></p>
<p><a id="page_631"></a>This approximation will converge for any <span class="cItalic">p</span> that is nonzero where the integrand is nonzero. However, it will only converge well if the integrand is not very large relative to <span class="cItalic">p.</span> Ideally, <span class="cItalic">p</span>(<span class="cBold">k</span>) should be approximately shaped like the integrand <span class="cItalic">ρ</span>(<span class="cBold">k<span class="cSubscript">j</span></span>, <span class="cBold">k</span><span class="cSubscript"><span class="cItalic">o</span></span>)<span class="cItalic">L<span class="cSubscript">f</span></span> (<span class="cBold">k</span><span class="cItalic">j</span>) cos<span class="cItalic">θ<span class="cSubscript">j</span></span>. In practice, <span class="cItalic">L<span class="cSubscript">f</span></span> is complicated, and the best we can accomplish is to have <span class="cItalic">p</span>(<span class="cBold">k</span>) shaped somewhat like <span class="cItalic">ρ</span>(<span class="cBold">k</span>, <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>)<span class="cItalic">L<span class="cSubscript">f</span></span>(<span class="cBold">k</span>) cos <span class="cItalic">θ</span>.</p>
<p>For example, if the BRDF is Lambertian, then it is constant and the “ideal” <span class="cItalic">p</span>(<span class="cBold">k</span>) is proportional to cos <span class="cItalic">θ</span>. Because the integral of <span class="cItalic">p</span> must be one, we can deduce the leading constant:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-842-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_859&quot;&gt;&lt;mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;with&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.&lt;/mn&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_859" overflow="scroll" style="width: 12.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.136em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1012.04em, 3.345em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44089"><span class="mrow" id="MathJax-Span-44090"><span class="mstyle" id="MathJax-Span-44091"><span class="mrow" id="MathJax-Span-44092"><span class="mrow" id="MathJax-Span-44093"><span class="msub" id="MathJax-Span-44094"><span style="display: inline-block; position: relative; width: 5.71em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-44095" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-44096"><span class="mtext" id="MathJax-Span-44097" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-44098" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mstyle" id="MathJax-Span-44099"><span class="mrow" id="MathJax-Span-44100"><span class="mi" id="MathJax-Span-44101" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span class="mtext" id="MathJax-Span-44102" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-44103" style="font-size: 70.7%; font-family: MathJax_Main;">with</span><span class="mtext" id="MathJax-Span-44104" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-44105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44106" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-44107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44108" style="font-size: 70.7%; font-family: MathJax_Main;">/</span><span class="mn" id="MathJax-Span-44109" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44110" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-44111" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-44112" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-44113" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44114" style="font-family: MathJax_Math-italic;">θ</span><span class="mi" id="MathJax-Span-44115" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-44116" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44117" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-44118" style="font-family: MathJax_Main; padding-left: 0.26em;">1.</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.162em; border-left: 0px solid; width: 0px; height: 2.598em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_859"><mrow><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext>&nbsp;</mtext><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mtext>&nbsp;</mtext><mtext>with</mtext><mtext>&nbsp;</mtext><mi>θ</mi><mo>&lt;</mo><mi>π</mi><mo>/</mo><mn>2</mn></mrow></msub><mrow><mi>C</mi><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi><mi>d</mi><mi>σ</mi><mo>=</mo><mn>1.</mn></mrow></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-842"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_859"><mrow><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext> </mtext><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mtext> </mtext><mtext>with</mtext><mtext> </mtext><mi>θ</mi><mo>&lt;</mo><mi>π</mi><mo>/</mo><mn>2</mn></mrow></msub><mrow><mi>C</mi><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi><mi>d</mi><mi>σ</mi><mo>=</mo><mn>1.</mn></mrow></mrow></mstyle></mrow></math></script></p>
<p>This implies that <span class="cItalic">C</span> = 1<span class="cItalic">/π</span>, so we have</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-843-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_860&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_860" overflow="scroll" style="width: 6.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.532em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1006.44em, 2.676em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-44120"><span class="mrow" id="MathJax-Span-44121"><span class="mi" id="MathJax-Span-44122" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-44123" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44124" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-44125"><span class="mrow" id="MathJax-Span-44126"><span class="mi" id="MathJax-Span-44127" style="font-family: MathJax_Main-bold;">k</span></span></span><span class="mo" id="MathJax-Span-44128" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44129" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-44130" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-44131" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-44132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.52em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mi" id="MathJax-Span-44133" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-44134" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44135" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44136" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_860"><mrow><mi>p</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>π</mi></mfrac><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-843"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_860"><mrow><mi>p</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>π</mi></mfrac><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi><mo>.</mo></mrow></math></script></p>
<p>An acceptably efficient implementation will result as long as <span class="cItalic">p</span> doesn’t get too small when the integrand is nonzero. Thus, the constant pdf will also suffice:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-844-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_861&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_861" overflow="scroll" style="width: 4.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.681em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1004.59em, 2.676em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-44138"><span class="mrow" id="MathJax-Span-44139"><span class="mi" id="MathJax-Span-44140" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-44141" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44142" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-44143"><span class="mrow" id="MathJax-Span-44144"><span class="mi" id="MathJax-Span-44145" style="font-family: MathJax_Main-bold;">k</span></span></span><span class="mo" id="MathJax-Span-44146" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44147" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-44148" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-44149" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-44150"><span class="mn" id="MathJax-Span-44151" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-44152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-44153" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_861"><mrow><mi>p</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-844"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_861"><mrow><mi>p</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>This emphasizes that many pdfs may be acceptable for a given BRDF model.</p>
<h2><a id="sec24-3"></a>24.3 Specular Reflection Models</h2>
<p>For a metal, we typically specify the reflectance at normal incidence <span class="cItalic">R</span><span class="cSubscript">0</span><span class="cItalic">(λ).</span> The reflectance should vary according to the Fresnel equations, and a good approximation is given by (Schlick, 1994a)</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-845-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_862&quot;&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_862" overflow="scroll" style="width: 20.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.54em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1019.45em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44155"><span class="mrow" id="MathJax-Span-44156"><span class="mi" id="MathJax-Span-44157" style="font-family: MathJax_Math-italic;">R</span><span class="mrow" id="MathJax-Span-44158" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44159" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44160"><span class="mi" id="MathJax-Span-44161" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44162" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44163" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">λ</span></span><span class="mo" id="MathJax-Span-44164" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44165" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44166" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44167" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-44168" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44169" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44170" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44171" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44172" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44173" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-44174" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-44175" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44176"><span class="mn" id="MathJax-Span-44177" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44178" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44179" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44180" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-44181" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44182" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44183" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44184" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44185" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44186" style="font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-44187" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.1em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44188"><span class="mrow" id="MathJax-Span-44189"><span class="mo" id="MathJax-Span-44190" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44191"><span class="mn" id="MathJax-Span-44192" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44193" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-44194" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-44195" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44196" style="font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-44197" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.195em;"><span class="mn" id="MathJax-Span-44198" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44199" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_862"><mrow><mi>R</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-845"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_862"><mrow><mi>R</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mo>.</mo></mrow></math></script></p>
<p>This approximation allows us to just set the normal reflectance of the metal either from data or by eye.</p>
<p>For a dielectric, the same formula works for reflectance. However, we can set <span class="cItalic">R</span><span class="cSubscript">0</span>(<span class="cItalic">λ</span>) in terms of the refractive index <span class="cItalic">n</span>(<span class="cItalic">λ</span>):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-846-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_863&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_863" overflow="scroll" style="width: 8.794em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.537em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1008.44em, 2.933em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44201"><span class="mrow" id="MathJax-Span-44202"><span class="msub" id="MathJax-Span-44203"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44204" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-44205" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44206" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44207" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44208" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44209" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44210" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msup" id="MathJax-Span-44211" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.27em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1003.66em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44212"><span class="mrow" id="MathJax-Span-44213"><span class="mo" id="MathJax-Span-44214" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-44215"><span class="mfrac" id="MathJax-Span-44216"><span style="display: inline-block; position: relative; width: 2.419em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1002.22em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-44217"><span class="mi" id="MathJax-Span-44218" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-44219"><span class="mo" id="MathJax-Span-44220" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44221" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44222" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44223" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-44224" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.22em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-44225"><span class="mi" id="MathJax-Span-44226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-44227"><span class="mo" id="MathJax-Span-44228" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44230" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44231" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-44232" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.43em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.419em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44233" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 3.859em;"><span class="mn" id="MathJax-Span-44234" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44235" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 2.174em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_863"><mrow><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi>n</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>−</mo><mn>1</mn></mrow><mrow><mi>n</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-846"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_863"><mrow><msub><mi>R</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi>n</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>−</mo><mn>1</mn></mrow><mrow><mi>n</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>.</mo></mrow></math></script></p>
<p>Typically, <span class="cItalic">n</span> does not vary with wavelength, but for applications where dispersion is important, <span class="cItalic">n</span> can vary. The refractive indices that are often useful include water (<span class="cItalic">n</span> = 1.33), glass (<span class="cItalic">n</span> = 1.4 to <span class="cItalic">n</span> = 1.7), and diamond (<span class="cItalic">n</span> = 2.4).</p>
<h2><a id="sec24-4"></a><a id="page_632"></a>24.4 smooth-Layered Model</h2>
<p>Reflection in matte/specular materials, such as plastics or polished woods, is governed by Fresnel equations at the surface and by scattering within the subsurface. An example of this reflection can be seen in the tiles in the renderings in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-5">Figure 24.5</a>. Note that the blurring in the specular reflection is mostly vertical due to the compression of apparent bump spacing in the view direction. This effect causes the vertically streaked reflections seen on lakes on windy days; it can either be modeled using explicit microgeometry and a simple smooth-surface reflection model or by a more general model that accounts for this asymmetry.</p>
<div id="art_Dest_fig_24-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-5"></a><span class="cBold">Figure 24.5</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-5.png" alt="Figure showing renderings of polished tiles using coupled model. These images were produced using a Monte Carlo path tracer. The sampling distribution for the diffuse term is cos θ/π." width="600" height="208" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-5.png"></p>
<p class="Text figcaption">Renderings of polished tiles using coupled model. These images were produced using a Monte Carlo path tracer. The sampling distribution for the diffuse term is cos <span class="cItalic">θ/π</span>.</p>
</div>
<p>We could use the traditional Lambertian-specular model for the tiles, which linearly mixes specular and Lambertian terms. In standard radiometric terms, this can be expressed as</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-847-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_864&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_864" overflow="scroll" style="width: 18.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.1em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1018.06em, 2.625em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44237"><span class="mrow" id="MathJax-Span-44238"><span class="mi" id="MathJax-Span-44239" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44240" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44241" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44242"><span class="mi" id="MathJax-Span-44243" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44244" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44245" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44246" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44247" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44248" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44249" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44250" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44251" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44252" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44253" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44254" style="font-family: MathJax_Math-italic;">λ</span></span><span class="mo" id="MathJax-Span-44255" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44256" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-44257" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.008em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.81em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.923em;"><span class="mrow" id="MathJax-Span-44258"><span class="mi" id="MathJax-Span-44259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-44260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-44261"><span class="mo" id="MathJax-Span-44262" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44264" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-44265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.02em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.008em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-44266" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-44267" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44268" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-44270"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44271" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44273" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44274" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44275"><span class="mi" id="MathJax-Span-44276" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44277" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44278" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44279" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44280" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44281" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44282" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44283" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44284" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44285" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44286" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44287" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44288" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_864"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>R</mi><mi>d</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow></mrow><mi>π</mi></mfrac><mo>+</mo><msub><mi>R</mi><mi>s</mi></msub><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-847"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_864"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>R</mi><mi>d</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow></mrow><mi>π</mi></mfrac><mo>+</mo><msub><mi>R</mi><mi>s</mi></msub><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></script></p>
<p>where <span class="cItalic">Rd(λ)</span> is the hemispherical reflectance of the matte term, <span class="cItalic">R<span class="cSubscript">s</span></span> is the specular reflectance, and <span class="cItalic">ρ<span class="cSubscript">s</span></span> is the normalized specular BRDF (a weighted Dirac delta function on the sphere). This equation is a simplified version of the BRDF where <span class="cItalic">R<span class="cSubscript">s</span></span> is independent of wavelength. The independence of wavelength causes a highlight that is the color of the luminaire, so a polished rather than a metal appearance will be achieved. Ward (G. J. Ward, 1992) suggests to set <span class="cItalic">Rd(λ)</span> + <span class="cItalic">R<span class="cSubscript">s</span></span> ≤ 1 in order to conserve energy. However, such models with constant <span class="cItalic">R<span class="cSubscript">s</span></span> fail to show the increase in specularity for steep viewing angles. This is the key point: in the real world the relative proportions of matte and specular appearance change with the viewing angle.</p>
<p><a id="page_633"></a>One way to simulate the change in the matte appearance is to explicitly dampen <span class="cBold"><span class="cItalic">Rd</span>(<span class="cItalic">λ</span>)</span> as <span class="cBold"><span class="cItalic">R<span class="cSubscript">s</span></span></span> increases (Shirley, 1991):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-848-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_865&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_865" overflow="scroll" style="width: 23.448em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.728em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1022.68em, 2.625em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44290"><span class="mrow" id="MathJax-Span-44291"><span class="mi" id="MathJax-Span-44292" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44293" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44294" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44295"><span class="mi" id="MathJax-Span-44296" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44297" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44298" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44299" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44300" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44301" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44302" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44303" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44304" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44305" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44306" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44307" style="font-family: MathJax_Math-italic;">λ</span></span><span class="mo" id="MathJax-Span-44308" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44309" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44310" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44311" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44313" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44314" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44315" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44316" style="font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-44317" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44318" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44320" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44321" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44322"><span class="mi" id="MathJax-Span-44323" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44324" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44325" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44326" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44327" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44328" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44329" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44330" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44331" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44332" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44333" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44334" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44335" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-44336" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1005em, 4.373em, -1000.01em); top: -4.625em; left: 50%; margin-left: -2.517em;"><span class="mrow" id="MathJax-Span-44337"><span class="mi" id="MathJax-Span-44338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-44339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-44340"><span class="mo" id="MathJax-Span-44341" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44342" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44343" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-44344"><span class="mo" id="MathJax-Span-44345" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-44346"><span class="mn" id="MathJax-Span-44347" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44348" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-44349"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-44351" style="font-size: 50%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44352"><span class="mo" id="MathJax-Span-44353" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44355" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44356" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-44357" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.2em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.195em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-44358" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_865"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mi>R</mi><mi>d</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mi>π</mi></mfrac><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-848"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_865"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mi>R</mi><mi>d</mi><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mi>π</mi></mfrac><mo>,</mo></mrow></math></script></p>
<p>where <span class="cBold"><span class="cItalic">R<span class="cSubscript">f</span></span> (<span class="cItalic">θ</span>)</span> is the Fresnel reflectance for a polish-air interface. The problem with this equation is that it is not reciprocal, as can been seen by exchanging <span class="cBold"><span class="cItalic">θ</span></span> and <span class="cBold"><span class="cItalic">θ'</span>; <span class="cBold"></span></span>this changes the value of the matte damping factor because of the multiplication by (1 — <span class="cItalic">R<span class="cSubscript">f</span></span>(<span class="cItalic">θ</span>)). The specular term, a scaled Dirac delta function, is reciprocal, but this does not make up for the non-reciprocity of the matte term. Although this BRDF works well, its lack of reciprocity can cause some rendering methods to have ill-defined solutions.</p>
<p>We now present a model that produces the matte/specular tradeoff while remaining reciprocal and energy conserving. Because the key feature of the new model is that it couples the matte and specular scaling coefficients, it is called a <span class="cItalic">coupled</span> model (Shirley, Smits, Hu, &amp; Lafortune, 1997).</p>
<p>Surfaces which have a glossy appearance are often a clear dielectric, such as polyurethane or oil, with some subsurface structure. The specular (mirror-like) component of the reflection is caused by the smooth dielectric surface and is independent of the structure below this surface. The magnitude of this specular term is governed by the Fresnel equations.</p>
<p>The light that is not reflected specularly at the surface is transmitted through the surface. There, either it is absorbed by the subsurface, or it is reflected from a pigment or a subsurface and transmitted back through the surface of the polish. This transmitted light forms the matte component of reflection. Since the matte component can only consist of the light that is transmitted, it will naturally decrease in total magnitude for increasing angle.</p>
<p>To avoid choosing between physically plausible models and models with good qualitative behavior over a range of incident angles, note that the Fresnel equations that account for the specular term, <span class="cBold"><span class="cItalic">R<span class="cSubscript">f</span></span>(<span class="cItalic">θ</span>)</span>, are derived directly from the physics of the dielectric-air interface. Therefore, the problem must lie in the matte term. We could use a full-blown simulation of subsurface scattering as implemented, but this technique is both costly and requires detailed knowledge of subsurface structure, which is usually neither known nor easily measurable. Instead, we can modify the matte term to be a simple approximation that captures the important qualitative angular behavior shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-4">Figure 24.4</a>.</p>
<p>Let us assume that the matte term is not Lambertian, but instead is some other function that depends only on <span class="cBold"><span class="cItalic">θ</span>, <span class="cBold"><span class="cItalic">θ'</span></span></span> and <span class="cBold"><span class="cItalic">λ</span></span>: <span class="cBold"><span class="cItalic">ρ<span class="cSubscript">m</span>(θ, θ', λ</span>)</span>. We discard behavior that depends on <span class="cBold"><span class="cItalic">ϕ</span></span> or <span class="cBold"><span class="cItalic">ϕ'</span></span> in the interest of simplicity. We try to keep the formulas reasonably simple because the physics of the matte term is complicated and <a id="page_634"></a>sometimes requires unknown parameters. We expect the matte term to be close to constant, and roughly rotationally symmetric (He et al., 1992).</p>
<p>An obvious candidate for the matte component <span class="cItalic">ρ<span class="cSubscript">m</span>(θ, θ', λ)</span> that will be reciprocal is the <span class="cItalic">separable</span> form <span class="cItalic">kR<span class="cSubscript">m</span>(λ)f(θ)f(θ')</span> for some constant <span class="cItalic">k</span> and matte reflectance parameter <span class="cItalic">R<span class="cSubscript">m</span></span>(<span class="cItalic">λ</span>). We could merge <span class="cItalic">k</span> and <span class="cItalic">R<span class="cSubscript">m</span>(λ)</span> into a single term, but we choose to keep them separated because this makes it more intuitive to set <span class="cItalic">R<span class="cSubscript">m</span></span>(<span class="cItalic">λ</span>) —which must be between 0 and 1 for all wavelengths. Separable BRDFs have been shown to have several computational advantages, thus we use the separable model:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-849-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_866&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_866" overflow="scroll" style="width: 26.172em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.401em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1025.31em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44360"><span class="mrow" id="MathJax-Span-44361"><span class="mi" id="MathJax-Span-44362" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44363" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44364" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44365"><span class="mi" id="MathJax-Span-44366" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44367" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44368" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44369" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44370" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44371" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44372" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44373" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44374" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44375" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44376" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44377" style="font-family: MathJax_Math-italic;">λ</span></span><span class="mo" id="MathJax-Span-44378" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44379" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44380" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44381" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44383" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44384" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44385" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44386" style="font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-44387" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44388" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44390" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44391" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44392"><span class="mi" id="MathJax-Span-44393" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44394" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44395" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44396" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44397" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44398" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44399" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44400" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44401" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44402" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44403" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44404" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44405" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-44406" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">k</span><span class="msub" id="MathJax-Span-44407"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44408" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44410" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44411" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44412" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44413" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-44414" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-44415" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44416" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44417" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44418" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-44419" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-44420" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44421" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="msup" id="MathJax-Span-44422"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44423" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44424" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44425" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44426" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_866"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-849"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_866"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>We know that the matte component can only contain energy not reflected in the surface (specular) component. This means that for <span class="cItalic">R<span class="cSubscript">m</span>(λ)</span> = 1, the incident and reflected energy are the same, which suggests the following constraint on the BRDF for each incident <span class="cItalic">θ</span> and <span class="cItalic">λ</span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-850-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8674_1&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.&lt;/mn&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.1)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8674_1" overflow="scroll" style="width: 25.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.681em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.311em, 1024.59em, 3.19em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44428"><span class="mrow" id="MathJax-Span-44429"><span class="msub" id="MathJax-Span-44430"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44431" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44433" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44434" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44435" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44436" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44437" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-44438" style="font-family: MathJax_Main; padding-left: 0.208em;">2</span><span class="mi" id="MathJax-Span-44439" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-44440" style="font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-44441" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-44442" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44443" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44444" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44445" style="font-family: MathJax_Main;">)</span></span><span class="mstyle" id="MathJax-Span-44446" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-44447"><span class="mrow" id="MathJax-Span-44448"><span class="msubsup" id="MathJax-Span-44449"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-44450" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.73em, 4.476em, -1000.01em); top: -5.087em; left: 1.134em;"><span class="mrow" id="MathJax-Span-44451"><span class="mfrac" id="MathJax-Span-44452"><span style="display: inline-block; position: relative; width: 0.414em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.653em, 1000.27em, 4.167em, -1000.01em); top: -4.368em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-44453" style="font-size: 50%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.22em, 4.167em, -1000.01em); top: -3.699em; left: 50%; margin-left: -0.1em;"><span class="mn" id="MathJax-Span-44454" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.42em, 1.237em, -1000.01em); top: -1.231em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.414em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.167em, -1000.01em); top: -3.134em; left: 0.568em;"><span class="mn" id="MathJax-Span-44455" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44456" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-44457" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-44458" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44459" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="msup" id="MathJax-Span-44460"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44461" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.465em;"><span class="mo" id="MathJax-Span-44462" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44463" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mi" id="MathJax-Span-44464" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-44465" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-44466"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44467" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.465em;"><span class="mo" id="MathJax-Span-44468" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44469" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-44470" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-44471"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44472" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.465em;"><span class="mo" id="MathJax-Span-44473" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44474" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-44475"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44476" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.419em; left: 0.465em;"><span class="mo" id="MathJax-Span-44477" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44478" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mn" id="MathJax-Span-44479" style="font-family: MathJax_Main; padding-left: 0.26em;">1.</span></span></span></span></span></span><span class="mtext" id="MathJax-Span-44480" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.1)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.004em; border-left: 0px solid; width: 0px; height: 2.756em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8674_1"><mrow><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>+</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mstyle displaystyle="true"><mrow><msubsup><mo>∫</mo><mn>0</mn><mrow><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow></msubsup><mrow><mi>f</mi><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup><mi>sin</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup><mo>=</mo><mn>1.</mn></mrow></mrow></mstyle></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.1)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-850"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8674_1"><mrow><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>+</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mstyle displaystyle="true"><mrow><msubsup><mo>∫</mo><mn>0</mn><mrow><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow></msubsup><mrow><mi>f</mi><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup><mi>sin</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup><mi>d</mi><msup><mi>θ</mi><mo>′</mo></msup><mo>=</mo><mn>1.</mn></mrow></mrow></mstyle></mrow><mtext>        (24.1)</mtext></math></script></p>
<p>We can see that <span class="cItalic">f(θ)</span> must be proportional to (1 <span class="cItalic">- Rf(θ)).</span> If we assume that matte components that absorb some energy have the same directional pattern as this ideal, we get a BRDF of the form</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-851-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_868&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_868" overflow="scroll" style="width: 32.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.314em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1031.22em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44482"><span class="mrow" id="MathJax-Span-44483"><span class="mi" id="MathJax-Span-44484" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44485" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44486" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44487"><span class="mi" id="MathJax-Span-44488" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44489" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44490" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44491" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44492" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44493" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44494" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44495" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44496" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44497" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44498" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44499" style="font-family: MathJax_Math-italic;">λ</span></span><span class="mo" id="MathJax-Span-44500" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44501" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44502" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44503" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44505" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44506" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44507" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44508" style="font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-44509" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44510" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44512" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44513" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44514"><span class="mi" id="MathJax-Span-44515" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44516" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44517" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44518" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44519" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44520" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44521" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44522" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44523" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44524" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44525" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44526" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44527" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-44528" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">k</span><span class="msub" id="MathJax-Span-44529"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44530" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44531" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44532" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44533" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44534" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44535" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-44536" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44537" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mrow" id="MathJax-Span-44538"><span class="mn" id="MathJax-Span-44539" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44540" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44541" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44542" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44544" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44545" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44546" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44547" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44548" style=""><span style="font-family: MathJax_Main;">]</span></span></span><span class="mrow" id="MathJax-Span-44549" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44550" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mrow" id="MathJax-Span-44551"><span class="mn" id="MathJax-Span-44552" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44553" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44554" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44555" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44557" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44558" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="msup" id="MathJax-Span-44559"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44560" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44561" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44562" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span class="mo" id="MathJax-Span-44563" style=""><span style="font-family: MathJax_Main;">]</span></span></span><span class="mo" id="MathJax-Span-44564" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.221em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_868"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-851"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_868"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>[</mo> <mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><mrow><mo>[</mo> <mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>f</mi></msub><mrow><mo>(</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>We could now insert the full form of the Fresnel equations to get <span class="cItalic">R<span class="cSubscript">f</span></span>(<span class="cItalic">θ</span>), and then use energy conservation to solve for constraints on <span class="cItalic">k.</span> Instead, we will use the approximation discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#sec24-1-1">Section 24.1.1</a> We find that</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-852-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_869&quot;&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x221D;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_869" overflow="scroll" style="width: 12.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.136em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.905em, 1012.04em, 4.013em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-44566"><span class="mrow" id="MathJax-Span-44567"><span class="mi" id="MathJax-Span-44568" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-44569" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44570" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44571" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44572" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44573" style="font-family: MathJax_Main; padding-left: 0.26em;">∝</span><span class="mrow" id="MathJax-Span-44574" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-44575" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-44576"><span class="mn" id="MathJax-Span-44577" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44578" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-44579" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.1em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44580"><span class="mrow" id="MathJax-Span-44581"><span class="mo" id="MathJax-Span-44582" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44583"><span class="mn" id="MathJax-Span-44584" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44585" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-44586" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-44587" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44588" style="font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-44589" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.195em;"><span class="mn" id="MathJax-Span-44590" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44591" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-44592" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 1.962em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_869"><mrow><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>∝</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-852"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_869"><mrow><mi>f</mi><mrow><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mo>∝</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>Applying Equation (24.1) yields</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-853-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8704_2&quot;&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.2)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8704_2" overflow="scroll" style="width: 10.851em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.543em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1010.45em, 2.882em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44594"><span class="mrow" id="MathJax-Span-44595"><span class="mi" id="MathJax-Span-44596" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-44597" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-44598" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 3.55em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-44599"><span class="mn" id="MathJax-Span-44600" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1003.35em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.694em;"><span class="mrow" id="MathJax-Span-44601"><span class="mn" id="MathJax-Span-44602" style="font-size: 70.7%; font-family: MathJax_Main;">20</span><span class="mi" id="MathJax-Span-44603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-44604"><span class="mo" id="MathJax-Span-44605" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44606"><span class="mn" id="MathJax-Span-44607" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44608" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-44609"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mn" id="MathJax-Span-44611" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44612" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1003.51em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.55em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-44613" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-44614" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.2)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8704_2"><mrow><mi>k</mi><mo>=</mo><mfrac><mrow><mn>21</mn></mrow><mrow><mn>20</mn><mi>π</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.2)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-853"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8704_2"><mrow><mi>k</mi><mo>=</mo><mfrac><mrow><mn>21</mn></mrow><mrow><mn>20</mn><mi>π</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>        (24.2)</mtext></math></script></p>
<p>The full coupled BRDF is then</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-854-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8714_3&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x3BB;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.3)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8714_3" overflow="scroll" style="width: 54.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 52.805em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.905em, 1052.71em, 4.013em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-44616"><span class="mrow" id="MathJax-Span-44617"><span class="mi" id="MathJax-Span-44618" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44619" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44620" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44621"><span class="mi" id="MathJax-Span-44622" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44623" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44624" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44625" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44626" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44627" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44628" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44629" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44630" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44631" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44632" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44633" style="font-family: MathJax_Math-italic;">λ</span></span><span class="mo" id="MathJax-Span-44634" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44635" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-44636" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-44637" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-44638"><span class="msub" id="MathJax-Span-44639"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44640" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-44641" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44642" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msup" id="MathJax-Span-44643" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.1em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44644"><span class="mrow" id="MathJax-Span-44645"><span class="mo" id="MathJax-Span-44646" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44647"><span class="mn" id="MathJax-Span-44648" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44649" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-44650" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-44651" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44652" style="font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-44653" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.195em;"><span class="mn" id="MathJax-Span-44654" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44655" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44656" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44657"><span class="mn" id="MathJax-Span-44658" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44659" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44660" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44661" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mn" id="MathJax-Span-44662" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44663" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44664" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span><span class="msub" id="MathJax-Span-44665" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44666" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44667" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44668" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44669" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44670"><span class="mi" id="MathJax-Span-44671" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-44672" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44673" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span><span class="mo" id="MathJax-Span-44674" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44675" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44676" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44677" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44678" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-44679" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44680" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-44681" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44682" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44683" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-44684" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">k</span><span class="msub" id="MathJax-Span-44685"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44686" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44688" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44689" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44690" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-44691" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-44692" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44693" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-44694"><span class="mn" id="MathJax-Span-44695" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44696" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-44697" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.607em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.1em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44698"><span class="mrow" id="MathJax-Span-44699"><span class="mo" id="MathJax-Span-44700" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44701"><span class="mn" id="MathJax-Span-44702" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44703" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-44704" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-44705" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44706" style="font-family: MathJax_Math-italic;">θ</span></span><span class="mo" id="MathJax-Span-44707" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.195em;"><span class="mn" id="MathJax-Span-44708" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44709" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span><span class="mrow" id="MathJax-Span-44710" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44711" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-44712"><span class="mn" id="MathJax-Span-44713" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44714" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-44715" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.864em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.36em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44716"><span class="mrow" id="MathJax-Span-44717"><span class="mo" id="MathJax-Span-44718" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-44719"><span class="mn" id="MathJax-Span-44720" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44721" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-44722" style="font-family: MathJax_Main; padding-left: 0.208em;">cos</span><span class="mo" id="MathJax-Span-44723" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-44724"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44725" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-44726" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44727" style=""><span style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 5.452em;"><span class="mn" id="MathJax-Span-44728" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44729" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span><span class="mo" id="MathJax-Span-44730" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span class="mtext" id="MathJax-Span-44731" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.3)</span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 1.962em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8714_3"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>]</mo></mrow><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>]</mo></mrow><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.3)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-854"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8714_3"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup><mi>λ</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mo>[</mo> <mrow><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow> <mo>]</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ϕ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow><mo>+</mo><mi>k</mi><msub><mi>R</mi><mi>m</mi></msub><mrow><mo>(</mo><mi>λ</mi><mo>)</mo></mrow><mrow><mo>[</mo> <mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow> <mo>]</mo></mrow><mrow><mo>[</mo> <mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow> <mo>]</mo></mrow><mo>.</mo></mrow><mtext>        (24.3)</mtext></math></script></p>
<p><a id="page_635"></a>The results of running the coupled model is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-5">Figure 24.5</a>. Note that for the high viewpoint, the specular reflection is almost invisible, but it is clearly visible in the low-angle photograph image, where the matte behavior is less obvious.</p>
<p>For reasonable values of refractive indices, <span class="cItalic">R</span><span class="cSubscript">0</span> is limited to approximately the range 0.03 to 0.06 (the value <span class="cItalic">R</span><span class="cSubscript">0</span> = 0.05 was used for <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-5">Figure 24.5</a>). The value of <span class="cItalic">R<span class="cSubscript">s</span></span> in a traditional Phong model is harder to choose, because it typically must be tuned for viewpoint in static images and tuned for a particular camera sequence for animations. Thus, the coupled model is easier to use in a “hands-off” mode.</p>
<h2><a id="sec24-5"></a>24.5 Rough-Layered Model</h2>
<p>The previous model is fine if the surface is smooth. However, if the surface is not ideal, some spread is needed in the specular component. An extension of the coupled model to this case is presented here (Ashikhmin &amp; Shirley, 2000). At a given point on a surface, the BRDF is a function of two directions, one in the direction toward the light and one in the direction toward the viewer. We would like to have a BRDF model that works for “common” surfaces, such as metal and plastic, and has the following characteristics:</p>
<ol>
<li class="LX"><span class="cBold">Plausible</span>. As defined by Lewis (R. R. Lewis, 1994), this refers to the BRDF obeying energy conservation and reciprocity.</li>
<li class="LX"><span class="cBold">Anisotropy</span>. The material should model simple anisotropy, such as seen on brushed metals.</li>
<li class="LX"><span class="cBold">Intuitive parameters</span>. For material, such as plastics, there should be parameters <span class="cItalic">R<span class="cSubscript">d</span></span> for the substrate and <span class="cItalic">R<span class="cSubscript">s</span></span> for the normal specular reflectance as well as two roughness parameters <span class="cItalic">n<span class="cSubscript">u</span></span> and <span class="cItalic">n<span class="cSubscript">v</span></span>.</li>
<li class="LX"><span class="cBold">Fresnel behavior</span>. Specularity should increase as the incident angle decreases.</li>
<li class="LX"><span class="cBold">Non-Lambertian diffuse term</span>. The material should allow for a diffuse term, but the component should be non-Lambertian to assure energy conservation in the presence of Fresnel behavior.</li>
<li class="LX"><span class="cBold">Monte Carlo friendliness</span>. There should be some reasonable probability density function that allows straightforward Monte Carlo sample generation for the BRDF.</li>
</ol>
<p><a id="page_636"></a>A BRDF with these properties is a Fresnel-weighted, Phong-style cosine lobe model that is anisotropic.</p>
<p>We again decompose the BRDF into a specular component and a diffuse component (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-6">Figure 24.6</a>). Accordingly, we write our BRDF as the classical sum of two parts:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-855-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_872&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.4)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_872" overflow="scroll" style="width: 21.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.877em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1020.78em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44733"><span class="mrow" id="MathJax-Span-44734"><span class="mi" id="MathJax-Span-44735" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44736" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44737" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44738"><span class="msub" id="MathJax-Span-44739"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44740"><span class="mrow" id="MathJax-Span-44741"><span class="mi" id="MathJax-Span-44742" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44743" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44744" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44745" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44746"><span class="mrow" id="MathJax-Span-44747"><span class="mi" id="MathJax-Span-44748" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44749" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44750" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44751" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44752" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44753" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-44754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44755" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44756" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44757"><span class="msub" id="MathJax-Span-44758"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44759"><span class="mrow" id="MathJax-Span-44760"><span class="mi" id="MathJax-Span-44761" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44762" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44763" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44764" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44765"><span class="mrow" id="MathJax-Span-44766"><span class="mi" id="MathJax-Span-44767" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44768" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44769" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44770" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-44771" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ρ</span><span class="mi" id="MathJax-Span-44772" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-44773" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44774" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44775"><span class="msub" id="MathJax-Span-44776"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44777"><span class="mrow" id="MathJax-Span-44778"><span class="mi" id="MathJax-Span-44779" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44780" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44781" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44782" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44783"><span class="mrow" id="MathJax-Span-44784"><span class="mi" id="MathJax-Span-44785" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44786" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44787" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44788" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span><span class="mtext" id="MathJax-Span-44789" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.4)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_872"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.4)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-855"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_872"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>          (24.4)</mtext></math></script></p>
<div id="art_Dest_fig_24-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-6"></a><span class="cBold">Figure 24.6</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-6.png" alt="Figure showing geometry of reflection. Note that k1, k2, and h share a plane, which usually does not include n." width="600" height="281" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-6.png"></p>
<p class="Text figcaption">Geometry of reflection. Note that <span class="cBold">k</span><span class="cSubscript">1</span>, <span class="cBold">k</span><span class="cSubscript">2</span>, and <span class="cBold">h</span> share a plane, which usually does not include <span class="cBold">n</span>.</p>
</div>
<p>where the first term accounts for the specular reflection (this will be presented in the next section). While it is possible to use the Lambertian BRDF for the diffuse term <span class="cItalic">ρd</span>(<span class="cBold">k</span><span class="cSubscript">1</span>, <span class="cBold">k</span><span class="cSubscript">2</span>) in our model, we will discuss a better solution in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#sec24-5-2">Section 24.5.2</a> and how to implement the model in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#sec24-5-3">Section 24.5.3</a>. Readers who just want to implement the model should skip to that section.</p>
<h3><a id="sec24-5-1"></a>24.5.1 Anisotropic Specular BRDF</h3>
<p>To model the specular behavior, we use a Phong-style specular lobe but make this lobe anisotropic and incorporate Fresnel behavior while attempting to preserve the simplicity of the initial mode. This BRDF is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-856-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8734_5&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mrow&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.5)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8734_5" overflow="scroll" style="width: 30.286em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.412em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.671em, 1029.32em, 2.933em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44791"><span class="mrow" id="MathJax-Span-44792"><span class="mi" id="MathJax-Span-44793" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-44794" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44795" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44796"><span class="msub" id="MathJax-Span-44797"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44798"><span class="mrow" id="MathJax-Span-44799"><span class="mi" id="MathJax-Span-44800" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44801" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44802" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44803" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44804"><span class="mrow" id="MathJax-Span-44805"><span class="mi" id="MathJax-Span-44806" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44807" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44808" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44809" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-44810" style="padding-left: 0.26em;"><span class="mfrac" id="MathJax-Span-44811"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.242em, 1005.1em, 4.424em, -1000.01em); top: -4.676em; left: 50%; margin-left: -2.568em;"><span class="msqrt" id="MathJax-Span-44812"><span style="display: inline-block; position: relative; width: 5.093em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1004.33em, 4.321em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-44813"><span class="mrow" id="MathJax-Span-44814"><span class="mrow" id="MathJax-Span-44815"><span class="mo" id="MathJax-Span-44816" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44817"><span class="msub" id="MathJax-Span-44818"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44819" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-44820" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44821" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-44822" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-44823" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-44824"><span class="mo" id="MathJax-Span-44825" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44826"><span class="msub" id="MathJax-Span-44827"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-44829" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44830" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-44831" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-44832" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1004.38em, 1.288em, -1000.01em); top: -1.694em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 4.373em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.73em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">√</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-44833"><span class="mn" id="MathJax-Span-44834" style="font-size: 70.7%; font-family: MathJax_Main;">8</span><span class="mi" id="MathJax-Span-44835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.2em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.195em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mfrac" id="MathJax-Span-44836"><span style="display: inline-block; position: relative; width: 9.72em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.139em, 1008.24em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -4.111em;"><span class="mrow" id="MathJax-Span-44837"><span class="mrow" id="MathJax-Span-44838"><span class="mo" id="MathJax-Span-44839" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44840"><span class="mstyle" id="MathJax-Span-44841"><span class="mrow" id="MathJax-Span-44842"><span class="mi" id="MathJax-Span-44843" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-44844" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mstyle" id="MathJax-Span-44845"><span class="mrow" id="MathJax-Span-44846"><span class="mi" id="MathJax-Span-44847" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-44848" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-44849"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44850" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-44851" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-44852"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1001.66em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44853"><span class="mi" id="MathJax-Span-44854" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-44855" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.648em;"><span class="mn" id="MathJax-Span-44856" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-44858" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msub" id="MathJax-Span-44859"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44860" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-44861" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-44862" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">sin</span><span class="mo" id="MathJax-Span-44863" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-44864" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1009.52em, 4.321em, -1000.01em); top: -3.545em; left: 50%; margin-left: -4.779em;"><span class="mrow" id="MathJax-Span-44865"><span class="mrow" id="MathJax-Span-44866"><span class="mo" id="MathJax-Span-44867" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44868"><span class="mstyle" id="MathJax-Span-44869"><span class="mrow" id="MathJax-Span-44870"><span class="mi" id="MathJax-Span-44871" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-44872" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="msub" id="MathJax-Span-44873"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44874"><span class="mrow" id="MathJax-Span-44875"><span class="mi" id="MathJax-Span-44876" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-44877" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44878" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-44879" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">max</span><span class="mo" id="MathJax-Span-44880" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-44881"><span class="mrow" id="MathJax-Span-44882"><span class="mrow" id="MathJax-Span-44883"><span class="mo" id="MathJax-Span-44884" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-44885"><span class="mi" id="MathJax-Span-44886" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-44887" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-44888"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-44890" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44891" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44892" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-44893" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-44894"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44895" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-44896" style="font-size: 50%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44897" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span class="mo" id="MathJax-Span-44898" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1009.73em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.72em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mi" id="MathJax-Span-44899" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mrow" id="MathJax-Span-44900" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44901" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44902"><span class="msub" id="MathJax-Span-44903"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44904"><span class="mrow" id="MathJax-Span-44905"><span class="mi" id="MathJax-Span-44906" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44908" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mtext" id="MathJax-Span-44909" style="font-family: MathJax_Main; padding-left: 0.208em;">h</span></span><span class="mo" id="MathJax-Span-44910" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44911" style="font-family: MathJax_Main; padding-left: 0.157em;">⋅</span></span><span class="mtext" id="MathJax-Span-44912" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.5)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 2.121em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8734_5"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><msqrt><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mrow><mn>8</mn><mi>π</mi></mrow></mfrac></mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi></mrow><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>max</mi><mo>&nbsp;​⁡</mo><mrow><mrow><mrow><mo>(</mo><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mfrac><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow><mo>⋅</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.5)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-856"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8734_5"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><msqrt><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mrow><mn>8</mn><mi>π</mi></mrow></mfrac></mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><mi>sin</mi><mo> ​⁡</mo><mi>ϕ</mi></mrow><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>max</mi><mo> ​⁡</mo><mrow> <mrow><mrow><mo>(</mo><mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow> <mo>)</mo></mrow></mrow></mfrac><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow><mo>⋅</mo></mrow><mtext>        (24.5)</mtext></math></script></p>
<p>Again we use Schlick’s approximation to the Fresnel equation:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-857-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8744_6&quot;&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext&gt;h&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.6)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8744_6" overflow="scroll" style="width: 22.831em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.162em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.031em, 1022.07em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-44914"><span class="mrow" id="MathJax-Span-44915"><span class="mi" id="MathJax-Span-44916" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mrow" id="MathJax-Span-44917" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44918" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44919"><span class="msub" id="MathJax-Span-44920"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44921"><span class="mrow" id="MathJax-Span-44922"><span class="mi" id="MathJax-Span-44923" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44925" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mtext" id="MathJax-Span-44926" style="font-family: MathJax_Main; padding-left: 0.208em;">h</span></span><span class="mo" id="MathJax-Span-44927" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44928" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-44929" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44930" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44932" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mrow" id="MathJax-Span-44933" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-44934" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44935"><span class="mn" id="MathJax-Span-44936" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44937" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44938" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44939" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-44940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44941" style="font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-44942" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.864em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1005.36em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-44943"><span class="mrow" id="MathJax-Span-44944"><span class="mo" id="MathJax-Span-44945" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44946"><span class="mn" id="MathJax-Span-44947" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44948" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mrow" id="MathJax-Span-44949" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-44950" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44951"><span class="msub" id="MathJax-Span-44952"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44953"><span class="mrow" id="MathJax-Span-44954"><span class="mi" id="MathJax-Span-44955" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-44956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44957" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mtext" id="MathJax-Span-44958" style="font-family: MathJax_Main; padding-left: 0.208em;">h</span></span><span class="mo" id="MathJax-Span-44959" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-44960" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 5.452em;"><span class="mn" id="MathJax-Span-44961" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44962" style="font-family: MathJax_Main;">,</span></span><span class="mtext" id="MathJax-Span-44963" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.6)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8744_6"><mrow><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>s</mi></msub><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>s</mi></msub></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.6)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-857"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8744_6"><mrow><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>R</mi><mi>s</mi></msub><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>s</mi></msub></mrow><mo>)</mo></mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mtext>h</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup><mo>,</mo></mrow><mtext>        (24.6)</mtext></math></script></p>
<p>where <span class="cItalic">R<span class="cSubscript">s</span></span> is the material’s reflectance for the normal incidence. Because <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span> · <span class="cBold">h</span> = <span class="cBold">k</span><span class="cSubscript"><span class="cItalic">o</span></span> · <span class="cBold">h</span>, this form is reciprocal. We have an empirical model whose terms are <a id="page_637"></a>chosen to enforce energy conservation and reciprocity. A full rationalization for the terms is given in the paper by Ashikhmin, listed in the chapter notes.</p>
<p>The specular BRDF of Equation (24.5) is useful for representing metallic surfaces where the diffuse component of reflection is very small. <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-7">Figure 24.7</a> shows a set of metal spheres on a texture-mapped Lambertian plane. As the values of parameters <span class="cItalic">n<span class="cSubscript">u</span></span> and <span class="cItalic">n<span class="cSubscript">v</span></span> change, the appearance of the spheres shift from rough metal to almost perfect mirror, and from highly anisotropic to the more familiar Phong-like behavior.</p>
<div id="art_Dest_fig_24-7" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-7"></a><span class="cBold">Figure 24.7</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-7.png" alt="Figure showing metallic spheres for exponents 10, 100, 1000, and 10,000 increasing both left to right and top to bottom." width="600" height="600" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-7.png"></p>
<p class="Text figcaption">Metallic spheres for exponents 10, 100, 1000, and 10,000 increasing both left to right and top to bottom.</p>
</div>
<h3><a id="sec24-5-2"></a>24.5.2 Diffuse Term for the Anisotropic Phong Model</h3>
<p>It is possible to use a Lambertian BRDF together with the anisotropic specular term; this is done for most models, but it does not necessarily conserve energy. A <a id="page_638"></a>better approach is a simple angle-dependent form of the diffuse component which accounts for the fact that the amount of energy available for diffuse scattering varies due to the dependence of the specular term’s total reflectance on the incident angle. In particular, diffuse color of a surface disappears near the grazing angle, because the total specular reflectance is close to one. This well-known effect cannot be reproduced with a Lambertian diffuse term and is therefore missed by most reflection models.</p>
<p>Following a similar approach to the coupled model, we can find a form of the diffuse term that is compatible with the anisotropic Phong lobe:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-858-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8754_7&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;28&lt;/mn&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;23&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.7)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8754_7" overflow="scroll" style="width: 34.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 33.319em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.751em, 1033.22em, 4.424em, -1000.01em); top: -3.339em; left: 0em;"><span class="mrow" id="MathJax-Span-44965"><span class="mrow" id="MathJax-Span-44966"><span class="mi" id="MathJax-Span-44967" style="font-family: MathJax_Math-italic;">ρ</span><span class="mi" id="MathJax-Span-44968" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-44969" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-44970" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44971"><span class="msub" id="MathJax-Span-44972"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44973"><span class="mrow" id="MathJax-Span-44974"><span class="mi" id="MathJax-Span-44975" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44976" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-44977" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-44978" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-44979"><span class="mrow" id="MathJax-Span-44980"><span class="mi" id="MathJax-Span-44981" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-44982" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-44983" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-44984" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-44985" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.751em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.61em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.82em;"><span class="mrow" id="MathJax-Span-44986"><span class="mn" id="MathJax-Span-44987" style="font-size: 70.7%; font-family: MathJax_Main;">28</span><span class="mi" id="MathJax-Span-44988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-44989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.563em;"><span class="mrow" id="MathJax-Span-44990"><span class="mn" id="MathJax-Span-44991" style="font-size: 70.7%; font-family: MathJax_Main;">23</span><span class="mi" id="MathJax-Span-44992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.76em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.751em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-44993"><span class="mo" id="MathJax-Span-44994" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-44995"><span class="mn" id="MathJax-Span-44996" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44997" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-44998" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-44999" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.774em;"><span class="mi" id="MathJax-Span-45000" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45001" style="font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-45002" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45003" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-45004"><span class="mn" id="MathJax-Span-45005" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45006" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-45007" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 5.915em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1005.31em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45008"><span class="mrow" id="MathJax-Span-45009"><span class="mo" id="MathJax-Span-45010" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-45011"><span class="mn" id="MathJax-Span-45012" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45013" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mfrac" id="MathJax-Span-45014" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 2.316em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1002.22em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-45015"><span class="mi" id="MathJax-Span-45016" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45017" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-45018"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45019" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-45020" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-45021" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.33em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.316em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45022" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 5.452em;"><span class="mn" id="MathJax-Span-45023" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45024" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mrow" id="MathJax-Span-45025" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45026" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-45027"><span class="mn" id="MathJax-Span-45028" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45029" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-45030" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.27em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1003.66em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45031"><span class="mrow" id="MathJax-Span-45032"><span class="mo" id="MathJax-Span-45033" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-45034"><span class="mfrac" id="MathJax-Span-45035"><span style="display: inline-block; position: relative; width: 2.419em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1002.27em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-45036"><span class="mi" id="MathJax-Span-45037" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45038" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-45039"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-45041" style="font-size: 50%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-45042" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.43em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.419em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45043" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 3.859em;"><span class="mn" id="MathJax-Span-45044" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45045" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-45046" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span class="mtext" id="MathJax-Span-45047" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.7)</span></span><span style="display: inline-block; width: 0px; height: 3.345em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.004em; border-left: 0px solid; width: 0px; height: 2.598em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8754_7"><mrow><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mn>28</mn><mi>R</mi><mi>d</mi></mrow><mrow><mn>23</mn><mi>π</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>s</mi></msub></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.7)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-858"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8754_7"><mrow><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mn>28</mn><mi>R</mi><mi>d</mi></mrow><mrow><mn>23</mn><mi>π</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>R</mi><mi>s</mi></msub></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mn>5</mn></msup></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>        (24.7)</mtext></math></script></p>
<p>Here <span class="cItalic">Rd</span> is the diffuse reflectance for normal incidence, and <span class="cItalic">R<span class="cSubscript">s</span></span> is the Phong lobe coefficient. An example using this model is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#Text_Anchor_fig_24-8">Figure 24.8</a>.</p>
<div id="art_Dest_fig_24-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_24-8"></a><span class="cBold">Figure 24.8</span></p>
<p class="ObjectLine"><img src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/fig24-8.png" alt="Figure showing three views for nu = nv = 400 and a diffuse substrate. Note the change in intensity of the specular reflection." width="600" height="294" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig24-8.png"></p>
<p class="Text figcaption">Three views for <span class="cItalic">n<span class="cSubscript">u</span> = n<span class="cSubscript">v</span></span> = 400 and a diffuse substrate. Note the change in intensity of the specular reflection.</p>
</div>
<h3><a id="sec24-5-3"></a>24.5.3 Implementing the Model</h3>
<p>Recall that the BRDF is a combination of diffuse and specular components:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-859-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8764_8&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.8)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8764_8" overflow="scroll" style="width: 20.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.363em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1020.27em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-45049"><span class="mrow" id="MathJax-Span-45050"><span class="mi" id="MathJax-Span-45051" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-45052" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45053" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45054"><span class="msub" id="MathJax-Span-45055"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45056"><span class="mrow" id="MathJax-Span-45057"><span class="mi" id="MathJax-Span-45058" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45059" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45060" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-45061" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45062"><span class="mrow" id="MathJax-Span-45063"><span class="mi" id="MathJax-Span-45064" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45065" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45066" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45067" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-45068" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45069" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mi" id="MathJax-Span-45070" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-45071" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45072" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45073"><span class="msub" id="MathJax-Span-45074"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45075"><span class="mrow" id="MathJax-Span-45076"><span class="mi" id="MathJax-Span-45077" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45078" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45079" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-45080" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45081"><span class="mrow" id="MathJax-Span-45082"><span class="mi" id="MathJax-Span-45083" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45084" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45085" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45086" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-45087" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ρ</span><span class="mi" id="MathJax-Span-45088" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-45089" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45090" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45091"><span class="msub" id="MathJax-Span-45092"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45093"><span class="mrow" id="MathJax-Span-45094"><span class="mi" id="MathJax-Span-45095" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45096" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45097" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-45098" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45099"><span class="mrow" id="MathJax-Span-45100"><span class="mi" id="MathJax-Span-45101" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45102" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45103" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45104" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span class="mtext" id="MathJax-Span-45105" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.8)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8764_8"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.8)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-859"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8764_8"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>ρ</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>ρ</mi><mi>d</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>        (24.8)</mtext></math></script></p>
<p>The diffuse component is given in Equation (24.7); the specular component is given in Equation (24.5). It is not necessary to call trigonometric functions to <a id="page_639"></a>compute the exponent, so the specular BRDF can be written:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-860-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8774_9&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mtext&gt;v&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;hn&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.9)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8774_9" overflow="scroll" style="width: 34.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 33.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.311em, 1033.28em, 2.985em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-45107"><span class="mrow" id="MathJax-Span-45108"><span class="mi" id="MathJax-Span-45109" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-45110" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45111" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45112"><span class="msub" id="MathJax-Span-45113"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45114"><span class="mrow" id="MathJax-Span-45115"><span class="mi" id="MathJax-Span-45116" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45117" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45118" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-45119" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45120"><span class="mrow" id="MathJax-Span-45121"><span class="mi" id="MathJax-Span-45122" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mn" id="MathJax-Span-45123" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45124" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45125" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-45126" style="padding-left: 0.26em;"><span class="mfrac" id="MathJax-Span-45127"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.242em, 1005.1em, 4.424em, -1000.01em); top: -4.676em; left: 50%; margin-left: -2.568em;"><span class="mrow" id="MathJax-Span-45128"><span class="msqrt" id="MathJax-Span-45129"><span style="display: inline-block; position: relative; width: 5.093em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1004.33em, 4.321em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-45130"><span class="mrow" id="MathJax-Span-45131"><span class="mo" id="MathJax-Span-45132" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45133"><span class="msub" id="MathJax-Span-45134"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45136" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45137" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45138" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-45139" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-45140"><span class="mo" id="MathJax-Span-45141" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45142"><span class="msub" id="MathJax-Span-45143"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45144" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45145" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45146" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45147" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-45148" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1004.38em, 1.288em, -1000.01em); top: -1.694em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 4.373em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.73em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">√</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-45149"><span class="mn" id="MathJax-Span-45150" style="font-size: 70.7%; font-family: MathJax_Main;">8</span><span class="mi" id="MathJax-Span-45151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.2em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.195em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-45152"><span class="mo" id="MathJax-Span-45153" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45154"><span class="mstyle" id="MathJax-Span-45155"><span class="mrow" id="MathJax-Span-45156"><span class="mi" id="MathJax-Span-45157" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-45158" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mstyle" id="MathJax-Span-45159" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-45160"><span class="mi" id="MathJax-Span-45161" style="font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-45162" style="font-family: MathJax_Main;">)</span></span><span class="mfrac" id="MathJax-Span-45163" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 10.697em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1010.45em, 4.63em, -1000.01em); top: -4.882em; left: 50%; margin-left: -5.293em;"><span class="mrow" id="MathJax-Span-45164"><span class="mrow" id="MathJax-Span-45165"><span class="mo" id="MathJax-Span-45166" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-45167"><span class="msub" id="MathJax-Span-45168"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45170" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45171"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1001.61em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45172"><span class="mrow" id="MathJax-Span-45173"><span class="mo" id="MathJax-Span-45174" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45175"><span class="mstyle" id="MathJax-Span-45176"><span class="mrow" id="MathJax-Span-45177"><span class="mi" id="MathJax-Span-45178" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-45179" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mstyle" id="MathJax-Span-45180"><span class="mrow" id="MathJax-Span-45181"><span class="mi" id="MathJax-Span-45182" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-45183" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.648em;"><span class="mn" id="MathJax-Span-45184" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45185" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msub" id="MathJax-Span-45186"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45188" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45189"><span style="display: inline-block; position: relative; width: 1.853em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1001.5em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45190"><span class="mrow" id="MathJax-Span-45191"><span class="mo" id="MathJax-Span-45192" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45193"><span class="mstyle" id="MathJax-Span-45194"><span class="mrow" id="MathJax-Span-45195"><span class="mi" id="MathJax-Span-45196" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-45197" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mtext" id="MathJax-Span-45198" style="font-size: 70.7%; font-family: MathJax_Main;">v</span></span><span class="mo" id="MathJax-Span-45199" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.596em;"><span class="mn" id="MathJax-Span-45200" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45201" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span><span class="mo" id="MathJax-Span-45202" style="font-size: 70.7%; font-family: MathJax_Main;">/</span><span class="mrow" id="MathJax-Span-45203"><span class="mo" id="MathJax-Span-45204" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-45205"><span class="mn" id="MathJax-Span-45206" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45207" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-45208"><span style="display: inline-block; position: relative; width: 1.751em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1001.4em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45209"><span class="mrow" id="MathJax-Span-45210"><span class="mo" id="MathJax-Span-45211" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45212"><span class="mstyle" id="MathJax-Span-45213"><span class="mrow" id="MathJax-Span-45214"><span class="mi" id="MathJax-Span-45215" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h<span style="font-family: MathJax_Main-bold;">n</span></span></span></span></span><span class="mo" id="MathJax-Span-45216" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.442em;"><span class="mn" id="MathJax-Span-45217" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45218" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1009.27em, 4.321em, -1000.01em); top: -3.545em; left: 50%; margin-left: -4.676em;"><span class="mrow" id="MathJax-Span-45219"><span class="mrow" id="MathJax-Span-45220"><span class="mo" id="MathJax-Span-45221" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45222"><span class="mstyle" id="MathJax-Span-45223"><span class="mrow" id="MathJax-Span-45224"><span class="mi" id="MathJax-Span-45225" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-45226" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="msub" id="MathJax-Span-45227"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45228"><span class="mrow" id="MathJax-Span-45229"><span class="mi" id="MathJax-Span-45230" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45231" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45232" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-45233" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">max</span><span class="mo" id="MathJax-Span-45234" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-45235"><span class="mo" id="MathJax-Span-45236" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-45237"><span class="mi" id="MathJax-Span-45238" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45239" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-45240"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-45242" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45243" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45244" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45245" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-45246"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-45248" style="font-size: 50%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45249" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1010.71em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 10.697em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mi" id="MathJax-Span-45250" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mrow" id="MathJax-Span-45251" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45252" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45253"><span class="msub" id="MathJax-Span-45254"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45255"><span class="mrow" id="MathJax-Span-45256"><span class="mi" id="MathJax-Span-45257" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45259" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mstyle" id="MathJax-Span-45260" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-45261"><span class="mi" id="MathJax-Span-45262" style="font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-45263" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45264" style="font-family: MathJax_Main; padding-left: 0.157em;">⋅</span></span><span class="mtext" id="MathJax-Span-45265" style="font-family: MathJax_Main;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.9)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 2.492em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8774_9"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><mrow><msqrt><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></msqrt></mrow><mrow><mn>8</mn><mi>π</mi></mrow></mfrac></mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mfrac><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><mtext>v</mtext></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>hn</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>max</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mo>⋅</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.9)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-860"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8774_9"><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>1</mn></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><mrow><msqrt><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></msqrt></mrow><mrow><mn>8</mn><mi>π</mi></mrow></mfrac></mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mfrac><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><mtext>v</mtext></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>/</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>hn</mi></mstyle></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow><mrow><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>⋅</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>max</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mi>F</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mo>⋅</mo></mrow><mtext>        (24.9)</mtext></math></script></p>
<p>In a Monte Carlo setting, we are interested in the following proble given <span class="cBold">k</span><span class="cSubscript">1</span>, generate samples of <span class="cBold">k</span><span class="cSubscript">2</span> with a distribution whose shape is similar to the cosine-weighted BRDF. Note that greatly undersampling a large value of the integrand is a serious error, while greatly oversampling a small value is acceptable in practice. The reader can verify that the densities suggested below have this property.</p>
<p>A suitable way to construct a pdf for sampling is to consider the distribution of half vectors that would give rise to our BRDF. Such a function is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-861-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8784_10&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;nh&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.10)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8784_10" overflow="scroll" style="width: 27.612em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.789em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.774em, 1026.69em, 2.676em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-45267"><span class="mrow" id="MathJax-Span-45268"><span class="mi" id="MathJax-Span-45269" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-45270" style="font-family: MathJax_Math-italic;">h</span><span class="mrow" id="MathJax-Span-45271" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45272" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-45273"><span class="mrow" id="MathJax-Span-45274"><span class="mi" id="MathJax-Span-45275" style="font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-45276" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45277" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-45278" style="padding-left: 0.26em;"><span class="mfrac" id="MathJax-Span-45279"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.242em, 1005.1em, 4.424em, -1000.01em); top: -4.676em; left: 50%; margin-left: -2.568em;"><span class="msqrt" id="MathJax-Span-45280"><span style="display: inline-block; position: relative; width: 5.093em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1004.33em, 4.321em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-45281"><span class="mrow" id="MathJax-Span-45282"><span class="mrow" id="MathJax-Span-45283"><span class="mo" id="MathJax-Span-45284" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45285"><span class="msub" id="MathJax-Span-45286"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45288" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45289" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45290" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-45291" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mrow" id="MathJax-Span-45292"><span class="mo" id="MathJax-Span-45293" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45294"><span class="msub" id="MathJax-Span-45295"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45297" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45298" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45299" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-45300" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1004.38em, 1.288em, -1000.01em); top: -1.694em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 4.373em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(3.242em, 1000.73em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">√</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-45301"><span class="mn" id="MathJax-Span-45302" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-45303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1005.2em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.195em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mrow" id="MathJax-Span-45304"><span class="mo" id="MathJax-Span-45305" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45306"><span class="mstyle" id="MathJax-Span-45307"><span class="mrow" id="MathJax-Span-45308"><span class="mi" id="MathJax-Span-45309" style="font-family: MathJax_Main-bold;">n<span style="font-family: MathJax_Main-bold;">h</span></span></span></span></span><span class="mo" id="MathJax-Span-45310" style="font-family: MathJax_Main;">)</span></span></span><span class="msub" id="MathJax-Span-45311" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45312" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45313" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45314"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.22em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45315"><span class="mi" id="MathJax-Span-45316" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45317" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 2.265em;"><span class="mn" id="MathJax-Span-45318" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-45319" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-45320" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-45321" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45322" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45324"><span style="display: inline-block; position: relative; width: 2.573em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.12em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45325"><span class="mi" id="MathJax-Span-45326" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-45327" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 2.162em;"><span class="mn" id="MathJax-Span-45328" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-45329" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-45330" style="font-family: MathJax_Main;">,</span></span><span class="mtext" id="MathJax-Span-45331" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.10)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.803em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8784_10"><mrow><mi>p</mi><mi>h</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><msqrt><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>nh</mi></mstyle></mrow><mo>)</mo></mrow></mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><msup><mrow><mi>sin</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.10)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-861"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8784_10"><mrow><mi>p</mi><mi>h</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>)</mo></mrow><mo>=</mo><mrow><mfrac><msqrt><mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>nh</mi></mstyle></mrow><mo>)</mo></mrow></mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msub><mi>n</mi><mi>v</mi></msub><msup><mrow><mi>sin</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>,</mo></mrow><mtext>        (24.10)</mtext></math></script></p>
<p>where the constants are chosen to ensure it is a valid pdf.</p>
<p>We can just use the probability density function <span class="cItalic">ph</span>(<span class="cBold">h</span>) of Equation (24.10) to generate a random <span class="cBold">h</span>. However, to evaluate the rendering equation, we need both a reflected vector <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span> and a probability density function <span class="cItalic">p</span>(<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>). It is important to note that if you generate <span class="cBold">h</span> according to <span class="cItalic">ph</span> (<span class="cBold">h</span>) and then transform to the resulting <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-862-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8794_11&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.11)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8794_11" overflow="scroll" style="width: 15.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.17em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1015.08em, 2.573em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-45333"><span class="mrow" id="MathJax-Span-45334"><span class="msub" id="MathJax-Span-45335"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45336"><span class="mrow" id="MathJax-Span-45337"><span class="mi" id="MathJax-Span-45338" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45340" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mo" id="MathJax-Span-45341" style="font-family: MathJax_Main; padding-left: 0.26em;">−</span><span class="msub" id="MathJax-Span-45342"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45343"><span class="mrow" id="MathJax-Span-45344"><span class="mi" id="MathJax-Span-45345" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45347" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mn" id="MathJax-Span-45348" style="font-family: MathJax_Main; padding-left: 0.208em;">2</span><span class="mrow" id="MathJax-Span-45349" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45350" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45351"><span class="msub" id="MathJax-Span-45352"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45353"><span class="mrow" id="MathJax-Span-45354"><span class="mi" id="MathJax-Span-45355" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45357" style="font-family: MathJax_Main; padding-left: 0.208em;">⋅</span><span class="mstyle" id="MathJax-Span-45358" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-45359"><span class="mi" id="MathJax-Span-45360" style="font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-45361" style="font-family: MathJax_Main;">)</span></span><span class="mstyle" id="MathJax-Span-45362" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-45363"><span class="mi" id="MathJax-Span-45364" style="font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-45365" style="font-family: MathJax_Main;">,</span></span><span class="mtext" id="MathJax-Span-45366" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.11)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.115em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8794_11"><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>=</mo><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>+</mo><mn>2</mn><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.11)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-862"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8794_11"><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub><mo>=</mo><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>+</mo><mn>2</mn><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>⋅</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>,</mo></mrow><mtext>        (24.11)</mtext></math></script></p>
<p>the density of the resulting <span class="cBold">k</span><span class="cSubscript"><span class="cItalic">o</span> <span class="cSubscript"></span></span>is <span class="cBold">not</span> <span class="cItalic">ph</span>(<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>). This is because of the difference in measures in <span class="cBold">h</span> and <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>. So the actual density <span class="cItalic">p</span>(<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>) is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-863-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_880&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.12)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_880" overflow="scroll" style="width: 12.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.085em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1011.99em, 2.882em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-45368"><span class="mrow" id="MathJax-Span-45369"><span class="mi" id="MathJax-Span-45370" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-45371" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45372" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45373"><span class="msub" id="MathJax-Span-45374"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45375"><span class="mrow" id="MathJax-Span-45376"><span class="mi" id="MathJax-Span-45377" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-45378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45379" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45380" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-45381" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.111em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.71em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.871em;"><span class="mrow" id="MathJax-Span-45382"><span class="mi" id="MathJax-Span-45383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-45384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mrow" id="MathJax-Span-45385"><span class="mo" id="MathJax-Span-45386" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-45387"><span class="mrow" id="MathJax-Span-45388"><span class="mi" id="MathJax-Span-45389" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span><span class="mo" id="MathJax-Span-45390" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.97em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.026em;"><span class="mrow" id="MathJax-Span-45391"><span class="mn" id="MathJax-Span-45392" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mrow" id="MathJax-Span-45393"><span class="mo" id="MathJax-Span-45394" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45395"><span class="msub" id="MathJax-Span-45396"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-45397"><span class="mrow" id="MathJax-Span-45398"><span class="mi" id="MathJax-Span-45399" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45400" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-45401"><span class="mrow" id="MathJax-Span-45402"><span class="mi" id="MathJax-Span-45403" style="font-size: 70.7%; font-family: MathJax_Main-bold;">h</span></span></span></span><span class="mo" id="MathJax-Span-45404" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.12em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.111em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-45405" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-45406" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.12)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 1.909em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_880"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mi>h</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>)</mo></mrow></mrow><mrow><mn>4</mn><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.12)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-863"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_880"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mi>h</mi><mrow><mo>(</mo><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle><mo>)</mo></mrow></mrow><mrow><mn>4</mn><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mstyle mathvariant="bold" mathsize="normal"><mi>h</mi></mstyle></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow><mtext>          (24.12)</mtext></math></script></p>
<p>Note that in an implementation where the BRDF is known to be this model, the estimate of the rendering equation is quite simple as many terms cancel out.</p>
<p>It is possible to generate an <span class="cBold">h</span> vector whose corresponding vector <span class="cBold">k</span><span class="cSubscript"><span class="cItalic">o</span> <span class="cSubscript"></span></span>will point inside the surface, i.e., cos<span class="cItalic">θ<span class="cSubscript">o</span></span> &lt; 0. The weight of such a sample should be set to zero. This situation corresponds to the specular lobe going below the horizon and is the main source of energy loss in the model. Clearly, this problem becomes progressively less severe as <span class="cItalic">n<span class="cSubscript">u</span>, n<span class="cSubscript">v</span></span> become larger.</p>
<p>The only thing left now is to describe how to generate <span class="cBold">h</span> vectors with the pdf of Equation (24.10). We will start by generating <span class="cBold">h</span> with its spherical angles in the range <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-864-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot; id=&quot;ueq_136&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="ueq_136" style="width: 9.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.617em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1009.42em, 2.728em, -1000.01em); top: -2.208em; left: 0em;"><span class="mrow" id="MathJax-Span-45408"><span class="mrow" id="MathJax-Span-45409"><span class="mrow" id="MathJax-Span-45410"><span class="mo" id="MathJax-Span-45411" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45412"><span class="mi" id="MathJax-Span-45413" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-45414" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45415" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">ϕ</span></span><span class="mo" id="MathJax-Span-45416" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-45417" style="font-family: MathJax_Main; padding-left: 0.26em;">∈</span><span class="mrow" id="MathJax-Span-45418" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-45419" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">[</span></span><span class="mrow" id="MathJax-Span-45420"><span class="mn" id="MathJax-Span-45421" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-45422" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-45423" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-45424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-45425" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.52em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45426" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">]</span></span></span><span class="mo" id="MathJax-Span-45427" style="font-family: MathJax_Main; padding-left: 0.208em;">×</span><span class="mrow" id="MathJax-Span-45428" style="padding-left: 0.208em;"><span class="mo" id="MathJax-Span-45429" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">[</span></span><span class="mrow" id="MathJax-Span-45430"><span class="mn" id="MathJax-Span-45431" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-45432" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-45433" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-45434" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-45435" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.52em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.517em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45436" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.213em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_136"><mrow><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi></mrow><mo>)</mo></mrow><mo>∈</mo><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow><mo>]</mo></mrow><mo>×</mo><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow><mo>]</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-864"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline" id="ueq_136"><mrow><mrow><mo>(</mo><mrow><mi>θ</mi><mo>,</mo><mi>ϕ</mi></mrow><mo>)</mo></mrow><mo>∈</mo><mrow><mo>[</mo> <mrow><mn>0</mn><mo>,</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow> <mo>]</mo></mrow><mo>×</mo><mrow><mo>[</mo> <mrow><mn>0</mn><mo>,</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow> <mo>]</mo></mrow></mrow></math></script>. Note that this is only the first quadrant of the hemisphere. Given two random numbers (<span class="cItalic">ξ</span>1, <span class="cItalic">ξ</span>2) uniformly distributed in [0, 1], we can choose</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-865-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8814_13&quot;&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;arctan&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi&gt;tan&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.13)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8814_13" overflow="scroll" style="width: 20.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.694em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.853em, 1019.6em, 4.013em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-45438"><span class="mrow" id="MathJax-Span-45439"><span class="mi" id="MathJax-Span-45440" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-45441" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-45442" style="font-family: MathJax_Main; padding-left: 0.208em;">arctan</span><span class="mo" id="MathJax-Span-45443" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-45444" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45445" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-45446"><span class="msqrt" id="MathJax-Span-45447"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1002.02em, 4.681em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-45448"><span class="mrow" id="MathJax-Span-45449"><span class="mfrac" id="MathJax-Span-45450"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1001.61em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.82em;"><span class="mrow" id="MathJax-Span-45451"><span class="msub" id="MathJax-Span-45452"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45454" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45455" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45456" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.55em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.82em;"><span class="mrow" id="MathJax-Span-45457"><span class="msub" id="MathJax-Span-45458"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45459" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45460" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45461" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45462" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.81em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.802em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1002.07em, 3.961em, -1000.01em); top: -4.882em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 1.339em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.362em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.877em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1001.04em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size2;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-45463" style="font-family: MathJax_Main; padding-left: 0.157em;">tan</span><span class="mo" id="MathJax-Span-45464" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-45465" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-45466" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-45467"><span class="mfrac" id="MathJax-Span-45468"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.04em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-45469"><span class="mi" id="MathJax-Span-45470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-45471"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.311em;"><span class="mn" id="MathJax-Span-45473" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-45474" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.14em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.134em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45475" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span class="mo" id="MathJax-Span-45476" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-45477" style="font-family: MathJax_Main; padding-left: 0.157em;">,</span></span><span class="mtext" id="MathJax-Span-45478" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.13)</span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.739em; border-left: 0px solid; width: 0px; height: 1.962em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8814_13"><mrow><mi>ϕ</mi><mo>−</mo><mi>arctan</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><msqrt><mrow><mfrac><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></msqrt><mi>tan</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mfrac><mrow><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.13)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-865"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8814_13"><mrow><mi>ϕ</mi><mo>−</mo><mi>arctan</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><msqrt><mrow><mfrac><mrow><msub><mi>n</mi><mi>u</mi></msub><mo>+</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></msqrt><mi>tan</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mfrac><mrow><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mrow><mtext>        (24.13)</mtext></math></script></p>
<p><a id="page_640"></a>and then use this value of <span class="cItalic">ϕ</span> to obtain <span class="cItalic">θ</span> according to</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-866-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8824_14&quot;&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(24.14)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8824_14" overflow="scroll" style="width: 22.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.597em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.568em, 1021.5em, 2.522em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-45480"><span class="mrow" id="MathJax-Span-45481"><span class="mi" id="MathJax-Span-45482" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45483" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-45484" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-45485" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msup" id="MathJax-Span-45486" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 12.599em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.25em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45487"><span class="mrow" id="MathJax-Span-45488"><span class="mo" id="MathJax-Span-45489" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-45490"><span class="mn" id="MathJax-Span-45491" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45492" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-45493" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45494" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-45495" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-45496" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.573em; left: 3.345em;"><span class="mrow" id="MathJax-Span-45497"><span class="mn" id="MathJax-Span-45498" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45499" style="font-size: 70.7%; font-family: MathJax_Main;">/</span><span class="mrow" id="MathJax-Span-45500"><span class="mo" id="MathJax-Span-45501" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-45502"><span class="msub" id="MathJax-Span-45503"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-45505" style="font-size: 50%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45506"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1001.66em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45507"><span class="mi" id="MathJax-Span-45508" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-45509" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.648em;"><span class="mn" id="MathJax-Span-45510" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-45511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-45512" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msup" id="MathJax-Span-45513"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-45514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mi" id="MathJax-Span-45515" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-45516"><span style="display: inline-block; position: relative; width: 1.905em; height: 0px;"><span style="position: absolute; clip: rect(3.293em, 1001.61em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-45517"><span class="mi" id="MathJax-Span-45518" style="font-size: 70.7%; font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-45519" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 1.596em;"><span class="mn" id="MathJax-Span-45520" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-45521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-45522" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-45523" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-45524" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-45525" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-45526" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.14)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.803em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8824_14"><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>θ</mi><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow></mrow><mrow><mn>1</mn><mo>/</mo><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msup><mi>n</mi><mi>v</mi></msup><msup><mrow><mi>sin</mi><mo>&nbsp;​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msup><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(24.14)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-866"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8824_14"><mrow><mi>cos</mi><mo> ​⁡</mo><mi>θ</mi><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow></mrow><mrow><mn>1</mn><mo>/</mo><mrow><mo>(</mo><mrow><msub><mi>n</mi><mi>u</mi></msub><msup><mrow><mi>cos</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><msup><mi>n</mi><mi>v</mi></msup><msup><mrow><mi>sin</mi><mo> ​⁡</mo></mrow><mn>2</mn></msup><mi>ϕ</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msup><mo>.</mo></mrow><mtext>        (24.14)</mtext></math></script></p>
<p>To sample the entire hemisphere, we use the standard manipulation where <span class="cItalic">ξ1</span> is mapped to one of four possible functions depending on whether it is in [0,0.25), [0.25,0.5), [0.5,0.75), or [0.75,1.0). For example, for <span class="cItalic">ξ1 ∈</span> [0.25,0.5), find ϕ(1 − 4(0.5 − ξ1)) via Equation (24.13), and then “flip” it about the ϕ = π/2 axis. This ensures full coverage and stratification.</p>
<p>For the diffuse term, use a simpler approach and generate samples according to a cosine distribution. This is sufficiently close to the complete diffuse BRDF to substantially reduce variance of the Monte Carlo estimation.</p>
<h2><a id="sec24-6"></a>Frequently Asked Questions</h2>
<ul>
<li class="LX"><p><span class="cBold">My images look too smooth, even with a complex BRDF. What am I do ing wrong?</span></p>
<p>BRDFs only capture subpixel detail that is too small to be resolved by the eye. Most real surfaces also have some small variations, such as the wrinkles in skin, that can be seen. If you want true realism, some sort of texture or displacement map is needed.</p></li>
<li class="LX"><p><span class="cBold">How do I integrate the BRDF with texture mapping?</span></p>
<p>Texture mapping can be used to control any parameter on a surface. So any kinds of colors or control parameters used by a BRDF should be programmable.</p></li>
<li class="LX"><p><span class="cBold">I have very pretty code except for my material class. What am I doing wrong?</span></p>
<p>You are probably doing nothing wrong. Material classes tend to be the ugly thing in everybody’s programs. If you find a nice way to deal with it, please let me know! My own code uses a shader architecture (Hanrahan &amp; Lawson, 1990) which makes the material include much of the rendering algorithm.</p></li>
</ul>
<h2><a id="sec24-7"></a>Notes</h2>
<p>There are many BRDF models described in the literature, and only a few of them have been described here. Others include (Cook &amp; Torrance, 1982; He <a id="page_641"></a>et al., 1992; G. J. Ward, 1992; Oren &amp; Nayar, 1994; Schlick, 1994a; Lafortune, Foo, Torrance, &amp; Greenberg, 1997; Stam, 1999; Ashikhmin, Premože, &amp; Shirley, 2000; Ershov, Kolchin, &amp; Myszkowski, 2001; Matusik, Pfister, Brand, &amp; McMillan, 2003; Lawrence, Rusinkiewicz, &amp; Ramamoorthi, 2004; Stark, Arvo, &amp; Smits, 2005). The desired characteristics of BRDF models is discussed in <span class="cItalic">Making Shaders More Physically Plausible</span> (R. R. Lewis, 1994).</p>
<h2><a id="sec24-8"></a>Exercises</h2>
<ol>
<li class="LX">Suppose that instead of the Lambertian BRDF we used a BRDF of the form <span class="cItalic">C</span> cos<span class="cSuperscript"><span class="cItalic">a</span></span> θ<span class="cSubscript"><span class="cItalic">i</span></span>. What must <span class="cItalic">C</span> be to conserve energy?</li>
<li class="LX">The BRDF in Exercise 1 is not reciprocal. Can you modify it to be reciprocal?</li>
<li class="LX">Something like a highway sign is a <span class="cItalic">retroreflector.</span> This means that the BRDF is large when <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span> and <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span> are near each other. Make a model inspired by the Phong model that captures retroreflection behavior while being reciprocal and conserving energy.</li>
</ol>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-21" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 23 Global Illumination</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C025.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 25 Computer Graphics in Games</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 24 Reflection Models - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_SansSerif-italic, sans-serif;"></div></div></body></html>