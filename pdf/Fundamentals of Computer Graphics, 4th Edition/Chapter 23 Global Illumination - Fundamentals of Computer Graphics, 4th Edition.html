<!DOCTYPE html>
<!-- saved from url=(0098)https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4127660" data-user-uuid="b28f9685-65fa-4f95-827a-bc87c37860af" data-username="chenshangwen" data-account-type="Trial" data-activated-trial-date="01/21/2019" data-archive="9781482229417" data-publishers="A K Peters/CRC Press" data-htmlfile-name="K22616_C003.xhtml" data-epub-title="Fundamentals of Computer Graphics, 4th Edition" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781482229417"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js.download"></script><script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/1732687426968531" async=""></script><script async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/bat.js.download"></script><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/f.txt"></script><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/linkid.js.download"></script><script async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/gtm.js.download"></script><script async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/css" rel="stylesheet" type="text/css"><title>Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition</title><link rel="stylesheet" href="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/1282215c62d0.css" type="text/css"><link rel="stylesheet" type="text/css" href="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/font-awesome.min.css"><style type="text/css" title="ibis-book">@font-face{font-family:"Helvetica LT Std Black";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Blk.otf)}@font-face{font-family:"Helvetica LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/HelveticaLTStd-Bold.otf)}@font-face{font-family:"Helvetica LT Std Bold Oblique";font-style:italic;font-weight:bold;src:url(../font/HelveticaLTStd-BoldObl.otf)}@font-face{font-family:"Helvetica LT Std Oblique";font-style:italic;font-weight:normal;src:url(../font/HelveticaLTStd-Obl.otf)}@font-face{font-family:"Helvetica LT Std";font-style:normal;font-weight:normal;src:url(../font/HelveticaLTStd-Roman.otf)}@font-face{font-family:"Myriad Pro";font-style:normal;font-weight:normal;src:url(../font/MyriadPro-Regular.otf)}@font-face{font-family:"STIX General";font-style:normal;font-weight:normal;src:url(../font/STIXGeneral.otf)}@font-face{font-family:"STIX General Bold";font-style:normal;font-weight:bold;src:url(../font/STIXGeneralBol.otf)}@font-face{font-family:"STIX General Bold Italic";font-style:italic;font-weight:bold;src:url(../font/STIXGeneralBolIta.otf)}@font-face{font-family:"STIX General Italic";font-style:italic;font-weight:normal;src:url(../font/STIXGeneralItalic.otf)}@font-face{font-family:"Times LT Std Bold";font-style:normal;font-weight:bold;src:url(../font/TimesLTStd-Bold.otf)}@font-face{font-family:"Times LT Std Bold Italic";font-style:italic;font-weight:bold;src:url(../font/TimesLTStd-BoldItalic.otf)}@font-face{font-family:"Times LT Std Italic";font-style:italic;font-weight:normal;src:url(../font/TimesLTStd-Italic.otf)}@font-face{font-family:"Times LT Std";font-style:normal;font-weight:normal;src:url(../font/TimesLTStd-Roman.otf)}#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content p,#sbo-rt-content .figcaption{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:auto;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.25em;margin-bottom:0;margin-left:2px;margin-right:2px;margin-top:0;orphans:2;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:2;word-spacing:normal}#sbo-rt-content blockquote,#sbo-rt-content q{-epub-hyphens:auto;background-color:inherit;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Adobe Caslon Pro",san-serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:0;margin-left:5%;margin-right:5%;margin-top:.75em;orphans:4;overflow:scroll;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:avoid;text-align:justify;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:4;word-spacing:normal}#sbo-rt-content pre{-epub-hyphens:none;background-color:Azure;border:none;border-width:0;break-after:auto;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.75em;margin-left:2px;margin-right:2px;margin-top:.75em;orphans:6;overflow:scroll;padding-bottom:.25em;padding-left:.25em;padding-right:.25em;padding-top:.45em;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p.h1Number,#sbo-rt-content .h1Author,#sbo-rt-content .h2Author,#sbo-rt-content .h3Author,#sbo-rt-content .h4Author,#sbo-rt-content .h5Author,#sbo-rt-content .h6Author,#sbo-rt-content .h1sub{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:DarkGreen;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:bold;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.1em;margin-left:2px;margin-right:2px;margin-top:1em;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-break:keep-all;word-spacing:normal}#sbo-rt-content h1{font-size:2em;margin-top:.5em}#sbo-rt-content p.h1sub{font-size:1.75em;font-style:italic}#sbo-rt-content h2{font-size:1.8em}#sbo-rt-content h3{font-size:1.5em}#sbo-rt-content h4{font-size:1.2em}#sbo-rt-content h5{font-size:1em}#sbo-rt-content h6{font-size:1em;font-style:italic}#sbo-rt-content .h1Author{color:black;font-size:1.75em;font-weight:normal;font-style:italic}#sbo-rt-content .h2Author{color:black;font-size:1.4em;font-weight:normal;font-style:italic}#sbo-rt-content .h3Author{color:black;font-size:1.2em;font-weight:normal;font-style:italic}#sbo-rt-content .h4Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h5Author{color:black;font-size:1em;font-weight:normal;font-style:italic}#sbo-rt-content .h6Author{color:black;font-size:.8em;font-weight:normal;font-style:normal}#sbo-rt-content .h1Affiliation,#sbo-rt-content .h2Affiliation,#sbo-rt-content .h3Affiliation,#sbo-rt-content .h4Affiliation,#sbo-rt-content .h5Affiliation,#sbo-rt-content .h6Affiliation{-epub-hyphens:none;background-color:inherit;border:none;border-width:0;break-after:avoid;break-before:auto;break-inside:avoid;color:black;display:block;float:none;font-family:"Times LT Std","STIX General","Adobe Caslon Pro",serif;font-size:1em;font-style:normal;font-weight:normal;font-size-adjust:none;font-stretch:normal;hanging-punctuation:none;letter-spacing:0;line-height:1.2em;margin-bottom:.5em;margin-left:2px;margin-right:2px;margin-top:0;orphans:6;overflow:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:avoid;page-break-before:auto;page-break-inside:avoid;text-align:left;text-align-last:left;text-decoration:none;text-shadow:none;text-indent:0;text-justify:inter-word;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .h1Affiliation{color:black;font-size:1.55em}#sbo-rt-content .h2Affiliation{color:black;font-size:1.2em}#sbo-rt-content .h3Affiliation{color:black;font-size:1em}#sbo-rt-content .h4Affiliation{color:black;font-size:.9em}#sbo-rt-content .h5Affiliation{color:black;font-size:.8em}#sbo-rt-content .h6Affiliation{color:black;font-size:.8em}#sbo-rt-content .textAuthor{font-weight:bold;text-align:right}#sbo-rt-content .textAffiliation{font-style:italic;text-align:right;margin-bottom:.5em}#sbo-rt-content Allitross{font-family:monospace;font-size:4em;color:red;background-color:yellow;line-height:8em}#sbo-rt-content q{font-style:italic}#sbo-rt-content p{margin-top:1.2em;text-indent:.75em}#sbo-rt-content table{border-collapse:collapse;margin-bottom:.25em;margin-top:.25em}#sbo-rt-content thead{background-color:#0C6}#sbo-rt-content tr{background-color:inherit;border-bottom:thin dotted lightgrey;border-top:thin dotted lightgrey}#sbo-rt-content td{padding:2px 4px 2px 4px}#sbo-rt-content thead>tr{border:none}#sbo-rt-content thead>tr:last-child{border-bottom:thin solid DarkGreen}#sbo-rt-content img{height:auto;width:75%}#sbo-rt-content div.ArtGroup{border-bottom:thin solid DarkGreen;border-top:thin solid DarkGreen;break-inside:avoid;margin-bottom:.25em;margin-top:.25em;overflow:scroll;page-break-inside:avoid;width:100%}#sbo-rt-content div.Table{overflow:scroll;width:100%}#sbo-rt-content div.Box{border:black solid 2px;margin-bottom:2%;margin-left:3%;margin-right:3%;margin-top:2%;padding-bottom:1%;padding-left:3%;padding-right:3%;padding-top:1%;page-break-inside:avoid}#sbo-rt-content div.Shaded{background-color:silver}#sbo-rt-content .footer{page-break-inside:auto;text-align:center;text-align-last:center;text-decoration:none;text-shadow:none;text-indent:0;text-justify:distribute;text-transform:none;vertical-align:baseline;white-space:normal;widows:6;word-spacing:normal}#sbo-rt-content .Example{font-family:"Helvetica LT Std",sans-serif;margin-left:3%;margin-right:3%;margin-top:1em}#sbo-rt-content h1.Example,#sbo-rt-content h1.Extract,#sbo-rt-content h1.Vignette,#sbo-rt-content h1.Math,#sbo-rt-content h1.Problems,#sbo-rt-content h1.GC1,#sbo-rt-content h1.GC2,#sbo-rt-content h1.GC3,#sbo-rt-content h1.GC4{font-size:1.8em}#sbo-rt-content h2.Example,#sbo-rt-content h2.Extract,#sbo-rt-content h2.Vignette,#sbo-rt-content h2.Math,#sbo-rt-content h2.Problems,#sbo-rt-content h2.GC1,#sbo-rt-content h2.GC2,#sbo-rt-content h2.GC3,#sbo-rt-content h2.GC4{font-size:1.5em}#sbo-rt-content h3.Example,#sbo-rt-content h3.Extract,#sbo-rt-content h3.Vignette,#sbo-rt-content h3.Math,#sbo-rt-content h3.Problems,#sbo-rt-content h3.GC1,#sbo-rt-content h3.GC2,#sbo-rt-content h3.GC3,#sbo-rt-content h3.GC4{font-size:1.2em}#sbo-rt-content h4.Example,#sbo-rt-content h4.Extract,#sbo-rt-content h4.Vignette,#sbo-rt-content h4.Math,#sbo-rt-content h4.Problems,#sbo-rt-content h4.GC1,#sbo-rt-content h4.GC2,#sbo-rt-content h4.GC3,#sbo-rt-content h4.GC4{font-size:1em}#sbo-rt-content .Table{background-color:transparent;font-family:"Helvetica LT Std",sans-serif;font-size:85%}#sbo-rt-content .Extract{font-family:"Helvetica LT Std",sans-serif;font-size:88%;line-height:1em;margin-left:2%;margin-right:2%;margin-top:1em}#sbo-rt-content .Vignette{margin-right:2%;margin-left:2%}#sbo-rt-content .GC1{background-color:powderblue}#sbo-rt-content .GC2{background-color:oldlace}#sbo-rt-content .GC3{background-color:lightgrey}#sbo-rt-content .GC4{background-color:lightblue}#sbo-rt-content .Sidebar{font-size:75%}#sbo-rt-content .BookTitle{-epub-hyphens:none;font-size:2.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookSubTitle{-epub-hyphens:none;font-size:2em;font-style:italic;font-weight:bold;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookAuthor{-epub-hyphens:none;font-size:1.5em;font-weight:bold;margin-left:10%;margin-right:10%;margin-top:10%;text-align:center}#sbo-rt-content .BookAuthorAffiliation{-epub-hyphens:none;font-size:1em;font-style:italic;margin-left:10%;margin-right:10%;text-align:center}#sbo-rt-content .BookLogo{margin-top:1em;text-align:center;page-break-after:always}#sbo-rt-content .CIP1{font-family:"Helvetica LT Std",sans-serif;font-size:75%}#sbo-rt-content .CIP2{font-family:"Helvetica LT Std",sans-serif;font-size:75%;margin-top:.75em}#sbo-rt-content .Speaker{margin-top:.75em}#sbo-rt-content .Equation{line-height:3em;text-align:center}#sbo-rt-content .fignumber{display:inline;background-color:darkgreen;color:white;margin:.5em;padding-bottom:.25em;padding-left:.5em;padding-right:.5em;padding-top:.35em;break-after:avoid;font-size:1em;font-weight:bold;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figcaption{break-after:avoid;break-before:avoid;font-size:.85em;margin-left:4px;margin-right:4px;page-break-after:avoid;page-break-before:avoid}#sbo-rt-content .figsource{break-before:avoid;font-size:.85em;font-style:italic;margin-left:4px;margin-right:4px;page-break-before:avoid}#sbo-rt-content .ObjectLine{margin-bottom:6px;margin-top:6px;text-align:center}#sbo-rt-content .footnote{font-size:80%;margin-left:1%;margin-right:2%;text-indent:0}#sbo-rt-content .GlossTerm{font-weight:bold;margin-left:1em;margin-top:.5em}#sbo-rt-content .GlossDef{margin-left:1em}#sbo-rt-content .Float{float:right}#sbo-rt-content .Left{float:left}#sbo-rt-content .NoteHead{font-weight:bold}#sbo-rt-content .RF{margin-left:.5em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF1{margin-left:.75em;margin-top:.3em;text-indent:0}#sbo-rt-content .RF2{margin-left:1.25em;margin-top:.3em;text-indent:0}#sbo-rt-content h1+p,#sbo-rt-content h2+p,#sbo-rt-content h3+p,#sbo-rt-content h4+p,#sbo-rt-content h5+p,#sbo-rt-content h6+p,#sbo-rt-content p.Number+p,#sbo-rt-content td>p:first-child{margin-top:0;text-indent:0}#sbo-rt-content .Equation+p{text-indent:0}#sbo-rt-content h1+h1,#sbo-rt-content h1+h3,#sbo-rt-content h1+h4,#sbo-rt-content h1+h5,#sbo-rt-content h1+h6,#sbo-rt-content h2+h2,#sbo-rt-content h2+h4,#sbo-rt-content h2+h5,#sbo-rt-content h2+h6,#sbo-rt-content h3+h3,#sbo-rt-content h3+h5,#sbo-rt-content h3+h6,#sbo-rt-content h4+h4,#sbo-rt-content h4+h6,#sbo-rt-content h5+h5,#sbo-rt-content h6+h6,#sbo-rt-content p.h1sub+p.h1sub,#sbo-rt-content p.Number+p.Number{background-color:Yellow;color:Red;line-height:8em;margin-top:0}#sbo-rt-content h1+p.h1sub,#sbo-rt-content h1+h2,#sbo-rt-content p.h1sub+h2,#sbo-rt-content h2+h3,#sbo-rt-content h3+h4,#sbo-rt-content h4+h5,#sbo-rt-content h5+h6,#sbo-rt-content p+p,#sbo-rt-content blockquote.textAuthor+blockquote.textAffiliation,#sbo-rt-content p.Speaker+p.Speaker{margin-top:0}#sbo-rt-content h1+p.h1Author,#sbo-rt-content h2+p.h2Author,#sbo-rt-content h3+p.h3Author,#sbo-rt-content h4+p.h4Author,#sbo-rt-content h5+p.h5Author,#sbo-rt-content h6+p.h6Author{margin-top:0}#sbo-rt-content p.h1Author+p.h1Affiliation,#sbo-rt-content p.h2Author+p.h2Affiliation,#sbo-rt-content p.h3Author+p.h3Affiliation,#sbo-rt-content p.h4Author+p.h4Affiliation,#sbo-rt-content p.h5Author+p.h5Affiliation,#sbo-rt-content p.h6Author+p.h6Affiliation{color:grey;margin-top:0}#sbo-rt-content p.h1Affiliation+p,#sbo-rt-content p.h2Affiliation+p,#sbo-rt-content p.h3Affiliation+p,#sbo-rt-content p.h4Affiliation+p,#sbo-rt-content p.h5Affiliation+p,#sbo-rt-content p.h6Affiliation+p{margin-top:0;text-indent:0}#sbo-rt-content .Extract+.Extract,#sbo-rt-content .Example+.Example{margin-top:0}#sbo-rt-content .Extract+.Dictionary,#sbo-rt-content .Extract+.Example,#sbo-rt-content .Extract+.GC1,#sbo-rt-content .Extract+.GC2,#sbo-rt-content .Extract+.GC3,#sbo-rt-content .Extract+.GC4,#sbo-rt-content .Extract+.Text,#sbo-rt-content .Extract+.Math,#sbo-rt-content .Extract+.Problem,#sbo-rt-content .Dictionary+.Extract,#sbo-rt-content .Example+.Extract,#sbo-rt-content .GC1+.Extract,#sbo-rt-content .GC2+.Extract,#sbo-rt-content .GC3+.Extract,#sbo-rt-content .GC4+.Extract,#sbo-rt-content .Text+.Extract,#sbo-rt-content .Math+.Extract,#sbo-rt-content .Problem+.Extract{margin-top:1em;text-indent:0}#sbo-rt-content .Example+.Dictionary,#sbo-rt-content .Example+.Extract,#sbo-rt-content .Example+.GC1,#sbo-rt-content .Example+.GC2,#sbo-rt-content .Example+.GC3,#sbo-rt-content .Example+.GC4,#sbo-rt-content .Example+.Text,#sbo-rt-content .Example+.Math,#sbo-rt-content .Example+.Problem,#sbo-rt-content .Dictionary+.Example,#sbo-rt-content .Extract+.Example,#sbo-rt-content .GC1+.Example,#sbo-rt-content .GC2+.Example,#sbo-rt-content .GC3+.Example,#sbo-rt-content .GC4+.Example,#sbo-rt-content .Text+.Example,#sbo-rt-content .Math+.Example,#sbo-rt-content .Problem+.Example{margin-top:1em;text-indent:0}#sbo-rt-content .Dictionary+.Vignette,#sbo-rt-content .Example+.Vignette,#sbo-rt-content .Extract+.Vignette,#sbo-rt-content .GC1+.Vignette,#sbo-rt-content .GC2+.Vignette,#sbo-rt-content .GC3+.Vignette,#sbo-rt-content .GC4+.Vignette,#sbo-rt-content .Text+.Vignette,#sbo-rt-content .Math+.Vignette,#sbo-rt-content .Problem+.Vignette{border-top:black thin solid;margin-top:1em}#sbo-rt-content .Vignette+.Dictionary,#sbo-rt-content .Vignette+.Example,#sbo-rt-content .Vignette+.Extract,#sbo-rt-content .Vignette+.GC1,#sbo-rt-content .Vignette+.GC2,#sbo-rt-content .Vignette+.GC3,#sbo-rt-content .Vignette+.GC4,#sbo-rt-content .Vignette+.Text,#sbo-rt-content .Vignette+.Math,#sbo-rt-content .Vignette+.Problem{border-top:black thin solid;margin-top:1em}#sbo-rt-content span.cBold,#sbo-rt-content span.c75Bold{font-weight:bold}#sbo-rt-content span.cSubscript{font-size:82%;line-height:1em;vertical-align:sub}#sbo-rt-content span.cSuperscript{font-size:82%;line-height:1em;vertical-align:super}#sbo-rt-content span.cBI{font-style:italic;font-weight:bold}#sbo-rt-content span.cAllCaps{text-transform:uppercase}#sbo-rt-content span.cBIsub{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBIsup{font-size:82%;font-style:italic;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cBoldsub,#sbo-rt-content span.cBsub{font-size:82%;font-weight:bold;line-height:1em;vertical-align:sub}#sbo-rt-content span.cBoldsup,#sbo-rt-content span.cBsup{font-size:82%;font-weight:bold;line-height:1em;vertical-align:super}#sbo-rt-content span.cColor{color:darkblue}#sbo-rt-content span.cMagenta{color:magenta}#sbo-rt-content span.cDSP,#sbo-rt-content span.code{-epub-hyphens:none;background-color:Azure;font-family:"Courier Std","STIX General",monospaced;font-size:.95em;font-style:normal;font-weight:normal;font-size-adjust:.58}#sbo-rt-content span.cIsub{font-size:82%;font-style:italic;line-height:1em;vertical-align:sub}#sbo-rt-content span.cIsup{font-size:82%;font-style:italic;line-height:1em;vertical-align:super}#sbo-rt-content span.cItalic,#sbo-rt-content span.cVariable{font-style:italic}#sbo-rt-content span.cOverbar{border-top:solid 1px}#sbo-rt-content span.cSmCap{font-variant:small-caps}#sbo-rt-content span.cSymGreek,#sbo-rt-content span.cSymMath{font-family:"STIX General",serif}#sbo-rt-content span.cSymGreekBI{font-family:"STIX General",serif;font-style:italic;font-weight:bold}#sbo-rt-content span.cSymGreekBold{font-family:"STIX General",serif;font-weight:bold}#sbo-rt-content span.cSymGreekItalic{font-family:"STIX General",serif;font-style:italic}#sbo-rt-content span.cUnderline{border-bottom:solid 1px}#sbo-rt-content .application{font-size:85%;text-transform:uppercase}#sbo-rt-content .class{color:blue;font-style:italic}#sbo-rt-content .command{color:navy;font-weight:bold}#sbo-rt-content .comment{color:darkgrey}#sbo-rt-content .enumeration{color:purple;font-style:italic}#sbo-rt-content .function{font-style:italic}#sbo-rt-content .keywords{font-weight:bold}#sbo-rt-content .property{color:purple}#sbo-rt-content p.h1Number{border-bottom:1px solid black;color:black;font-size:1.65em;overflow:visible}#sbo-rt-content p.centerHead{font-weight:Bold;text-align:center}#sbo-rt-content p.leftHead{font-weight:Bold;text-align:left}#sbo-rt-content p.rightHead{font-weight:Bold;text-align:right}#sbo-rt-content p.tableTitle{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content p.tableNumber{font-size:110%;line-height:110%;font-weight:bold;text-indent:0}#sbo-rt-content .GlossTerm::after{content:": "}#sbo-rt-content math{font-family:"STIX General",serif}</style><style type="text/css" title="ibis-book"></style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781482229417/chapter/K22616_C003.xhtml",
          "book_id": "9781482229417",
          "chapter_uri": "K22616_C003.xhtml",
          "position": 0,
          "user_uuid": "b28f9685-65fa-4f95-827a-bc87c37860af",
          "next_chapter_uri": "/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml"
        
      },
      title: "Fundamentals of Computer Graphics, 4th Edition",
      author_list: "Peter Shirley, Steve Marschner",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: true,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/modernizr.8e35451ddb64.js.download"></script><script>
    
      

      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta name="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta property="og:title" content="Chapter 3 Raster Images"><meta itemprop="isPartOf" content="/library/view/fundamentals-of-computer/9781482229417/"><meta itemprop="name" content="Chapter 3 Raster Images"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781482229417/"><meta property="og:description" itemprop="description" content="Chapter 3 Raster Images Most computer graphics images are presented to the user on some kind of raster display. Raster displays show images as rectangular arrays of pixels. A common ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="A K Peters/CRC Press"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781482229417"><meta property="og:book:author" itemprop="author" content="Peter Shirley"><meta property="og:book:author" itemprop="author" content="Steve Marschner"><meta property="og:book:tag" itemprop="about" content="Digital Media"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': 'b28f9685-65fa-4f95-827a-bc87c37860af' });
  

  
    
      ga('set', 'dimension1', 'Trial');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', 'b28f9685-65fa-4f95-827a-bc87c37860af');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/vendor.40e3ab2299ca.js.download"></script><script defer="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/reader.54b3e1936311.js.download"></script><script type="text/javascript" async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/munchkin.js(1).download"></script><script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/f(1).txt"></script><script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/f(2).txt"></script><script async="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/MathJax.js.download"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Script; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf?V=2.7.1') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_SansSerif-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf?V=2.7.1') format('opentype')}
</style></head>


<body class="reading sidenav  scalefonts subscribe-panel library nav-collapsed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/b28f9685-65fa-4f95-827a-bc87c37860af/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://learning.oreilly.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Fundamentals of Computer Graphics, 4th Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781482229417/chapter/K22616_C003.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml&amp;text=Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Chapter%203%20Raster%20Images&amp;body=https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C003.xhtml%0D%0Afrom%20Fundamentals%20of%20Computer%20Graphics%2C%204th%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C022.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 22 Implicit Modeling</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 24 Reflection Models</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><p class="h1Number">Chapter 23</p>
<h1>Global Illumination</h1>
<p><a id="page_613"></a>Many surfaces in the real world receive most or all of their incident light from other reflective surfaces. This is often called <span class="cItalic">indirect lighting</span> or <span class="cItalic">mutual illumination</span>. For example, the ceilings of most rooms receive little or no illumination directly from luminaires (light-emitting objects). The direct and indirect components of illumination are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-1">Figure 23.1</a>.</p>
<div id="art_Dest_fig_23-1" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-1"></a><span class="cBold">Figure 23.1</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-1.png" alt="Figure showing in the left and middle images, the indirect and direct lighting, respectively, are separated out. On the right, the sum of both components is shown. Global illumination algorithms account for both the direct and the indirect lighting." width="600" height="200" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-1.png"></p>
<p class="Text figcaption">In the left and middle images, the indirect and direct lighting, respectively, are separated out. On the right, the sum of both components is shown. Global illumination algorithms account for both the direct and the indirect lighting.</p>
</div>
<p>Although accounting for the interreflection of light between surfaces is straightforward, it is potentially costly because all surfaces may reflect any given surface, resulting in as many as <span class="cItalic">O</span>(<span class="cItalic">N</span><span class="cSuperscript">2</span>) interactions for <span class="cItalic">N</span> surfaces. Because the entire global database of objects may illuminate any given object, accounting for indirect illumination is often called the <span class="cItalic">global illumination</span> problem.</p>
<p>There is a rich and complex literature on solving the global illumination problem (e.g., Appel, 1968; Goral, Torrance, Greenberg, &amp; Battaile, 1984; Cook et al., <a id="page_614"></a>1984; Immel et al., 1986; Kajiya, 1986; Malley, 1988). In this chapter, we discuss two algorithms as examples: particle tracing and path tracing. The first is useful for walkthrough applications such as maze games, and as a component of batch rendering. The second is useful for realistic batch rendering. Then we discuss separating out “direct” lighting where light takes exactly once bounce between luminaire and camera.</p>
<h2><a id="sec23-1"></a>23.1 Particle Tracing for Lambertian Scenes</h2>
<p>Recall the transport equation from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml#sec18-2">Section 18.2</a>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-811-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_828&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_828" overflow="scroll" style="width: 18.615em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.049em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1017.96em, 3.293em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42362"><span class="mrow" id="MathJax-Span-42363"><span class="msub" id="MathJax-Span-42364"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42365" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42367" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42368" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42369"><span class="msub" id="MathJax-Span-42370"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42371"><span class="mrow" id="MathJax-Span-42372"><span class="mi" id="MathJax-Span-42373" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42375" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-42376" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-42377" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-42378"><span class="mrow" id="MathJax-Span-42379"><span class="msub" id="MathJax-Span-42380"><span style="display: inline-block; position: relative; width: 2.213em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42381" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-42382"><span class="mtext" id="MathJax-Span-42383" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-42384" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-42385"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42386"><span class="mrow" id="MathJax-Span-42387"><span class="mi" id="MathJax-Span-42388" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42389" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42390" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-42391" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-42392" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42393" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42394"><span class="msub" id="MathJax-Span-42395"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42396"><span class="mrow" id="MathJax-Span-42397"><span class="mi" id="MathJax-Span-42398" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42400" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-42401" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42402"><span class="mrow" id="MathJax-Span-42403"><span class="mi" id="MathJax-Span-42404" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42406" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span class="msub" id="MathJax-Span-42407" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42408" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42410" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42411" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42412"><span class="msub" id="MathJax-Span-42413"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42414"><span class="mrow" id="MathJax-Span-42415"><span class="mi" id="MathJax-Span-42416" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42418" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-42419" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-42420" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-42421"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42422" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-42423" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42424" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42425"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42426" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-42427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42428" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_828"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-811"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_828"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></script></p>
<p>The geometry for this equation is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-2">Figure 23.2</a>. When the illuminated point is Lambertian, this equation reduces to:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-812-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_829&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;all&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_829" overflow="scroll" style="width: 13.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.113em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1013.07em, 3.293em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42430"><span class="mrow" id="MathJax-Span-42431"><span class="msub" id="MathJax-Span-42432"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42433" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42434" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42435" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42436" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.255em;"><span class="mi" id="MathJax-Span-42437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-42438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.68em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.671em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-42439" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-42440"><span class="mrow" id="MathJax-Span-42441"><span class="msub" id="MathJax-Span-42442"><span style="display: inline-block; position: relative; width: 2.213em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42443" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-42444"><span class="mtext" id="MathJax-Span-42445" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-42446" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="msub" id="MathJax-Span-42447"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42448"><span class="mrow" id="MathJax-Span-42449"><span class="mi" id="MathJax-Span-42450" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42451" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42452" style="padding-left: 0.157em;"><span class="msub" id="MathJax-Span-42453"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42454" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42455" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42456" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42457" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42458"><span class="msub" id="MathJax-Span-42459"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42460"><span class="mrow" id="MathJax-Span-42461"><span class="mi" id="MathJax-Span-42462" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42464" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span class="mi" id="MathJax-Span-42465" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-42466" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-42467"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42468" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-42469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42470" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42471"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42472" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-42473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42474" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_829"><mrow><msub><mi>L</mi><mi>s</mi></msub><mo>=</mo><mfrac><mi>R</mi><mi>π</mi></mfrac><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-812"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_829"><mrow><msub><mi>L</mi><mi>s</mi></msub><mo>=</mo><mfrac><mi>R</mi><mi>π</mi></mfrac><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mtext>all</mtext><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>,</mo></mrow></math></script></p>
<p>where <span class="cItalic">R</span> is the diffuse reflectance. One way to approximate the solution to this equation is to use finite element methods. First, we break the scene into <span class="cItalic">N</span> surfaces each with unknown surface radiance <span class="cItalic">Li</span>, reflectance <span class="cItalic">R<span class="cSubscript">i</span></span>, and emitted radiance <span class="cItalic">Ei.</span> This results in the set of <span class="cItalic">N</span> simultaneous linear equations</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-813-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_830&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_830" overflow="scroll" style="width: 10.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.823em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.414em, 1009.78em, 3.602em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42476"><span class="mrow" id="MathJax-Span-42477"><span class="msub" id="MathJax-Span-42478"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42479" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42480" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42481" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-42482" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.78em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42483" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-42484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42485" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-42486" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-42487"><span class="msub" id="MathJax-Span-42488"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-42490" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-42491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.88em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.877em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-42492" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-42493"><span class="munderover" id="MathJax-Span-42494"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42495" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.424em, -1000.01em); top: -2.928em; left: 0.105em;"><span class="mrow" id="MathJax-Span-42496"><span class="mi" id="MathJax-Span-42497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-42498" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-42499" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.447em, 1000.42em, 4.167em, -1000.01em); top: -5.139em; left: 0.517em;"><span class="mi" id="MathJax-Span-42500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42501" style="padding-left: 0.157em;"><span class="msub" id="MathJax-Span-42502"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42503" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.517em;"><span class="mrow" id="MathJax-Span-42504"><span class="mi" id="MathJax-Span-42505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-42506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msub" id="MathJax-Span-42507"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42508" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42510" style="font-family: MathJax_Main;">,</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.427em; border-left: 0px solid; width: 0px; height: 3.074em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_830"><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mi>i</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><mi>π</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>L</mi><mi>j</mi></msub><mo>,</mo></mrow></mstyle></mrow></math></span></span><script type="math/mml" id="MathJax-Element-813"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_830"><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mi>i</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><mi>π</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>L</mi><mi>j</mi></msub><mo>,</mo></mrow></mstyle></mrow></math></script></p>
<p>where <span class="cItalic">k<span class="cSubscript">ij</span></span> is a constant related to the original integral representation. We then solve this set of linear equations, and we can render <span class="cItalic">N</span> constant-colored polygons. This finite element approach is often called <span class="cItalic">radiosity.</span></p>
<div id="art_Dest_fig_23-2" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-2"></a><span class="cBold">Figure 23.2</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-2.png" alt="Figure showing the geometry for the transport equation in its directional form." width="600" height="378" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-2.png"></p>
<p class="Text figcaption">The geometry for the transport equation in its directional form.</p>
</div>
<p><a id="page_615"></a>An alternative method to radiosity is to use a statistical simulation approach by randomly following light “particles” from the luminaire through the environment. This is a type <span class="cItalic">of particle tracing.</span> There are many algorithms that use some form of particle tracing; we will discuss a form of particle tracing that deposits light in the textures on triangles. First, we review some basic radiometric relations. The radiance <span class="cItalic">L</span> of a Lambertian surface with area <span class="cItalic">A</span> is directly proportional to the incident power per unit area:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-814-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8313_1&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mo&gt;&amp;#x3A6;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.1)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8313_1" overflow="scroll" style="width: 8.229em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.972em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1007.88em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42512"><span class="mrow" id="MathJax-Span-42513"><span class="mi" id="MathJax-Span-42514" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-42515" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42516"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.255em;"><span class="mo" id="MathJax-Span-42517" style="font-size: 70.7%; font-family: MathJax_Main;">Φ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-42518"><span class="mi" id="MathJax-Span-42519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-42520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.04em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42521" style="font-family: MathJax_Main;">,</span></span><span class="mtext" id="MathJax-Span-42522" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.1)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8313_1"><mrow><mi>L</mi><mo>=</mo><mfrac><mo>Φ</mo><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>,</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.1)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-814"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8313_1"><mrow><mi>L</mi><mo>=</mo><mfrac><mo>Φ</mo><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>,</mo></mrow><mtext>        (23.1)</mtext></math></script></p>
<p>where Φ is the outgoing power from the surface. Note that in this discussion, all radiometric quantities are either spectral or RGB, depending on the implementation. If the surface has emitted power Φ<span class="cIsub">e</span>, incident power Φ<span class="cIsub">i</span>, and reflectance <span class="cItalic">R</span>, then this equation becomes</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-815-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_832&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x3A6;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x3A6;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_832" overflow="scroll" style="width: 5.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.195em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1005.1em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42524"><span class="mrow" id="MathJax-Span-42525"><span class="mi" id="MathJax-Span-42526" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-42527" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42528" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.728em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1002.63em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -1.283em;"><span class="mrow" id="MathJax-Span-42529"><span class="msub" id="MathJax-Span-42530"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42531" style="font-size: 70.7%; font-family: MathJax_Main;">Φ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-42532" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42533" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-42534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="msub" id="MathJax-Span-42535"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42536" style="font-size: 70.7%; font-family: MathJax_Main;">Φ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-42537" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-42538"><span class="mi" id="MathJax-Span-42539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-42540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.74em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.728em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42541" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.591em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_832"><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mo>Φ</mo><mi>e</mi></msub><mo>+</mo><mi>R</mi><msub><mo>Φ</mo><mi>i</mi></msub></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-815"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_832"><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mo>Φ</mo><mi>e</mi></msub><mo>+</mo><mi>R</mi><msub><mo>Φ</mo><mi>i</mi></msub></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>If we are given a model with Φ<span class="cSubscript"><span class="cItalic">e</span></span> and <span class="cItalic">R</span> specified for each triangle, we can proceed luminaire by luminaire, firing power in the form of particles from each luminaire. We associate a texture map with each triangle to store accumulated radiance, with all texels initialized to</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-816-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_833&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x3A6;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_833" overflow="scroll" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.293em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.979em, 1003.2em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42543"><span class="mrow" id="MathJax-Span-42544"><span class="mi" id="MathJax-Span-42545" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-42546" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42547"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.27em, -1000.01em); top: -4.522em; left: 50%; margin-left: -0.409em;"><span class="mrow" id="MathJax-Span-42548"><span class="msub" id="MathJax-Span-42549"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42550" style="font-size: 70.7%; font-family: MathJax_Main;">Φ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.517em;"><span class="mi" id="MathJax-Span-42551" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-42552"><span class="mi" id="MathJax-Span-42553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-42554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.04em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42555" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.591em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_833"><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mo>Φ</mo><mi>e</mi></msub></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-816"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_833"><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mo>Φ</mo><mi>e</mi></msub></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>If a given triangle has area <span class="cItalic">A</span> and <span class="cItalic">n<span class="cSubscript">t</span></span> texels, and it is hit by a particle carrying power ϕ, then the radiance of that texel is incremented by</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-817-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_834&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x394;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_834" overflow="scroll" style="width: 4.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.476em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.928em, 1004.38em, 2.676em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42557"><span class="mrow" id="MathJax-Span-42558"><span class="mo" id="MathJax-Span-42559" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-42560" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-42561" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42562" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1001.09em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.512em;"><span class="mrow" id="MathJax-Span-42563"><span class="msub" id="MathJax-Span-42564"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42566" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-42568"><span class="mi" id="MathJax-Span-42569" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-42570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.19em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.185em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42571" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.591em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_834"><mrow><mo>Δ</mo><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mi>t</mi></msub><mi>ϕ</mi></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-817"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_834"><mrow><mo>Δ</mo><mi>L</mi><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mi>t</mi></msub><mi>ϕ</mi></mrow><mrow><mi>π</mi><mi>A</mi></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>Once a particle hits a surface, we increment the radiance of the texel it hits, probabilistically decide whether to reflect the particle, and if we reflect it we choose a direction and adjust its power.</p>
<p>Note that we want the particle to terminate at some point. For each surface we can assign a reflection probability <span class="cItalic">p</span> to each surface interaction. A natural choice would be to let <span class="cItalic">p</span> = <span class="cItalic">R</span> as it is with light in nature. The particle would then scatter around the environment, not losing or gaining any energy until it is absorbed. This approach works well when the particles carry a single wavelength (Walter, Hubbard, Shirley, &amp; Greenberg, 1997). However, when a spectrum or RGB triple is carried by the ray as is often implemented (Jensen, 2001), there is no single <span class="cItalic">R</span> and some compromise for the value of <span class="cItalic">p</span> should be chosen. The power <span class="cItalic">ϕ</span>′ for reflected particles should be adjusted to account for the possible extinction of the particles:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-818-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_835&quot;&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_835" overflow="scroll" style="width: 3.859em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.756em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.928em, 1003.66em, 2.728em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42573"><span class="mrow" id="MathJax-Span-42574"><span class="msup" id="MathJax-Span-42575"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42576" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-42577" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42578" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-42579" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1000.94em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -0.46em;"><span class="mrow" id="MathJax-Span-42580"><span class="mi" id="MathJax-Span-42581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-42582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.37em, 4.321em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-42583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.09em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.082em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42584" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.527em; border-left: 0px solid; width: 0px; height: 1.697em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_835"><mrow><msup><mi>ϕ</mi><mo>′</mo></msup><mo>=</mo><mfrac><mrow><mi>R</mi><mi>ϕ</mi></mrow><mi>p</mi></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-818"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_835"><mrow><msup><mi>ϕ</mi><mo>′</mo></msup><mo>=</mo><mfrac><mrow><mi>R</mi><mi>ϕ</mi></mrow><mi>p</mi></mfrac><mo>.</mo></mrow></math></script></p>
<p><a id="page_616"></a>Note that <span class="cItalic">p</span> can be set to any positive constant less than one, and that this constant can be different for each interaction. When <span class="cItalic">p &gt; R</span> for a given wavelength, the particle will gain power at that wavelength, and when <span class="cItalic">p &lt; R</span> it will lose power at that wavelength. The case where it gains power will not interfere with convergence because the particle will stop scattering and be terminated at some point as long as <span class="cItalic">p</span> &lt; 1. For the remainder of this discussion we <span class="cItalic">set p</span> = 0.5. The path of a single particle in such a system is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-3">Figure 23.3</a>.</p>
<div id="art_Dest_fig_23-3" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-3"></a><span class="cBold">Figure 23.3</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-3.png" alt="Figure showing the path of a particle that survives with probability 0.5 and is absorbed at the last intersection. The RGB power is shown for each path segment." width="600" height="431" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-3.png"></p>
<p class="Text figcaption">The path of a particle that survives with probability 0.5 and is absorbed at the last intersection. The RGB power is shown for each path segment.</p>
</div>
<p>A key part to this algorithm is that we scatter the light with an appropriate distribution for Lambertian surfaces. As discussed in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml#sec14-4-1">Section 14.4.1</a>, we can find a vector with a cosine (Lambertian) distribution by transforming two canonical random numbers (<span class="cItalic">ξ</span><span class="cSubscript">1</span>, <span class="cItalic">ξ</span><span class="cSubscript">2</span>) as follows:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-819-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8363_2&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.2)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8363_2" overflow="scroll" style="width: 26.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.658em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.237em, 1025.56em, 2.779em, -1000.01em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-42586"><span class="mrow" id="MathJax-Span-42587"><span class="mstyle" id="MathJax-Span-42588"><span class="mrow" id="MathJax-Span-42589"><span class="mi" id="MathJax-Span-42590" style="font-family: MathJax_Main-bold;">a</span></span></span><span class="mo" id="MathJax-Span-42591" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-42592" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-42593" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-42594"><span class="mi" id="MathJax-Span-42595" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-42596" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-42597" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42598" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42599"><span class="mn" id="MathJax-Span-42600" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-42601" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42602"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42603" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42604" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42605" style="font-family: MathJax_Main;">)</span></span><span class="msqrt" id="MathJax-Span-42606" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1001.09em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42607"><span class="mrow" id="MathJax-Span-42608"><span class="msub" id="MathJax-Span-42609"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42610" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42611" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42612" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1001.25em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 0.568em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42613" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-42614" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-42615" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42616" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42617"><span class="mn" id="MathJax-Span-42618" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-42619" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42620"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42621" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42622" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42623" style="font-family: MathJax_Main;">)</span></span><span class="msqrt" id="MathJax-Span-42624" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1001.09em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42625"><span class="mrow" id="MathJax-Span-42626"><span class="msub" id="MathJax-Span-42627"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42628" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42629" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42630" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1001.25em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 1.237em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 0.568em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msqrt" id="MathJax-Span-42631"><span style="display: inline-block; position: relative; width: 3.653em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1002.58em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42632"><span class="mrow" id="MathJax-Span-42633"><span class="mn" id="MathJax-Span-42634" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-42635" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="mi" id="MathJax-Span-42636" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mn" id="MathJax-Span-42637" style="font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1002.68em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 1.956em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.414em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.928em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.442em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42638" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-42639" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span><span class="mtext" id="MathJax-Span-42640" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.2)</span></span><span style="display: inline-block; width: 0px; height: 2.265em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.38em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8363_2"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>a</mi></mstyle><mo>=</mo><mrow><mo>(</mo><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mo>,</mo></mrow></msqrt><mi>sin</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mo>,</mo></mrow></msqrt><msqrt><mrow><mn>1</mn><mo>−</mo><mi>ξ</mi><mn>2</mn></mrow></msqrt></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.2)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-819"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8363_2"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>a</mi></mstyle><mo>=</mo><mrow><mo>(</mo><mrow><mi>cos</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mo>,</mo></mrow></msqrt><mi>sin</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mo>,</mo></mrow></msqrt><msqrt><mrow><mn>1</mn><mo>−</mo><mi>ξ</mi><mn>2</mn></mrow></msqrt></mrow><mo>)</mo></mrow><mo>.</mo></mrow><mtext>        (23.2)</mtext></math></script></p>
<p>Note that this assumes the normal vector is parallel to the <span class="cItalic">z</span>-axis. For a triangle, we must establish an orthonormal basis with w parallel to the normal vector. We can accomplish this as follows:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-820-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_837&quot;&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd columnalign=&quot;right&quot;&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#xD7;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_837" overflow="scroll" style="width: 6.686em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.481em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.717em, 1006.23em, 4.476em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42642"><span class="mrow" id="MathJax-Span-42643"><span class="mtable" id="MathJax-Span-42644" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 6.172em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1000.78em, 7.509em, -1000.01em); top: -5.345em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -5.91em; right: 0em;"><span class="mtd" id="MathJax-Span-42645"><span class="mrow" id="MathJax-Span-42646"><span class="mrow" id="MathJax-Span-42647"><span class="mstyle" id="MathJax-Span-42648"><span class="mrow" id="MathJax-Span-42649"><span class="mi" id="MathJax-Span-42650" style="font-family: MathJax_Main-bold;">w</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -3.854em; right: 0em;"><span class="mtd" id="MathJax-Span-42667"><span class="mrow" id="MathJax-Span-42668"><span class="mrow" id="MathJax-Span-42669"><span class="mstyle" id="MathJax-Span-42670"><span class="mrow" id="MathJax-Span-42671"><span class="mi" id="MathJax-Span-42672" style="font-family: MathJax_Main-bold;">u</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -2.003em; right: 0em;"><span class="mtd" id="MathJax-Span-42707"><span class="mrow" id="MathJax-Span-42708"><span class="mrow" id="MathJax-Span-42709"><span class="mstyle" id="MathJax-Span-42710"><span class="mrow" id="MathJax-Span-42711"><span class="mi" id="MathJax-Span-42712" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.35em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1004.43em, 8.126em, -1000.01em); top: -5.807em; left: 1.648em;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1002.84em, 4.784em, -1000.01em); top: -5.91em; left: 0em;"><span class="mtd" id="MathJax-Span-42651"><span class="mrow" id="MathJax-Span-42652"><span class="mrow" id="MathJax-Span-42653"><span class="mo" id="MathJax-Span-42654" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-42655" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.203em;"><span class="mstyle" id="MathJax-Span-42656"><span class="mrow" id="MathJax-Span-42657"><span class="mi" id="MathJax-Span-42658" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.14em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.614em;"><span class="mrow" id="MathJax-Span-42659"><span class="mrow" id="MathJax-Span-42660"><span class="mo" id="MathJax-Span-42661" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mstyle" id="MathJax-Span-42662"><span class="mrow" id="MathJax-Span-42663"><span class="mi" id="MathJax-Span-42664" style="font-size: 70.7%; font-family: MathJax_Main-bold;">n</span></span></span><span class="mo" id="MathJax-Span-42665" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.35em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.339em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42666" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.882em, 1004.43em, 4.784em, -1000.01em); top: -3.854em; left: 0em;"><span class="mtd" id="MathJax-Span-42673"><span class="mrow" id="MathJax-Span-42674"><span class="mrow" id="MathJax-Span-42675"><span class="mo" id="MathJax-Span-42676" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-42677" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.985em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.447em, 1002.07em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.026em;"><span class="mrow" id="MathJax-Span-42678"><span class="msub" id="MathJax-Span-42679"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42680"><span class="mrow" id="MathJax-Span-42681"><span class="mi" id="MathJax-Span-42682" style="font-size: 70.7%; font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42683" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42684" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-42685"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42686"><span class="mrow" id="MathJax-Span-42687"><span class="mi" id="MathJax-Span-42688" style="font-size: 70.7%; font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42689" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.79em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.437em;"><span class="mrow" id="MathJax-Span-42690"><span class="mrow" id="MathJax-Span-42691"><span class="mo" id="MathJax-Span-42692" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-42693"><span class="msub" id="MathJax-Span-42694"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42695"><span class="mrow" id="MathJax-Span-42696"><span class="mi" id="MathJax-Span-42697" style="font-size: 70.7%; font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42698" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42699" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-42700"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42701"><span class="mrow" id="MathJax-Span-42702"><span class="mi" id="MathJax-Span-42703" style="font-size: 70.7%; font-family: MathJax_Main-bold;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42704" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42705" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.99em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.985em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42706" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1003.92em, 4.373em, -1000.01em); top: -2.003em; left: 0em;"><span class="mtd" id="MathJax-Span-42713"><span class="mrow" id="MathJax-Span-42714"><span class="mrow" id="MathJax-Span-42715"><span class="mo" id="MathJax-Span-42716" style="font-family: MathJax_Main;">=</span><span class="mstyle" id="MathJax-Span-42717" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-42718"><span class="mi" id="MathJax-Span-42719" style="font-family: MathJax_Main-bold;">w</span></span></span><span class="mo" id="MathJax-Span-42720" style="font-family: MathJax_Main; padding-left: 0.208em;">×</span><span class="mstyle" id="MathJax-Span-42721" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-42722"><span class="mi" id="MathJax-Span-42723" style="font-family: MathJax_Main-bold;">u</span></span></span><span class="mo" id="MathJax-Span-42724" style="font-family: MathJax_Main;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.812em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.327em; border-left: 0px solid; width: 0px; height: 5.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_837"><mrow><mtable><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>w</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mrow><mrow><mo>||</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>1</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>0</mn></msub></mrow><mrow><mrow><mo>||</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>1</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>0</mn></msub></mrow><mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>w</mi></mstyle><mo>×</mo><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mo>,</mo></mrow></mtd></mtr></mtable></mrow></math></span></span><script type="math/mml" id="MathJax-Element-820"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_837"><mrow><mtable><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>w</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mrow><mrow><mo>||</mo><mstyle mathvariant="bold" mathsize="normal"><mi>n</mi></mstyle><mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mfrac><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>1</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>0</mn></msub></mrow><mrow><mrow><mo>||</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>1</mn></msub><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>p</mi></mstyle><mn>0</mn></msub></mrow><mo>||</mo></mrow></mrow></mfrac><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign="right"><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow></mtd><mtd columnalign="left"><mrow><mo>=</mo><mstyle mathvariant="bold" mathsize="normal"><mi>w</mi></mstyle><mo>×</mo><mstyle mathvariant="bold" mathsize="normal"><mi>u</mi></mstyle><mo>,</mo></mrow></mtd></mtr></mtable></mrow></math></script></p>
<p><a id="page_617"></a>where <span class="cBold">p</span><span class="cItalic"><span class="cSubscript">i</span></span> are the vertices of the triangle. Then, by definition, our vector in the appropriate coordinates is</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-821-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8383_3&quot;&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;a&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.3)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8383_3" overflow="scroll" style="width: 29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.126em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.134em, 1028.03em, 2.676em, -1000.01em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-42726"><span class="mrow" id="MathJax-Span-42727"><span class="mtext" id="MathJax-Span-42728" style="font-family: MathJax_Main-bold;">a</span><span class="mo" id="MathJax-Span-42729" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-42730" style="font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-42731" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-42732" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42733" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42734"><span class="mn" id="MathJax-Span-42735" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-42736" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42737"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42738" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42739" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42740" style="font-family: MathJax_Main;">)</span></span><span class="msqrt" id="MathJax-Span-42741" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.522em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1001.5em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42742"><span class="mrow" id="MathJax-Span-42743"><span class="msub" id="MathJax-Span-42744"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42745" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42746" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42747" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1001.55em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 0.825em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.362em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42748" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-42749" style="font-family: MathJax_Main; padding-left: 0.208em;">sin</span><span class="mo" id="MathJax-Span-42750" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-42751" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42752" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42753"><span class="mn" id="MathJax-Span-42754" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-42755" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42756"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42757" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42758" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42759" style="font-family: MathJax_Main;">)</span></span><span class="msqrt" id="MathJax-Span-42760" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.522em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1001.45em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42761"><span class="mrow" id="MathJax-Span-42762"><span class="msub" id="MathJax-Span-42763"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42764" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42765" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-42766"><span class="mrow" id="MathJax-Span-42767"><span class="mi" id="MathJax-Span-42768" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1001.5em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 1.494em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 0.825em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.362em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42769" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msqrt" id="MathJax-Span-42770" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.424em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1003.35em, 4.373em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-42771"><span class="mrow" id="MathJax-Span-42772"><span class="mn" id="MathJax-Span-42773" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-42774" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-42775" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42776" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-42777" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42778" style="font-family: MathJax_Main-bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1003.4em, 3.961em, -1000.01em); top: -4.573em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 3.396em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 2.728em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.465em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.031em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.596em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.162em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.985em, 1001.04em, 4.527em, -1000.01em); top: -4.008em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42779" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-42780" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.3)</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.327em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8383_3"><mrow><mtext mathvariant="bold">a</mtext><mo>=</mo><mi>cos</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mi mathvariant="bold">u</mi></mrow></msqrt><mo>+</mo><mi>sin</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow></msqrt><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>2</mn></msub><mi mathvariant="bold">w</mi></mrow></msqrt><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.3)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-821"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8383_3"><mrow><mtext mathvariant="bold">a</mtext><mo>=</mo><mi>cos</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mi mathvariant="bold">u</mi></mrow></msqrt><mo>+</mo><mi>sin</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mi>ξ</mi><mn>2</mn></msub><mstyle mathvariant="bold" mathsize="normal"><mi>v</mi></mstyle></mrow></msqrt><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>2</mn></msub><mi mathvariant="bold">w</mi></mrow></msqrt><mo>.</mo></mrow><mtext>        (23.3)</mtext></math></script></p>
<p>In pseudocode our algorithm for <span class="cItalic">p</span> = 0.5 and one luminaire is:</p>
<pre><span class="code"><span class="cBold">for</span> (Each of <span class="cItalic">n</span> particles) <span class="cBold">do</span></span></pre>
<pre><span class="code"> RGB <span class="cItalic">phi</span> = Φ/<span class="cItalic">n</span></span></pre>
<pre><span class="code"> compute uniform random point <span class="cBold">a</span> on luminaire</span></pre>
<pre><span class="code"> compute random direction <span class="cBold">b</span> with cosine density</span></pre>
<pre><span class="code"> done = false</span></pre>
<pre><span class="code"> <span class="cBold">while</span> not done <span class="cBold">do</span></span></pre>
<pre><span class="code"> <span class="cBold">if</span> (ray <span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">b</span> hits at some point <span class="cBold">c</span>) <span class="cBold">then</span></span></pre>
<pre><span class="code">  add <span class="cItalic">n<span class="cSubscript">t</span>R<span class="cItalic">ϕ</span>/(<span class="cItalic">π</span>A)</span> to appropriate texel</span></pre>
<pre><span class="code">  <span class="cBold">if</span> (<span class="cItalic">ξ</span>1 &gt; 0.5) <span class="cBold">then</span></span></pre>
<pre><span class="code">   <span class="cItalic">ϕ = 2Rϕ</span></span></pre>
<pre><span class="code">   <span class="cBold">a</span> = <span class="cBold">c</span></span></pre>
<pre><span class="code">   <span class="cBold">b</span> = random direction with cosine density</span></pre>
<pre><span class="code"> <span class="cBold">else</span></span></pre>
<pre><span class="code">  done = true</span></pre>
<p>Here <span class="cItalic">ξ<span class="cSubscript">i</span></span> are canonical random numbers. Once this code has run, the texture maps store the radiance of each triangle and can be rendered directly for any viewpoint with no additional computation.</p>
<h2><a id="sec23-2"></a>23.2 Path Tracing</h2>
<p>While particle tracing is well suited to precomputation of the radiances of diffuse scenes, it is problematic for creating images of scenes with general BRDFs or scenes that contain many objects. The most straightforward way to create images of such scenes is to use <span class="cItalic">path tracing</span> (Kajiya, 1986). This is a probabilistic method that sends rays from the eye and traces them back to the light. Often path tracing is used only to compute the indirect lighting. Here we will present it in a way that captures all lighting, which can be inefficient. This is sometimes called <span class="cItalic">brute force</span> path tracing. In <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#sec23-3">Section 23.3</a>, more efficient techniques for direct lighting can be added.</p>
<p>In path tracing, we start with the full transport equation:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-822-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_839&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;all&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_839" overflow="scroll" style="width: 23.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.573em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.62em, 1022.48em, 3.293em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42782"><span class="mrow" id="MathJax-Span-42783"><span class="msub" id="MathJax-Span-42784"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42785" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42787" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42788" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42789"><span class="msub" id="MathJax-Span-42790"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42791"><span class="mrow" id="MathJax-Span-42792"><span class="mi" id="MathJax-Span-42793" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42795" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-42796" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="msub" id="MathJax-Span-42797" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42798" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42799" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42800" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42801" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42802"><span class="msub" id="MathJax-Span-42803"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42804"><span class="mrow" id="MathJax-Span-42805"><span class="mi" id="MathJax-Span-42806" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42808" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-42809" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mstyle" id="MathJax-Span-42810" style="padding-left: 0.208em;"><span class="mrow" id="MathJax-Span-42811"><span class="mrow" id="MathJax-Span-42812"><span class="msub" id="MathJax-Span-42813"><span style="display: inline-block; position: relative; width: 2.419em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42814" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-42815"><span class="mi" id="MathJax-Span-42816" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-42817" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;</span><span class="msub" id="MathJax-Span-42818"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42819"><span class="mrow" id="MathJax-Span-42820"><span class="mi" id="MathJax-Span-42821" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42822" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42823" style="padding-left: 0.157em;"><span class="mi" id="MathJax-Span-42824" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-42825" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42826" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42827"><span class="msub" id="MathJax-Span-42828"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42829"><span class="mrow" id="MathJax-Span-42830"><span class="mi" id="MathJax-Span-42831" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42832" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42833" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-42834" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42835"><span class="mrow" id="MathJax-Span-42836"><span class="mi" id="MathJax-Span-42837" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42838" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42839" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span class="mi" id="MathJax-Span-42840" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">L</span><span class="mi" id="MathJax-Span-42841" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mrow" id="MathJax-Span-42842" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42843" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42844"><span class="msub" id="MathJax-Span-42845"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42846"><span class="mrow" id="MathJax-Span-42847"><span class="mi" id="MathJax-Span-42848" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42850" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-42851" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-42852" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-42853"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42854" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-42855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42856" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42857"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.447em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42858" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-42859" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42860" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.109em; border-left: 0px solid; width: 0px; height: 2.545em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_839"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>all</mi><mtext>&nbsp;</mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>L</mi><mi>f</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-822"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_839"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>all</mi><mtext> </mtext><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow></msub><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mstyle><mi>L</mi><mi>f</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></script></p>
<p><a id="page_618"></a>We use Monte Carlo integration to approximate the solution to this equation for each viewing ray. Recall from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C014.xhtml#sec14-3">Section 14.3</a>, that we can use random samples to approximate an integral:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-823-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_840&quot;&gt;&lt;mrow&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x3BC;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_840" overflow="scroll" style="width: 12.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.342em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.208em, 1012.3em, 3.447em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42862"><span class="mrow" id="MathJax-Span-42863"><span class="mstyle" id="MathJax-Span-42864"><span class="mrow" id="MathJax-Span-42865"><span class="mrow" id="MathJax-Span-42866"><span class="msub" id="MathJax-Span-42867"><span style="display: inline-block; position: relative; width: 1.956em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42868" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-42869"><span class="mi" id="MathJax-Span-42870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-42871" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-42872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42873" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-42874" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42875" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-42876" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-42877" style="font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-42878" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-42879" style="font-family: MathJax_Math-italic;">μ</span><span class="mo" id="MathJax-Span-42880" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-42881" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-42882" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.306em;"><span class="mi" id="MathJax-Span-42883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1000.73em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.774em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-42884" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-42885"><span class="munderover" id="MathJax-Span-42886"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.933em, 1001.4em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-42887" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.09em, 4.27em, -1000.01em); top: -2.928em; left: 0.157em;"><span class="mrow" id="MathJax-Span-42888"><span class="mi" id="MathJax-Span-42889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-42890" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-42891" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.293em, 1000.63em, 4.167em, -1000.01em); top: -5.139em; left: 0.414em;"><span class="mi" id="MathJax-Span-42892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42893" style="padding-left: 0.157em;"><span class="mfrac" id="MathJax-Span-42894"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.087em, 1002.22em, 4.424em, -1000.01em); top: -4.728em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-42895"><span class="mi" id="MathJax-Span-42896" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-42897" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42898" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42899"><span class="msub" id="MathJax-Span-42900"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42901" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-42902" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42903" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.087em, 1002.22em, 4.424em, -1000.01em); top: -3.288em; left: 50%; margin-left: -1.18em;"><span class="mrow" id="MathJax-Span-42904"><span class="mi" id="MathJax-Span-42905" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-42906" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42907" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42908"><span class="msub" id="MathJax-Span-42909"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42910" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-42911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42912" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.43em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.47em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-42913" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.268em; border-left: 0px solid; width: 0px; height: 3.127em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_840"><mrow><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>x</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>g</mi></mrow></mstyle><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>μ</mi><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>g</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></mstyle><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-823"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_840"><mrow><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>x</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>g</mi></mrow></mstyle><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>μ</mi><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><mrow><mi>g</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></mstyle><mo>,</mo></mrow></math></script></p>
<p>where the <span class="cItalic">xi</span> are random points with probability density function <span class="cItalic">p.</span> If we apply this directly to the transport equation with <span class="cItalic">N</span> = 1 we get</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-824-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_841&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3C3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_841" overflow="scroll" style="width: 17.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.072em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.774em, 1016.98em, 2.882em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42915"><span class="mrow" id="MathJax-Span-42916"><span class="msub" id="MathJax-Span-42917"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42918" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42920" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42921" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42922"><span class="msub" id="MathJax-Span-42923"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42924"><span class="mrow" id="MathJax-Span-42925"><span class="mi" id="MathJax-Span-42926" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42927" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42928" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-42929" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="msub" id="MathJax-Span-42930" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42931" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-42932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42933" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42934" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42935"><span class="msub" id="MathJax-Span-42936"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42937"><span class="mrow" id="MathJax-Span-42938"><span class="mi" id="MathJax-Span-42939" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-42940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42941" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-42942" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mfrac" id="MathJax-Span-42943" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 8.023em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1007.93em, 4.373em, -1000.01em); top: -4.625em; left: 50%; margin-left: -3.956em;"><span class="mrow" id="MathJax-Span-42944"><span class="mi" id="MathJax-Span-42945" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-42946"><span class="mo" id="MathJax-Span-42947" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42948"><span class="msub" id="MathJax-Span-42949"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42950"><span class="mrow" id="MathJax-Span-42951"><span class="mi" id="MathJax-Span-42952" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42953" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-42954" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-42955"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42956"><span class="mrow" id="MathJax-Span-42957"><span class="mi" id="MathJax-Span-42958" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42959" style="font-size: 50%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42960" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-42961"><span style="display: inline-block; position: relative; width: 0.825em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-42963" style="font-size: 50%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-42964"><span class="mo" id="MathJax-Span-42965" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42966"><span class="msub" id="MathJax-Span-42967"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42968"><span class="mrow" id="MathJax-Span-42969"><span class="mi" id="MathJax-Span-42970" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42971" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42972" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-42973" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-42974" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-42975"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-42977" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-42978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-42979"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-42980" style="font-size: 70.7%; font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42981" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1001.5em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-42982"><span class="mi" id="MathJax-Span-42983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-42984"><span class="mo" id="MathJax-Span-42985" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-42986"><span class="msub" id="MathJax-Span-42987"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-42988"><span class="mrow" id="MathJax-Span-42989"><span class="mi" id="MathJax-Span-42990" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-42991" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-42992" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1008.03em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.023em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-42993" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 1.962em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_841"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-824"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_841"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>σ</mi><mi>i</mi></msub></mrow><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>So, if we have a way to select random directions <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span> with a known density <span class="cItalic">p</span>, we can get an estimate. The catch is that <span class="cItalic">Lf</span> (<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>) is itself an unknown. Fortunately, we can apply recursion and use a statistical estimate for <span class="cItalic">L<span class="cSubscript">f</span></span> (<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>) by sending a ray in that direction to find the surface seen in that direction. We end when we hit a luminaire and <span class="cItalic">L<span class="cSubscript">e</span></span> is nonzero (<a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-4">Figure 23.4</a>). This method assumes lights have zero reflectance, or we would continue to recurse.</p>
<div id="art_Dest_fig_23-4" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-4"></a><span class="cBold">Figure 23.4</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-4.png" alt="Figure showing in path tracing, a ray is followed through a pixel from the eye and scattered through the scene until it hits a luminaire." width="600" height="431" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-4.png"></p>
<p class="Text figcaption">In path tracing, a ray is followed through a pixel from the eye and scattered through the scene until it hits a luminaire.</p>
</div>
<p>In the case of a Lambertian BRDF <span class="cItalic">(ρ = R/π)</span>, we can use a cosine density function:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-825-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_842&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_842" overflow="scroll" style="width: 6.635em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.429em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1006.34em, 2.625em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-42995"><span class="mrow" id="MathJax-Span-42996"><span class="mi" id="MathJax-Span-42997" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-42998" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-42999" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43000"><span class="msub" id="MathJax-Span-43001"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43002"><span class="mrow" id="MathJax-Span-43003"><span class="mi" id="MathJax-Span-43004" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43005" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43006" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43007" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-43008" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 2.316em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1002.22em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-43009"><span class="mi" id="MathJax-Span-43010" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-43011" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-43012"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43013" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-43014" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-43015" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.33em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.316em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43016" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_842"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow><mi>π</mi></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-825"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_842"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow><mi>π</mi></mfrac><mo>.</mo></mrow></math></script></p>
<p><a id="page_619"></a>A direction with this density can be chosen according to Equation (23.3). This allows some cancellation of cosine terms in our estimate:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-826-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_843&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_843" overflow="scroll" style="width: 13.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.753em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.185em, 1012.66em, 2.573em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43018"><span class="mrow" id="MathJax-Span-43019"><span class="msub" id="MathJax-Span-43020"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43021" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43023" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43024" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43025"><span class="msub" id="MathJax-Span-43026"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43027"><span class="mrow" id="MathJax-Span-43028"><span class="mi" id="MathJax-Span-43029" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43031" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43032" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="msub" id="MathJax-Span-43033" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43034" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43035" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43036" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43037" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43038"><span class="msub" id="MathJax-Span-43039"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43040"><span class="mrow" id="MathJax-Span-43041"><span class="mi" id="MathJax-Span-43042" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43044" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43045" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="mi" id="MathJax-Span-43046" style="font-family: MathJax_Math-italic; padding-left: 0.208em;">R</span><span class="msub" id="MathJax-Span-43047"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43048" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43050" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43051" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43052"><span class="msub" id="MathJax-Span-43053"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43054"><span class="mrow" id="MathJax-Span-43055"><span class="mi" id="MathJax-Span-43056" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43058" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43059" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_843"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>R</mi><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-826"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_843"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>R</mi><msub><mi>L</mi><mi>f</mi></msub><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>In pseudocode, such a path tracer for Lambertian surfaces would operate just like the ray tracers described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>, but the <span class="cItalic">raycolor</span> function would be modified:</p>
<pre><span class="code">RGB raycolor(ray <span class="cBold">a</span> + <span class="cItalic">t</span><span class="cBold">b</span>, int depth)</span></pre>
<pre><span class="code"><span class="cBold">if</span> (ray hits at some point <span class="cBold">c</span>) <span class="cBold">then</span></span></pre>
<pre><span class="code"> RGB <span class="cItalic">c</span> = <span class="cItalic">L<span class="cSubscript">e</span></span>(‒<span class="cBold">b</span>)</span></pre>
<pre><span class="code"> <span class="cBold">if</span> (depth &lt; maxdepth) <span class="cBold">then</span></span></pre>
<pre><span class="code"> compute random direction <span class="cBold">d</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">c</span> + <span class="cItalic">R</span> raycolor(<span class="cBold">c</span> + <span class="cItalic">s</span><span class="cBold">d</span>, depth+1)</span></pre>
<pre><span class="code"> <span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> background color</span></pre>
<p>This will result in a very noisy image unless either large luminaires or very large numbers of samples are used. Note the color of the luminaires must be well above one (sometimes thousands or tens of thousands) to make the surfaces have final colors near one, because only those rays that hit a luminaire by chance will make a contribution, and most rays will contribute only a color near zero. To generate the random direction d, we use the same technique as we do in particle tracing (see Equation (23.2)).</p>
<p>In the general case, we might want to use spectral colors or use a more general BRDF. In practice, we should have the material class contain member functions to compute a random direction as well as compute the <span class="cItalic">p</span> associated with that direction. This way materials can be added transparently to an implementation.</p>
<h2><a id="sec23-3"></a>23.3 Accurate Direct Lighting</h2>
<p>This section presents a more physically based method of direct lighting than <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C010.xhtml">Chapter 10</a>. These methods will be useful in making global illumination algorithms more efficient. The key idea is to send shadow rays to the luminaires as described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C004.xhtml">Chapter 4</a>, but to do so with careful bookkeeping based on the transport equation from the previous chapter. The global illumination algorithms can be adjusted to make sure they compute the direct component exactly once. For example, in particle tracing, particles coming directly from the luminaire would not be logged, so the particles would only encode indirect lighting. This makes <a id="page_620"></a>nice looking shadows much more efficiently than computing direct lighting in the context of global illumination.</p>
<h3><a id="sec23-3-1"></a>23.3.1 Mathematical Framework</h3>
<p>To calculate the direct light from one <span class="cItalic">luminaire</span> (light emitting object) onto a non-emitting surface, we solve a form of the transport equation from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml#sec18-2">Section 18.2</a>:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-827-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8443_4&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;all&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.4)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8443_4" overflow="scroll" style="width: 34.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 33.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.414em, 1033.28em, 3.447em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43061"><span class="mrow" id="MathJax-Span-43062"><span class="msub" id="MathJax-Span-43063"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43064" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43065" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43066" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43067" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43068"><span class="msub" id="MathJax-Span-43069"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.66em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43070"><span class="mstyle" id="MathJax-Span-43071"><span class="mrow" id="MathJax-Span-43072"><span class="mi" id="MathJax-Span-43073" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43074" style="font-family: MathJax_Main;">,</span><span class="mstyle" id="MathJax-Span-43075" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-43076"><span class="mi" id="MathJax-Span-43077" style="font-family: MathJax_Main-bold;">k</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 1.648em;"><span class="mi" id="MathJax-Span-43078" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43079" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43080" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mstyle" id="MathJax-Span-43081" style="padding-left: 0.26em;"><span class="mrow" id="MathJax-Span-43082"><span class="mrow" id="MathJax-Span-43083"><span class="msub" id="MathJax-Span-43084"><span style="display: inline-block; position: relative; width: 2.368em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1000.94em, 5.041em, -1000.01em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-43085" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.414em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.134em; left: 0.568em;"><span class="mrow" id="MathJax-Span-43086"><span class="mi" id="MathJax-Span-43087" style="font-size: 70.7%; font-family: MathJax_Main;">all</span><span class="mtext" id="MathJax-Span-43088" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;</span><span class="msup" id="MathJax-Span-43089"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43090" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43091" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43092" style="padding-left: 0.157em;"><span class="mfrac" id="MathJax-Span-43093"><span style="display: inline-block; position: relative; width: 18.974em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.036em, 1018.88em, 4.424em, -1000.01em); top: -4.728em; left: 50%; margin-left: -9.406em;"><span class="mrow" id="MathJax-Span-43094"><span class="mi" id="MathJax-Span-43095" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-43096" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43097" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43098"><span class="msub" id="MathJax-Span-43099"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43100" style="font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43102" style="font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43103" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43104" style="font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43106" style="font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-43107" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43108" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43110" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43111" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-43112"><span class="msup" id="MathJax-Span-43113"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43114" style="font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-43115" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43116" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-43117" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="msub" id="MathJax-Span-43118"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43119" style="font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43121" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mi" id="MathJax-Span-43122" style="font-family: MathJax_Math-italic; padding-left: 0.157em;">v</span><span class="mrow" id="MathJax-Span-43123" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43124" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-43125"><span class="mi" id="MathJax-Span-43126" style="font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43127" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-43128" style="padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43129" style="font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-43130" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43131" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mi" id="MathJax-Span-43132" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-43133" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-43134"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43135" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-43136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-43137" style="font-family: MathJax_Main; padding-left: 0.157em;">cos</span><span class="mo" id="MathJax-Span-43138" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-43139"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43140" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-43141" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.933em, 1004.23em, 4.424em, -1000.01em); top: -3.082em; left: 50%; margin-left: -2.105em;"><span class="mrow" id="MathJax-Span-43142"><span class="msup" id="MathJax-Span-43143"><span style="display: inline-block; position: relative; width: 4.219em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1003.66em, 4.424em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43144"><span class="mrow" id="MathJax-Span-43145"><span class="mo" id="MathJax-Span-43146" style="font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43147"><span class="mi" id="MathJax-Span-43148" style="font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43149" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-43150" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43151" style="font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.62em;"><span class="mo" id="MathJax-Span-43152" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43153" style="font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.47em; left: 3.807em;"><span class="mn" id="MathJax-Span-43154" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1018.98em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 18.974em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span></span></span></span><span class="mi" id="MathJax-Span-43155" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-43156"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43157" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.774em;"><span class="mo" id="MathJax-Span-43158" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43159" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-43160" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.4)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.268em; border-left: 0px solid; width: 0px; height: 2.862em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8443_4"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>all</mi><mtext>&nbsp;</mtext><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow></msub><mrow><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub><mo>,</mo><msub><mi mathvariant="bold">k</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac></mrow></mrow></mstyle><mi>d</mi><msup><mi>A</mi><mo>′</mo></msup><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.4)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-827"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8443_4"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle="true"><mrow><msub><mo>∫</mo><mrow><mi>all</mi><mtext> </mtext><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow></msub><mrow><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub><mo>,</mo><msub><mi mathvariant="bold">k</mi><mi>o</mi></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac></mrow></mrow></mstyle><mi>d</mi><msup><mi>A</mi><mo>′</mo></msup><mo>.</mo></mrow><mtext>       (23.4)</mtext></math></script></p>
<p>Recall that <span class="cItalic">L<span class="cSubscript">e</span></span> is the emitted radiance of the source, <span class="cItalic">v</span> is a visibility function that is equal to 1 if <span class="cBold">x</span> “sees” <span class="cBold">x′</span> and zero otherwise, and the other variables are as illustrated in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-5">Figure 23.5</a>.</p>
<div id="art_Dest_fig_23-5" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-5"></a><span class="cBold">Figure 23.5</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-5.png" alt="Figure showing the direct lighting terms for Equation (23.4)." width="409" height="439" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-5.png"></p>
<p class="Text figcaption">The direct lighting terms for Equation (23.4).</p>
</div>
<p>If we are to sample Equation (23.4) using Monte Carlo integration, we need to pick a random point x′ on the surface of the luminaire with density function <span class="cItalic">p</span> (so x′ ~ <span class="cItalic">p</span>). Just plugging into Equation (14.5) with one sample yields</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-828-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8453_5&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.5)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8453_5" overflow="scroll" style="width: 24.116em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.396em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.774em, 1023.3em, 3.036em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43162"><span class="mrow" id="MathJax-Span-43163"><span class="msub" id="MathJax-Span-43164"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43165" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43167" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43168" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43169"><span class="msub" id="MathJax-Span-43170"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.66em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43171"><span class="mstyle" id="MathJax-Span-43172"><span class="mrow" id="MathJax-Span-43173"><span class="mi" id="MathJax-Span-43174" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43175" style="font-family: MathJax_Main;">,</span><span class="mstyle" id="MathJax-Span-43176" style="padding-left: 0.157em;"><span class="mrow" id="MathJax-Span-43177"><span class="mi" id="MathJax-Span-43178" style="font-family: MathJax_Main-bold;">k</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 1.648em;"><span class="mi" id="MathJax-Span-43179" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43180" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43181" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-43182" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 12.856em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1012.76em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -6.373em;"><span class="mrow" id="MathJax-Span-43183"><span class="mi" id="MathJax-Span-43184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-43185"><span class="mo" id="MathJax-Span-43186" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43187"><span class="msub" id="MathJax-Span-43188"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43189"><span class="mrow" id="MathJax-Span-43190"><span class="mi" id="MathJax-Span-43191" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-43192" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43193" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43194"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43195"><span class="mrow" id="MathJax-Span-43196"><span class="mi" id="MathJax-Span-43197" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mn" id="MathJax-Span-43198" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43199" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-43200"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-43202" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43203"><span class="mo" id="MathJax-Span-43204" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-43205"><span class="msup" id="MathJax-Span-43206"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43207" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43208" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43209" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-43210" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-43211"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43212" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-43213" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43214" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span class="mi" id="MathJax-Span-43215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mrow" id="MathJax-Span-43216"><span class="mo" id="MathJax-Span-43217" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-43218"><span class="mi" id="MathJax-Span-43219" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43220" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-43221"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43222" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43223" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43224" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span class="mi" id="MathJax-Span-43225" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-43226" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-43227"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-43229" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-43230" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-43231" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-43232"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.311em;"><span class="mo" id="MathJax-Span-43234" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1004.23em, 4.321em, -1000.01em); top: -3.442em; left: 50%; margin-left: -2.105em;"><span class="mrow" id="MathJax-Span-43235"><span class="mi" id="MathJax-Span-43236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-43237"><span class="mo" id="MathJax-Span-43238" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-43239"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43240" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43241" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43242" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="msup" id="MathJax-Span-43243"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1002.33em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43244"><span class="mrow" id="MathJax-Span-43245"><span class="mo" id="MathJax-Span-43246" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43247"><span class="mi" id="MathJax-Span-43248" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43249" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-43250"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43251" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43252" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43253" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 2.368em;"><span class="mn" id="MathJax-Span-43254" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1012.87em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.856em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43255" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-43256" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.5)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.845em; border-left: 0px solid; width: 0px; height: 2.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8453_5"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>0</mn></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.5)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-828"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8453_5"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>,</mo><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>,</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mn>0</mn></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>        (23.5)</mtext></math></script></p>
<p>If we pick a uniform random point on the luminaire, then <span class="cItalic">p = 1/A</span>, where <span class="cItalic">A</span> is the area of the luminaire. This gives</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-829-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8463_6&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x3C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.6)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8463_6" overflow="scroll" style="width: 24.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.962em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.774em, 1023.87em, 3.036em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43258"><span class="mrow" id="MathJax-Span-43259"><span class="msub" id="MathJax-Span-43260"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43261" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43263" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43264" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43265"><span class="msub" id="MathJax-Span-43266"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1001.66em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43267"><span class="mi" id="MathJax-Span-43268" style="font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43269" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-43270" style="font-family: MathJax_Main-bold; padding-left: 0.157em;">k</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 1.648em;"><span class="mi" id="MathJax-Span-43271" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43272" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43273" style="font-family: MathJax_Main; padding-left: 0.26em;">≈</span><span class="mfrac" id="MathJax-Span-43274" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 13.422em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1013.28em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -6.63em;"><span class="mrow" id="MathJax-Span-43275"><span class="mi" id="MathJax-Span-43276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-43277"><span class="mo" id="MathJax-Span-43278" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43279"><span class="msub" id="MathJax-Span-43280"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43281" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-43282" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43283" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msub" id="MathJax-Span-43284"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43285" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mn" id="MathJax-Span-43286" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43287" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="msub" id="MathJax-Span-43288"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.465em;"><span class="mi" id="MathJax-Span-43290" style="font-size: 50%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43291"><span class="mo" id="MathJax-Span-43292" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-43293"><span class="msup" id="MathJax-Span-43294"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43295" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43296" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43297" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-43298" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msub" id="MathJax-Span-43299"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43300" style="font-size: 70.7%; font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.414em;"><span class="mi" id="MathJax-Span-43301" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43302" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span class="mi" id="MathJax-Span-43303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mrow" id="MathJax-Span-43304"><span class="mo" id="MathJax-Span-43305" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="mrow" id="MathJax-Span-43306"><span class="mi" id="MathJax-Span-43307" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43308" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-43309"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43310" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43311" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43312" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span class="mi" id="MathJax-Span-43313" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mi" id="MathJax-Span-43314" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-43315" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msub" id="MathJax-Span-43316"><span style="display: inline-block; position: relative; width: 0.568em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43317" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.905em; left: 0.311em;"><span class="mi" id="MathJax-Span-43318" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-43319" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-43320" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-43321"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43322" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.311em;"><span class="mo" id="MathJax-Span-43323" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1002.68em, 4.321em, -1000.01em); top: -3.442em; left: 50%; margin-left: -1.334em;"><span class="mrow" id="MathJax-Span-43324"><span class="msup" id="MathJax-Span-43325"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1002.33em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43326"><span class="mrow" id="MathJax-Span-43327"><span class="mo" id="MathJax-Span-43328" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43329"><span class="mi" id="MathJax-Span-43330" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43331" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-43332"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43333" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43334" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43335" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 2.368em;"><span class="mn" id="MathJax-Span-43336" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1013.38em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 13.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43337" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-43338" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.6)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.845em; border-left: 0px solid; width: 0px; height: 2.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8463_6"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">x</mi><mo>,</mo><mi mathvariant="bold">k</mi></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub><mo>,</mo><msub><mi mathvariant="bold">k</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>A</mi><mi>cos</mi><mo>&nbsp;​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.6)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-829"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8463_6"><mrow><msub><mi>L</mi><mi>s</mi></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">x</mi><mo>,</mo><mi mathvariant="bold">k</mi></mrow><mi>o</mi></msub></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>ρ</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub><mo>,</mo><msub><mi mathvariant="bold">k</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">x</mi><mo>,</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>)</mo></mrow><mi>A</mi><mi>cos</mi><mo> ​⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>        (23.6)</mtext></math></script></p>
<p>We can use Equation (23.6) to sample planar (e.g., rectangular) luminaires in a straightforward fashion. We simply pick a random point on each luminaire.</p>
<p>The code for one luminaire is:</p>
<pre><span class="code">color directLight(<span class="cBold">x</span>, <span class="cBold">k</span><span class="cIsub">o</span>, <span class="cBold">n</span>)</span></pre>
<pre><span class="code">pick random point <span class="cBold">x′</span> with normal vector <span class="cBold">n′</span> on light</span></pre>
<pre><span class="code"><span class="cBold">d</span> = <span class="cBold">x′</span> − <span class="cBold">x</span></span></pre>
<pre><span class="code"><span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span> = <span class="cBold">d</span><span class="cItalic">/</span>∥<span class="cItalic">d</span>∥</span></pre>
<pre><span class="code"><span class="cBold">if</span> (ray <span class="cBold">x</span> + <span class="cItalic">t</span><span class="cBold">d</span> has no hits for <span class="cItalic">t</span> &lt; 1 ‒ ∈) <span class="cBold">then</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> <span class="cItalic">ρ</span>(<span class="cBold">k</span><span class="cSubscript"><span class="cItalic">i</span></span>, <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">o</span></span>)<span class="cItalic">L<span class="cSubscript">e</span></span>(<span class="cBold">x′</span>, ‒ <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>)(n · d)(‒n′ · d)<span class="cItalic">/</span>∥d∥<span class="cSuperscript">4</span></span></pre>
<pre><span class="code"><span class="cBold">else</span></span></pre>
<pre><span class="code"> <span class="cBold">return</span> 0</span></pre>
<p>The above code needs some extra tests such as clamping the cosines to zero if they are negative. Note that the term ∥<span class="cBold">d</span>∥<span class="cSuperscript">4</span> comes from the distance squared term <a id="page_621"></a>and the two cosines, e.g., <span class="cBold">n</span> · <span class="cBold">d</span> = ∥<span class="cBold">d</span>∥ cos <span class="cItalic">θ</span> because d is not necessarily a unit vector.</p>
<p>Several examples of soft shadows are shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-6">Figure 23.6</a>.</p>
<div id="art_Dest_fig_23-6" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-6"></a><span class="cBold">Figure 23.6</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-6.png" alt="Figure showing various soft shadows on a backlit sphere with a square and an area light source. Top: 1 sample. Botto 100 samples. Note that the shape of the light source is less important than its size in determining shadow appearance." width="600" height="584" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-6.png"></p>
<p class="Text figcaption">Various soft shadows on a backlit sphere with a square and an area light source. Top: 1 sample. Botto 100 samples. Note that the shape of the light source is less important than its size in determining shadow appearance.</p>
</div>
<h3><a id="sec23-3-2"></a>23.3.2 Sampling a Spherical Luminaire</h3>
<p>Though a sphere with center <span class="cBold">c</span> and radius <span class="cItalic">R</span> can be sampled using Equation (23.6), this sampling will yield a very noisy image because many samples will be on the back of the sphere, and the cos <span class="cItalic">θ′</span> term varies so much. Instead, we can use a more complex <span class="cItalic">p</span>(<span class="cBold">x′</span>) to reduce noise.</p>
<p>The first nonuniform density we might try is <span class="cItalic">p</span>(<span class="cBold">x′</span>) ∝ cos θ′. This turns out to be just as complicated as sampling with <span class="cItalic">p</span>(<span class="cBold">x′</span>) ∝ cos θ′ ∥<span class="cBold">x′</span> — <span class="cBold">x</span>∥<span class="cSuperscript">2</span>, so we instead discuss that here. We observe that sampling on the luminaire this way is the <a id="page_622"></a>same as using a constant density function <span class="cItalic">q</span>(<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>) = const defined in the space of directions subtended by the luminaire as seen from <span class="cBold">x</span>. We now use a coordinate system defined with <span class="cBold">x</span> at the origin, and a right-handed orthonormal basis with <span class="cBold">w</span> = (<span class="cBold">c</span> — <span class="cBold">x</span>)/∥<span class="cBold">c</span> − <span class="cBold">x</span>∥, and <span class="cBold">v</span> = (<span class="cBold">w</span> × <span class="cBold">n</span>)/∥(<span class="cBold">w</span> × <span class="cBold">n</span>)∥ (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-7">Figure 23.7</a>). We also define (α, ϕ) to be the azimuthal and polar angles with respect to the <span class="cItalic">uvw</span> coordinate system.</p>
<div id="art_Dest_fig_23-7" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-7"></a><span class="cBold">Figure 23.7</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-7.png" alt="Figure showing geometry for direct lighting at point × from a spherical luminaire." width="600" height="442" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-7.png"></p>
<p class="Text figcaption">Geometry for direct lighting at point × from a spherical luminaire.</p>
</div>
<p>The maximum <span class="cItalic">α</span> that includes the spherical luminaire is given by</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-830-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_847&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;arcsin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;arccos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_847" overflow="scroll" style="width: 22.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.265em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.494em, 1022.27em, 4.167em, -1000.01em); top: -3.185em; left: 0em;"><span class="mrow" id="MathJax-Span-43340"><span class="mrow" id="MathJax-Span-43341"><span class="msub" id="MathJax-Span-43342"><span style="display: inline-block; position: relative; width: 2.728em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43343" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.802em; left: 0.62em;"><span class="mrow" id="MathJax-Span-43344"><span class="mi" id="MathJax-Span-43345" style="font-size: 70.7%; font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-43346" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43347" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-43348" style="font-family: MathJax_Main; padding-left: 0.26em;">arcsin</span><span class="mo" id="MathJax-Span-43349" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mrow" id="MathJax-Span-43350" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43351" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-43352"><span class="mfrac" id="MathJax-Span-43353"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.255em;"><span class="mi" id="MathJax-Span-43354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.07em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-43355"><span class="mrow" id="MathJax-Span-43356"><span class="mo" id="MathJax-Span-43357" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43358"><span class="mstyle" id="MathJax-Span-43359"><span class="mrow" id="MathJax-Span-43360"><span class="mi" id="MathJax-Span-43361" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43362" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mstyle" id="MathJax-Span-43363"><span class="mrow" id="MathJax-Span-43364"><span class="mi" id="MathJax-Span-43365" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span></span></span><span class="mo" id="MathJax-Span-43366" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.27em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.265em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43367" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-43368" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mi" id="MathJax-Span-43369" style="font-family: MathJax_Main; padding-left: 0.26em;">arccos</span><span class="mo" id="MathJax-Span-43370" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msqrt" id="MathJax-Span-43371"><span style="display: inline-block; position: relative; width: 7.098em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1006.03em, 4.836em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-43372"><span class="mrow" id="MathJax-Span-43373"><span class="mn" id="MathJax-Span-43374" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43375" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-43376" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.116em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1003.51em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43377"><span class="mrow" id="MathJax-Span-43378"><span class="mo" id="MathJax-Span-43379" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-43380"><span class="mfrac" id="MathJax-Span-43381"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.255em;"><span class="mi" id="MathJax-Span-43382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.07em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-43383"><span class="mrow" id="MathJax-Span-43384"><span class="mo" id="MathJax-Span-43385" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43386"><span class="mstyle" id="MathJax-Span-43387"><span class="mrow" id="MathJax-Span-43388"><span class="mi" id="MathJax-Span-43389" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43390" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mstyle" id="MathJax-Span-43391"><span class="mrow" id="MathJax-Span-43392"><span class="mi" id="MathJax-Span-43393" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span></span></span><span class="mo" id="MathJax-Span-43394" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.27em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.265em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43395" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 3.704em;"><span class="mn" id="MathJax-Span-43396" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43397" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1006.13em, 3.961em, -1000.01em); top: -5.242em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 6.121em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 5.401em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.465em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.979em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.545em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.111em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.676em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.19em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.756em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.321em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.887em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.419em, 1001.04em, 5.093em, -1000.01em); top: -4.111em; left: 0em;"><span style="font-family: MathJax_Size3;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.898em; border-left: 0px solid; width: 0px; height: 2.598em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_847"><mrow><msub><mi>α</mi><mrow><mi>max</mi><mo>&nbsp;​⁡</mo></mrow></msub><mo>=</mo><mi>arcsin</mi><mo>&nbsp;​⁡</mo><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mi>arccos</mi><mo>&nbsp;​⁡</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>.</mo></mrow></msqrt></mrow></math></span></span><script type="math/mml" id="MathJax-Element-830"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_847"><mrow><msub><mi>α</mi><mrow><mi>max</mi><mo> ​⁡</mo></mrow></msub><mo>=</mo><mi>arcsin</mi><mo> ​⁡</mo><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mi>arccos</mi><mo> ​⁡</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>.</mo></mrow></msqrt></mrow></math></script></p>
<p>Thus, a uniform density (with respect to solid angle) within the cone of directions subtended by the sphere is just the reciprocal of the solid angle 2<span class="cItalic">π</span>(1 — cos <span class="cItalic">α</span>max) subtended by the sphere:</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-831-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_848&quot;&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_848" overflow="scroll" style="width: 11.879em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.519em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.082em, 1011.42em, 3.91em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43399"><span class="mrow" id="MathJax-Span-43400"><span class="mi" id="MathJax-Span-43401" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-43402" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43403" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43404"><span class="msub" id="MathJax-Span-43405"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43406"><span class="mrow" id="MathJax-Span-43407"><span class="mi" id="MathJax-Span-43408" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43410" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43411" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-43412" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 7.458em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.32em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.152em;"><span class="mn" id="MathJax-Span-43413" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1007.16em, 4.836em, -1000.01em); top: -3.031em; left: 50%; margin-left: -3.648em;"><span class="mrow" id="MathJax-Span-43414"><span class="mn" id="MathJax-Span-43415" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-43416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-43417"><span class="mo" id="MathJax-Span-43418" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">(</span></span></span><span class="mrow" id="MathJax-Span-43419"><span class="mn" id="MathJax-Span-43420" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43421" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msqrt" id="MathJax-Span-43422"><span style="display: inline-block; position: relative; width: 4.63em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1003.92em, 4.63em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-43423"><span class="mrow" id="MathJax-Span-43424"><span class="mn" id="MathJax-Span-43425" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43426" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-43427"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.58em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43428"><span class="mrow" id="MathJax-Span-43429"><span class="mo" id="MathJax-Span-43430" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-43431"><span class="mfrac" id="MathJax-Span-43432"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.499em, 1000.37em, 4.167em, -1000.01em); top: -4.368em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-43433" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.499em, 1001.45em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-43434"><span class="mrow" id="MathJax-Span-43435"><span class="mo" id="MathJax-Span-43436" style="font-size: 50%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43437"><span class="mstyle" id="MathJax-Span-43438"><span class="mrow" id="MathJax-Span-43439"><span class="mi" id="MathJax-Span-43440" style="font-size: 50%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43441" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mstyle" id="MathJax-Span-43442"><span class="mrow" id="MathJax-Span-43443"><span class="mi" id="MathJax-Span-43444" style="font-size: 50%; font-family: MathJax_Main-bold;">c</span></span></span></span><span class="mo" id="MathJax-Span-43445" style="font-size: 50%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.61em, 1.237em, -1000.01em); top: -1.231em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43446" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.625em; left: 2.728em;"><span class="mn" id="MathJax-Span-43447" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1003.92em, 1.288em, -1000.01em); top: -2.157em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 3.91em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(2.83em, 1000.73em, 4.836em, -1000.01em); top: -4.059em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">√</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43448" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1007.47em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.458em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43449" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.745em; border-left: 0px solid; width: 0px; height: 2.703em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_848"><mrow><mi>q</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-831"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_848"><mrow><mi>q</mi><mrow><mo>(</mo><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>And we get</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-832-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_849&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtable columnalign=&quot;left&quot;&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr columnalign=&quot;left&quot;&gt;&lt;mtd columnalign=&quot;left&quot;&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x3BE;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_849" overflow="scroll" style="width: 19.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.077em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(2.625em, 1018.98em, 6.738em, -1000.01em); top: -4.933em; left: 0em;"><span class="mrow" id="MathJax-Span-43451"><span class="mrow" id="MathJax-Span-43452"><span class="mrow" id="MathJax-Span-43453"><span class="mo" id="MathJax-Span-43454" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-43455"><span class="mtable" id="MathJax-Span-43456" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(2.368em, 1002.84em, 5.144em, -1000.01em); top: -4.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.84em, 4.373em, -1000.01em); top: -4.676em; left: 50%; margin-left: -1.437em;"><span class="mtd" id="MathJax-Span-43457"><span class="mrow" id="MathJax-Span-43458"><span class="mrow" id="MathJax-Span-43459"><span class="mi" id="MathJax-Span-43460" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-43461" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43462" style="font-family: MathJax_Math-italic;">α</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.373em, -1000.01em); top: -3.237em; left: 50%; margin-left: -0.306em;"><span class="mtd" id="MathJax-Span-43463"><span class="mrow" id="MathJax-Span-43464"><span class="mi" id="MathJax-Span-43465" style="font-family: MathJax_Math-italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43466" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-43467" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-43468" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-43469" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.82em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43470"><span class="mn" id="MathJax-Span-43471" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43472" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msub" id="MathJax-Span-43473" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43474" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-43475" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43476" style="font-family: MathJax_Main; padding-left: 0.208em;">+</span><span class="msub" id="MathJax-Span-43477" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43478" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-43479" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mtable" id="MathJax-Span-43480" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 6.841em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1006.85em, 6.635em, -1000.01em); top: -4.83em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.841em; height: 0px;"><span style="position: absolute; clip: rect(2.316em, 1006.85em, 4.99em, -1000.01em); top: -4.625em; left: 0em;"><span class="mtd" id="MathJax-Span-43481"><span class="mrow" id="MathJax-Span-43482"><span class="mrow" id="MathJax-Span-43483"><span class="msqrt" id="MathJax-Span-43484"><span style="display: inline-block; position: relative; width: 6.841em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1005.82em, 4.836em, -1000.01em); top: -4.008em; left: 0.979em;"><span class="mrow" id="MathJax-Span-43485"><span class="mrow" id="MathJax-Span-43486"><span class="mn" id="MathJax-Span-43487" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43488" style="font-family: MathJax_Main; padding-left: 0.208em;">−</span><span class="msup" id="MathJax-Span-43489" style="padding-left: 0.208em;"><span style="display: inline-block; position: relative; width: 4.116em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1003.51em, 4.836em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43490"><span class="mrow" id="MathJax-Span-43491"><span class="mo" id="MathJax-Span-43492" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-43493"><span class="mfrac" id="MathJax-Span-43494"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.396em, 1000.52em, 4.167em, -1000.01em); top: -4.419em; left: 50%; margin-left: -0.255em;"><span class="mi" id="MathJax-Span-43495" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.345em, 1002.07em, 4.321em, -1000.01em); top: -3.596em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-43496"><span class="mrow" id="MathJax-Span-43497"><span class="mo" id="MathJax-Span-43498" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43499"><span class="mstyle" id="MathJax-Span-43500"><span class="mrow" id="MathJax-Span-43501"><span class="mi" id="MathJax-Span-43502" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-43503" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mstyle" id="MathJax-Span-43504"><span class="mrow" id="MathJax-Span-43505"><span class="mi" id="MathJax-Span-43506" style="font-size: 70.7%; font-family: MathJax_Main-bold;">c</span></span></span></span><span class="mo" id="MathJax-Span-43507" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1002.27em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.265em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43508" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.882em; left: 3.704em;"><span class="mn" id="MathJax-Span-43509" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.602em, 1005.82em, 3.961em, -1000.01em); top: -5.242em; left: 0.979em;"><span style="display: inline-block; position: relative; width: 5.812em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.008em; left: 5.144em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.414em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 0.928em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 1.442em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.008em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 2.522em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.036em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 3.55em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.064em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.008em; left: 4.63em;">−<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.419em, 1001.04em, 5.093em, -1000.01em); top: -4.111em; left: 0em;"><span style="font-family: MathJax_Size3;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.97em, 4.373em, -1000.01em); top: -2.568em; left: 0em;"><span class="mtd" id="MathJax-Span-43510"><span class="mrow" id="MathJax-Span-43511"><span class="mrow" id="MathJax-Span-43512"><span class="mn" id="MathJax-Span-43513" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-43514" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msub" id="MathJax-Span-43515"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.42em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43516" style="font-family: MathJax_Math-italic;">ξ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mn" id="MathJax-Span-43517" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.836em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43518" style="vertical-align: 2.162em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.82em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.797em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43519" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.938em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.745em; border-left: 0px solid; width: 0px; height: 4.08em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_849"><mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mi>ϕ</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ξ</mi><mn>1</mn></msub><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>2</mn></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-832"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_849"><mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mi>cos</mi><mo> ​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mi>ϕ</mi></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ξ</mi><mn>1</mn></msub><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mstyle mathvariant="bold" mathsize="normal"><mi>x</mi></mstyle><mo>−</mo><mstyle mathvariant="bold" mathsize="normal"><mi>c</mi></mstyle></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mn>2</mn><mi>π</mi><msub><mi>ξ</mi><mn>2</mn></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>This gives us the direction <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>. To find the actual point, we need to find the first point on the sphere in that direction. The ray in that direction is just (<span class="cBold">x</span> + <span class="cItalic">t</span><span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>), <a id="page_623"></a>where <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span> is given by</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-833-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_850&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3D5;&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x3B1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_850" overflow="scroll" style="width: 17.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.712em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.956em, 1016.62em, 6.224em, -1000.01em); top: -4.316em; left: 0em;"><span class="mrow" id="MathJax-Span-43521"><span class="mrow" id="MathJax-Span-43522"><span class="msub" id="MathJax-Span-43523"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43524"><span class="mrow" id="MathJax-Span-43525"><span class="mi" id="MathJax-Span-43526" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43527" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43528" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mrow" id="MathJax-Span-43529" style="padding-left: 0.26em;"><span class="mo" id="MathJax-Span-43530" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.717em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43531"><span class="mtable" id="MathJax-Span-43532" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 4.836em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1001.04em, 6.429em, -1000.01em); top: -4.573em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.04em, 4.321em, -1000.01em); top: -5.447em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-43533"><span class="mrow" id="MathJax-Span-43534"><span class="mrow" id="MathJax-Span-43535"><span class="msub" id="MathJax-Span-43536"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43537" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43538" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.476em, -1000.01em); top: -4.008em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-43551"><span class="mrow" id="MathJax-Span-43552"><span class="mrow" id="MathJax-Span-43553"><span class="msub" id="MathJax-Span-43554"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43555" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.321em, -1000.01em); top: -2.465em; left: 50%; margin-left: -0.512em;"><span class="mtd" id="MathJax-Span-43569"><span class="mrow" id="MathJax-Span-43570"><span class="mrow" id="MathJax-Span-43571"><span class="msub" id="MathJax-Span-43572"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43573" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.568em;"><span class="mi" id="MathJax-Span-43574" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.578em;"></span></span><span style="position: absolute; clip: rect(2.573em, 1000.99em, 6.429em, -1000.01em); top: -4.573em; left: 1.853em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.99em, 4.321em, -1000.01em); top: -5.447em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-43539"><span class="mrow" id="MathJax-Span-43540"><span class="mrow" id="MathJax-Span-43541"><span class="msub" id="MathJax-Span-43542"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43543" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-43544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.94em, 4.476em, -1000.01em); top: -4.008em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-43557"><span class="mrow" id="MathJax-Span-43558"><span class="mrow" id="MathJax-Span-43559"><span class="msub" id="MathJax-Span-43560"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43561" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-43562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.88em, 4.321em, -1000.01em); top: -2.465em; left: 50%; margin-left: -0.46em;"><span class="mtd" id="MathJax-Span-43575"><span class="mrow" id="MathJax-Span-43576"><span class="mrow" id="MathJax-Span-43577"><span class="msub" id="MathJax-Span-43578"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43579" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.465em;"><span class="mi" id="MathJax-Span-43580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.578em;"></span></span><span style="position: absolute; clip: rect(2.573em, 1001.19em, 6.429em, -1000.01em); top: -4.573em; left: 3.602em;"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.19em, 4.321em, -1000.01em); top: -5.447em; left: 50%; margin-left: -0.614em;"><span class="mtd" id="MathJax-Span-43545"><span class="mrow" id="MathJax-Span-43546"><span class="mrow" id="MathJax-Span-43547"><span class="msub" id="MathJax-Span-43548"><span style="display: inline-block; position: relative; width: 1.185em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43549" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-43550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.476em, -1000.01em); top: -4.008em; left: 50%; margin-left: -0.563em;"><span class="mtd" id="MathJax-Span-43563"><span class="mrow" id="MathJax-Span-43564"><span class="mrow" id="MathJax-Span-43565"><span class="msub" id="MathJax-Span-43566"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43567" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-43568" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1001.14em, 4.321em, -1000.01em); top: -2.465em; left: 50%; margin-left: -0.563em;"><span class="mtd" id="MathJax-Span-43581"><span class="mrow" id="MathJax-Span-43582"><span class="mrow" id="MathJax-Span-43583"><span class="msub" id="MathJax-Span-43584"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.68em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43585" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.722em;"><span class="mi" id="MathJax-Span-43586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.578em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43587" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.717em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-43588" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43589" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43590"><span class="mtable" id="MathJax-Span-43591" style="padding-right: 0.157em; padding-left: 0.157em;"><span style="display: inline-block; position: relative; width: 5.761em; height: 0px;"><span style="position: absolute; clip: rect(2.522em, 1005.72em, 6.738em, -1000.01em); top: -4.882em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.761em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1005.72em, 4.373em, -1000.01em); top: -5.396em; left: 50%; margin-left: -2.877em;"><span class="mtd" id="MathJax-Span-43592"><span class="mrow" id="MathJax-Span-43593"><span class="mrow" id="MathJax-Span-43594"><span class="mi" id="MathJax-Span-43595" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-43596" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43597" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mi" id="MathJax-Span-43598" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-43599" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43600" style="font-family: MathJax_Math-italic;">α</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1005.62em, 4.373em, -1000.01em); top: -3.956em; left: 50%; margin-left: -2.825em;"><span class="mtd" id="MathJax-Span-43601"><span class="mrow" id="MathJax-Span-43602"><span class="mrow" id="MathJax-Span-43603"><span class="mi" id="MathJax-Span-43604" style="font-family: MathJax_Main;">sin</span><span class="mo" id="MathJax-Span-43605" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43606" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mi" id="MathJax-Span-43607" style="font-family: MathJax_Main; padding-left: 0.157em;">sin</span><span class="mo" id="MathJax-Span-43608" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43609" style="font-family: MathJax_Math-italic;">α</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.036em, 1002.84em, 4.373em, -1000.01em); top: -2.517em; left: 50%; margin-left: -1.437em;"><span class="mtd" id="MathJax-Span-43610"><span class="mrow" id="MathJax-Span-43611"><span class="mrow" id="MathJax-Span-43612"><span class="mi" id="MathJax-Span-43613" style="font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-43614" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="mi" id="MathJax-Span-43615" style="font-family: MathJax_Math-italic;">α</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.887em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43616" style="vertical-align: 2.213em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.877em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.769em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.746em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43617" style="font-family: MathJax_Main; padding-left: 0.157em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.851em; border-left: 0px solid; width: 0px; height: 4.186em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_850"><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>x</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>u</mi><mi>y</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>y</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>y</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>u</mi><mi>z</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>z</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>z</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>ϕ</mi><mi>sin</mi><mo>&nbsp;​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><mi>α</mi></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-833"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_850"><mrow><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>x</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>u</mi><mi>y</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>y</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>y</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>u</mi><mi>z</mi></msub></mrow></mtd><mtd><mrow><msub><mi>v</mi><mi>z</mi></msub></mrow></mtd><mtd><mrow><msub><mi>w</mi><mi>z</mi></msub></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mi>cos</mi><mo> ​⁡</mo><mi>ϕ</mi><mi>sin</mi><mo> ​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>sin</mi><mo> ​⁡</mo><mi>ϕ</mi><mi>sin</mi><mo> ​⁡</mo><mi>α</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>cos</mi><mo> ​⁡</mo><mi>α</mi></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></script></p>
<p>We must also calculate <span class="cItalic">p</span>(<span class="cBold">x′</span>), the probability density function with respect to the area measure (recall that the density function <span class="cItalic">q</span> is defined in solid angle space). Since we know that <span class="cItalic">q</span> is a valid probability density function using the <span class="cItalic">ω</span> measure, and we know that <span class="cItalic">d</span>Ω = <span class="cItalic">dA</span>(<span class="cBold">x′</span>) cos <span class="cItalic">θ</span>′<span class="cItalic">/</span>∥<span class="cBold">x′</span> — <span class="cBold">x</span>∥<span class="cSuperscript">2</span>, we can relate any probability density function <span class="cItalic">q</span>(<span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>) with its associated probability density function <span class="cItalic">p</span>(<span class="cBold">x′</span>):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-834-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_8513_7&quot;&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;&amp;#xA0;(23.7)&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_8513_7" overflow="scroll" style="width: 12.959em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.548em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.774em, 1012.45em, 3.036em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43619"><span class="mrow" id="MathJax-Span-43620"><span class="mi" id="MathJax-Span-43621" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-43622" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43623" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43624"><span class="msub" id="MathJax-Span-43625"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43626" style="font-family: MathJax_Main-bold;">k</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43628" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-43629" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-43630" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 4.013em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1003.92em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.951em;"><span class="mrow" id="MathJax-Span-43631"><span class="mi" id="MathJax-Span-43632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-43633"><span class="mo" id="MathJax-Span-43634" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="msup" id="MathJax-Span-43635"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43636" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43637" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43638" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span><span class="mi" id="MathJax-Span-43639" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">cos</span><span class="mo" id="MathJax-Span-43640" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-43641"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43642" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.311em;"><span class="mo" id="MathJax-Span-43643" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1002.68em, 4.321em, -1000.01em); top: -3.442em; left: 50%; margin-left: -1.334em;"><span class="mrow" id="MathJax-Span-43644"><span class="msup" id="MathJax-Span-43645"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1002.33em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43646"><span class="mrow" id="MathJax-Span-43647"><span class="mo" id="MathJax-Span-43648" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43649"><span class="msup" id="MathJax-Span-43650"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43651" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43652" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43653" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-43654" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span><span class="mo" id="MathJax-Span-43655" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 2.368em;"><span class="mn" id="MathJax-Span-43656" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1004.02em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.013em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43657" style="font-family: MathJax_Main;">.</span></span><span class="mtext" id="MathJax-Span-43658" style="font-family: MathJax_Main; padding-left: 0.157em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.7)</span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.845em; border-left: 0px solid; width: 0px; height: 2.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8513_7"><mrow><mi>q</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>−</mo><mi mathvariant="bold">x</mi></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(23.7)</mtext></math></span></span><script type="math/mml" id="MathJax-Element-834"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_8513_7"><mrow><mi>q</mi><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><msup><mrow><mrow><mo>||</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>−</mo><mi mathvariant="bold">x</mi></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup></mrow></mfrac><mo>.</mo></mrow><mtext>       (23.7)</mtext></math></script></p>
<p>So we can solve for <span class="cItalic">p</span>(<span class="cBold">x′</span>):</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-835-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_852&quot;&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;||&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_852" overflow="scroll" style="width: 14.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.193em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1014.1em, 3.91em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43660"><span class="mrow" id="MathJax-Span-43661"><span class="mi" id="MathJax-Span-43662" style="font-family: MathJax_Math-italic;">p</span><span class="mrow" id="MathJax-Span-43663" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43664" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="msup" id="MathJax-Span-43665"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43666" style="font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-43667" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43668" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-43669" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-43670" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 10.131em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.293em, 1002.17em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.077em;"><span class="mrow" id="MathJax-Span-43671"><span class="mi" id="MathJax-Span-43672" style="font-size: 70.7%; font-family: MathJax_Main;">cos</span><span class="mo" id="MathJax-Span-43673" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.26em;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span><span class="msup" id="MathJax-Span-43674"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.32em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.316em; left: 0.311em;"><span class="mo" id="MathJax-Span-43676" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.779em, 1009.88em, 4.836em, -1000.01em); top: -3.031em; left: 50%; margin-left: -4.985em;"><span class="mrow" id="MathJax-Span-43677"><span class="mn" id="MathJax-Span-43678" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-43679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-43680"><span style="display: inline-block; position: relative; width: 2.676em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1002.33em, 4.321em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43681"><span class="mrow" id="MathJax-Span-43682"><span class="mo" id="MathJax-Span-43683" style="font-size: 70.7%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43684"><span class="msup" id="MathJax-Span-43685"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43686" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.213em; left: 0.414em;"><span class="mo" id="MathJax-Span-43687" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43688" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-43689" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span><span class="mo" id="MathJax-Span-43690" style="font-size: 70.7%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 2.368em;"><span class="mn" id="MathJax-Span-43691" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43692"><span class="mo" id="MathJax-Span-43693" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">(</span></span></span><span class="mrow" id="MathJax-Span-43694"><span class="mn" id="MathJax-Span-43695" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43696" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msqrt" id="MathJax-Span-43697"><span style="display: inline-block; position: relative; width: 4.63em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1003.92em, 4.63em, -1000.01em); top: -4.008em; left: 0.722em;"><span class="mrow" id="MathJax-Span-43698"><span class="mrow" id="MathJax-Span-43699"><span class="mn" id="MathJax-Span-43700" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-43701" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msup" id="MathJax-Span-43702"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.58em, 4.63em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43703"><span class="mrow" id="MathJax-Span-43704"><span class="mo" id="MathJax-Span-43705" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span><span class="mrow" id="MathJax-Span-43706"><span class="mfrac" id="MathJax-Span-43707"><span style="display: inline-block; position: relative; width: 1.648em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.499em, 1000.37em, 4.167em, -1000.01em); top: -4.368em; left: 50%; margin-left: -0.203em;"><span class="mi" id="MathJax-Span-43708" style="font-size: 50%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.499em, 1001.45em, 4.27em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.769em;"><span class="mrow" id="MathJax-Span-43709"><span class="mrow" id="MathJax-Span-43710"><span class="mo" id="MathJax-Span-43711" style="font-size: 50%; font-family: MathJax_Main;">||</span><span class="mrow" id="MathJax-Span-43712"><span class="mi" id="MathJax-Span-43713" style="font-size: 50%; font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-43714" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-43715" style="font-size: 50%; font-family: MathJax_Main-bold;">c</span></span><span class="mo" id="MathJax-Span-43716" style="font-size: 50%; font-family: MathJax_Main;">||</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1001.61em, 1.237em, -1000.01em); top: -1.231em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.648em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43717" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.625em; left: 2.728em;"><span class="mn" id="MathJax-Span-43718" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.979em, 1003.92em, 1.288em, -1000.01em); top: -2.157em; left: 0.722em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.049em; border-top: 1.3px solid; width: 3.91em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span><span style="position: absolute; clip: rect(2.83em, 1000.73em, 4.836em, -1000.01em); top: -4.059em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">√</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43719" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size3;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1010.14em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 10.131em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-43720" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.745em; border-left: 0px solid; width: 0px; height: 2.968em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_852"><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>cos</mi><mo>&nbsp;​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><mn>2</mn><mi>π</mi><msup><mrow><mrow><mo>||</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>−</mo><mi mathvariant="bold">x</mi></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><mi mathvariant="bold">c</mi></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-835"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_852"><mrow><mi>p</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>cos</mi><mo> ​⁡</mo><msup><mi>θ</mi><mo>′</mo></msup></mrow><mrow><mn>2</mn><mi>π</mi><msup><mrow><mrow><mo>||</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>−</mo><mi mathvariant="bold">x</mi></mrow><mo>||</mo></mrow></mrow><mn>2</mn></msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mi>R</mi><mrow><mrow><mo>||</mo><mrow><mi mathvariant="bold">x</mi><mo>−</mo><mi mathvariant="bold">c</mi></mrow><mo>||</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></mrow></math></script></p>
<p>A good debugging case for this is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-8">Figure 23.8</a>.</p>
<div id="art_Dest_fig_23-8" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-8"></a><span class="cBold">Figure 23.8</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-8.png" alt="Figure showing a sphere with Le = 1 touching a sphere of reflectance 1. Where the two spheres touch, the reflective sphere should have L(x′) = 1 . Left: 1 sample. Middle: 100 samples. Right: 100 samples, close-up." width="600" height="196" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-8.png"></p>
<p class="Text figcaption">A sphere with L<span class="cItalic">e</span> = 1 touching a sphere of reflectance 1. Where the two spheres touch, the reflective sphere should have L(<span class="cBold">x</span>′) = 1 . Left: 1 sample. Middle: 100 samples. Right: 100 samples, close-up.</p>
</div>
<h3><a id="sec23-3-3"></a>23.3.3 Nondiffuse Luminaries</h3>
<p>There is no reason the luminance of the luminaire cannot vary with both direction and position. For example, it can vary with position if the luminaire is a television. It can vary with direction for car headlights and other directional sources. Little in our analysis need change from the previous sections, except that <span class="cItalic">L<span class="cSubscript">e</span></span>(<span class="cBold">x′</span>) must change to <span class="cItalic">L<span class="cSubscript">e</span></span>(<span class="cBold">x′</span>, — <span class="cBold">k</span><span class="cItalic"><span class="cSubscript">i</span></span>). The simplest way to vary the intensity with direction is to use a Phong-like pattern with respect to the normal vector <span class="cBold">n</span>′. To avoid using an exponent in the term for the total light output, we can use the form</p>
<p class="Equation"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-836-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; overflow=&quot;scroll&quot; id=&quot;eq_853&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle mathvariant=&quot;bold&quot; mathsize=&quot;normal&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mstyle&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x3C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mtext mathvariant=&quot;italic&quot;&gt;cos&lt;/mtext&gt;&lt;mo&gt;&amp;#xA0;&amp;#x200B;&amp;#x2061;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x3B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="eq_853" overflow="scroll" style="width: 15.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.324em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.825em, 1015.28em, 2.625em, -1000.01em); top: -2.105em; left: 0em;"><span class="mrow" id="MathJax-Span-43722"><span class="mrow" id="MathJax-Span-43723"><span class="msub" id="MathJax-Span-43724"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.63em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43725" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="mi" id="MathJax-Span-43726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mrow" id="MathJax-Span-43727" style="padding-left: 0.157em;"><span class="mo" id="MathJax-Span-43728" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mrow" id="MathJax-Span-43729"><span class="msup" id="MathJax-Span-43730"><span style="display: inline-block; position: relative; width: 0.877em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43731" style="font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.62em;"><span class="mo" id="MathJax-Span-43732" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43733" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-43734" style="font-family: MathJax_Main; padding-left: 0.157em;">−</span><span class="msub" id="MathJax-Span-43735"><span style="display: inline-block; position: relative; width: 0.928em; height: 0px;"><span style="position: absolute; clip: rect(3.19em, 1000.58em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mstyle" id="MathJax-Span-43736"><span class="mrow" id="MathJax-Span-43737"><span class="mi" id="MathJax-Span-43738" style="font-family: MathJax_Main-bold;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.62em;"><span class="mi" id="MathJax-Span-43739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-43740" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-43741" style="font-family: MathJax_Main; padding-left: 0.26em;">=</span><span class="mfrac" id="MathJax-Span-43742" style="padding-left: 0.26em;"><span style="display: inline-block; position: relative; width: 3.704em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.345em, 1003.51em, 4.321em, -1000.01em); top: -4.573em; left: 50%; margin-left: -1.797em;"><span class="mrow" id="MathJax-Span-43743"><span class="mrow" id="MathJax-Span-43744"><span class="mo" id="MathJax-Span-43745" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43746"><span class="mi" id="MathJax-Span-43747" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-43748" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-43749" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-43750" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span class="mi" id="MathJax-Span-43751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-43752"><span class="mo" id="MathJax-Span-43753" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">(</span></span></span><span class="msup" id="MathJax-Span-43754"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px;"><span style="position: absolute; clip: rect(3.55em, 1000.42em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-43755" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.414em;"><span class="mo" id="MathJax-Span-43756" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43757" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.78em, 4.167em, -1000.01em); top: -3.648em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-43758"><span class="mn" id="MathJax-Span-43759" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-43760" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.877em, 1003.71em, 1.237em, -1000.01em); top: -1.283em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.704em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="msup" id="MathJax-Span-43761"><span style="display: inline-block; position: relative; width: 4.116em; height: 0px;"><span style="position: absolute; clip: rect(3.036em, 1002.12em, 4.373em, -1000.01em); top: -4.008em; left: 0em;"><span class="mrow" id="MathJax-Span-43762"><span class="mtext" id="MathJax-Span-43763" style="font-family: MathJax_Math-italic;">c<span style="font-family: MathJax_Math-italic;">o</span><span style="font-family: MathJax_Math-italic;">s</span></span><span class="mo" id="MathJax-Span-43764" style="font-family: MathJax_Main;">&nbsp;<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 97%; font-style: normal; font-weight: normal;">​</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.522em; left: 2.162em;"><span class="mrow" id="MathJax-Span-43765"><span class="mrow" id="MathJax-Span-43766"><span class="mo" id="MathJax-Span-43767" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-43768"><span class="mi" id="MathJax-Span-43769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-43770" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-43771" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span class="mo" id="MathJax-Span-43772" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msup" id="MathJax-Span-43773"><span style="display: inline-block; position: relative; width: 0.722em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.47em, 4.167em, -1000.01em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-43774" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.465em;"><span class="mo" id="MathJax-Span-43775" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-43776" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.111em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.644em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_853"><mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mi>E</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msup><mrow><mtext mathvariant="italic">cos</mtext><mo>&nbsp;​⁡</mo></mrow><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msup><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-836"><math xmlns="http://www.w3.org/1998/Math/MathML" overflow="scroll" id="eq_853"><mrow><msub><mi>L</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>,</mo><mo>−</mo><msub><mstyle mathvariant="bold" mathsize="normal"><mi>k</mi></mstyle><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mi>E</mi><mrow><mo>(</mo><msup><mtext mathvariant="bold">x</mtext><mo>′</mo></msup><mo>)</mo></mrow></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msup><mrow><mtext mathvariant="italic">cos</mtext><mo> ​⁡</mo></mrow><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msup><msup><mi>θ</mi><mo>′</mo></msup><mo>,</mo></mrow></math></script></p>
<p><a id="page_624"></a>where <span class="cItalic">E</span> (<span class="cBold">x′</span>) is the <span class="cItalic">radiant exitance</span> (power per unit area) at point <span class="cBold">x′</span>, and <span class="cItalic">n</span> is the Phong exponent. You get a diffuse light for <span class="cItalic">n</span> = 1. If the light is nonuniform across its area, e.g., as a television set is, then <span class="cItalic">E</span> will not be a constant.</p>
<h2><a id="sec23-4"></a>Frequently Asked Questions</h2>
<p><span class="cBold">• My pixel values are no longer in some sensible zero-to-one range. What should I display?</span></p>
<p>You should use one of the <span class="cItalic">tone reproduction</span> techniques described in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C021.xhtml">Chapter 21</a>.</p>
<p><span class="cBold">• What global illumination techniques are used in practice?</span></p>
<p>For batch rendering of complex scenes, path tracing with one level of reflection is often used. Path tracing is often augmented with a particle tracing preprocess as described in Jensen’s book in the chapter notes. For walkthrough games, some form of world-space preprocess is often used, such as the particle tracing described in this chapter. For scenes with very complicated specular transport, an elegant but involved method, Metropolis Light Transport (Veach &amp; Guibas, 1997) may be the best choice.</p>
<p><span class="cBold">• How does the ambient component relate to global illumination?</span></p>
<p>For diffuse scenes, the radiance of a surface is proportional to the product of the irradiance at the surface and the reflectance of the surface. The ambient component is just an approximation to the irradiance scaled by the inverse of <span class="cItalic">π</span>. So although it is a crude approximation, there can be some methodology to guessing it (M. F Cohen, Chen, Wallace, &amp; Greenberg, 1988), and it is probably more accurate than doing nothing, i.e., using zero for the ambient term. Because the indirect irradiance can vary widely within a scene, using a different constant for each surface can be used for better results rather than using a global ambient term.</p>
<p><span class="cBold">• Why do most algorithms compute direct lighting using traditional ray tracing?</span></p>
<p>Although global illumination algorithms automatically compute direct lighting, and it is, in fact, slightly more complicated to make them compute only indirect lighting, it is usually faster to compute direct lighting separately. There are three reasons for this.  First, indirect lighting tends to be smooth compared to <a id="page_625"></a>direct lighting (see <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-1">Figure 23.1</a>) so coarser representations can be used, e.g., low-resolution texture maps for particle tracing. The second reason is that light sources tend to be small, and it is rare to hit them by chance in a “from the eye” method such as path tracing, while direct shadow rays are efficient. The third reason is that direct lighting allows stratified sampling, so it converges rapidly compared to unstratified sampling. The issue of stratification is the reason that shadow rays are used in Metropolis Light Transport despite the stability of its default technique for dealing with direct lighting as just one type of path to handle.</p>
<p><span class="cBold">• How artificial is it to assume ideal diffuse and specular behavior?</span></p>
<p>For environments that have only matte and mirrored surfaces, the Lambertian/ specular assumption works well. A comparison between a rendering using that assumption and a photograph is shown in <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#Text_Anchor_fig_23-9">Figure 23.9</a>.</p>
<div id="art_Dest_fig_23-9" class="ArtGroup">
<p class="Text fignumber"><a id="Text_Anchor_fig_23-9"></a><span class="cBold">Figure 23.9</span></p>
<p class="ObjectLine"><img src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/fig23-9.png" alt="Figure showing a comparison between a rendering and a photo." width="600" height="251" data-mfp-src="/library/view/fundamentals-of-computer/9781482229417/image/fig23-9.png"></p>
<p class="Text figcaption">A comparison between a rendering and a photo.</p>
<p class="Text figsource"><span class="cItalic">Image courtesy Sumant Pattanaik and the Cornell Program of Computer Graphics.</span></p>
</div>
<p><span class="cBold">• How many shadow rays are needed per pixel?</span></p>
<p>Typically between 16 and 400. Using narrow penumbra, a large ambient term (or a large indirect component), and a masking texture (Ferwerda, Shirley, Pattanaik, &amp; Greenberg, 1997) can reduce the number needed.</p>
<p><span class="cBold">• How do I sample something like a filament with a metal reflector where much of the light is reflected from the filament?</span></p>
<p>Typically, the whole light is replaced by a simple source that approximates its aggregate behavior. For viewing rays, the complicated source is used. So a car <a id="page_626"></a>headlight would look complex to the viewer, but the lighting code might see simple disk-shaped lights.</p>
<p><span class="cBold">• Isn’t something like the sky a luminaire?</span></p>
<p>Yes, and you can treat it as one. However, such large light sources may not be helped by direct lighting; the brute-force techniques are likely to work better.</p>
<h2><a id="sec23-5"></a>Notes</h2>
<p>Global illumination has its roots in the fields of heat transfer and illumination engineering as documented in <span class="cItalic">Radiosity: A Programmer’s Perspective</span> (Ashdown, 1994). Other good books related to global illumination include <span class="cItalic">Radiosity and Global Illumination</span> (M. F. Cohen &amp; Wallace, 1993), <span class="cItalic">Radiosity and Realistic Image Synthesis</span> (Sillion &amp; Puech, 1994), <span class="cItalic">Principles of Digital Image Synthesis</span> (Glassner, 1995), <span class="cItalic">Realistic Image Synthesis Using Photon Mapping</span> (Jensen, 2001), <span class="cItalic">Advanced Global Illumination</span> (Dutreé, Bala, &amp; Bekaert, 2002), and <span class="cItalic">Physically Based Rendering</span> (Pharr &amp; Humphreys, 2004). The probabilistic methods discussed in this chapter are from <span class="cItalic">Monte Carlo Techniques for Direct Lighting Calculations</span> (Shirley, Wang, &amp; Zimmerman, 1996).</p>
<h2><a id="sec23-6"></a>Exercises</h2>
<ol>
<li class="LX">For a closed environment, where every surface is a diffuse reflector and emittor with reflectance <span class="cItalic">R</span> and emitted radiance <span class="cItalic">E</span>, what is the total radiance at each point? <span class="cItalic">Hint: for R</span> = 0.5 <span class="cItalic">and E</span> = 0.25 <span class="cItalic">the answer is</span> 0.5. This is an excellent debugging case.</li>
<li class="LX">Using the definitions from <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C018.xhtml">Chapter 18</a>, verify Equation (23.1).</li>
<li class="LX">If we want to render a typically sized room with textures at centimetersquare resolution, approximately how many particles should we send to get an average of about 1000 hits per texel?</li>
<li class="LX">Develop a method to take random samples with uniform density from a disk.</li>
<li class="LX">Develop a method to take random samples with uniform density from a triangle.</li>
<li class="LX">Develop a method to take uniform random samples on a “sky dome” (the inside of a hemisphere).</li>
</ol>
<div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-20" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C022.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Chapter 22 Implicit Modeling</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C024.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Chapter 24 Reflection Models</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" class="icon-up" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://learning.oreilly.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://learning.oreilly.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://learning.oreilly.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://learning.oreilly.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://learning.oreilly.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://learning.oreilly.com/online-learning/apps.html">Get the App</a></li>
      <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"licenseKey":"510f1a6865","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","beacon":"bam.nr-data.net","queueTime":2,"applicationID":"3275661,67267027,67267028","applicationTime":155,"agent":""}</script>


    
    <script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource" charset="utf-8"></script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/embed.js.download"></script><script type="text/javascript" id="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.3614381240402751"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7124633219858325" width="0" height="0" alt="" src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/0"></div>



    <script src="./Chapter 23 Global Illumination - Fundamentals of Computer Graphics, 4th Edition_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 201.003px; left: 1818px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/fundamentals-of-computer/9781482229417/K22616_C023.xhtml#">Reset</a>
</div>
</div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_SansSerif-italic, sans-serif;"></div></div></body></html>